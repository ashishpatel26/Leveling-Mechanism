<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Time Series Forecast Study with Python: Monthly Sales of French Champagne - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Time Series Forecast Study with Python: Monthly Sales of French Champagne - Machine Learning Mastery" property="og:title"/>
<meta content="Time series forecasting is a process, and the only way to get good forecasts is to practice this process. In this tutorial, you will discover how to forecast the monthly sales of French champagne with Python. Working through this tutorial will provide you with a framework for the steps and the tools for working through …" property="og:description"/>
<meta content="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Time Series" property="article:section"/>
<meta content="2017-02-20T05:00:36+11:00" property="article:published_time"/>
<meta content="2017-03-30T09:17:59+11:00" property="article:modified_time"/>
<meta content="2017-03-30T09:17:59+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Time-Series-Forecast-Study-with-Python-Monthly-Sales-of-French-Champagne.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Time-Series-Forecast-Study-with-Python-Monthly-Sales-of-French-Champagne.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/time-series-forecast-study-python-monthly-sales-french-champagne\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/feed/" rel="alternate" title="Machine Learning Mastery » Time Series Forecast Study with Python: Monthly Sales of French Champagne Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3725" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-forecast-study-python-monthly-sales-french-champagne%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-forecast-study-python-monthly-sales-french-champagne%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3725 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3725 post type-post status-publish format-standard has-post-thumbnail hentry category-time-series">
<header>
<h1 class="title entry-title">Time Series Forecast Study with Python: Monthly Sales of French Champagne</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-02-20T05:00:36+1100">February 20, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/time-series/" title="View all items in Time Series">Time Series</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-forecast-study-python-monthly-sales-french-champagne%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/&amp;summary=Time+series+forecasting+is+a+process%2C+and+the+only+way+to+get+good+forecasts+is+to+practice+this+pro..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/&amp;summary=Time+series+forecasting+is+a+process%2C+and+the+only+way+to+get+good+forecasts+is+to+practice+this+pro...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Time series forecasting is a process, and the only way to get good forecasts is to practice this process.</p>
<p>In this tutorial, you will discover how to forecast the monthly sales of French champagne with Python.</p>
<p>Working through this tutorial will provide you with a framework for the steps and the tools for working through your own time series forecasting problems.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to confirm your Python environment and carefully define a time series forecasting problem.</li>
<li>How to create a test harness for evaluating models, develop a baseline forecast, and better understand your problem with the tools of time series analysis.</li>
<li>How to develop an autoregressive integrated moving average model, save it to file, and later load it to make predictions for new time steps.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Mar/2017</strong>: Fixed a typo in the code example in the “Review Residual Errors” section where the wrong model was run.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3726" style="max-width: 650px"><img alt="Time Series Forecast Study with Python - Monthly Sales of French Champagne" class="size-full wp-image-3726" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Time-Series-Forecast-Study-with-Python-Monthly-Sales-of-French-Champagne.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Time-Series-Forecast-Study-with-Python-Monthly-Sales-of-French-Champagne.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Time-Series-Forecast-Study-with-Python-Monthly-Sales-of-French-Champagne-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Time Series Forecast Study with Python – Monthly Sales of French Champagne<br/>Photo by <a href="https://www.flickr.com/photos/basheertome/5976017913/">Basheer Tome</a>, some rights reserved.</p></div>
<h2>Overview</h2>
<p>In this tutorial, we will work through a time series forecasting project from end-to-end, from downloading the dataset and defining the problem to training a final model and making predictions.</p>
<p>This project is not exhaustive, but shows how you can get good results quickly by working through a time series forecasting problem systematically.</p>
<p>The steps of this project that we will through are as follows.</p>
<ol>
<li>Environment.</li>
<li>Problem Description.</li>
<li>Test Harness.</li>
<li>Persistence.</li>
<li>Data Analysis.</li>
<li>ARIMA Models.</li>
<li>Model Validation.</li>
</ol>
<p>This will provide a template for working through a time series prediction problem that you can use on your own dataset.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Stop learning Time Series Forecasting the <em>slow way</em>!</h3>
<p>Take my free 7-day email course and discover data prep, modeling and more (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/14158d173f72a2%3A164f8be4f346dc/5760744339537920/" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="14158d173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/14158d173f72a2%3A164f8be4f346dc/5760744339537920/" src="https://machinelearningmastery.leadpages.co/leadbox-1487347410.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>1. Environment</h2>
<p>This tutorial assumes an installed and working SciPy environment and dependencies, including:</p>
<ul>
<li>SciPy</li>
<li>NumPy</li>
<li>Matplotlib</li>
<li>Pandas</li>
<li>scikit-learn</li>
<li>statsmodels</li>
</ul>
<p>If you need help installing Python and the SciPy environment on your workstation, consider the <a href="https://www.continuum.io/downloads">Anaconda distribution</a> that manages much of it for you.</p>
<p>This script will help you check your installed versions of these libraries.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a06269685325" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# scipy
import scipy
print('scipy: %s' % scipy.__version__)
# numpy
import numpy
print('numpy: %s' % numpy.__version__)
# matplotlib
import matplotlib
print('matplotlib: %s' % matplotlib.__version__)
# pandas
import pandas
print('pandas: %s' % pandas.__version__)
# scikit-learn
import sklearn
print('sklearn: %s' % sklearn.__version__)
# statsmodels
import statsmodels
print('statsmodels: %s' % statsmodels.__version__)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a06269685325-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a06269685325-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a06269685325-1"><span class="crayon-p"># scipy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-2"><span class="crayon-e">import </span><span class="crayon-e">scipy</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'scipy: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-4"><span class="crayon-p"># numpy</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-5"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'numpy: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-7"><span class="crayon-p"># matplotlib</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-8"><span class="crayon-e">import </span><span class="crayon-e">matplotlib</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'matplotlib: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-10"><span class="crayon-p"># pandas</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-11"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'pandas: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-13"><span class="crayon-p"># scikit-learn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-14"><span class="crayon-e">import </span><span class="crayon-e">sklearn</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'sklearn: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-16"><span class="crayon-p"># statsmodels</span></div><div class="crayon-line" id="crayon-5a65907ca0a06269685325-17"><span class="crayon-e">import </span><span class="crayon-e">statsmodels</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a06269685325-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'statsmodels: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>The results on my workstation used to write this tutorial are as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a11488945965" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
scipy: 0.18.1
numpy: 1.11.2
matplotlib: 1.5.3
pandas: 0.19.1
sklearn: 0.18.1
statsmodels: 0.6.1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a11488945965-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a11488945965-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a11488945965-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a11488945965-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a11488945965-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a11488945965-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a11488945965-1">scipy: 0.18.1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a11488945965-2">numpy: 1.11.2</div><div class="crayon-line" id="crayon-5a65907ca0a11488945965-3">matplotlib: 1.5.3</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a11488945965-4">pandas: 0.19.1</div><div class="crayon-line" id="crayon-5a65907ca0a11488945965-5">sklearn: 0.18.1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a11488945965-6">statsmodels: 0.6.1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>2. Problem Description</h2>
<p>The problem is to predict the number of monthly sales of champagne for the Perrin Freres label (named for a region in France).</p>
<p>The dataset provides the number of monthly sales of champagne from January 1964 to September 1972, or just under 10 years of data.</p>
<p>The values are a count of millions of sales and there are 105 observations.</p>
<p>The dataset is credited to Makridakis and Wheelwright, 1989.</p>
<p><a href="https://datamarket.com/data/set/22r5/perrin-freres-monthly-champagne-sales-millions-64-72">You can learn more about this dataset and download it directly from DataMarket</a>.</p>
<p>Download the dataset as a CSV file and place it in your current working directory with the filename “<em>champagne.csv</em>“.</p>
<h2>3. Test Harness</h2>
<p>We must develop a test harness to investigate the data and evaluate candidate models.</p>
<p>This involves two steps:</p>
<ol>
<li>Defining a Validation Dataset.</li>
<li>Developing a Method for Model Evaluation.</li>
</ol>
<h3>3.1 Validation Dataset</h3>
<p>The dataset is not current. This means that we cannot easily collect updated data to validate the model.</p>
<p>Therefore we will pretend that it is September 1971 and withhold the last one year of data from analysis and model selection.</p>
<p>This final year of data will be used to validate the final model.</p>
<p>The code below will load the dataset as a Pandas Series and split into two, one for model development (<em>dataset.csv</em>) and the other for validation (<em>validation.csv</em>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a15268248733" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
series = Series.from_csv('champagne.csv', header=0)
split_point = len(series) - 12
dataset, validation = series[0:split_point], series[split_point:]
print('Dataset %d, Validation %d' % (len(dataset), len(validation)))
dataset.to_csv('dataset.csv')
validation.to_csv('validation.csv')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a15268248733-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a15268248733-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a15268248733-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a15268248733-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a15268248733-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a15268248733-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a15268248733-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a15268248733-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a15268248733-2"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'champagne.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a15268248733-3"><span class="crayon-v">split_point</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a15268248733-4"><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">split_point</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">[</span><span class="crayon-v">split_point</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a15268248733-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Dataset %d, Validation %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">validation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a15268248733-6"><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a15268248733-7"><span class="crayon-v">validation</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'validation.csv'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Running the example creates two files and prints the number of observations in each.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a18398884930" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Dataset 93, Validation 12</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a18398884930-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a18398884930-1">Dataset 93, Validation 12</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The specific contents of these files are:</p>
<ul>
<li><em>dataset.csv</em>: Observations from January 1964 to September 1971 (93 observations)</li>
<li><em>validation.csv</em>: Observations from October 1971 to September 1972 (12 observations)</li>
</ul>
<p>The validation dataset is about 11% of the original dataset.</p>
<p>Note that the saved datasets do not have a header line, therefore we do not need to cater for this when working with these files later.</p>
<h3>3.2. Model Evaluation</h3>
<p>Model evaluation will only be performed on the data in <em>dataset.csv</em> prepared in the previous section.</p>
<p>Model evaluation involves two elements:</p>
<ol>
<li>Performance Measure.</li>
<li>Test Strategy.</li>
</ol>
<h4>3.2.1 Performance Measure</h4>
<p>The observations are a count of champagne sales in millions of units.</p>
<p>We will evaluate the performance of predictions using the root mean squared error (RMSE). This will give more weight to predictions that are grossly wrong and will have the same units as the original data.</p>
<p>Any transforms to the data must be reversed before the RMSE is calculated and reported to make the performance between different methods directly comparable.</p>
<p>We can calculate the RMSE using the helper function from the scikit-learn library <em>mean_squared_error()</em> that calculates the mean squared error between a list of expected values (the test set) and the list of predictions. We can then take the square root of this value to give us an RMSE score.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a1b252207448" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from sklearn.metrics import mean_squared_error
from math import sqrt
...
test = ...
predictions = ...
mse = mean_squared_error(test, predictions)
rmse = sqrt(mse)
print('RMSE: %.3f' % rmse)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a1b252207448-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a1b252207448-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a1b252207448-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a1b252207448-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a1b252207448-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a1b252207448-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a1b252207448-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a1b252207448-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a1b252207448-1"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a1b252207448-2"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">sqrt</span></div><div class="crayon-line" id="crayon-5a65907ca0a1b252207448-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a1b252207448-4"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5a65907ca0a1b252207448-5"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a1b252207448-6"><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a1b252207448-7"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a1b252207448-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<h4>3.2.2 Test Strategy</h4>
<p>Candidate models will be evaluated using walk-forward validation.</p>
<p>This is because a rolling-forecast type model is required from the problem definition. This is where one-step forecasts are needed given all available data.</p>
<p>The walk-forward validation will work as follows:</p>
<ul>
<li>The first 50% of the dataset will be held back to train the model.</li>
<li>The remaining 50% of the dataset will be iterated and test the model.</li>
<li>For each step in the test dataset:
<ul>
<li>A model will be trained.</li>
<li>A one-step prediction made and the prediction stored for later evaluation.</li>
<li>The actual observation from the test dataset will be added to the training dataset for the next iteration.</li>
</ul>
</li>
<li>The predictions made during the iteration of the test dataset will be evaluated and an RMSE score reported.</li>
</ul>
<p>Given the small size of the data, we will allow a model to be re-trained given all available data prior to each prediction.</p>
<p>We can write the code for the test harness using simple NumPy and Python code.</p>
<p>Firstly, we can split the dataset into train and test sets directly. We’re careful to always convert a loaded dataset to <em>float32</em> in case the loaded data still has some <em>String</em> or <em>Integer</em> data types.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a20454628462" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a20454628462-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a20454628462-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a20454628462-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a20454628462-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a20454628462-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a20454628462-1"><span class="crayon-p"># prepare data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a20454628462-2"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a65907ca0a20454628462-3"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a20454628462-4"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a20454628462-5"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Next, we can iterate over the time steps in the test dataset. The train dataset is stored in a Python list as we need to easily append a new observation each iteration and NumPy array concatenation feels like overkill.</p>
<p>The prediction made by the model is called <em>yhat</em> for convention, as the outcome or observation is referred to as <em>y</em> and <em>yhat</em> (a ‘<em>y</em>‘ with a mark above) is the mathematical notation for the prediction of the <em>y</em> variable.</p>
<p>The prediction and observation are printed each observation for a sanity check prediction in case there are issues with the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a22883169488" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# predict
	yhat = ...
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
	print('&gt;Predicted=%.3f, Expected=%3.f' % (yhat, obs))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a22883169488-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a22883169488-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a22883169488-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a22883169488-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a22883169488-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a22883169488-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a22883169488-1"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a22883169488-2"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a22883169488-3"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a22883169488-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a22883169488-5"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a22883169488-6"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5a65907ca0a22883169488-7"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a22883169488-8"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line" id="crayon-5a65907ca0a22883169488-9"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a22883169488-10"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a22883169488-11"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Predicted=%.3f, Expected=%3.f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<h2>4. Persistence</h2>
<p>The first step before getting bogged down in data analysis and modeling is to establish a baseline of performance.</p>
<p>This will provide both a template for evaluating models using the proposed test harness and a performance measure by which all more elaborate predictive models can be compared.</p>
<p>The baseline prediction for time series forecasting is called the naive forecast, or persistence.</p>
<p>This is where the observation from the previous time step is used as the prediction for the observation at the next time step.</p>
<p>We can plug this directly into the test harness defined in the previous section.</p>
<p>The complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a25512598310" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from sklearn.metrics import mean_squared_error
from math import sqrt
# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# predict
	yhat = history[-1]
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
	print('&gt;Predicted=%.3f, Expected=%3.f' % (yhat, obs))
# report performance
mse = mean_squared_error(test, predictions)
rmse = sqrt(mse)
print('RMSE: %.3f' % rmse)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a25512598310-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a25512598310-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a25512598310-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-2"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-3"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-4"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-5"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-6"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-7"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-8"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-9"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-10"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-11"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-12"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-13"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-14"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-15"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-16"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-17"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-18"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-19"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-20"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-21"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Predicted=%.3f, Expected=%3.f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-22"><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-23"><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a25512598310-24"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a25512598310-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Running the test harness prints the prediction and observation for each iteration of the test dataset.</p>
<p>The example ends by printing the RMSE for the model.</p>
<p>In this case, we can see that the persistence model achieved an RMSE of 3186.501. This means that on average, the model was wrong by about 3,186 million sales for each prediction made.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a28173044879" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;Predicted=4676.000, Expected=5010
&gt;Predicted=5010.000, Expected=4874
&gt;Predicted=4874.000, Expected=4633
&gt;Predicted=4633.000, Expected=1659
&gt;Predicted=1659.000, Expected=5951
RMSE: 3186.501</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a28173044879-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a28173044879-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a28173044879-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a28173044879-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a28173044879-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a28173044879-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a28173044879-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a28173044879-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a28173044879-2">&gt;Predicted=4676.000, Expected=5010</div><div class="crayon-line" id="crayon-5a65907ca0a28173044879-3">&gt;Predicted=5010.000, Expected=4874</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a28173044879-4">&gt;Predicted=4874.000, Expected=4633</div><div class="crayon-line" id="crayon-5a65907ca0a28173044879-5">&gt;Predicted=4633.000, Expected=1659</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a28173044879-6">&gt;Predicted=1659.000, Expected=5951</div><div class="crayon-line" id="crayon-5a65907ca0a28173044879-7">RMSE: 3186.501</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We now have a baseline prediction method and performance; now we can start digging into our data.</p>
<h2>5. Data Analysis</h2>
<p>We can use summary statistics and plots of the data to quickly learn more about the structure of the prediction problem.</p>
<p>In this section, we will look at the data from five perspectives:</p>
<ol>
<li>Summary Statistics.</li>
<li>Line Plot.</li>
<li>Seasonal Line Plots</li>
<li>Density Plots.</li>
<li>Box and Whisker Plot.</li>
</ol>
<h3>5.1 Summary Statistics</h3>
<p>Summary statistics provide a quick look at the limits of observed values. It can help to get a quick idea of what we are working with.</p>
<p>The example below calculates and prints summary statistics for the time series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a2b056843590" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
series = Series.from_csv('dataset.csv')
print(series.describe())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a2b056843590-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a2b056843590-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a2b056843590-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a2b056843590-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a2b056843590-2"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a2b056843590-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running the example provides a number of summary statistics to review.</p>
<p>Some observations from these statistics include:</p>
<ul>
<li>The number of observations (count) matches our expectation, meaning we are handling the data correctly.</li>
<li>The mean is about 4,641, which we might consider our level in this series.</li>
<li>The standard deviation (average spread from the mean) is relatively large at 2,486 sales.</li>
<li>The percentiles along with the standard deviation do suggest a large spread to the data.</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a2e195154952" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
count       93.000000
mean      4641.118280
std       2486.403841
min       1573.000000
25%       3036.000000
50%       4016.000000
75%       5048.000000
max      13916.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a2e195154952-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a2e195154952-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a2e195154952-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a2e195154952-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a2e195154952-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a2e195154952-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a2e195154952-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a2e195154952-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a2e195154952-1">count       93.000000</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a2e195154952-2">mean      4641.118280</div><div class="crayon-line" id="crayon-5a65907ca0a2e195154952-3">std       2486.403841</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a2e195154952-4">min       1573.000000</div><div class="crayon-line" id="crayon-5a65907ca0a2e195154952-5">25%       3036.000000</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a2e195154952-6">50%       4016.000000</div><div class="crayon-line" id="crayon-5a65907ca0a2e195154952-7">75%       5048.000000</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a2e195154952-8">max      13916.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>5.2 Line Plot</h3>
<p>A line plot of a time series can provide a lot of insight into the problem.</p>
<p>The example below creates and shows a line plot of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a31123135122" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from matplotlib import pyplot
series = Series.from_csv('dataset.csv')
series.plot()
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a31123135122-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a31123135122-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a31123135122-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a31123135122-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a31123135122-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a31123135122-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a31123135122-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a31123135122-3"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a31123135122-4"><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a31123135122-5"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Run the example and review the plot. Note any obvious temporal structures in the series.</p>
<p>Some observations from the plot include:</p>
<ul>
<li>There may be an increasing trend of sales over time.</li>
<li>There appears to be systematic seasonality to the sales for each year.</li>
<li>The seasonal signal appears to be growing over time, suggesting a multiplicative relationship (increasing change).</li>
<li>There do not appear to be any obvious outliers.</li>
<li>The seasonality suggests that the series is almost certainly non-stationary.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3728" style="max-width: 810px"><img alt="Champagne Sales Line Plot" class="size-full wp-image-3728" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Line-Plot.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Line-Plot.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Line-Plot-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Line-Plot-768x576.png 768w" width="800"/><p class="wp-caption-text">Champagne Sales Line Plot</p></div>
<p>There may be benefit in explicitly modeling the seasonal component and removing it. You may also explore using differencing with one or two levels in order to make the series stationary.</p>
<p>The increasing trend or growth in the seasonal component may suggest the use of a log or other power transform.</p>
<h3>5.3 Seasonal Line Plots</h3>
<p>We can confirm the assumption that the seasonality is a yearly cycle by eyeballing line plots of the dataset by year.</p>
<p>The example below takes the 7 full years of data as separate groups and creates one line plot for each. The line plots are aligned vertically to help spot any year-to-year pattern.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a34185513328" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from pandas import DataFrame
from pandas import TimeGrouper
from matplotlib import pyplot
series = Series.from_csv('dataset.csv')
groups = series['1964':'1970'].groupby(TimeGrouper('A'))
years = DataFrame()
pyplot.figure()
i = 1
n_groups = len(groups)
for name, group in groups:
	pyplot.subplot((n_groups*100) + 10 + i)
	i += 1
	pyplot.plot(group)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a34185513328-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a34185513328-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a34185513328-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">TimeGrouper</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-5"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-6"><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">[</span><span class="crayon-s">'1964'</span><span class="crayon-o">:</span><span class="crayon-s">'1970'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-e">TimeGrouper</span><span class="crayon-sy">(</span><span class="crayon-s">'A'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-7"><span class="crayon-v">years</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-8"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-9"><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-10"><span class="crayon-v">n_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-11"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-12"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">n_groups*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-13"><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a34185513328-14"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a34185513328-15"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Running the example creates the stack of 7 line plots.</p>
<p>We can clearly see a dip each August and a rise from each August to December. This pattern appears the same each year, although at different levels.</p>
<p>This will help with any explicitly season-based modeling later.</p>
<div class="wp-caption aligncenter" id="attachment_3730" style="max-width: 810px"><img alt="Seasonal Per Year Line Plots" class="size-full wp-image-3730" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Per-Year-Line-Plots.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Per-Year-Line-Plots.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Per-Year-Line-Plots-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Per-Year-Line-Plots-768x576.png 768w" width="800"/><p class="wp-caption-text">Seasonal Per Year Line Plots</p></div>
<p>It might have been easier if all season line plots were added to the one graph to help contrast the data for each year.</p>
<h3>5.4 Density Plot</h3>
<p>Reviewing plots of the density of observations can provide further insight into the structure of the data.</p>
<p>The example below creates a histogram and density plot of the observations without any temporal structure.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a37718220647" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from matplotlib import pyplot
series = Series.from_csv('dataset.csv')
pyplot.figure(1)
pyplot.subplot(211)
series.hist()
pyplot.subplot(212)
series.plot(kind='kde')
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a37718220647-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a37718220647-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a37718220647-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a37718220647-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a37718220647-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a37718220647-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a37718220647-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a37718220647-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a37718220647-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a37718220647-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a37718220647-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a37718220647-3"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a37718220647-4"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a37718220647-5"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">211</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a37718220647-6"><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a37718220647-7"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">212</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a37718220647-8"><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">kind</span><span class="crayon-o">=</span><span class="crayon-s">'kde'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a37718220647-9"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Run the example and review the plots.</p>
<p>Some observations from the plots include:</p>
<ul>
<li>The distribution is not Gaussian.</li>
<li>The shape has a long right tail and may suggest an exponential distribution</li>
</ul>
<p><img alt="" class="aligncenter size-full wp-image-3729" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Density-Plot.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Density-Plot.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Density-Plot-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Density-Plot-768x576.png 768w" width="800"/></p>
<p>This lends more support to exploring some power transforms of the data prior to modeling.</p>
<h3>5.5 Box and Whisker Plots</h3>
<p>We can group the monthly data by year and get an idea of the spread of observations for each year and how this may be changing.</p>
<p>We do expect to see some trend (increasing mean or median), but it may be interesting to see how the rest of the distribution may be changing.</p>
<p>The example below groups the observations by year and creates one box and whisker plot for each year of observations. The last year (1971) only contains 9 months and may not be a useful comparison with the 12 months of observations for other years. Therefore, only data between 1964 and 1970 was plotted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a3a953979865" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from pandas import DataFrame
from pandas import TimeGrouper
from matplotlib import pyplot
series = Series.from_csv('dataset.csv')
groups = series['1964':'1970'].groupby(TimeGrouper('A'))
years = DataFrame()
for name, group in groups:
	years[name.year] = group.values
years.boxplot()
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3a953979865-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3a953979865-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3a953979865-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3a953979865-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3a953979865-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a3a953979865-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3a953979865-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">TimeGrouper</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3a953979865-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-5"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3a953979865-6"><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">[</span><span class="crayon-s">'1964'</span><span class="crayon-o">:</span><span class="crayon-s">'1970'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-e">TimeGrouper</span><span class="crayon-sy">(</span><span class="crayon-s">'A'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-7"><span class="crayon-v">years</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3a953979865-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-9"><span class="crayon-h"> </span><span class="crayon-v">years</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-v">year</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3a953979865-10"><span class="crayon-v">years</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3a953979865-11"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Running the example creates 7 box and whisker plots side-by-side, one for each of the 7 years of selected data.</p>
<p>Some observations from reviewing the plots include:</p>
<ul>
<li>The median values for each year (red line) may show an increasing trend.</li>
<li>The spread or middle 50% of the data (blue boxes) does appear reasonably stable.</li>
<li>There are outliers each year (black crosses); these may be the tops or bottoms of the seasonal cycle.</li>
<li>The last year, 1970, does look different from the trend in prior years</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3731" style="max-width: 810px"><img alt="Champagne Sales Box and Whisker Plots" class="size-full wp-image-3731" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Box-and-Whisker-Plots.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Box-and-Whisker-Plots.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Box-and-Whisker-Plots-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Champagne-Sales-Box-and-Whisker-Plots-768x576.png 768w" width="800"/><p class="wp-caption-text">Champagne Sales Box and Whisker Plots</p></div>
<p>The observations suggest perhaps some growth trend over the years and outliers that may be a part of the seasonal cycle.</p>
<p>This yearly view of the data is an interesting avenue and could be pursued further by looking at summary statistics from year-to-year and changes in summary stats from year-to-year.</p>
<h2>6. ARIMA Models</h2>
<p>In this section, we will develop Autoregressive Integrated Moving Average, or ARIMA, models for the problem.</p>
<p>We will approach modeling by both manual and automatic configuration of the ARIMA model. This will be followed by a third step of investigating the residual errors of the chosen model.</p>
<p>As such, this section is broken down into 3 steps:</p>
<ol>
<li>Manually Configure the ARIMA.</li>
<li>Automatically Configure the ARIMA.</li>
<li>Review Residual Errors.</li>
</ol>
<h3>6.1 Manually Configured ARIMA</h3>
<p>The ARIMA(<em>p,d,q</em>) model requires three parameters and is traditionally configured manually.</p>
<p>Analysis of the time series data assumes that we are working with a stationary time series.</p>
<p>The time series is almost certainly non-stationary. We can make it stationary this by first differencing the series and using a statistical test to confirm that the result is stationary.</p>
<p>The seasonality in the series is seemingly year-to-year. Seasonal data can be differenced by subtracting the observation from the same time in the previous cycle, in this case the same month in the previous year. This does mean that we will lose the first year of observations as there is no prior year to difference with.</p>
<p>The example below creates a deseasonalized version of the series and saves it to file <em>stationary.csv</em>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a3e975703140" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from statsmodels.tsa.stattools import adfuller
from matplotlib import pyplot

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return Series(diff)

series = Series.from_csv('dataset.csv')
X = series.values
X = X.astype('float32')
# difference data
months_in_year = 12
stationary = difference(X, months_in_year)
stationary.index = series.index[months_in_year:]
# check if stationary
result = adfuller(stationary)
print('ADF Statistic: %f' % result[0])
print('p-value: %f' % result[1])
print('Critical Values:')
for key, value in result[4].items():
	print('\t%s: %.3f' % (key, value))
# save
stationary.to_csv('stationary.csv')
# plot
stationary.plot()
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a3e975703140-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a3e975703140-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-2"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">stattools </span><span class="crayon-e">import </span><span class="crayon-e">adfuller</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-4"> </div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-5"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-6"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-7"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-9"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-10"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-12"> </div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-13"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-14"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-15"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-16"><span class="crayon-p"># difference data</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-17"><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-18"><span class="crayon-v">stationary</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-19"><span class="crayon-v">stationary</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">[</span><span class="crayon-v">months_in_year</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-20"><span class="crayon-p"># check if stationary</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-21"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">adfuller</span><span class="crayon-sy">(</span><span class="crayon-v">stationary</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ADF Statistic: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'p-value: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Critical Values:'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-25"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-26"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\t%s: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-27"><span class="crayon-p"># save</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-28"><span class="crayon-v">stationary</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'stationary.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-29"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a3e975703140-30"><span class="crayon-v">stationary</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a3e975703140-31"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>Running the example outputs the result of a statistical significance test of whether the differenced series is stationary. Specifically, the augmented Dickey-Fuller test.</p>
<p>The results show that the test statistic value -7.134898 is smaller than the critical value at 1% of -3.515. This suggests that we can reject the null hypothesis with a significance level of less than 1% (i.e. a low probability that the result is a statistical fluke).</p>
<p>Rejecting the null hypothesis means that the process has no unit root, and in turn that the time series is stationary or does not have time-dependent structure.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a41514815257" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ADF Statistic: -7.134898
p-value: 0.000000
Critical Values:
	5%: -2.898
	1%: -3.515
	10%: -2.586</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a41514815257-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a41514815257-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a41514815257-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a41514815257-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a41514815257-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a41514815257-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a41514815257-1">ADF Statistic: -7.134898</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a41514815257-2">p-value: 0.000000</div><div class="crayon-line" id="crayon-5a65907ca0a41514815257-3">Critical Values:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a41514815257-4">	5%: -2.898</div><div class="crayon-line" id="crayon-5a65907ca0a41514815257-5">	1%: -3.515</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a41514815257-6">	10%: -2.586</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>For reference, the seasonal difference operation can be inverted by adding the observation for the same month the year before. This is needed in the case that predictions are made by a model fit on seasonally differenced data. The function to invert the seasonal difference operation is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a44803257849" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a44803257849-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a44803257849-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a44803257849-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a44803257849-1"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a44803257849-2"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a44803257849-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>A plot of the differenced dataset is also created.</p>
<p>The plot does not show any obvious seasonality or trend, suggesting the seasonally differenced dataset is a good starting point for modeling.</p>
<p>We will use this dataset as an input to the ARIMA model. It also suggests that no further differencing may be required, and that the d parameter may be set to 0.</p>
<div class="wp-caption aligncenter" id="attachment_3732" style="max-width: 810px"><img alt="Seasonal Differenced Champagne Sales Line Plot" class="size-full wp-image-3732" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Differenced-Champagne-Sales-Line-Plot.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Differenced-Champagne-Sales-Line-Plot.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Differenced-Champagne-Sales-Line-Plot-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Seasonal-Differenced-Champagne-Sales-Line-Plot-768x576.png 768w" width="800"/><p class="wp-caption-text">Seasonal Differenced Champagne Sales Line Plot</p></div>
<p>The next first step is to select the lag values for the Autoregression (AR) and Moving Average (MA) parameters, <em>p</em> and <em>q</em> respectively.</p>
<p>We can do this by reviewing Autocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) plots.</p>
<p>Note, we are now using the seasonally differenced stationary.csv as our dataset.</p>
<p>The example below creates ACF and PACF plots for the series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a47236003803" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from statsmodels.graphics.tsaplots import plot_acf
from statsmodels.graphics.tsaplots import plot_pacf
from matplotlib import pyplot
series = Series.from_csv('stationary.csv')
pyplot.figure()
pyplot.subplot(211)
plot_acf(series, ax=pyplot.gca())
pyplot.subplot(212)
plot_pacf(series, ax=pyplot.gca())
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a47236003803-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a47236003803-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a47236003803-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a47236003803-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a47236003803-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a47236003803-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a47236003803-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a47236003803-2"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-e">import </span><span class="crayon-e">plot_acf</span></div><div class="crayon-line" id="crayon-5a65907ca0a47236003803-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-e">import </span><span class="crayon-e">plot_pacf</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a47236003803-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a47236003803-5"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'stationary.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a47236003803-6"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a47236003803-7"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">211</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a47236003803-8"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a47236003803-9"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">212</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a47236003803-10"><span class="crayon-e">plot_pacf</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a47236003803-11"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Run the example and review the plots for insights into how to set the <em>p</em> and <em>q</em> variables for the ARIMA model.</p>
<p>Below are some observations from the plots.</p>
<ul>
<li>The ACF shows a significant lag for 1 month.</li>
<li>The PACF shows a significant lag for 1 month, with perhaps some significant lag at 12 and 13 months.</li>
<li>Both the ACF and PACF show a drop-off at the same point, perhaps suggesting a mix of AR and MA.</li>
</ul>
<p>A good starting point for the p and q values is also 1.</p>
<p>The PACF plot also suggests that there is still some seasonality present in the differenced data.</p>
<p>We may consider a better model of seasonality, such as modeling it directly and explicitly removing it from the model rather than seasonal differencing.</p>
<div class="wp-caption aligncenter" id="attachment_3733" style="max-width: 810px"><img alt="ACF and PACF Plots of Seasonally Differenced Champagne Sales" class="size-full wp-image-3733" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/ACF-and-PACF-Plots-of-Seasonally-Differenced-Champagne-Sales.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/ACF-and-PACF-Plots-of-Seasonally-Differenced-Champagne-Sales.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/ACF-and-PACF-Plots-of-Seasonally-Differenced-Champagne-Sales-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/ACF-and-PACF-Plots-of-Seasonally-Differenced-Champagne-Sales-768x576.png 768w" width="800"/><p class="wp-caption-text">ACF and PACF Plots of Seasonally Differenced Champagne Sales</p></div>
<p>This quick analysis suggests an ARIMA(1,0,1) on the stationary data may be a good starting point.</p>
<p>The historic observations will be seasonally differenced prior to the fitting of each ARIMA model. The differencing will be inverted for all predictions made to make them directly comparable to the expected observation in the original sale count units.</p>
<p>Experimentation shows that this configuration of ARIMA does not converge and results in errors by the underlying library. Further experimentation showed that adding one level of differencing to the stationary data made the model more stable. The model can be extended to ARIMA(1,1,1).</p>
<p>We will also disable the automatic addition of a trend constant from the model by setting the ‘<em>trend</em>‘ argument to ‘<em>nc</em>‘ for no constant in the call to <a href="http://statsmodels.sourceforge.net/stable/generated/statsmodels.tsa.arima_model.ARIMA.fit.html">fit()</a>. From experimentation, I find that this can result in better forecast performance on some problems.</p>
<p>The example below demonstrates the performance of this ARIMA model on the test harness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a4b748605184" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from sklearn.metrics import mean_squared_error
from statsmodels.tsa.arima_model import ARIMA
from math import sqrt

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# difference data
	months_in_year = 12
	diff = difference(history, months_in_year)
	# predict
	model = ARIMA(diff, order=(1,1,1))
	model_fit = model.fit(trend='nc', disp=0)
	yhat = model_fit.forecast()[0]
	yhat = inverse_difference(history, yhat, months_in_year)
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
	print('&gt;Predicted=%.3f, Expected=%3.f' % (yhat, obs))
# report performance
mse = mean_squared_error(test, predictions)
rmse = sqrt(mse)
print('RMSE: %.3f' % rmse)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4b748605184-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a4b748605184-45">45</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-2"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-4"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-6"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-7"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-8"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-10"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-11"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-14"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-15"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-18"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-19"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-20"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-21"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-23"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-24"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-25"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-26"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-27"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-28"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-29"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-30"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-31"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-32"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-33"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-34"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-35"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-36"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-37"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-38"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-39"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-40"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-41"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Predicted=%.3f, Expected=%3.f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-42"><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-43"><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4b748605184-44"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a4b748605184-45"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>Note, you may see a warning message from the underlying linear algebra library; this can be ignored for now.</p>
<p>Running this example results in an RMSE of 956.942, which is dramatically better than the persistence RMSE of 3186.501.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a4f377045057" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;Predicted=3157.018, Expected=5010
&gt;Predicted=4615.082, Expected=4874
&gt;Predicted=4624.998, Expected=4633
&gt;Predicted=2044.097, Expected=1659
&gt;Predicted=5404.428, Expected=5951
RMSE: 956.942</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a4f377045057-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4f377045057-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a4f377045057-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4f377045057-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a4f377045057-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a4f377045057-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a4f377045057-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a4f377045057-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4f377045057-2">&gt;Predicted=3157.018, Expected=5010</div><div class="crayon-line" id="crayon-5a65907ca0a4f377045057-3">&gt;Predicted=4615.082, Expected=4874</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4f377045057-4">&gt;Predicted=4624.998, Expected=4633</div><div class="crayon-line" id="crayon-5a65907ca0a4f377045057-5">&gt;Predicted=2044.097, Expected=1659</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a4f377045057-6">&gt;Predicted=5404.428, Expected=5951</div><div class="crayon-line" id="crayon-5a65907ca0a4f377045057-7">RMSE: 956.942</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This is a great start, but we may be able to get improved results with a better configured ARIMA model.</p>
<h3>6.2 Grid Search ARIMA Hyperparameters</h3>
<p>The ACF and PACF plots suggest that an ARIMA(1,0,1) or similar may be the best that we can do.</p>
<p>To confirm this analysis, we can grid search a suite of ARIMA hyperparameters and check that no models result in better out of sample RMSE performance.</p>
<p>In this section, we will search values of <em>p</em>, <em>d</em>, and <em>q</em> for combinations (skipping those that fail to converge), and find the combination that results in the best performance on the test set. We will use a grid search to explore all combinations in a subset of integer values.</p>
<p>Specifically, we will search all combinations of the following parameters:</p>
<ul>
<li><em>p</em>: 0 to 6.</li>
<li><em>d</em>: 0 to 2.</li>
<li><em>q</em>: 0 to 6.</li>
</ul>
<p>This is (<em>7 * 3 * 7</em>), or 147, potential runs of the test harness and will take some time to execute.</p>
<p>It may be interesting to evaluate MA models with a lag of 12 or 13 as were noticed as potentially interesting from reviewing the ACF and PACF plots. Experimentation suggested that these models may not be stable, resulting in errors in the underlying mathematical libraries.</p>
<p>The complete worked example with the grid search version of the test harness is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a52760366003" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import warnings
from pandas import Series
from statsmodels.tsa.arima_model import ARIMA
from sklearn.metrics import mean_squared_error
from math import sqrt
import numpy

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return numpy.array(diff)

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# evaluate an ARIMA model for a given order (p,d,q) and return RMSE
def evaluate_arima_model(X, arima_order):
	# prepare training dataset
	X = X.astype('float32')
	train_size = int(len(X) * 0.50)
	train, test = X[0:train_size], X[train_size:]
	history = [x for x in train]
	# make predictions
	predictions = list()
	for t in range(len(test)):
		# difference data
		months_in_year = 12
		diff = difference(history, months_in_year)
		model = ARIMA(diff, order=arima_order)
		model_fit = model.fit(trend='nc', disp=0)
		yhat = model_fit.forecast()[0]
		yhat = inverse_difference(history, yhat, months_in_year)
		predictions.append(yhat)
		history.append(test[t])
	# calculate out of sample error
	mse = mean_squared_error(test, predictions)
	rmse = sqrt(mse)
	return rmse

# evaluate combinations of p, d and q values for an ARIMA model
def evaluate_models(dataset, p_values, d_values, q_values):
	dataset = dataset.astype('float32')
	best_score, best_cfg = float("inf"), None
	for p in p_values:
		for d in d_values:
			for q in q_values:
				order = (p,d,q)
				try:
					mse = evaluate_arima_model(dataset, order)
					if mse &lt; best_score:
						best_score, best_cfg = mse, order
					print('ARIMA%s RMSE=%.3f' % (order,mse))
				except:
					continue
	print('Best ARIMA%s RMSE=%.3f' % (best_cfg, best_score))

# load dataset
series = Series.from_csv('dataset.csv')
# evaluate parameters
p_values = range(0, 7)
d_values = range(0, 3)
q_values = range(0, 7)
warnings.filterwarnings("ignore")
evaluate_models(series.values, p_values, d_values, q_values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-52">52</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-54">54</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-56">56</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-58">58</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-60">60</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-62">62</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-64">64</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-66">66</div><div class="crayon-num" data-line="crayon-5a65907ca0a52760366003-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a52760366003-68">68</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a52760366003-1"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-5"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-6"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-8"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-9"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-10"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-12"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-13"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-16"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-17"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-20"><span class="crayon-p"># evaluate an ARIMA model for a given order (p,d,q) and return RMSE</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-21"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-22"><span class="crayon-h"> </span><span class="crayon-p"># prepare training dataset</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-23"><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-24"><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-25"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-26"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-27"><span class="crayon-h"> </span><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-28"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-30"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-31"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-32"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-33"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-34"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-35"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-36"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-37"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-38"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-39"><span class="crayon-h"> </span><span class="crayon-p"># calculate out of sample error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-40"><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-41"><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-42"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-43"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-44"><span class="crayon-p"># evaluate combinations of p, d and q values for an ARIMA model</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-45"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-46"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-47"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-s">"inf"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-48"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-49"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-50"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">q</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-51"><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-52"><span class="crayon-h"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-53"><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-54"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-55"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">order</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-56"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ARIMA%s RMSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">order</span><span class="crayon-sy">,</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-57"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-58"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-59"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Best ARIMA%s RMSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">best_cfg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-60"> </div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-61"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-62"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-63"><span class="crayon-p"># evaluate parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-64"><span class="crayon-v">p_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-65"><span class="crayon-v">d_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-66"><span class="crayon-v">q_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a52760366003-67"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a52760366003-68"><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0051 seconds] -->
<p>Running the example runs through all combinations and reports the results on those that converge without error. The example takes a little over 2 minutes to run on modern hardware.</p>
<p>The results show that the best configuration discovered was ARIMA(0, 0, 1) with an RMSE of 939.464, slightly lower than the manually configured ARIMA from the previous section. This difference may or may not be statistically significant.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a56588103374" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
ARIMA(5, 1, 2) RMSE=1003.200
ARIMA(5, 2, 1) RMSE=1053.728
ARIMA(6, 0, 0) RMSE=996.466
ARIMA(6, 1, 0) RMSE=1018.211
ARIMA(6, 1, 1) RMSE=1023.762
Best ARIMA(0, 0, 1) RMSE=939.464</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a56588103374-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a56588103374-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a56588103374-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a56588103374-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a56588103374-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a56588103374-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a56588103374-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a56588103374-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a56588103374-2">ARIMA(5, 1, 2) RMSE=1003.200</div><div class="crayon-line" id="crayon-5a65907ca0a56588103374-3">ARIMA(5, 2, 1) RMSE=1053.728</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a56588103374-4">ARIMA(6, 0, 0) RMSE=996.466</div><div class="crayon-line" id="crayon-5a65907ca0a56588103374-5">ARIMA(6, 1, 0) RMSE=1018.211</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a56588103374-6">ARIMA(6, 1, 1) RMSE=1023.762</div><div class="crayon-line" id="crayon-5a65907ca0a56588103374-7">Best ARIMA(0, 0, 1) RMSE=939.464</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We will select this ARIMA(0, 0, 1) model going forward.</p>
<h3>6.3 Review Residual Errors</h3>
<p>A good final check of a model is to review residual forecast errors.</p>
<p>Ideally, the distribution of residual errors should be a Gaussian with a zero mean.</p>
<p>We can check this by using summary statistics and plots to investigate the residual errors from the ARIMA(0, 0, 1) model. The example below calculates and summarizes the residual forecast errors.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a59014605475" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from pandas import DataFrame
from statsmodels.tsa.arima_model import ARIMA
from matplotlib import pyplot

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# difference data
	months_in_year = 12
	diff = difference(history, months_in_year)
	# predict
	model = ARIMA(diff, order=(0,0,1))
	model_fit = model.fit(trend='nc', disp=0)
	yhat = model_fit.forecast()[0]
	yhat = inverse_difference(history, yhat, months_in_year)
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
# errors
residuals = [test[i]-predictions[i] for i in range(len(test))]
residuals = DataFrame(residuals)
print(residuals.describe())
# plot
pyplot.figure()
pyplot.subplot(211)
residuals.hist(ax=pyplot.gca())
pyplot.subplot(212)
residuals.plot(kind='kde', ax=pyplot.gca())
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a59014605475-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca0a59014605475-51">51</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a59014605475-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-6"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-7"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-8"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-10"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-11"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-14"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-15"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-18"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-19"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-20"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-21"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-23"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-24"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-25"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-26"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-27"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-28"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-29"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-30"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-31"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-32"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-33"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-34"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-35"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-36"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-37"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-38"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-39"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-40"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-41"><span class="crayon-p"># errors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-42"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-43"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-44"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-45"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-46"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-47"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">211</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-48"><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-49"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">212</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a59014605475-50"><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">kind</span><span class="crayon-o">=</span><span class="crayon-s">'kde'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a59014605475-51"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example first describes the distribution of the residuals.</p>
<p>We can see that the distribution has a right shift and that the mean is non-zero at 165.904728.</p>
<p>This is perhaps a sign that the predictions are biased.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a5c483402600" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
count    47.000000
mean    165.904728
std     934.696199
min   -2164.247449
25%    -289.651596
50%     191.759548
75%     732.992187
max    2367.304748</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a5c483402600-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5c483402600-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a5c483402600-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5c483402600-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a5c483402600-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5c483402600-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a5c483402600-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5c483402600-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a5c483402600-1">count    47.000000</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5c483402600-2">mean    165.904728</div><div class="crayon-line" id="crayon-5a65907ca0a5c483402600-3">std     934.696199</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5c483402600-4">min   -2164.247449</div><div class="crayon-line" id="crayon-5a65907ca0a5c483402600-5">25%    -289.651596</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5c483402600-6">50%     191.759548</div><div class="crayon-line" id="crayon-5a65907ca0a5c483402600-7">75%     732.992187</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5c483402600-8">max    2367.304748</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The distribution of residual errors is also plotted.</p>
<p>The graphs suggest a Gaussian-like distribution with a bumpy left tail, providing further evidence that perhaps a power transform might be worth exploring.</p>
<div class="wp-caption aligncenter" id="attachment_3734" style="max-width: 810px"><img alt="Residual Forecast Error Density Plots" class="size-full wp-image-3734" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-Density-Plots.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-Density-Plots.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-Density-Plots-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-Density-Plots-768x576.png 768w" width="800"/><p class="wp-caption-text">Residual Forecast Error Density Plots</p></div>
<p>We could use this information to bias-correct predictions by adding the mean residual error of 165.904728 to each forecast made.</p>
<p>The example below performs this bias correlation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a5f227006384" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from pandas import DataFrame
from statsmodels.tsa.arima_model import ARIMA
from matplotlib import pyplot
from sklearn.metrics import mean_squared_error
from math import sqrt

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]
# walk-forward validation
history = [x for x in train]
predictions = list()
bias = 165.904728
for i in range(len(test)):
	# difference data
	months_in_year = 12
	diff = difference(history, months_in_year)
	# predict
	model = ARIMA(diff, order=(0,0,1))
	model_fit = model.fit(trend='nc', disp=0)
	yhat = model_fit.forecast()[0]
	yhat = bias + inverse_difference(history, yhat, months_in_year)
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
# report performance
mse = mean_squared_error(test, predictions)
rmse = sqrt(mse)
print('RMSE: %.3f' % rmse)
# errors
residuals = [test[i]-predictions[i] for i in range(len(test))]
residuals = DataFrame(residuals)
print(residuals.describe())
# plot
pyplot.figure()
pyplot.subplot(211)
residuals.hist(ax=pyplot.gca())
pyplot.subplot(212)
residuals.plot(kind='kde', ax=pyplot.gca())
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-52">52</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-54">54</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-56">56</div><div class="crayon-num" data-line="crayon-5a65907ca0a5f227006384-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a5f227006384-58">58</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-8"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-9"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-10"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-12"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-13"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-16"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-17"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-20"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-21"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-22"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-24"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-25"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-26"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-27"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-28"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-29"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-30"><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">165.904728</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-31"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-32"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-33"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-34"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-35"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-36"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-37"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-38"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-39"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-40"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-41"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-42"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-43"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-44"><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-45"><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-46"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-47"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-48"><span class="crayon-p"># errors</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-49"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-50"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-51"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-52"><span class="crayon-p"># plot</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-53"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-54"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">211</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-55"><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-56"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">212</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a5f227006384-57"><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">kind</span><span class="crayon-o">=</span><span class="crayon-s">'kde'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a5f227006384-58"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0043 seconds] -->
<p>The performance of the predictions is improved very slightly from 939.464 to 924.699, which may or may not be significant.</p>
<p>The summary of the forecast residual errors shows that the mean was indeed moved to a value very close to zero.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a63586908719" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
RMSE: 924.699

count  4.700000e+01
mean   4.965016e-07
std    9.346962e+02
min   -2.330152e+03
25%   -4.555563e+02
50%    2.585482e+01
75%    5.670875e+02
max    2.201400e+03</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a63586908719-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a63586908719-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a63586908719-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a63586908719-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a63586908719-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a63586908719-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a63586908719-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a63586908719-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a63586908719-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a63586908719-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a63586908719-1">RMSE: 924.699</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a63586908719-2"> </div><div class="crayon-line" id="crayon-5a65907ca0a63586908719-3">count  4.700000e+01</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a63586908719-4">mean   4.965016e-07</div><div class="crayon-line" id="crayon-5a65907ca0a63586908719-5">std    9.346962e+02</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a63586908719-6">min   -2.330152e+03</div><div class="crayon-line" id="crayon-5a65907ca0a63586908719-7">25%   -4.555563e+02</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a63586908719-8">50%    2.585482e+01</div><div class="crayon-line" id="crayon-5a65907ca0a63586908719-9">75%    5.670875e+02</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a63586908719-10">max    2.201400e+03</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Finally, density plots of the residual error do show a small shift towards zero.</p>
<p>It is debatable whether this bias correction is worth it, but we will use it for now.</p>
<div class="wp-caption aligncenter" id="attachment_3735" style="max-width: 810px"><img alt="Bias Corrected Residual Forecast Error Density Plots" class="size-full wp-image-3735" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Bias-Corrected-Residual-Forecast-Error-Density-Plots.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Bias-Corrected-Residual-Forecast-Error-Density-Plots.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Bias-Corrected-Residual-Forecast-Error-Density-Plots-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Bias-Corrected-Residual-Forecast-Error-Density-Plots-768x576.png 768w" width="800"/><p class="wp-caption-text">Bias-Corrected Residual Forecast Error Density Plots</p></div>
<p>It is also a good idea to check the time series of the residual errors for any type of autocorrelation. If present, it would suggest that the model has more opportunity to model the temporal structure in the data.</p>
<p>The example below re-calculates the residual errors and creates ACF and PACF plots to check for any significant autocorrelation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a66576858171" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from pandas import DataFrame
from statsmodels.tsa.arima_model import ARIMA
from matplotlib import pyplot
from statsmodels.graphics.tsaplots import plot_acf
from statsmodels.graphics.tsaplots import plot_pacf

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
train_size = int(len(X) * 0.50)
train, test = X[0:train_size], X[train_size:]
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# difference data
	months_in_year = 12
	diff = difference(history, months_in_year)
	# predict
	model = ARIMA(diff, order=(0,0,1))
	model_fit = model.fit(trend='nc', disp=0)
	yhat = model_fit.forecast()[0]
	yhat = inverse_difference(history, yhat, months_in_year)
	predictions.append(yhat)
	# observation
	obs = test[i]
	history.append(obs)
# errors
residuals = [test[i]-predictions[i] for i in range(len(test))]
residuals = DataFrame(residuals)
print(residuals.describe())
# plot
pyplot.figure()
pyplot.subplot(211)
plot_acf(residuals, ax=pyplot.gca())
pyplot.subplot(212)
plot_pacf(residuals, ax=pyplot.gca())
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a66576858171-52">52</div><div class="crayon-num" data-line="crayon-5a65907ca0a66576858171-53">53</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a66576858171-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-5"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-e">import </span><span class="crayon-e">plot_acf</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-6"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-e">import </span><span class="crayon-v">plot_pacf</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-8"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-9"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-10"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-12"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-13"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-16"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-17"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-20"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-21"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-22"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-24"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-25"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-26"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-27"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-28"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-29"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-30"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-31"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-32"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-33"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-34"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-35"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-36"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-37"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-38"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-39"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-40"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-41"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-42"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-43"><span class="crayon-p"># errors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-44"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-45"><span class="crayon-v">residuals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-46"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-47"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-48"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-49"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">211</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-50"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-51"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">212</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a66576858171-52"><span class="crayon-e">plot_pacf</span><span class="crayon-sy">(</span><span class="crayon-v">residuals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">gca</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a66576858171-53"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>The results suggest that what little autocorrelation is present in the time series has been captured by the model.</p>
<div class="wp-caption aligncenter" id="attachment_3736" style="max-width: 810px"><img alt="Residual Forecast Error ACF and PACF Plots" class="size-full wp-image-3736" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-ACF-and-PACF-Plots.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-ACF-and-PACF-Plots.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-ACF-and-PACF-Plots-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Residual-Forecast-Error-ACF-and-PACF-Plots-768x576.png 768w" width="800"/><p class="wp-caption-text">Residual Forecast Error ACF and PACF Plots</p></div>
<h2>7. Model Validation</h2>
<p>After models have been developed and a final model selected, it must be validated and finalized.</p>
<p>Validation is an optional part of the process, but one that provides a ‘last check’ to ensure we have not fooled or misled ourselves.</p>
<p>This section includes the following steps:</p>
<ol>
<li><strong>Finalize Model</strong>: Train and save the final model.</li>
<li><strong>Make Prediction</strong>: Load the finalized model and make a prediction.</li>
<li><strong>Validate Model</strong>: Load and validate the final model.</li>
</ol>
<h3>7.1 Finalize Model</h3>
<p>Finalizing the model involves fitting an ARIMA model on the entire dataset, in this case on a transformed version of the entire dataset.</p>
<p>Once fit, the model can be saved to file for later use.</p>
<p>The example below trains an ARIMA(0,0,1) model on the dataset and saves the whole fit object and the bias to file.</p>
<p>There is a bug in the current stable version of the statsmodels library (v0.6.1) that results in an error when you try to load a saved ARIMA model from file. The error reported is:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a6a462419619" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
TypeError: __new__() takes at least 3 arguments (1 given)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a6a462419619-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a6a462419619-1">TypeError: __new__() takes at least 3 arguments (1 given)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This bug also seems present in the 0.8 release candidate 1 of statsmodels when I tested it. For more details, see <a href="http://zaemyung.com/">Zae Myung Kim</a>‘s <a href="https://github.com/statsmodels/statsmodels/pull/3217">discussion and fix in this GitHub issue</a>.</p>
<p>We can work around this with a monkey patch that adds a <em>__getnewargs__()</em> instance function to the ARIMA class before saving.</p>
<p>The example below saves the fit model to file in the correct state so that it can be loaded successfully later.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a6d259471750" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from statsmodels.tsa.arima_model import ARIMA
from scipy.stats import boxcox
import numpy

# monkey patch around bug in ARIMA class
def __getnewargs__(self):
	return ((self.endog),(self.k_lags, self.k_diff, self.k_ma))

ARIMA.__getnewargs__ = __getnewargs__

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# load data
series = Series.from_csv('dataset.csv')
# prepare data
X = series.values
X = X.astype('float32')
# difference data
months_in_year = 12
diff = difference(X, months_in_year)
# fit model
model = ARIMA(diff, order=(0,0,1))
model_fit = model.fit(trend='nc', disp=0)
# bias constant, could be calculated from in-sample mean residual
bias = 165.904728
# save model
model_fit.save('model.pkl')
numpy.save('model_bias.npy', [bias])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a6d259471750-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a6d259471750-35">35</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-2"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-3"><span class="crayon-e">from </span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-e">stats </span><span class="crayon-e">import </span><span class="crayon-e">boxcox</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-4"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-6"><span class="crayon-p"># monkey patch around bug in ARIMA class</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-7"><span class="crayon-e">def </span><span class="crayon-e">__getnewargs__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">endog</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">k_lags</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">k_diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">k_ma</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-10"><span class="crayon-v">ARIMA</span><span class="crayon-sy">.</span><span class="crayon-v">__getnewargs__</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">__getnewargs__</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-12"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-13"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-14"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-15"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-16"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-17"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-20"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-21"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-22"><span class="crayon-p"># prepare data</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-24"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-25"><span class="crayon-p"># difference data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-26"><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-27"><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-28"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-29"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-30"><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-31"><span class="crayon-p"># bias constant, could be calculated from in-sample mean residual</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-32"><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">165.904728</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-33"><span class="crayon-p"># save model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a6d259471750-34"><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'model.pkl'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a6d259471750-35"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'model_bias.npy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">bias</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Running the example creates two local files:</p>
<ul>
<li><em>model.pkl</em> This is the ARIMAResult object from the call to <em>ARIMA.fit()</em>. This includes the coefficients and all other internal data returned when fitting the model.</li>
<li><em>model_bias.npy</em> This is the bias value stored as a one-row, one-column NumPy array.</li>
</ul>
<h3>7.2 Make Prediction</h3>
<p>A natural case may be to load the model and make a single forecast.</p>
<p>This is relatively straightforward and involves restoring the saved model and the bias and calling the <em>forecast()</em> method. To invert the seasonal differencing, the historical data must also be loaded.</p>
<p>The example below loads the model, makes a prediction for the next time step, and prints the prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a70046068758" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from statsmodels.tsa.arima_model import ARIMAResults
import numpy

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

series = Series.from_csv('dataset.csv')
months_in_year = 12
model_fit = ARIMAResults.load('model.pkl')
bias = numpy.load('model_bias.npy')
yhat = float(model_fit.forecast()[0])
yhat = bias + inverse_difference(series.values, yhat, months_in_year)
print('Predicted: %.3f' % yhat)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a70046068758-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a70046068758-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a70046068758-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-2"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMAResults</span></div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-3"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-4"> </div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-5"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-6"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-8"> </div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-9"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-10"><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-11"><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ARIMAResults</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'model.pkl'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-12"><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'model_bias.npy'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-13"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a70046068758-14"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a70046068758-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Predicted: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example prints the prediction of about 6794.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a73181775772" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Predicted: 6794.773</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a73181775772-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a73181775772-1">Predicted: 6794.773</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>If we peek inside <em>validation.csv</em>, we can see that the value on the first row for the next time period is 6981.</p>
<p>The prediction is in the right ballpark.</p>
<h3>7.3 Validate Model</h3>
<p>We can load the model and use it in a pretend operational manner.</p>
<p>In the test harness section, we saved the final 12 months of the original dataset in a separate file to validate the final model.</p>
<p>We can load this <em>validation.csv</em> file now and use it see how well our model really is on “unseen” data.</p>
<p>There are two ways we might proceed:</p>
<ul>
<li>Load the model and use it to forecast the next 12 months. The forecast beyond the first one or two months will quickly start to degrade in skill.</li>
<li>Load the model and use it in a rolling-forecast manner, updating the transform and model for each time step. This is the preferred method as it is how one would use this model in practice as it would achieve the best performance.</li>
</ul>
<p>As with model evaluation in previous sections, we will make predictions in a rolling-forecast manner. This means that we will step over lead times in the validation dataset and take the observations as an update to the history.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a76171097622" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import Series
from matplotlib import pyplot
from statsmodels.tsa.arima_model import ARIMA
from statsmodels.tsa.arima_model import ARIMAResults
from sklearn.metrics import mean_squared_error
from math import sqrt
import numpy

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return diff

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load and prepare datasets
dataset = Series.from_csv('dataset.csv')
X = dataset.values.astype('float32')
history = [x for x in X]
months_in_year = 12
validation = Series.from_csv('validation.csv')
y = validation.values.astype('float32')
# load model
model_fit = ARIMAResults.load('model.pkl')
bias = numpy.load('model_bias.npy')
# make first prediction
predictions = list()
yhat = float(model_fit.forecast()[0])
yhat = bias + inverse_difference(history, yhat, months_in_year)
predictions.append(yhat)
history.append(y[0])
print('&gt;Predicted=%.3f, Expected=%3.f' % (yhat, y[0]))
# rolling forecasts
for i in range(1, len(y)):
	# difference data
	months_in_year = 12
	diff = difference(history, months_in_year)
	# predict
	model = ARIMA(diff, order=(0,0,1))
	model_fit = model.fit(trend='nc', disp=0)
	yhat = model_fit.forecast()[0]
	yhat = bias + inverse_difference(history, yhat, months_in_year)
	predictions.append(yhat)
	# observation
	obs = y[i]
	history.append(obs)
	print('&gt;Predicted=%.3f, Expected=%3.f' % (yhat, obs))
# report performance
mse = mean_squared_error(y, predictions)
rmse = sqrt(mse)
print('RMSE: %.3f' % rmse)
pyplot.plot(y)
pyplot.plot(predictions, color='red')
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-52">52</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-54">54</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-56">56</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a76171097622-58">58</div><div class="crayon-num" data-line="crayon-5a65907ca0a76171097622-59">59</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a76171097622-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-4"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMAResults</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-7"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-8"> </div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-9"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-10"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-11"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-13"><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-14"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-15"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-16"> </div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-17"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-18"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-20"> </div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-21"><span class="crayon-p"># load and prepare datasets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-22"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-24"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-25"><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-26"><span class="crayon-v">validation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'validation.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-27"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-28"><span class="crayon-p"># load model</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-29"><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ARIMAResults</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'model.pkl'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-30"><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'model_bias.npy'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-31"><span class="crayon-p"># make first prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-32"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-33"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-34"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-35"><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-36"><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-37"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Predicted=%.3f, Expected=%3.f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-38"><span class="crayon-p"># rolling forecasts</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-39"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-40"><span class="crayon-h"> </span><span class="crayon-p"># difference data</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-41"><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-42"><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-43"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-44"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-45"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-o">=</span><span class="crayon-s">'nc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-46"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-47"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bias</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">months_in_year</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-48"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-49"><span class="crayon-h"> </span><span class="crayon-p"># observation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-50"><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-51"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-52"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Predicted=%.3f, Expected=%3.f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-53"><span class="crayon-p"># report performance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-54"><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-55"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-56"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-57"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a76171097622-58"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65907ca0a76171097622-59"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>Running the example prints each prediction and expected value for the time steps in the validation dataset.</p>
<p>The final RMSE for the validation period is predicted at 361.110 million sales.</p>
<p>This is much better than the expectation of an error of a little more than 924 million sales per month.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca0a79366396841" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
&gt;Predicted=6794.773, Expected=6981
&gt;Predicted=10101.763, Expected=9851
&gt;Predicted=13219.067, Expected=12670
&gt;Predicted=3996.535, Expected=4348
&gt;Predicted=3465.934, Expected=3564
&gt;Predicted=4522.683, Expected=4577
&gt;Predicted=4901.336, Expected=4788
&gt;Predicted=5190.094, Expected=4618
&gt;Predicted=4930.190, Expected=5312
&gt;Predicted=4944.785, Expected=4298
&gt;Predicted=1699.409, Expected=1413
&gt;Predicted=6085.324, Expected=5877
RMSE: 361.110</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca0a79366396841-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca0a79366396841-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca0a79366396841-1">&gt;Predicted=6794.773, Expected=6981</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-2">&gt;Predicted=10101.763, Expected=9851</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-3">&gt;Predicted=13219.067, Expected=12670</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-4">&gt;Predicted=3996.535, Expected=4348</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-5">&gt;Predicted=3465.934, Expected=3564</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-6">&gt;Predicted=4522.683, Expected=4577</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-7">&gt;Predicted=4901.336, Expected=4788</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-8">&gt;Predicted=5190.094, Expected=4618</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-9">&gt;Predicted=4930.190, Expected=5312</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-10">&gt;Predicted=4944.785, Expected=4298</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-11">&gt;Predicted=1699.409, Expected=1413</div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca0a79366396841-12">&gt;Predicted=6085.324, Expected=5877</div><div class="crayon-line" id="crayon-5a65907ca0a79366396841-13">RMSE: 361.110</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the predictions compared to the validation dataset is also provided.</p>
<p>At this scale on the plot, the 12 months of forecast sales figures look fantastic.</p>
<div class="wp-caption aligncenter" id="attachment_3737" style="max-width: 810px"><img alt="Forecast for Champagne Sales Validation Dataset" class="size-full wp-image-3737" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Forecast-for-Champagne-Sales-Validation-Dataset.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Forecast-for-Champagne-Sales-Validation-Dataset.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Forecast-for-Champagne-Sales-Validation-Dataset-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/Forecast-for-Champagne-Sales-Validation-Dataset-768x576.png 768w" width="800"/><p class="wp-caption-text">Forecast for Champagne Sales Validation Dataset</p></div>
<h2>Summary</h2>
<p>In this tutorial, you discovered the steps and the tools for a time series forecasting project with Python.</p>
<p>We have covered a lot of ground in this tutorial; specifically:</p>
<ul>
<li>How to develop a test harness with a performance measure and evaluation method and how to quickly develop a baseline forecast and skill.</li>
<li>How to use time series analysis to raise ideas for how to best model the forecast problem.</li>
<li>How to develop an ARIMA model, save it, and later load it to make predictions on new data.</li>
</ul>
<p>How did you do? Do you have any questions about this tutorial?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-26"> <div class="textwidget"><p></p><center>
<div class="woo-sc-hr"></div>
<h2>Want to Develop Time Series Forecasts with Python?</h2>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img align="left" alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasts in Minutes</h4>
<p>...with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/introduction-to-time-series-forecasting-with-python/">Introduction to Time Series Forecasting With Python</a></p>
<p>It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Loading data, visualization, modeling, algorithm tuning,</em> and much more...</p>
<h4>Finally Bring Time Series Forecasting to<br/>
Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
<p></p></center>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-forecast-study-python-monthly-sales-french-champagne%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/&amp;summary=Time+series+forecasting+is+a+process%2C+and+the+only+way+to+get+good+forecasts+is+to+practice+this+pro..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Time%20Series%20Forecast%20Study%20with%20Python%3A%20Monthly%20Sales%20of%20French%20Champagne&amp;url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/&amp;summary=Time+series+forecasting+is+a+process%2C+and+the+only+way+to+get+good+forecasts+is+to+practice+this+pro...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/student-got-machine-learning-internship-job-data-science-team/" rel="prev"><i class="fa fa-angle-left"></i> How Álvaro Lemos got a Machine Learning Internship on a Data Science Team</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/difference-time-series-dataset-python/" rel="next">How to Difference a Time Series Dataset with Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">77 Responses to <em>Time Series Forecast Study with Python: Monthly Sales of French Champagne</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-389250">
<div class="comment-container" id="li-comment-389250">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benson Dube</span>
<span class="date">February 20, 2017 at 8:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389250" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank You Jason. </p>
<p>Would you recommend this example to a starter. I am totally new to programming and Machine Learning, and I am currently learning Python sytnax and understanding the basic terms around algorithms used.</p>
<p>Regards,</p>
<p>Benson</p>
<div class="reply">
<a aria-label="Reply to Benson Dube" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389250#respond" onclick='return addComment.moveForm( "comment-389250", "389250", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-389335">
<div class="comment-container" id="li-comment-389335">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389335" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Benson, this tutorial is an example for a beginner in time series forecasting, but does assume you know your way around Python first (or you can pick it up fast).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389335#respond" onclick='return addComment.moveForm( "comment-389335", "389335", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-390692">
<div class="comment-container" id="li-comment-390692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benson</span>
<span class="date">March 1, 2017 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-390692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A surely steep learning curve taking you out of your comfort zone, but that’s the way to learn. ?</p>
<div class="reply">
<a aria-label="Reply to Benson" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=390692#respond" onclick='return addComment.moveForm( "comment-390692", "390692", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-390720">
<div class="comment-container" id="li-comment-390720">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-390720" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For sure. Dive in!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=390720#respond" onclick='return addComment.moveForm( "comment-390720", "390720", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-389782">
<div class="comment-container" id="li-comment-389782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52ebf7d6ff2c031a05c442928739edcb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52ebf7d6ff2c031a05c442928739edcb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viral Mehta</span>
<span class="date">February 24, 2017 at 4:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thanks for very detailed instructions on how to construct the model. When I add a few additional periods in the validation set (manually) for a short-term forecast beyond the dataset, the model won’t run until I provide some ‘fake’ targets (expected y). However, when I provide some fake targets, I see that model quickly adjusts to those targets. I tried different levels of y values and I see model predicted accordingly, shouldn’t the predictions be independent of what targets it sees?</p>
<div class="reply">
<a aria-label="Reply to Viral Mehta" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389782#respond" onclick='return addComment.moveForm( "comment-389782", "389782", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-389821">
<div class="comment-container" id="li-comment-389821">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 24, 2017 at 10:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389821" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You should not need fake targets Viral.</p>
<p>You can forecast a new out of sample data point by training the model on all of the available data and predicting one-step. E.g.:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca3d3b636632123" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
yhat = model_fit.forecast()[0]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca3d3b636632123-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca3d3b636632123-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389821#respond" onclick='return addComment.moveForm( "comment-389821", "389821", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-389948">
<div class="comment-container" id="li-comment-389948">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52ebf7d6ff2c031a05c442928739edcb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52ebf7d6ff2c031a05c442928739edcb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viral Mehta</span>
<span class="date">February 25, 2017 at 2:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389948" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, much appreciate your response. What I am trying to convey is that the model should predict same outputs regardless of the observations. For example, when I change y values in my validation set (last 12 months that the model hasn’t seen), my predictions change and the model gives me a very nice RMSE every time. If the model was trained properly, it should have same output for next twelve months regardless of my y values in the validation set. I think you will see this effect very quickly if you also change your y values from validation set. Unless the model is only good for one period forward and needs to continuously adjust based on observed values of last period.</p>
<div class="reply">
<a aria-label="Reply to Viral Mehta" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389948#respond" onclick='return addComment.moveForm( "comment-389948", "389948", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-389975">
<div class="comment-container" id="li-comment-389975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 25, 2017 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-389975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In this specific case we are using walk-forward validation with a model trained for one-step forecasts.</p>
<p>This means as we walk over the validation dataset, observations are moved from validation into training and the model is refit. This is to simulate a new observation being available after a prediction is made for a time step and us being able to update our model in response.</p>
<p>I think what you are talking about is a multi-step forecast, e.g. fitting the model on all of the training data, then forecasting the next n time steps. This is not the experimental setup here, but you are welcome to try it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=389975#respond" onclick='return addComment.moveForm( "comment-389975", "389975", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-392735">
<div class="comment-container" id="li-comment-392735">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ff42a39e189b2df74dfe312c5008e30?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benson Dube</span>
<span class="date">March 15, 2017 at 9:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-392735" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>If you don’t mind me asking, where exactly should the line below fit?:</p>
<p>yhat = model_fit.forecast()[0]</p>
<div class="reply">
<a aria-label="Reply to Benson Dube" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=392735#respond" onclick='return addComment.moveForm( "comment-392735", "392735", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-392852">
<div class="comment-container" id="li-comment-392852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 16, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-392852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Benson,</p>
<p>Fit the ARIMA model on all of your data.</p>
<p>After that, make a forecast for the next time step by calling the forecast() function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=392852#respond" onclick='return addComment.moveForm( "comment-392852", "392852", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-390352">
<div class="comment-container" id="li-comment-390352">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e329c69592ab2a0f893458bd058895f9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e329c69592ab2a0f893458bd058895f9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Juanlu</span>
<span class="date">February 27, 2017 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-390352" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Time to upgrade to matplotlib 2.0, the colors are nicer 🙂</p>
<div class="reply">
<a aria-label="Reply to Juanlu" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=390352#respond" onclick='return addComment.moveForm( "comment-390352", "390352", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390482">
<div class="comment-container" id="li-comment-390482">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 28, 2017 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-390482" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree Juanlu! I have recently upgraded myself.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=390482#respond" onclick='return addComment.moveForm( "comment-390482", "390482", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-393939">
<div class="comment-container" id="li-comment-393939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/23284164f4f9f7d0b9351d8ef340ceb1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/23284164f4f9f7d0b9351d8ef340ceb1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hugo</span>
<span class="date">March 24, 2017 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-393939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
Thanks for the post. Clear, concise and working.</p>
<p>Have you considered to forecast the TS using a SARIMA model instead of substracting the seasonality and adding it latter? As a matter of fact, statsmodel has it integrated in its dev version. (<a href="http://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html" rel="nofollow">http://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html</a>)</p>
<p>I am wondering if it is possible to take into account hierarchy, like the forecast of monthly sales divided in sub-forecasts of french champagne destination markets, using python.</p>
<p>Thanks and keep posting!</p>
<div class="reply">
<a aria-label="Reply to Hugo" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=393939#respond" onclick='return addComment.moveForm( "comment-393939", "393939", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393977">
<div class="comment-container" id="li-comment-393977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-393977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Hugo, yes I am familiar with SARIMA, but I decided to keep the example limited to ARIMA.</p>
<p>Yes, as long as you have the data to train/verify the model. I would consider starting with independent models for each case, using all available data and tease out how to optimize it further after that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=393977#respond" onclick='return addComment.moveForm( "comment-393977", "393977", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398294">
<div class="comment-container" id="li-comment-398294">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ac39788c11c5586619636e6e9d483d1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ac39788c11c5586619636e6e9d483d1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luis Ashurei</span>
<span class="date">May 2, 2017 at 7:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-398294" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the wonderful post Jason,</p>
<p>Two quick question:</p>
<p>1.<br/>
When I’m doing Grid Search ARIMA Hyperparameters with your example, it’s quite slow on my machine, spent about 1 minutes. However the parameter range and data are not large at all. Is it slow specific on my end? I’m concerning the model is too slow to use.</p>
<p>2.<br/>
Does ARIMA support multi-step forecast? E.g. What if I keep use predicted value into next forecast, will it overfitting?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Luis Ashurei" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=398294#respond" onclick='return addComment.moveForm( "comment-398294", "398294", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398357">
<div class="comment-container" id="li-comment-398357">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-398357" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your timing sounds fine. If it is too slow for you, consider working with a sub-sample of your data.</p>
<p>You can do multi-step forecasting directly (forecast() function) or by using the ARIMA model recursively:<br/>
<a href="http://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=398357#respond" onclick='return addComment.moveForm( "comment-398357", "398357", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-398423">
<div class="comment-container" id="li-comment-398423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ac39788c11c5586619636e6e9d483d1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ac39788c11c5586619636e6e9d483d1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luis</span>
<span class="date">May 3, 2017 at 6:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-398423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks in advice.</p>
<div class="reply">
<a aria-label="Reply to Luis" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=398423#respond" onclick='return addComment.moveForm( "comment-398423", "398423", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404637">
<div class="comment-container" id="li-comment-404637">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9c251f675fee22e092cb44c9214593f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9c251f675fee22e092cb44c9214593f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pramod Gupta</span>
<span class="date">July 3, 2017 at 7:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-404637" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason</p>
<p>Thanks for this awesome hands-on on Time series. However I have a query. </p>
<p>I extracted year and month from date column as my features for model. Then I built a Linear Regression model and a Random Forest model. My final prediction was a weighted average of both these models. I got an rmse of 366 (similar to yours i.e. 361 on validation data).</p>
<p>Can this approach be the alternative for an ARIMA model? What can be the possible drawbacks of this approach?</p>
<p>Appreciate your comments<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Pramod Gupta" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=404637#respond" onclick='return addComment.moveForm( "comment-404637", "404637", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404868">
<div class="comment-container" id="li-comment-404868">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-404868" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work. ARIMA may be a simpler model if model complexity is important on a project.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=404868#respond" onclick='return addComment.moveForm( "comment-404868", "404868", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404762">
<div class="comment-container" id="li-comment-404762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a6fda460699a59d4bfb475edffd71c0a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a6fda460699a59d4bfb475edffd71c0a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roberto</span>
<span class="date">July 5, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-404762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi just a silly note have you consider using itertools for your evaluate_models() function?<br/>
<a href="https://pastebin.com/w0apb6Tg" rel="nofollow">https://pastebin.com/w0apb6Tg</a></p>
<p>in python nested loops are not so readable.</p>
<div class="reply">
<a aria-label="Reply to Roberto" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=404762#respond" onclick='return addComment.moveForm( "comment-404762", "404762", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404896">
<div class="comment-container" id="li-comment-404896">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-404896" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=404896#respond" onclick='return addComment.moveForm( "comment-404896", "404896", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405088">
<div class="comment-container" id="li-comment-405088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e9deb5fceeaa670e53216a9ec1a3132e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e9deb5fceeaa670e53216a9ec1a3132e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishi Patil</span>
<span class="date">July 8, 2017 at 9:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-405088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I just finished reading “Introduction to Time Series Forecasting in Python” in detail and had two questions:<br/>
* Are you planning to come out with a “Intermediate course in Time Series Forecasting in Python” soon?<br/>
* You spend the first few chapters discussing how to reframe a time-series problem into a typical Machine Learning problem using Lag features. However, in later chapters, you only use ARIMA models, that obviate the necessity of using explicitly generated lag features. What’s the best way to use explicitly generated timeseries features with other ML algorithms (such as SVM or XGBoost)?<br/>
(I tried out a few AR lags with XGB and got decent results using but couldn’t figure out how to incorporate the MA parts).<br/>
Would appreciate any insights.</p>
<div class="reply">
<a aria-label="Reply to Rishi Patil" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=405088#respond" onclick='return addComment.moveForm( "comment-405088", "405088", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405258">
<div class="comment-container" id="li-comment-405258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-405258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I may have a more advanced TS book in the future.</p>
<p>Great question. You would have to calculate the MA features manually.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=405258#respond" onclick='return addComment.moveForm( "comment-405258", "405258", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408293">
<div class="comment-container" id="li-comment-408293">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/544d1a205925f88d63d380ce45ebabbd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/544d1a205925f88d63d380ce45ebabbd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jan</span>
<span class="date">August 2, 2017 at 8:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-408293" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>can it be that TimeGrouper() does not work if there are months missing in a year? Also there are no docs available for TimeGrouper(). May you can use pd.Grouper in your future examples?</p>
<p>Regards</p>
<div class="reply">
<a aria-label="Reply to Jan" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=408293#respond" onclick='return addComment.moveForm( "comment-408293", "408293", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408351">
<div class="comment-container" id="li-comment-408351">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-408351" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think it does work with missing data, allowing you to resample.</p>
<p>TimeGrouper does not have docs, but Grouper does and is a good start:<br/>
<a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Grouper.html" rel="nofollow">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Grouper.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=408351#respond" onclick='return addComment.moveForm( "comment-408351", "408351", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409883">
<div class="comment-container" id="li-comment-409883">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b0b8ecbe0723d6d2825d9cb04c101234?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b0b8ecbe0723d6d2825d9cb04c101234?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sambit</span>
<span class="date">August 17, 2017 at 5:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-409883" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Thanks for this great link on time series.</p>
<p>I am not able to acces the dataset stored at:- <a href="https://datamarket.com/data/set/22r5/perrin-freres-monthly-champagne-sales-millions-64-72#!ds=22r5&amp;display=line" rel="nofollow">https://datamarket.com/data/set/22r5/perrin-freres-monthly-champagne-sales-millions-64-72#!ds=22r5&amp;display=line</a></p>
<p>Regards,<br/>
Sambit</p>
<div class="reply">
<a aria-label="Reply to Sambit" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=409883#respond" onclick='return addComment.moveForm( "comment-409883", "409883", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409908">
<div class="comment-container" id="li-comment-409908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-409908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that, here is the full dataset:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65907ca3517047970180" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
"Month","Sales"
"1964-01",2815
"1964-02",2672
"1964-03",2755
"1964-04",2721
"1964-05",2946
"1964-06",3036
"1964-07",2282
"1964-08",2212
"1964-09",2922
"1964-10",4301
"1964-11",5764
"1964-12",7312
"1965-01",2541
"1965-02",2475
"1965-03",3031
"1965-04",3266
"1965-05",3776
"1965-06",3230
"1965-07",3028
"1965-08",1759
"1965-09",3595
"1965-10",4474
"1965-11",6838
"1965-12",8357
"1966-01",3113
"1966-02",3006
"1966-03",4047
"1966-04",3523
"1966-05",3937
"1966-06",3986
"1966-07",3260
"1966-08",1573
"1966-09",3528
"1966-10",5211
"1966-11",7614
"1966-12",9254
"1967-01",5375
"1967-02",3088
"1967-03",3718
"1967-04",4514
"1967-05",4520
"1967-06",4539
"1967-07",3663
"1967-08",1643
"1967-09",4739
"1967-10",5428
"1967-11",8314
"1967-12",10651
"1968-01",3633
"1968-02",4292
"1968-03",4154
"1968-04",4121
"1968-05",4647
"1968-06",4753
"1968-07",3965
"1968-08",1723
"1968-09",5048
"1968-10",6922
"1968-11",9858
"1968-12",11331
"1969-01",4016
"1969-02",3957
"1969-03",4510
"1969-04",4276
"1969-05",4968
"1969-06",4677
"1969-07",3523
"1969-08",1821
"1969-09",5222
"1969-10",6872
"1969-11",10803
"1969-12",13916
"1970-01",2639
"1970-02",2899
"1970-03",3370
"1970-04",3740
"1970-05",2927
"1970-06",3986
"1970-07",4217
"1970-08",1738
"1970-09",5221
"1970-10",6424
"1970-11",9842
"1970-12",13076
"1971-01",3934
"1971-02",3162
"1971-03",4286
"1971-04",4676
"1971-05",5010
"1971-06",4874
"1971-07",4633
"1971-08",1659
"1971-09",5951
"1971-10",6981
"1971-11",9851
"1971-12",12670
"1972-01",4348
"1972-02",3564
"1972-03",4577
"1972-04",4788
"1972-05",4618
"1972-06",5312
"1972-07",4298
"1972-08",1413
"1972-09",5877</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-2">2</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-4">4</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-6">6</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-8">8</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-10">10</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-12">12</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-14">14</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-16">16</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-18">18</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-20">20</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-22">22</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-24">24</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-26">26</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-28">28</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-30">30</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-32">32</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-34">34</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-36">36</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-38">38</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-40">40</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-42">42</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-44">44</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-46">46</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-48">48</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-50">50</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-52">52</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-54">54</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-56">56</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-58">58</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-60">60</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-62">62</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-64">64</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-66">66</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-68">68</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-70">70</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-72">72</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-74">74</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-76">76</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-78">78</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-80">80</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-82">82</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-84">84</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-86">86</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-88">88</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-90">90</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-92">92</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-94">94</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-96">96</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-98">98</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-100">100</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-102">102</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-104">104</div><div class="crayon-num" data-line="crayon-5a65907ca3517047970180-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65907ca3517047970180-106">106</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65907ca3517047970180-1"><span class="crayon-s">"Month"</span><span class="crayon-sy">,</span><span class="crayon-s">"Sales"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-2"><span class="crayon-s">"1964-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">2815</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-3"><span class="crayon-s">"1964-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">2672</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-4"><span class="crayon-s">"1964-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">2755</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-5"><span class="crayon-s">"1964-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">2721</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-6"><span class="crayon-s">"1964-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">2946</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-7"><span class="crayon-s">"1964-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">3036</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-8"><span class="crayon-s">"1964-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">2282</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-9"><span class="crayon-s">"1964-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">2212</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-10"><span class="crayon-s">"1964-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">2922</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-11"><span class="crayon-s">"1964-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">4301</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-12"><span class="crayon-s">"1964-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">5764</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-13"><span class="crayon-s">"1964-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">7312</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-14"><span class="crayon-s">"1965-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">2541</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-15"><span class="crayon-s">"1965-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">2475</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-16"><span class="crayon-s">"1965-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">3031</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-17"><span class="crayon-s">"1965-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">3266</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-18"><span class="crayon-s">"1965-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">3776</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-19"><span class="crayon-s">"1965-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">3230</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-20"><span class="crayon-s">"1965-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">3028</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-21"><span class="crayon-s">"1965-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1759</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-22"><span class="crayon-s">"1965-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">3595</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-23"><span class="crayon-s">"1965-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">4474</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-24"><span class="crayon-s">"1965-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">6838</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-25"><span class="crayon-s">"1965-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">8357</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-26"><span class="crayon-s">"1966-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">3113</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-27"><span class="crayon-s">"1966-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">3006</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-28"><span class="crayon-s">"1966-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">4047</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-29"><span class="crayon-s">"1966-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">3523</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-30"><span class="crayon-s">"1966-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">3937</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-31"><span class="crayon-s">"1966-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">3986</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-32"><span class="crayon-s">"1966-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">3260</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-33"><span class="crayon-s">"1966-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1573</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-34"><span class="crayon-s">"1966-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">3528</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-35"><span class="crayon-s">"1966-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">5211</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-36"><span class="crayon-s">"1966-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">7614</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-37"><span class="crayon-s">"1966-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">9254</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-38"><span class="crayon-s">"1967-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">5375</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-39"><span class="crayon-s">"1967-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">3088</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-40"><span class="crayon-s">"1967-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">3718</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-41"><span class="crayon-s">"1967-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">4514</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-42"><span class="crayon-s">"1967-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">4520</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-43"><span class="crayon-s">"1967-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">4539</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-44"><span class="crayon-s">"1967-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">3663</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-45"><span class="crayon-s">"1967-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1643</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-46"><span class="crayon-s">"1967-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">4739</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-47"><span class="crayon-s">"1967-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">5428</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-48"><span class="crayon-s">"1967-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">8314</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-49"><span class="crayon-s">"1967-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">10651</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-50"><span class="crayon-s">"1968-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">3633</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-51"><span class="crayon-s">"1968-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">4292</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-52"><span class="crayon-s">"1968-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">4154</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-53"><span class="crayon-s">"1968-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">4121</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-54"><span class="crayon-s">"1968-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">4647</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-55"><span class="crayon-s">"1968-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">4753</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-56"><span class="crayon-s">"1968-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">3965</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-57"><span class="crayon-s">"1968-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1723</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-58"><span class="crayon-s">"1968-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">5048</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-59"><span class="crayon-s">"1968-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">6922</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-60"><span class="crayon-s">"1968-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">9858</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-61"><span class="crayon-s">"1968-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">11331</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-62"><span class="crayon-s">"1969-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">4016</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-63"><span class="crayon-s">"1969-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">3957</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-64"><span class="crayon-s">"1969-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">4510</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-65"><span class="crayon-s">"1969-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">4276</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-66"><span class="crayon-s">"1969-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">4968</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-67"><span class="crayon-s">"1969-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">4677</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-68"><span class="crayon-s">"1969-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">3523</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-69"><span class="crayon-s">"1969-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1821</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-70"><span class="crayon-s">"1969-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">5222</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-71"><span class="crayon-s">"1969-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">6872</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-72"><span class="crayon-s">"1969-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">10803</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-73"><span class="crayon-s">"1969-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">13916</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-74"><span class="crayon-s">"1970-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">2639</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-75"><span class="crayon-s">"1970-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">2899</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-76"><span class="crayon-s">"1970-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">3370</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-77"><span class="crayon-s">"1970-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">3740</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-78"><span class="crayon-s">"1970-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">2927</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-79"><span class="crayon-s">"1970-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">3986</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-80"><span class="crayon-s">"1970-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">4217</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-81"><span class="crayon-s">"1970-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1738</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-82"><span class="crayon-s">"1970-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">5221</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-83"><span class="crayon-s">"1970-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">6424</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-84"><span class="crayon-s">"1970-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">9842</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-85"><span class="crayon-s">"1970-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">13076</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-86"><span class="crayon-s">"1971-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">3934</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-87"><span class="crayon-s">"1971-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">3162</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-88"><span class="crayon-s">"1971-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">4286</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-89"><span class="crayon-s">"1971-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">4676</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-90"><span class="crayon-s">"1971-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">5010</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-91"><span class="crayon-s">"1971-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">4874</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-92"><span class="crayon-s">"1971-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">4633</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-93"><span class="crayon-s">"1971-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1659</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-94"><span class="crayon-s">"1971-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">5951</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-95"><span class="crayon-s">"1971-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">6981</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-96"><span class="crayon-s">"1971-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">9851</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-97"><span class="crayon-s">"1971-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">12670</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-98"><span class="crayon-s">"1972-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">4348</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-99"><span class="crayon-s">"1972-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">3564</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-100"><span class="crayon-s">"1972-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">4577</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-101"><span class="crayon-s">"1972-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">4788</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-102"><span class="crayon-s">"1972-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">4618</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-103"><span class="crayon-s">"1972-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">5312</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-104"><span class="crayon-s">"1972-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">4298</span></div><div class="crayon-line" id="crayon-5a65907ca3517047970180-105"><span class="crayon-s">"1972-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">1413</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65907ca3517047970180-106"><span class="crayon-s">"1972-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">5877</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=409908#respond" onclick='return addComment.moveForm( "comment-409908", "409908", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410764">
<div class="comment-container" id="li-comment-410764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c9d81a96d76e89dcb53b0a84d06a56f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c9d81a96d76e89dcb53b0a84d06a56f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sarrauste</span>
<span class="date">August 24, 2017 at 1:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-410764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi,<br/>
i am having the following error:</p>
<p>X = X.astype(‘float32’)<br/>
ValueError: could not convert string to float: ‘1972-09’</p>
<p>can you please help me<br/>
ty</p>
<div class="reply">
<a aria-label="Reply to sarrauste" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=410764#respond" onclick='return addComment.moveForm( "comment-410764", "410764", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410815">
<div class="comment-container" id="li-comment-410815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 24, 2017 at 6:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-410815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you may have missed some lines of code. Confirm you have them all.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=410815#respond" onclick='return addComment.moveForm( "comment-410815", "410815", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411494">
<div class="comment-container" id="li-comment-411494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/85a2f6123bfd828ed583c788c4c12c94?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/85a2f6123bfd828ed583c788c4c12c94?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sandip</span>
<span class="date">August 28, 2017 at 8:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason , Nice approach for time series forecasting.Thanks for this Article.</p>
<p>Just had a one small doubt,Here we are tuning our ARIMA parameter on test data using RMSE as a measure  but generally we tune our parameter on the training(train+validation)data and then we check whether those parameters are well generalized or not  by using test data. is it right?<br/>
Because my concern is that  if we choose our parameter on that particular test data,whether those parameter will generalized to coming new test data or not? I feel that there will be biasness while choosing parameter because we are specifically  choosing parameter those giving less RMSE for that test data.Here we are not checking whether our model is working/fitted well for our train data or not?<br/>
If i am wrong just correct me.Let me know the logic behind this parameter tuning on the basis of test data?</p>
<div class="reply">
<a aria-label="Reply to sandip" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411494#respond" onclick='return addComment.moveForm( "comment-411494", "411494", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411607">
<div class="comment-container" id="li-comment-411607">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 29, 2017 at 5:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411607" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, that is a less biased way to prepare a model.</p>
<p>More here:<br/>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411607#respond" onclick='return addComment.moveForm( "comment-411607", "411607", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-411624">
<div class="comment-container" id="li-comment-411624">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/85a2f6123bfd828ed583c788c4c12c94?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/85a2f6123bfd828ed583c788c4c12c94?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sandip</span>
<span class="date">August 29, 2017 at 5:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411624" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much Jason.</p>
<div class="reply">
<a aria-label="Reply to sandip" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411624#respond" onclick='return addComment.moveForm( "comment-411624", "411624", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411692">
<div class="comment-container" id="li-comment-411692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 30, 2017 at 6:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome sandip.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411692#respond" onclick='return addComment.moveForm( "comment-411692", "411692", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411819">
<div class="comment-container" id="li-comment-411819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c6728cb1706dcc5edf6cdb43bf4eaba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c6728cb1706dcc5edf6cdb43bf4eaba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anthy</span>
<span class="date">August 31, 2017 at 2:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for this detailed and clear tutorial.<br/>
I have a question concerning fiding ARIMA’s parameters. I didn’t understand why we have an imbricated “for” loop and we do consider all the p values and not all the q values. </p>
<p>Please ask if the question is not that clear.</p>
<p>Thank you in advance.</p>
<div class="reply">
<a aria-label="Reply to Anthy" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411819#respond" onclick='return addComment.moveForm( "comment-411819", "411819", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411852">
<div class="comment-container" id="li-comment-411852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2017 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-411852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please review the example again, we grid search p, d and q values.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=411852#respond" onclick='return addComment.moveForm( "comment-411852", "411852", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-412103">
<div class="comment-container" id="li-comment-412103">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e20bca25ff7e4cd4edae5157ae6eba7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e20bca25ff7e4cd4edae5157ae6eba7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ella Zhao</span>
<span class="date">September 2, 2017 at 4:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412103" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for this awesome example! It helped me a lot! However if you don’t mind, I have a question on the prediction loop.</p>
<p>Why did you use history.append(obs) instead of history.append(yhat) when doing the loop for prediction? Sees like you add the observation (real data in test) to history. And yhat = bias + inverse_difference(history, yhat, months_in_year) is based on the history data. but actually we don’t have those observation data when solving practical problem. </p>
<p>I’ve tried to use history.append(yhat) in my model, but the result is worse than using history.append(obs). </p>
<p>Appreciate your comments</p>
<p>Thanks,</p>
<p>Ella</p>
<div class="reply">
<a aria-label="Reply to Ella Zhao" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412103#respond" onclick='return addComment.moveForm( "comment-412103", "412103", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412126">
<div class="comment-container" id="li-comment-412126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2017 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, because in this scenario, we are assuming that each new real observation is available after we make a prediction.</p>
<p>Pretend we are running this loop one iteration per day, and we get yesterdays observation this morning so we can accurately predict tomorrow.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412126#respond" onclick='return addComment.moveForm( "comment-412126", "412126", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-412313">
<div class="comment-container" id="li-comment-412313">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e20bca25ff7e4cd4edae5157ae6eba7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e20bca25ff7e4cd4edae5157ae6eba7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ella Zhao</span>
<span class="date">September 2, 2017 at 11:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412313" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much for your explanation!!</p>
<div class="reply">
<a aria-label="Reply to Ella Zhao" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412313#respond" onclick='return addComment.moveForm( "comment-412313", "412313", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-412350">
<div class="comment-container" id="li-comment-412350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412350#respond" onclick='return addComment.moveForm( "comment-412350", "412350", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-412321">
<div class="comment-container" id="li-comment-412321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1219c03347edb0eedb18b1a340111456?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1219c03347edb0eedb18b1a340111456?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alaoui</span>
<span class="date">September 3, 2017 at 12:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thanks a lot for this work.<br/>
I have a point to discuss on concerning the walk forward validation.<br/>
I saw that you fill the history part by a value from the test set at each iteration :<br/>
…..<br/>
# observation<br/>
obs = test[i]<br/>
history.append(obs)<br/>
….</p>
<p>Do we really have to do this or we have to use the new yhat computed for the next predictions?<br/>
Indeed when we have to do a future prediction on some range date we don’t have the historical value….<br/>
Regards and thanks in advance for your feedback</p>
<p>Simo</p>
<div class="reply">
<a aria-label="Reply to Alaoui" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412321#respond" onclick='return addComment.moveForm( "comment-412321", "412321", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412351">
<div class="comment-container" id="li-comment-412351">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412351" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It depends on your model and project goals.</p>
<p>In this case, we are assuming that the true observations are available after each modeling step and can be used in the formulation of the next prediction, a reasonable assumption, but not required in general.</p>
<p>If you use outputs as inputs (e.g. recursive multi-step forecasting), error will compound and things will go more crazy, sooner (e.g. model skill will drop). See this post:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412351#respond" onclick='return addComment.moveForm( "comment-412351", "412351", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-412322">
<div class="comment-container" id="li-comment-412322">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1219c03347edb0eedb18b1a340111456?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1219c03347edb0eedb18b1a340111456?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alaoui</span>
<span class="date">September 3, 2017 at 12:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412322" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I just read the Ella question…So for long range future prediction we have ti use the yhat…<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Alaoui" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412322#respond" onclick='return addComment.moveForm( "comment-412322", "412322", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412352">
<div class="comment-container" id="li-comment-412352">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-412352" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can if you choose.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=412352#respond" onclick='return addComment.moveForm( "comment-412352", "412352", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414010">
<div class="comment-container" id="li-comment-414010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c8d3674c0ecca3e7c66e7363a3ca561?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c8d3674c0ecca3e7c66e7363a3ca561?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sujeet</span>
<span class="date">September 16, 2017 at 12:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I am getting NAN after these steps:</p>
<p>from pandas import Series<br/>
series = Series.from_csv(‘champagne.csv’, header=0)<br/>
print(len(series))<br/>
split_point = len(series) – 12<br/>
print(split_point)<br/>
dataset, validation = series[0:split_point], series[split_point:]<br/>
print(dataset)<br/>
print(‘Dataset %d, Validation %d’ % (len(dataset), len(validation)))<br/>
dataset.to_csv(‘dataset.csv’)<br/>
validation.to_csv(‘validation.csv’)</p>
<div class="reply">
<a aria-label="Reply to Sujeet" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414010#respond" onclick='return addComment.moveForm( "comment-414010", "414010", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414063">
<div class="comment-container" id="li-comment-414063">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 17, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414063" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that.</p>
<p>Ensure that you have copied all of the code and that you have removed the footer from the data file. Also confirm that your environment is up to date.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414063#respond" onclick='return addComment.moveForm( "comment-414063", "414063", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414309">
<div class="comment-container" id="li-comment-414309">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/66f83a296e5b2b678dd00625341ec4b7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/66f83a296e5b2b678dd00625341ec4b7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jaryn</span>
<span class="date">September 20, 2017 at 3:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414309" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This is extremely useful. Thank you very much!</p>
<p>I was wondering if you could provide the full code to extend the forecast for 1 year ahead. I know you mentioned above that there is a forecast function but when I run:<br/>
yhat = model_fit.forecast()[0]<br/>
pyplot.plot(y)<br/>
pyplot.plot(yhat, color=’green’)<br/>
pyplot.plot(predictions, color=’red’)<br/>
pyplot.show()</p>
<p>I don’t get any green lines in my code. I’m sure I’m missing a lot of things here, but I don’t know what.</p>
<p>Thank you again, much appreciated!</p>
<div class="reply">
<a aria-label="Reply to Jaryn" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414309#respond" onclick='return addComment.moveForm( "comment-414309", "414309", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414330">
<div class="comment-container" id="li-comment-414330">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2017 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414330" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will help you with making longer-term forecasts:<br/>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414330#respond" onclick='return addComment.moveForm( "comment-414330", "414330", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414365">
<div class="comment-container" id="li-comment-414365">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0f09c3934f602063b5a9596e304194eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0f09c3934f602063b5a9596e304194eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kunal Shrivastava</span>
<span class="date">September 20, 2017 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414365" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I am using this modelling steps to model my problem. When I am passing best parameter which  i have got from Grid Search for doing prediction, I am getting Linear Algebra error and sometimes not converging<br/>
Due to this I am not able to predict the values. </p>
<p>My second concern is if this is happening for Grid search, how can i automate the script in production environment. Lets say i have to forecast some values for 50000 different sites then what is best way to achieve this goal ?</p>
<div class="reply">
<a aria-label="Reply to Kunal Shrivastava" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414365#respond" onclick='return addComment.moveForm( "comment-414365", "414365", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414406">
<div class="comment-container" id="li-comment-414406">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414406" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, perhaps you have not set all of the parameters the same as you used in the grid search?</p>
<p>I have some notes about models in production here that may help:<br/>
<a href="http://machinelearningmastery.com/deploy-machine-learning-model-to-production/" rel="nofollow">http://machinelearningmastery.com/deploy-machine-learning-model-to-production/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414406#respond" onclick='return addComment.moveForm( "comment-414406", "414406", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414725">
<div class="comment-container" id="li-comment-414725">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/391f85af2713f4db6626a726111eb420?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/391f85af2713f4db6626a726111eb420?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tri Bien</span>
<span class="date">September 24, 2017 at 7:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414725" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank for your post, it is really helpful for me. It is great!<br/>
I have a small question:<br/>
In the post, you use 2 data set:  dataset.csv and validation.csv<br/>
+ In dataset.csv, you split it and use Walk-forward validation -&gt; I totally agree.<br/>
+ In validation.csv, you still re-train ARIMA model with walk-forward validation (model_fit = model.fit(trend=’nc’, disp=0) – line 45 in section 7.3) -&gt; I think it is unseen data for testing, so we don’t train model here and only test the model’s performance. Is it correct?</p>
<div class="reply">
<a aria-label="Reply to Tri Bien" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414725#respond" onclick='return addComment.moveForm( "comment-414725", "414725", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414751">
<div class="comment-container" id="li-comment-414751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-414751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the case of walk forward validation, we are assuming that the real observations are available after the time of prediction.</p>
<p>You can make different assumptions when evaluating your model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=414751#respond" onclick='return addComment.moveForm( "comment-414751", "414751", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415120">
<div class="comment-container" id="li-comment-415120">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cfa7be2d9683ade27e91735a58c8d249?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cfa7be2d9683ade27e91735a58c8d249?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Navid</span>
<span class="date">September 30, 2017 at 1:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-415120" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
First of all, thank you for your wonderful tutorial.<br/>
Until now (part 5.4) I just have one doubt: why you plotted a histogram/kde without removing the trend first? If the goal is to see how the distribution shape is similar to Gaussian distribution, doesn’t a trend changes the distribution of data?</p>
<p>Thanks<br/>
Navid</p>
<div class="reply">
<a aria-label="Reply to Navid" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=415120#respond" onclick='return addComment.moveForm( "comment-415120", "415120", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415168">
<div class="comment-container" id="li-comment-415168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2017 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-415168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, at that point we are early in the analysis. Generally, I’d recommend looking at density plots before and after making the series stationary.</p>
<p>Trend removal generally won’t impact the form of the distribution if we are doing simple linear operations.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=415168#respond" onclick='return addComment.moveForm( "comment-415168", "415168", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417126">
<div class="comment-container" id="li-comment-417126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9d2dae331b464a70f261da89b162f9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9d2dae331b464a70f261da89b162f9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nick</span>
<span class="date">October 19, 2017 at 12:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-417126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for your awesome post. Could you explain how to set the ‘interval’ in the function difference if I only have 1-year data? My dataset is recorded in half an hour, from June 2016 to June 2017. These data number are large in summer and small in winter, i.e. in winter it is between 0-2000, but in summer it is between 5000-14000.</p>
<div class="reply">
<a aria-label="Reply to Nick" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=417126#respond" onclick='return addComment.moveForm( "comment-417126", "417126", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417510">
<div class="comment-container" id="li-comment-417510">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/527ac283f695fed5a3cae25c173e8d29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/527ac283f695fed5a3cae25c173e8d29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shashank Hegde</span>
<span class="date">October 22, 2017 at 3:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-417510" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for the post.I want to implement ‘ARIMA’ function instead of using built-in function.<br/>
Do you know where I can find the algorithm to implement ‘ARIMA’ function as well understanding that in detail manner?</p>
<div class="reply">
<a aria-label="Reply to Shashank Hegde" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=417510#respond" onclick='return addComment.moveForm( "comment-417510", "417510", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417564">
<div class="comment-container" id="li-comment-417564">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-417564" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A good textbook on the math is this one: <a href="http://amzn.to/2zvfIcB" rel="nofollow">http://amzn.to/2zvfIcB</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=417564#respond" onclick='return addComment.moveForm( "comment-417564", "417564", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418156">
<div class="comment-container" id="li-comment-418156">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18598d058ffb7131d389a1ef29b58add?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18598d058ffb7131d389a1ef29b58add?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hara</span>
<span class="date">October 28, 2017 at 3:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-418156" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the brief tutorial on Time Series forecasting. I am receiving the error “Given a pandas object and the index does not contain dates” when running the ARIMA model code snippet.</p>
<div class="reply">
<a aria-label="Reply to Hara" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=418156#respond" onclick='return addComment.moveForm( "comment-418156", "418156", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418175">
<div class="comment-container" id="li-comment-418175">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-418175" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Be sure you copied all of the sample code exactly including indenting, and also be sure you have prepared the data, including removing the footer information from the file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=418175#respond" onclick='return addComment.moveForm( "comment-418175", "418175", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423751">
<div class="comment-container" id="li-comment-423751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Makis</span>
<span class="date">December 18, 2017 at 8:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-423751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>Thanks for your amazing tut!</p>
<p>I have one problem only when i run the rolling forecasts.</p>
<p>I use a different dataset which has temperature values for every minute of the day. I train the model with the first four days and i use the last day as a test dataset. My problem might  be because i add the test observation to the history and my arima returns the following error: raise ValueError(“The computed initial AR coefficients are not ”<br/>
ValueError: The computed initial AR coefficients are not stationary<br/>
You should induce stationarity, choose a different model order, or you can<br/>
pass your own start_params. </p>
<p> for i in range(0, len(x_test)):</p>
<p>        # difference data<br/>
        diff = difference(history, minutes)<br/>
        # predict<br/>
        model = importer.ARIMA(diff, order=(5, 0, 1))<br/>
        model_fit = model.fit(trend=’nc’, disp=0)<br/>
        yhat = model_fit.forecast()[0]<br/>
        yhat = inverse_difference(history, yhat, minutes)<br/>
        predictions.append(yhat)<br/>
        # observation<br/>
        obs = x_test[i]<br/>
        history.append(obs)<br/>
        print(‘Predicted=%.6f, Expected=%.6f’ % (yhat, obs))</p>
<p>My x_test dataset contains 1440 rows and i get the error on the 1423 iteration of the loop. Until iteration 1423 the each arima model does not have issues.</p>
<p>Your help is precious to me.</p>
<p>Thanks again!</p>
<p>Kindest Regards,<br/>
Makis</p>
<div class="reply">
<a aria-label="Reply to Makis" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=423751#respond" onclick='return addComment.moveForm( "comment-423751", "423751", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423782">
<div class="comment-container" id="li-comment-423782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2017 at 5:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-423782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Have you confirmed that your data set is stationary? Perhaps there is still some trend or seasonal structure?</p>
<p>I have many posts on detrending and seasonal adjustment that may help.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=423782#respond" onclick='return addComment.moveForm( "comment-423782", "423782", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-424008">
<div class="comment-container" id="li-comment-424008">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Makis</span>
<span class="date">December 20, 2017 at 12:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424008" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason, </p>
<p>Thanks for your response!</p>
<p> I have used a different hyperparameter (Arima 5,1,1) instead, and everything worked. I don’t know if this is the right thing, since 5,0,1 and 5,1,1 had exactly the same RMSE. What is your opinion about that? And please, one final question, my results now are extremely good, with an RMSE less than 0,01. The prediction line in the plot is almost over the the real data line. Does this has to do with the history.append(obs)? I’m not sure i understand correctly why the test observation is added to the history. And what is the difference of doing a prediction in a for loop with a new model for every step compared by using the steps parameter in 1 model?</p>
<p>Sorry for the long questions!</p>
<p>Your tutorials are even better than the books i’m currently reading!</p>
<p>Cheers from Greece.</p>
<div class="reply">
<a aria-label="Reply to Makis" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=424008#respond" onclick='return addComment.moveForm( "comment-424008", "424008", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-424057">
<div class="comment-container" id="li-comment-424057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done. I’d recommend using the model that is skillful and stable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=424057#respond" onclick='return addComment.moveForm( "comment-424057", "424057", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-424085">
<div class="comment-container" id="li-comment-424085">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Makis</span>
<span class="date">December 20, 2017 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424085" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason! What i’m trying to say is, maybe the good predictions are because i append the y observation to the history. Why we do this? what is the purpose? If we do not append the y observation then the results are going to be still valid?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-424165">
<div class="comment-container" id="li-comment-424165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 3:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the test setup we are assuming that real observations are made after each prediction that we can in turn use to make the next prediction.</p>
<p>Your specific framing of the problem may differ and I would encourage you to design a test harness to capture that.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-424219">
<div class="comment-container" id="li-comment-424219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Makis</span>
<span class="date">December 20, 2017 at 10:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, for once more thanks for your feedback!<br/>
I will follow your suggestion right now 🙂</p>
<p>Thanks for everything</p>
<p>Kind Regards,<br/>
Makis</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-424224">
<div class="comment-container" id="li-comment-424224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb35f21f5c4b4e41f490aaf82b7b74f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Makis</span>
<span class="date">December 20, 2017 at 10:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, one last question. </p>
<p>Since i do the rolling forecast manner and i introduce a new model for every iteration, why do i need to save a model and do a the first prediction based on that? </p>
<p>Can i simply do the rolling forecast loop to start from 0 instead of 1?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-424253">
<div class="comment-container" id="li-comment-424253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 21, 2017 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423953">
<div class="comment-container" id="li-comment-423953">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/739260af5ce2d9c19f08ac08c5947158?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/739260af5ce2d9c19f08ac08c5947158?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amir</span>
<span class="date">December 19, 2017 at 6:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-423953" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you so much for this amazing tutorial. It really helps me to learn time series forecasting and prepare for my new job. I’m a total beginner in data analysis/science as I’m currently making transition from engineering to data analysis.</p>
<p>But the problem that I’m facing with this tutorial is as I’m running the code, I’m stuck with the final step, “Validate the Model”. I’ve tried to re-copy and re-run the sample code many times but it didn’t seem to work. Here is the error.</p>
<p>&gt;Predicted=10101.763, Expected=9851<br/>
&gt;Predicted=13219.067, Expected=12670<br/>
&gt;Predicted=3996.535, Expected=4348<br/>
&gt;Predicted=3465.934, Expected=3564<br/>
&gt;Predicted=4522.683, Expected=4577<br/>
&gt;Predicted=4901.336, Expected=4788<br/>
&gt;Predicted=5190.094, Expected=4618<br/>
&gt;Predicted=4930.190, Expected=5312<br/>
&gt;Predicted=4944.785, Expected=4298<br/>
&gt;Predicted=1699.409, Expected=1413<br/>
&gt;Predicted=6085.324, Expected=5877<br/>
&gt;Predicted=7135.720, Expected=nan</p>
<p>ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
     56<br/>
     57 # Report performance<br/>
—&gt; 58 mse = mean_squared_error(y, predictions)<br/>
     59 rmse = sqrt(mse)<br/>
     60 print(‘RMSE: %.3f’ % rmse)</p>
<p>/Users/amir/Library/Enthought/Canopy/edm/envs/User/lib/python3.5/site-packages/sklearn/metrics/regression.py in mean_squared_error(y_true, y_pred, sample_weight, multioutput)<br/>
    229     “””<br/>
    230     y_type, y_true, y_pred, multioutput = _check_reg_targets(<br/>
–&gt; 231         y_true, y_pred, multioutput)<br/>
    232     output_errors = np.average((y_true – y_pred) ** 2, axis=0,<br/>
    233                                weights=sample_weight)</p>
<p>/Users/amir/Library/Enthought/Canopy/edm/envs/User/lib/python3.5/site-packages/sklearn/metrics/regression.py in _check_reg_targets(y_true, y_pred, multioutput)<br/>
     73     “””<br/>
     74     check_consistent_length(y_true, y_pred)<br/>
—&gt; 75     y_true = check_array(y_true, ensure_2d=False)<br/>
     76     y_pred = check_array(y_pred, ensure_2d=False)<br/>
     77 </p>
<p>/Users/amir/Library/Enthought/Canopy/edm/envs/User/lib/python3.5/site-packages/sklearn/utils/validation.py in check_array(array, accept_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, warn_on_dtype, estimator)<br/>
    405                              % (array.ndim, estimator_name))<br/>
    406         if force_all_finite:<br/>
–&gt; 407             _assert_all_finite(array)<br/>
    408<br/>
    409     shape_repr = _shape_repr(array.shape)</p>
<p>/Users/amir/Library/Enthought/Canopy/edm/envs/User/lib/python3.5/site-packages/sklearn/utils/validation.py in _assert_all_finite(X)<br/>
     56             and not np.isfinite(X).all()):<br/>
     57         raise ValueError(“Input contains NaN, infinity”<br/>
—&gt; 58                          ” or a value too large for %r.” % X.dtype)<br/>
     59<br/>
     60 </p>
<p>ValueError: Input contains NaN, infinity or a value too large for dtype(‘float32’).</p>
<p>Could you please help me with this?</p>
<p>Thank you so much</p>
<p>Amir</p>
<div class="reply">
<a aria-label="Reply to Amir" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=423953#respond" onclick='return addComment.moveForm( "comment-423953", "423953", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424045">
<div class="comment-container" id="li-comment-424045">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-424045" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure of the cause of your fault, sorry.</p>
<p>Ensure your libraries are up to date and that you have copied all of the code exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=424045#respond" onclick='return addComment.moveForm( "comment-424045", "424045", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425040">
<div class="comment-container" id="li-comment-425040">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/403d01f0a05d0456c0c4e6fce3beb4d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/403d01f0a05d0456c0c4e6fce3beb4d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://thezphyr.com" rel="external nofollow">Satyajit Pattnaik</a></span>
<span class="date">December 28, 2017 at 5:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425040" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>In the prediction area, where you have added the observation to history and then running the loop to find the ARIMA results.<br/>
i.e. </p>
<p>model = ARIMA(history, order=(4,1,2))<br/>
	model_fit = model.fit(disp=0)<br/>
	output = model_fit.forecast()<br/>
	yhat = output[0]<br/>
	predictions.append(yhat)<br/>
	obs = test[t]<br/>
	history.append(obs)</p>
<p>Here, what if we append yhat to history, when i am appending yhat to history, my results are really bad, pls help..</p>
<p>Because as per my model, we need to predict the test data by using only the training data, so we cannot use obs to be appended in history, hope you get my point.</p>
<div class="reply">
<a aria-label="Reply to Satyajit Pattnaik" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425040#respond" onclick='return addComment.moveForm( "comment-425040", "425040", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425071">
<div class="comment-container" id="li-comment-425071">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 29, 2017 at 5:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425071" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, that would be called a recursive multi-step forecast. It is challenging. You can learn a little more about it here:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425071#respond" onclick='return addComment.moveForm( "comment-425071", "425071", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-425132">
<div class="comment-container" id="li-comment-425132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/403d01f0a05d0456c0c4e6fce3beb4d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/403d01f0a05d0456c0c4e6fce3beb4d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://thezphyr.com" rel="external nofollow">Satyajit Pattnaik</a></span>
<span class="date">December 29, 2017 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Concept wise i understand what is Recursive Multi step forecasting, that’s the same i have used in my earlier reply code, i have appended obs in history, so that means everytime my loop runs, it takes the existing training data + next observation, so that should work and should predict correctly, but my results are really bad..</p>
<p>Or do you mean to say, for this we need to plot the ACF, PACF graph in a a loop to determine the pdq values, and then run the ARIMA function on the pdq values, if that so, pls help us in finding a way to determine pdq values in loop</p>
<div class="reply">
<a aria-label="Reply to Satyajit Pattnaik" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425132#respond" onclick='return addComment.moveForm( "comment-425132", "425132", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-425156">
<div class="comment-container" id="li-comment-425156">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 30, 2017 at 5:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425156" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally using forecasts in a recursive model is challenging, you may need to get creative with your model/models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425156#respond" onclick='return addComment.moveForm( "comment-425156", "425156", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425888">
<div class="comment-container" id="li-comment-425888">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Udi</span>
<span class="date">January 8, 2018 at 8:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425888" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thank you for your clear and straightforward post!<br/>
I have the same question as Nick above – about the choice of differentiation interval.<br/>
In your example you set it to 12 according to the expected cycle of the data.<br/>
However, in a more problematic case the data does not seem to imply a clear cycle (ACF and PACF graphs notwithstanding).<br/>
In my case, I’ve found out that setting the interval  to 12 yielded better results than my default, which was 1. I can understand why choosing a small interval would be generally bad – random noise is too dominant. I have more difficulty understanding how to calibrate the ideal interval value for my data (except brute force, that is. Maybe I shouldn’t calibrate? That could induce overfit. Anyway, I still should find a generally decent value).</p>
<div class="reply">
<a aria-label="Reply to Udi" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425888#respond" onclick='return addComment.moveForm( "comment-425888", "425888", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425915">
<div class="comment-container" id="li-comment-425915">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425915" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the amount of data is relatively small, consider using a grid search across difference values to see what works.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425915#respond" onclick='return addComment.moveForm( "comment-425915", "425915", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425889">
<div class="comment-container" id="li-comment-425889">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Udi</span>
<span class="date">January 8, 2018 at 9:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425889" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>And another question. I applied a grid search in order to choose the hyperparameters of my ARIMA model. I fear that bias correction could be counter productive in this case.  </p>
<p>Do you have any insights on this subject? Would you perform both (grid search followed by bias correction)? Is the answer data dependent?</p>
<div class="reply">
<a aria-label="Reply to Udi" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425889#respond" onclick='return addComment.moveForm( "comment-425889", "425889", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425916">
<div class="comment-container" id="li-comment-425916">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/#comment-425916" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would only perform bias correction if it lifted model skill (e.g. if the model was biased).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/time-series-forecast-study-python-monthly-sales-french-champagne/?replytocom=425916#respond" onclick='return addComment.moveForm( "comment-425916", "425916", "respond", "3725" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/time-series-forecast-study-python-monthly-sales-french-champagne/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3725"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="5f008a2282"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="92"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-27"> <div class="textwidget"><p></p><center>
<h3>Get Good at Time Series Forecasting</h3>
<p>Need visualizations and forecast models?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Get Started with Time Series Forecasting in Python!</a></p>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>