<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Use Word Embedding Layers for Deep Learning with Keras - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Use Word Embedding Layers for Deep Learning with Keras - Machine Learning Mastery" property="og:title"/>
<meta content="Word embeddings provide a dense representation of words and their relative meanings. They are an improvement over sparse representations used in simpler bag of word model representations. Word embeddings can be learned from text data and reused among projects. They can also be learned as part of fitting a neural network on text data. In this …" property="og:description"/>
<meta content="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Natural Language Processing" property="article:section"/>
<meta content="2017-10-04T05:00:43+11:00" property="article:published_time"/>
<meta content="2017-11-21T11:02:05+11:00" property="article:modified_time"/>
<meta content="2017-11-21T11:02:05+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/use-word-embedding-layers-deep-learning-keras\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/feed/" rel="alternate" title="Machine Learning Mastery » How to Use Word Embedding Layers for Deep Learning with Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4346" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4346 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-44"> <div class="textwidget"><p>Need help with Deep Learning for Text? <a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4346 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
<header>
<h1 class="title entry-title">How to Use Word Embedding Layers for Deep Learning with Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-04T05:00:43+1100">October 4, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Natural Language Processing">Natural Language Processing</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/&amp;summary=Word+embeddings+provide+a+dense+representation+of+words+and+their+relative+meanings.%0D%0A%0D%0AThey+are+an%C2..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/&amp;summary=Word+embeddings+provide+a+dense+representation+of+words+and+their+relative+meanings.%0D%0A%0D%0AThey+are+an%C2...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Word embeddings provide a dense representation of words and their relative meanings.</p>
<p>They are an improvement over sparse representations used in simpler bag of word model representations.</p>
<p>Word embeddings can be learned from text data and reused among projects. They can also be learned as part of fitting a neural network on text data.</p>
<p>In this tutorial, you will discover how to use word embeddings for deep learning in Python with Keras.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>About word embeddings and that Keras supports word embeddings via the Embedding layer.</li>
<li>How to learn a word embedding while fitting a neural network.</li>
<li>How to use a pre-trained word embedding in a neural network.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_4347" style="max-width: 650px"><img alt="How to Use Word Embedding Layers for Deep Learning with Keras" class="size-full wp-image-4347" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Use Word Embedding Layers for Deep Learning with Keras<br/>Photo by <a href="https://www.flickr.com/photos/davebloggs007/36375879215/">thisguy</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 3 parts; they are:</p>
<ol>
<li>Word Embedding</li>
<li>Keras Embedding Layer</li>
<li>Example of Learning an Embedding</li>
<li>Example of Using Pre-Trained GloVe Embedding</li>
</ol>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Text Data?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Crash-Course Now</a><script data-config="%7B%7D" data-leadbox="144855173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" src="https://machinelearningmastery.lpages.co/leadbox-1509466860.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>1. Word Embedding</h2>
<p>A word embedding is a class of approaches for representing words and documents using a dense vector representation.</p>
<p>It is an improvement over more the traditional bag-of-word model encoding schemes where large sparse vectors were used to represent each word or to score each word within a vector to represent an entire vocabulary. These representations were sparse because the vocabularies were vast and a given word or document would be represented by a large vector comprised mostly of zero values.</p>
<p>Instead, in an embedding, words are represented by dense vectors where a vector represents the projection of the word into a continuous vector space.</p>
<p>The position of a word within the vector space is learned from text and is based on the words that surround the word when it is used.</p>
<p>The position of a word in the learned vector space is referred to as its embedding.</p>
<p>Two popular examples of methods of learning word embeddings from text include:</p>
<ul>
<li>Word2Vec.</li>
<li>GloVe.</li>
</ul>
<p>In addition to these carefully designed methods, a word embedding can be learned as part of a deep learning model. This can be a slower approach, but tailors the model to a specific training dataset.</p>
<h2>2. Keras Embedding Layer</h2>
<p>Keras offers an <a href="https://keras.io/layers/embeddings/#embedding">Embedding</a> layer that can be used for neural networks on text data.</p>
<p>It requires that the input data be integer encoded, so that each word is represented by a unique integer. This data preparation step can be performed using the <a href="# https://keras.io/preprocessing/text/#tokenizer">Tokenizer API</a> also provided with Keras.</p>
<p>The Embedding layer is initialized with random weights and will learn an embedding for all of the words in the training dataset.</p>
<p>It is a flexible layer that can be used in a variety of ways, such as:</p>
<ul>
<li>It can be used alone to learn a word embedding that can be saved and used in another model later.</li>
<li>It can be used as part of a deep learning model where the embedding is learned along with the model itself.</li>
<li>It can be used to load a pre-trained word embedding model, a type of transfer learning.</li>
</ul>
<p>The Embedding layer is defined as the first hidden layer of a network. It must specify 3 arguments:</p>
<p>It must specify 3 arguments:</p>
<ul>
<li><strong>input_dim</strong>: This is the size of the vocabulary in the text data. For example, if your data is integer encoded to values between 0-10, then the size of the vocabulary would be 11 words.</li>
<li><strong>output_dim</strong>: This is the size of the vector space in which words will be embedded. It defines the size of the output vectors from this layer for each word. For example, it could be 32 or 100 or even larger. Test different values for your problem.</li>
<li><strong>input_length</strong>: This is the length of input sequences, as you would define for any input layer of a Keras model. For example, if all of your input documents are comprised of 1000 words, this would be 1000.</li>
</ul>
<p>For example, below we define an Embedding layer with a vocabulary of 200 (e.g. integer encoded words from 0 to 199, inclusive), a vector space of 32 dimensions in which words will be embedded, and input documents that have 50 words each.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1be8343666918" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
e = Embedding(200, 32, input_length=50)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1be8343666918-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1be8343666918-1"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>The Embedding layer has weights that are learned. If you save your model to file, this will include weights for the Embedding layer.</p>
<p>The output of the <em>Embedding</em> layer is a 2D vector with one embedding for each word in the input sequence of words (input document).</p>
<p>If you wish to connect a <em>Dense</em> layer directly to an Embedding layer, you must first flatten the 2D output matrix to a 1D vector using the <em>Flatten</em> layer.</p>
<p>Now, let’s see how we can use an Embedding layer in practice.</p>
<h2>3. Example of Learning an Embedding</h2>
<p>In this section, we will look at how we can learn a word embedding while fitting a neural network on a text classification problem.</p>
<p>We will define a small problem where we have 10 text documents, each with a comment about a piece of work a student submitted. Each text document is classified as positive “1” or negative “0”. This is a simple sentiment analysis problem.</p>
<p>First, we will define the documents and their class labels.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1bf4020893702" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = [1,1,1,1,1,0,0,0,0,0]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf4020893702-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1bf4020893702-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-1"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-2"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-3"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-4"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-5"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-6"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-7"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-8"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-9"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-10"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-11"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf4020893702-12"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5a65913bd1bf4020893702-13"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Next, we can integer encode each document. This means that as input the Embedding layer will have sequences of integers. We could experiment with other more sophisticated bag of word model encoding like counts or TF-IDF.</p>
<p>Keras provides the <a href="https://keras.io/preprocessing/text/#one_hot">one_hot() function</a> that creates a hash of each word as an efficient integer encoding. We will estimate the vocabulary size of 50, which is much larger than needed to reduce the probability of collisions from the hash function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1bf8118910521" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# integer encode the documents
vocab_size = 50
encoded_docs = [one_hot(d, vocab_size) for d in docs]
print(encoded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1bf8118910521-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf8118910521-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1bf8118910521-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bf8118910521-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1bf8118910521-1"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf8118910521-2"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="crayon-5a65913bd1bf8118910521-3"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">one_hot</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">docs</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bf8118910521-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>The sequences have different lengths and Keras prefers inputs to be vectorized and all inputs to have the same length. We will pad all input sequences to have the length of 4. Again, we can do this with a built in Keras function, in this case the <a href="https://keras.io/preprocessing/sequence/#pad_sequences">pad_sequences() function</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1bfb473140872" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1bfb473140872-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfb473140872-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1bfb473140872-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfb473140872-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1bfb473140872-1"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfb473140872-2"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a65913bd1bfb473140872-3"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfb473140872-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We are now ready to define our <em>Embedding</em> layer as part of our neural network model.</p>
<p>The <em>Embedding</em> has a vocabulary of 50 and an input length of 4. We will choose a small embedding space of 8 dimensions.</p>
<p>The model is a simple binary classification model. Importantly, the output from the <em>Embedding</em> layer will be 4 vectors of 8 dimensions each, one for each word. We flatten this to a one 32-element vector to pass on to the <em>Dense</em> output layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1bfe202114343" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define the model
model = Sequential()
model.add(Embedding(vocab_size, 8, input_length=max_length))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1bfe202114343-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfe202114343-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1bfe202114343-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfe202114343-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1bfe202114343-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfe202114343-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1bfe202114343-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1bfe202114343-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1bfe202114343-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1bfe202114343-1"><span class="crayon-p"># define the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfe202114343-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1bfe202114343-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfe202114343-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1bfe202114343-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfe202114343-6"><span class="crayon-p"># compile the model</span></div><div class="crayon-line" id="crayon-5a65913bd1bfe202114343-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1bfe202114343-8"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line" id="crayon-5a65913bd1bfe202114343-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Finally, we can fit and evaluate the classification model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c00601547349" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c00601547349-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c00601547349-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c00601547349-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c00601547349-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c00601547349-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c00601547349-1"><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c00601547349-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c00601547349-3"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c00601547349-4"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c00601547349-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>The complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c03541173178" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.preprocessing.text import one_hot
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.embeddings import Embedding
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = [1,1,1,1,1,0,0,0,0,0]
# integer encode the documents
vocab_size = 50
encoded_docs = [one_hot(d, vocab_size) for d in docs]
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)
# define the model
model = Sequential()
model.add(Embedding(vocab_size, 8, input_length=max_length))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-14">14</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-16">16</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-18">18</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-20">20</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-22">22</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-24">24</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-26">26</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-28">28</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-30">30</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-32">32</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-34">34</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-36">36</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-38">38</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c03541173178-40">40</div><div class="crayon-num" data-line="crayon-5a65913bd1c03541173178-41">41</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c03541173178-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">one_hot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-v">Embedding</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-7"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-8"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-9"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-10"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-11"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-12"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-13"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-14"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-15"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-16"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-17"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-18"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-19"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-20"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-21"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-22"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">one_hot</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">docs</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-24"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-25"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-26"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-28"><span class="crayon-p"># define the model</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-29"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-30"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-31"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-32"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-33"><span class="crayon-p"># compile the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-35"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-36"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-37"><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-39"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c03541173178-40"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c03541173178-41"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>Running the example first prints the integer encoded documents.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c06164323471" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[6, 16], [42, 24], [2, 17], [42, 24], [18], [17], [22, 17], [27, 42], [22, 24], [49, 46, 16, 34]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c06164323471-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c06164323471-1">[[6, 16], [42, 24], [2, 17], [42, 24], [18], [17], [22, 17], [27, 42], [22, 24], [49, 46, 16, 34]]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Then the padded versions of each document are printed, making them all uniform length.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c09470364885" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[ 6 16  0  0]
 [42 24  0  0]
 [ 2 17  0  0]
 [42 24  0  0]
 [18  0  0  0]
 [17  0  0  0]
 [22 17  0  0]
 [27 42  0  0]
 [22 24  0  0]
 [49 46 16 34]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c09470364885-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c09470364885-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c09470364885-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c09470364885-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c09470364885-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c09470364885-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c09470364885-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c09470364885-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c09470364885-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c09470364885-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c09470364885-1">[[ 6 16  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c09470364885-2"> [42 24  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c09470364885-3"> [ 2 17  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c09470364885-4"> [42 24  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c09470364885-5"> [18  0  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c09470364885-6"> [17  0  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c09470364885-7"> [22 17  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c09470364885-8"> [27 42  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c09470364885-9"> [22 24  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c09470364885-10"> [49 46 16 34]]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>After the network is defined, a summary of the layers is printed. We can see that as expected, the output of the Embedding layer is a 4×8 matrix and this is squashed to a 32-element vector by the Flatten layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c0b711156444" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 4, 8)              400
_________________________________________________________________
flatten_1 (Flatten)          (None, 32)                0
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 33
=================================================================
Total params: 433
Trainable params: 433
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c0b711156444-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1c0b711156444-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-4">embedding_1 (Embedding)      (None, 4, 8)              400</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-6">flatten_1 (Flatten)          (None, 32)                0</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-8">dense_1 (Dense)              (None, 1)                 33</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-9">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-10">Total params: 433</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-11">Trainable params: 433</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c0b711156444-12">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5a65913bd1c0b711156444-13">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Finally, the accuracy of the trained model is printed, showing that it learned the training dataset perfectly (which is not surprising).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c0e727290978" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Accuracy: 100.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c0e727290978-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c0e727290978-1">Accuracy: 100.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You could save the learned weights from the Embedding layer to file for later use in other models.</p>
<p>You could also use this model generally to classify other documents that have the same kind vocabulary seen in the test dataset.</p>
<p>Next, let’s look at loading a pre-trained word embedding in Keras.</p>
<h2>4. Example of Using Pre-Trained GloVe Embedding</h2>
<p>The Keras Embedding layer can also use a word embedding learned elsewhere.</p>
<p>It is common in the field of Natural Language Processing to learn, save, and make freely available word embeddings.</p>
<p>For example, the researchers behind GloVe method provide a suite of pre-trained word embeddings on their website released under a public domain license. See:</p>
<ul>
<li><a href="https://nlp.stanford.edu/projects/glove/">GloVe: Global Vectors for Word Representation</a></li>
</ul>
<p>The smallest package of embeddings is 822Mb, called “<em>glove.6B.zip</em>“. It was trained on a dataset of one billion tokens (words) with a vocabulary of 400 thousand words. There are a few different embedding vector sizes, including 50, 100, 200 and 300 dimensions.</p>
<p>You can download this collection of embeddings and we can seed the Keras <em>Embedding</em> layer with weights from the pre-trained embedding for the words in your training dataset.</p>
<p>This example is inspired by an example in the Keras project: <a href="https://github.com/fchollet/keras/blob/master/examples/pretrained_word_embeddings.py">pretrained_word_embeddings.py</a>.</p>
<p>After downloading and unzipping, you will see a few files, one of which is “<em>glove.6B.100d.txt</em>“, which contains a 100-dimensional version of the embedding.</p>
<p>If you peek inside the file, you will see a token (word) followed by the weights (100 numbers) on each line. For example, below are the first line of the embedding ASCII text file showing the embedding for “<em>the</em>“.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c11566826930" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
the -0.038194 -0.24487 0.72812 -0.39961 0.083172 0.043953 -0.39141 0.3344 -0.57545 0.087459 0.28787 -0.06731 0.30906 -0.26384 -0.13231 -0.20757 0.33395 -0.33848 -0.31743 -0.48336 0.1464 -0.37304 0.34577 0.052041 0.44946 -0.46971 0.02628 -0.54155 -0.15518 -0.14107 -0.039722 0.28277 0.14393 0.23464 -0.31021 0.086173 0.20397 0.52624 0.17164 -0.082378 -0.71787 -0.41531 0.20335 -0.12763 0.41367 0.55187 0.57908 -0.33477 -0.36559 -0.54857 -0.062892 0.26584 0.30205 0.99775 -0.80481 -3.0243 0.01254 -0.36942 2.2167 0.72201 -0.24978 0.92136 0.034514 0.46745 1.1079 -0.19358 -0.074575 0.23353 -0.052062 -0.22044 0.057162 -0.15806 -0.30798 -0.41625 0.37972 0.15006 -0.53212 -0.2055 -1.2526 0.071624 0.70565 0.49744 -0.42063 0.26148 -1.538 -0.30223 -0.073438 -0.28312 0.37104 -0.25217 0.016215 -0.017099 -0.38984 0.87424 -0.72569 -0.51058 -0.52028 -0.1459 0.8278 0.27062</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c11566826930-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c11566826930-1">the -0.038194 -0.24487 0.72812 -0.39961 0.083172 0.043953 -0.39141 0.3344 -0.57545 0.087459 0.28787 -0.06731 0.30906 -0.26384 -0.13231 -0.20757 0.33395 -0.33848 -0.31743 -0.48336 0.1464 -0.37304 0.34577 0.052041 0.44946 -0.46971 0.02628 -0.54155 -0.15518 -0.14107 -0.039722 0.28277 0.14393 0.23464 -0.31021 0.086173 0.20397 0.52624 0.17164 -0.082378 -0.71787 -0.41531 0.20335 -0.12763 0.41367 0.55187 0.57908 -0.33477 -0.36559 -0.54857 -0.062892 0.26584 0.30205 0.99775 -0.80481 -3.0243 0.01254 -0.36942 2.2167 0.72201 -0.24978 0.92136 0.034514 0.46745 1.1079 -0.19358 -0.074575 0.23353 -0.052062 -0.22044 0.057162 -0.15806 -0.30798 -0.41625 0.37972 0.15006 -0.53212 -0.2055 -1.2526 0.071624 0.70565 0.49744 -0.42063 0.26148 -1.538 -0.30223 -0.073438 -0.28312 0.37104 -0.25217 0.016215 -0.017099 -0.38984 0.87424 -0.72569 -0.51058 -0.52028 -0.1459 0.8278 0.27062</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>As in the previous section, the first step is to define the examples, encode them as integers, then pad the sequences to be the same length.</p>
<p>In this case, we need to be able to map words to integers as well as integers to words.</p>
<p>Keras provides a <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer</a> class that can be fit on the training data, can convert text to sequences consistently by calling the <em>texts_to_sequences()</em> method on the <em>Tokenizer</em> class, and provides access to the dictionary mapping of words to integers in a <em>word_index</em> attribute.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c14396393142" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = [1,1,1,1,1,0,0,0,0,0]
# prepare tokenizer
t = Tokenizer()
t.fit_on_texts(docs)
vocab_size = len(t.word_index) + 1
# integer encode the documents
encoded_docs = t.texts_to_sequences(docs)
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-14">14</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-16">16</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-18">18</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-20">20</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-22">22</div><div class="crayon-num" data-line="crayon-5a65913bd1c14396393142-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c14396393142-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c14396393142-1"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-2"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-3"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-4"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-5"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-6"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-7"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-8"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-9"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-10"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-11"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-12"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-13"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-14"><span class="crayon-p"># prepare tokenizer</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-15"><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-16"><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-17"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-18"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-19"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-21"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-22"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a65913bd1c14396393142-23"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c14396393142-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Next, we need to load the entire GloVe word embedding file into memory as a dictionary of word to embedding array.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c17706975606" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the whole embedding into memory
embeddings_index = dict()
f = open('glove.6B.100d.txt')
for line in f:
	values = line.split()
	word = values[0]
	coefs = asarray(values[1:], dtype='float32')
	embeddings_index[word] = coefs
f.close()
print('Loaded %s word vectors.' % len(embeddings_index))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c17706975606-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c17706975606-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c17706975606-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c17706975606-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c17706975606-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c17706975606-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c17706975606-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c17706975606-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c17706975606-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c17706975606-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c17706975606-1"><span class="crayon-p"># load the whole embedding into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c17706975606-2"><span class="crayon-v">embeddings_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c17706975606-3"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c17706975606-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65913bd1c17706975606-5"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c17706975606-6"><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65913bd1c17706975606-7"><span class="crayon-h"> </span><span class="crayon-v">coefs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c17706975606-8"><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">coefs</span></div><div class="crayon-line" id="crayon-5a65913bd1c17706975606-9"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c17706975606-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded %s word vectors.'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>This is pretty slow. It might be better to filter the embedding for the unique words in your training data.</p>
<p>Next, we need to create a matrix of one embedding for each word in the training dataset. We can do that by enumerating all unique words in the <em>Tokenizer.word_index</em> and locating the embedding weight vector from the loaded GloVe embedding.</p>
<p>The result is a matrix of weights only for words we will see during training.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c1a223327473" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a weight matrix for words in training docs
embedding_matrix = zeros((vocab_size, 100))
for word, i in t.word_index.items():
	embedding_vector = embeddings_index.get(word)
	if embedding_vector is not None:
		embedding_matrix[i] = embedding_vector</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c1a223327473-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1a223327473-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c1a223327473-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1a223327473-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c1a223327473-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1a223327473-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c1a223327473-1"><span class="crayon-p"># create a weight matrix for words in training docs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1a223327473-2"><span class="crayon-v">embedding_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1a223327473-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1a223327473-4"><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1a223327473-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">embedding_vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1a223327473-6"><span class="crayon-h"> </span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Now we can define our model, fit, and evaluate it as before.</p>
<p>The key difference is that the embedding layer can be seeded with the GloVe word embedding weights. We chose the 100-dimensional version, therefore the Embedding layer must be defined with <em>output_dim</em> set to 100. Finally, we do not want to update the learned word weights in this model, therefore we will set the <em>trainable</em> attribute for the model to be <em>False</em>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c1c140961783" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
e = Embedding(vocab_size, 100, weights=[embedding_matrix], input_length=4, trainable=False)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c1c140961783-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c1c140961783-1"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The complete worked example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c1f273521641" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import asarray
from numpy import zeros
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import Embedding
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = [1,1,1,1,1,0,0,0,0,0]
# prepare tokenizer
t = Tokenizer()
t.fit_on_texts(docs)
vocab_size = len(t.word_index) + 1
# integer encode the documents
encoded_docs = t.texts_to_sequences(docs)
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)
# load the whole embedding into memory
embeddings_index = dict()
f = open('../glove_data/glove.6B/glove.6B.100d.txt')
for line in f:
	values = line.split()
	word = values[0]
	coefs = asarray(values[1:], dtype='float32')
	embeddings_index[word] = coefs
f.close()
print('Loaded %s word vectors.' % len(embeddings_index))
# create a weight matrix for words in training docs
embedding_matrix = zeros((vocab_size, 100))
for word, i in t.word_index.items():
	embedding_vector = embeddings_index.get(word)
	if embedding_vector is not None:
		embedding_matrix[i] = embedding_vector
# define model
model = Sequential()
e = Embedding(vocab_size, 100, weights=[embedding_matrix], input_length=4, trainable=False)
model.add(e)
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-14">14</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-16">16</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-18">18</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-20">20</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-22">22</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-24">24</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-26">26</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-28">28</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-30">30</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-32">32</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-34">34</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-36">36</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-38">38</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-40">40</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-42">42</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-44">44</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-46">46</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-48">48</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-50">50</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-52">52</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-54">54</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-56">56</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-58">58</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-60">60</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c1f273521641-62">62</div><div class="crayon-num" data-line="crayon-5a65913bd1c1f273521641-63">63</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Embedding</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-9"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-10"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-11"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-12"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-13"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-14"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-15"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-16"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-17"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-18"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-19"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-20"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-21"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-22"><span class="crayon-p"># prepare tokenizer</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-23"><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-24"><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-25"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-26"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-27"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-29"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-30"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-31"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-33"><span class="crayon-p"># load the whole embedding into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-34"><span class="crayon-v">embeddings_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-35"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'../glove_data/glove.6B/glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-37"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-38"><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-39"><span class="crayon-h"> </span><span class="crayon-v">coefs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-40"><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">coefs</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-41"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-42"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded %s word vectors.'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-43"><span class="crayon-p"># create a weight matrix for words in training docs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-44"><span class="crayon-v">embedding_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-45"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-46"><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-47"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">embedding_vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-48"><span class="crayon-h"> </span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-49"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-50"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-51"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-52"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-53"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-54"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-55"><span class="crayon-p"># compile the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-56"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-57"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-58"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-59"><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-60"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-61"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c1f273521641-62"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65913bd1c1f273521641-63"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0044 seconds] -->
<p>Running the example may take a bit longer, but then demonstrates that it is just as capable of fitting this simple problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65913bd1c22702265865" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[6, 2], [3, 1], [7, 4], [8, 1], [9], [10], [5, 4], [11, 3], [5, 1], [12, 13, 2, 14]]

[[ 6  2  0  0]
 [ 3  1  0  0]
 [ 7  4  0  0]
 [ 8  1  0  0]
 [ 9  0  0  0]
 [10  0  0  0]
 [ 5  4  0  0]
 [11  3  0  0]
 [ 5  1  0  0]
 [12 13  2 14]]

Loaded 400000 word vectors.

_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 4, 100)            1500
_________________________________________________________________
flatten_1 (Flatten)          (None, 400)               0
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 401
=================================================================
Total params: 1,901
Trainable params: 401
Non-trainable params: 1,500
_________________________________________________________________


Accuracy: 100.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-2">2</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-4">4</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-6">6</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-8">8</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-10">10</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-12">12</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-14">14</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-16">16</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-18">18</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-20">20</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-22">22</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-24">24</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-26">26</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-28">28</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65913bd1c22702265865-30">30</div><div class="crayon-num" data-line="crayon-5a65913bd1c22702265865-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65913bd1c22702265865-1">[[6, 2], [3, 1], [7, 4], [8, 1], [9], [10], [5, 4], [11, 3], [5, 1], [12, 13, 2, 14]]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-2"> </div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-3">[[ 6  2  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-4"> [ 3  1  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-5"> [ 7  4  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-6"> [ 8  1  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-7"> [ 9  0  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-8"> [10  0  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-9"> [ 5  4  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-10"> [11  3  0  0]</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-11"> [ 5  1  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-12"> [12 13  2 14]]</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-14">Loaded 400000 word vectors.</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-16">_________________________________________________________________</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-17">Layer (type)                 Output Shape              Param #</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-18">=================================================================</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-19">embedding_1 (Embedding)      (None, 4, 100)            1500</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-20">_________________________________________________________________</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-21">flatten_1 (Flatten)          (None, 400)               0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-22">_________________________________________________________________</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-23">dense_1 (Dense)              (None, 1)                 401</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-24">=================================================================</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-25">Total params: 1,901</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-26">Trainable params: 401</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-27">Non-trainable params: 1,500</div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-28">_________________________________________________________________</div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65913bd1c22702265865-30"> </div><div class="crayon-line" id="crayon-5a65913bd1c22702265865-31">Accuracy: 100.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>In practice, I would encourage you to experiment with learning a word embedding using a pre-trained embedding that is fixed and trying to perform learning on top of a pre-trained embedding.</p>
<p>See what works best for your specific problem.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Word_embedding">Word Embedding on Wikipedia</a></li>
<li><a href="https://keras.io/layers/embeddings/#embedding">Keras Embedding Layer API</a></li>
<li><a href="https://blog.keras.io/using-pre-trained-word-embeddings-in-a-keras-model.html">Using pre-trained word embeddings in a Keras model</a>, 2016</li>
<li><a href="https://github.com/fchollet/keras/blob/master/examples/pretrained_word_embeddings.py">Example of using a pre-trained GloVe Embedding in Keras</a></li>
<li><a href="https://nlp.stanford.edu/projects/glove/">GloVe Embedding</a></li>
<li><a href="http://blog.aylien.com/overview-word-embeddings-history-word2vec-cbow-glove/">An overview of word embeddings and their connection to distributional semantic models</a>, 2016</li>
<li><a href="http://colah.github.io/posts/2014-07-NLP-RNNs-Representations/">Deep Learning, NLP, and Representations</a>, 2014</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to use word embeddings for deep learning in Python with Keras.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About word embeddings and that Keras supports word embeddings via the Embedding layer.</li>
<li>How to learn a word embedding while fitting a neural network.</li>
<li>How to use a pre-trained word embedding in a neural network.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-42"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<p><a href="/deep-learning-for-nlp/"><img align="left" alt="Deep Learning for Natural Language Processing" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Text models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-nlp/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/&amp;summary=Word+embeddings+provide+a+dense+representation+of+words+and+their+relative+meanings.%0D%0A%0D%0AThey+are+an%C2..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20Word%20Embedding%20Layers%20for%20Deep%20Learning%20with%20Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/&amp;summary=Word+embeddings+provide+a+dense+representation+of+words+and+their+relative+meanings.%0D%0A%0D%0AThey+are+an%C2...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Prepare Text Data for Deep Learning with Keras</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/develop-word-embeddings-python-gensim/" rel="next">How to Develop Word Embeddings in Python with Gensim <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">79 Responses to <em>How to Use Word Embedding Layers for Deep Learning with Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-415535">
<div class="comment-container" id="li-comment-415535">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammad</span>
<span class="date">October 4, 2017 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415535" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason,<br/>
I am excited to read more NLP posts.</p>
<div class="reply">
<a aria-label="Reply to Mohammad" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415535#respond" onclick='return addComment.moveForm( "comment-415535", "415535", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415537">
<div class="comment-container" id="li-comment-415537">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415537" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415537#respond" onclick='return addComment.moveForm( "comment-415537", "415537", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415679">
<div class="comment-container" id="li-comment-415679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a624f04322a55dfb78ad84152fa3a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a624f04322a55dfb78ad84152fa3a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shiv</span>
<span class="date">October 5, 2017 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I split my data into 80-20 test-train and I’m still getting 100% accuracy. Any idea why? It is ~99% on epoch 1 and the rest its 100%.</p>
<div class="reply">
<a aria-label="Reply to shiv" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415679#respond" onclick='return addComment.moveForm( "comment-415679", "415679", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415715">
<div class="comment-container" id="li-comment-415715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider using the procedure in this post to evaluate your model:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415715#respond" onclick='return addComment.moveForm( "comment-415715", "415715", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-415819">
<div class="comment-container" id="li-comment-415819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trulia</span>
<span class="date">October 6, 2017 at 12:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use drop-out 20%, your model is overfit!!</p>
<div class="reply">
<a aria-label="Reply to trulia" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415819#respond" onclick='return addComment.moveForm( "comment-415819", "415819", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415825">
<div class="comment-container" id="li-comment-415825">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 6, 2017 at 2:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415825" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason. I always find things easier when reading your post.<br/>
I have a question about the vector of each word after training. For example, the word “done” in sentence “Well done!” will be represented in different vector from that word in sentence “Could have done better!”. Is that right? I mean the presentation of each word will depend on the context of each sentence?</p>
<div class="reply">
<a aria-label="Reply to Sandy" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415825#respond" onclick='return addComment.moveForm( "comment-415825", "415825", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415881">
<div class="comment-container" id="li-comment-415881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, each word in the dictionary is represented differently, but the same word in different contexts will have the same representation.</p>
<p>It is the word in its different contexts that is used to define the representation of the word.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415881#respond" onclick='return addComment.moveForm( "comment-415881", "415881", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-415935">
<div class="comment-container" id="li-comment-415935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 7, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, thank you. But I still have a question. We will train each context separately, then after training the first context, in this case is “Well done!”, we will have a vector representation of the word “done”. After training the second context, “Could have done better”, we have another vector representation of the word “done”. So, which vector will we choose to be the representation of the word “done”?<br/>
I might misunderstand the procedure of training. Thank you for clarifying it for me.</p>
<div class="reply">
<a aria-label="Reply to Sandy" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415935#respond" onclick='return addComment.moveForm( "comment-415935", "415935", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-415971">
<div class="comment-container" id="li-comment-415971">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415971" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. All examples where a word is used are used as part of the training of the representation of the word. There is only one representation for each word during and after training.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415971#respond" onclick='return addComment.moveForm( "comment-415971", "415971", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-416009">
<div class="comment-container" id="li-comment-416009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 8, 2017 at 2:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got it. Thank you, Jason.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415934">
<div class="comment-container" id="li-comment-415934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2ee8e847f73af202b1d1880edffc276?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2ee8e847f73af202b1d1880edffc276?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiedu</span>
<span class="date">October 7, 2017 at 5:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
any ideas on how to “filter the embedding for the unique words in your training data” as mentioned in the tutorial?</p>
<div class="reply">
<a aria-label="Reply to Chiedu" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415934#respond" onclick='return addComment.moveForm( "comment-415934", "415934", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415970">
<div class="comment-container" id="li-comment-415970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The mapping of word to vector dictionary is built into Gensim, you can access it directly to retrieve the representations for the words you want: model.wv.vocab</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415970#respond" onclick='return addComment.moveForm( "comment-415970", "415970", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415952">
<div class="comment-container" id="li-comment-415952">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abbey</span>
<span class="date">October 8, 2017 at 2:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415952" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>Good day.</p>
<p>I just need your suggestion and example. I have two different dataset, where one is structured and the other is unstructured.  The goal is to use the structured to construct a representation for the unstructured, so apply use word embedding on the two input data but how can I find the average of the two embedding and flatten it to one before feeding the layer into CNN and LSTM.</p>
<p>Looking forward to your response.<br/>
Regards<br/>
Abbey</p>
<div class="reply">
<a aria-label="Reply to Abbey" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415952#respond" onclick='return addComment.moveForm( "comment-415952", "415952", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415975">
<div class="comment-container" id="li-comment-415975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, what was your question?</p>
<p>If your question was if this is a good approach, my advice is to try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=415975#respond" onclick='return addComment.moveForm( "comment-415975", "415975", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-416110">
<div class="comment-container" id="li-comment-416110">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abiodun Modupe</span>
<span class="date">October 9, 2017 at 7:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416110" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
How can I find the average of the word embedding from the two input?<br/>
Regards<br/>
Abbey</p>
<div class="reply">
<a aria-label="Reply to Abiodun Modupe" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416110#respond" onclick='return addComment.moveForm( "comment-416110", "416110", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-416174">
<div class="comment-container" id="li-comment-416174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you could retrieve the vectors for each word and take their average?</p>
<p>Perhaps you can use the Gensim API to achieve this result?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416174#respond" onclick='return addComment.moveForm( "comment-416174", "416174", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416104">
<div class="comment-container" id="li-comment-416104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d0950d83c9034d59e31b486bdcaf443a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d0950d83c9034d59e31b486bdcaf443a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinu</span>
<span class="date">October 9, 2017 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason…Could you also help us with R codes for using Pre-Trained GloVe Embedding</p>
<div class="reply">
<a aria-label="Reply to Vinu" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416104#respond" onclick='return addComment.moveForm( "comment-416104", "416104", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416173">
<div class="comment-container" id="li-comment-416173">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416173" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have R code for word embeddings.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416173#respond" onclick='return addComment.moveForm( "comment-416173", "416173", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416423">
<div class="comment-container" id="li-comment-416423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e08f731cef24b3e368ac1325e46f655?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e08f731cef24b3e368ac1325e46f655?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hao</span>
<span class="date">October 12, 2017 at 5:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, really appreciate that you answered all the replies! I am planning to try both CNN and RNN (maybe LSTM &amp; GRU) on text classification. Most of my documents are less than 100 words long, but about 5 % are longer than 500 words. How do you suggest to set the max length when using RNN?If I set it to be 1000, will it degrade the learning result? Should I just use 100? Will it be different in the case of CNN?<br/>
Thank you!</p>
<div class="reply">
<a aria-label="Reply to Hao" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416423#respond" onclick='return addComment.moveForm( "comment-416423", "416423", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416480">
<div class="comment-container" id="li-comment-416480">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416480" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend experimenting with different configurations and see how the impact model skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416480#respond" onclick='return addComment.moveForm( "comment-416480", "416480", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416516">
<div class="comment-container" id="li-comment-416516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/09626c924d61713b6422f4ccb87286e2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/09626c924d61713b6422f4ccb87286e2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">October 13, 2017 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’d like to thank you for this post. I’ve been struggling to understand this precise way of using keras for a week now and this is the only post I’ve found that actually explains what each step in the process is doing – and provides code that self-documents what the data looks like as the model is constructed and trained. This makes it so much easier to adapt to my particular requirements.</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416516#respond" onclick='return addComment.moveForm( "comment-416516", "416516", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416531">
<div class="comment-container" id="li-comment-416531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 2:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=416531#respond" onclick='return addComment.moveForm( "comment-416531", "416531", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417023">
<div class="comment-container" id="li-comment-417023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Azim</span>
<span class="date">October 17, 2017 at 5:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the above Keras example, how can we predict a list of context words given a word? Lets say i have a word named ‘sudoku’ and want to predict the sourrounding words. how can we use word2vec from keras to do that?</p>
<div class="reply">
<a aria-label="Reply to Azim" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417023#respond" onclick='return addComment.moveForm( "comment-417023", "417023", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417055">
<div class="comment-container" id="li-comment-417055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 18, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It sounds like you are describing a language model. We can use LSTMs to learn these relationships.</p>
<p>Here is an example:<br/>
<a href="https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417055#respond" onclick='return addComment.moveForm( "comment-417055", "417055", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-417429">
<div class="comment-container" id="li-comment-417429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Azim</span>
<span class="date">October 21, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, what i meant was for word2vec skip-gram model predicts a context word given the center word. So if i train a word2vec skip-gram model, how can i predict the list of context words if my center word is ‘sudoku’?</p>
<p>Regards,</p>
<p>Azim</p>
<div class="reply">
<a aria-label="Reply to Azim" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417429#respond" onclick='return addComment.moveForm( "comment-417429", "417429", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-417475">
<div class="comment-container" id="li-comment-417475">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417475" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know Azim.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417475#respond" onclick='return addComment.moveForm( "comment-417475", "417475", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417408">
<div class="comment-container" id="li-comment-417408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">October 21, 2017 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your useful blog I have learned a lots.</p>
<p>I am wondering if I already have pretrained word embedding, is that possible to set keras embedding layer trainable to be true? If it is workable, will I get a better result, when I only use small size of data to pretrain the word embedding model. Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417408#respond" onclick='return addComment.moveForm( "comment-417408", "417408", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417471">
<div class="comment-container" id="li-comment-417471">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417471" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can. It is hard to know whether it will give better results. Try it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=417471#respond" onclick='return addComment.moveForm( "comment-417471", "417471", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418179">
<div class="comment-container" id="li-comment-418179">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f685391ab3f38f9cdd38036280aed136?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f685391ab3f38f9cdd38036280aed136?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cam</span>
<span class="date">October 28, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418179" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Is it possible to perform probability calculations on the label? I am looking at a case where it is not simply +/- but that a given data entry could be both but more likely one and not the other.</p>
<div class="reply">
<a aria-label="Reply to cam" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418179#respond" onclick='return addComment.moveForm( "comment-418179", "418179", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418280">
<div class="comment-container" id="li-comment-418280">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418280" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, a neural network with a sigmoid or softmax output can predict a probability-like score for each class.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418280#respond" onclick='return addComment.moveForm( "comment-418280", "418280", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418852">
<div class="comment-container" id="li-comment-418852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/905f07649c7cf267b83ab7b8788e052b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/905f07649c7cf267b83ab7b8788e052b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://ait.nyc" rel="external nofollow">David Stancu</a></span>
<span class="date">November 3, 2017 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m doing something like this except with my own feature vectors — but to the point of the labels — I do ternary classification using categorical_crossentropy and a softmax output. I get back an answer of the probability of each label.</p>
<div class="reply">
<a aria-label="Reply to David Stancu" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418852#respond" onclick='return addComment.moveForm( "comment-418852", "418852", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-418877">
<div class="comment-container" id="li-comment-418877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 2:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418877#respond" onclick='return addComment.moveForm( "comment-418877", "418877", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418850">
<div class="comment-container" id="li-comment-418850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ravil</span>
<span class="date">November 3, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason!</p>
<p>Thanks for a wonderful and detailed explanation of the post. It helped me a lot.</p>
<p>However, I’m struggling to understand how the model predicts a sentence as positive or negative.<br/>
i understand that each word in the document is converted into a word embedding, so how does our model evaluate the entire sentence as positive or negative? Does it take the sum of all the word vectors? Perhaps average of them?  I’ve not been able to figure this part out.</p>
<div class="reply">
<a aria-label="Reply to Ravil" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418850#respond" onclick='return addComment.moveForm( "comment-418850", "418850", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418875">
<div class="comment-container" id="li-comment-418875">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 2:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418875" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question!</p>
<p>The model interprets all of the words in the sequence and learns to associate specific patterns (of encoded words) with positive or negative sentiment</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=418875#respond" onclick='return addComment.moveForm( "comment-418875", "418875", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419457">
<div class="comment-container" id="li-comment-419457">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b01ebad197d596e925b43dc4116d8f72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b01ebad197d596e925b43dc4116d8f72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chengcheng</span>
<span class="date">November 9, 2017 at 2:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-419457" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>the chinese word how to vector sequence</p>
<div class="reply">
<a aria-label="Reply to chengcheng" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=419457#respond" onclick='return addComment.moveForm( "comment-419457", "419457", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419497">
<div class="comment-container" id="li-comment-419497">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2017 at 10:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-419497" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=419497#respond" onclick='return addComment.moveForm( "comment-419497", "419497", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-423494">
<div class="comment-container" id="li-comment-423494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/107d08aa220d5c73bfab33ce1be1857b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/107d08aa220d5c73bfab33ce1be1857b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lstmbot</span>
<span class="date">December 16, 2017 at 10:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-423494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>me bot trying interact comments born with lstm</p>
<div class="reply">
<a aria-label="Reply to lstmbot" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=423494#respond" onclick='return addComment.moveForm( "comment-423494", "423494", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420209">
<div class="comment-container" id="li-comment-420209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ee5b9be3dbc5ad785e8dcbf7d38aee8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ee5b9be3dbc5ad785e8dcbf7d38aee8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hilmi Jauffer</span>
<span class="date">November 16, 2017 at 4:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have successfully trained a model using the word embedding and Keras. The accuracy was at 100%. </p>
<p>I saved the trained model and the word tokens for predictions.<br/>
MODEL.save(‘model.h5’, True)</p>
<p>TOKENIZER = Tokenizer(num_words=MAX_NB_WORDS)<br/>
TOKENIZER.fit_on_texts(TEXT_SAMPLES)<br/>
pickle.dump(TOKENIZER, open(‘tokens’, ‘wb’))</p>
<p>When predicting:<br/>
 – Load the saved model.<br/>
 – Setup the tokenizer, by loading the saved word tokens.<br/>
 – Then predict the category of the new data.</p>
<p>I am not sure the prediction logic is correct, since I am not seeing the expected category from the prediction.</p>
<p>The source code is in Github: <a href="https://github.com/hilmij/keras-test/blob/master/predict.py" rel="nofollow">https://github.com/hilmij/keras-test/blob/master/predict.py</a></p>
<p>Appreciate if you can have a look and let me know what I am missing.</p>
<p>Best regards,<br/>
Hilmi.</p>
<div class="reply">
<a aria-label="Reply to Hilmi Jauffer" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420209#respond" onclick='return addComment.moveForm( "comment-420209", "420209", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420281">
<div class="comment-container" id="li-comment-420281">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420281" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your process sounds correct. I cannot review your code sorry.</p>
<p>What was the problem exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420281#respond" onclick='return addComment.moveForm( "comment-420281", "420281", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-420276">
<div class="comment-container" id="li-comment-420276">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c560b2c066be1516e0b06a1a1c086dc7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c560b2c066be1516e0b06a1a1c086dc7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://Brazil" rel="external nofollow">Fabrício Melo</a></span>
<span class="date">November 17, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420276" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason!</p>
<p>In Example of Using Pre-Trained GloVe Embedding, do you use the word embedding vectors as weights of the embedding layer?</p>
<div class="reply">
<a aria-label="Reply to Fabrício Melo" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420276#respond" onclick='return addComment.moveForm( "comment-420276", "420276", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420298">
<div class="comment-container" id="li-comment-420298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420298#respond" onclick='return addComment.moveForm( "comment-420298", "420298", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420761">
<div class="comment-container" id="li-comment-420761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 21, 2017 at 11:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice set of Blogs of NLP and Keras – thanks for writing them.</p>
<p>As a quick note for others</p>
<p>When I tried to load the glove file with the line:<br/>
f = open(‘../glove_data/glove.6B/glove.6B.100d.txt’)</p>
<p>I got the error<br/>
UnicodeDecodeError: ‘charmap’ codec can’t decode byte 0x9d in position 2776: character maps to </p>
<p>To fix I added:<br/>
f = open(‘../glove_data/glove.6B/glove.6B.100d.txt’,encoding=”utf8″)</p>
<p>This issue may have been caused by using Windows.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420761#respond" onclick='return addComment.moveForm( "comment-420761", "420761", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420819">
<div class="comment-container" id="li-comment-420819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 11:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tip Alex.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=420819#respond" onclick='return addComment.moveForm( "comment-420819", "420819", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-421219">
<div class="comment-container" id="li-comment-421219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/44fb04d97bd89b23a7ac691c99fd75ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/44fb04d97bd89b23a7ac691c99fd75ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liliana</span>
<span class="date">November 26, 2017 at 12:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Wonderful tutorials!</p>
<p>I have a question.  Why do we have to one-hot vectorize the labels? Also, if I have a pad sequence of ex. [2,4,0] what the one hot will be? I’m trying to understand better one hot vectorzer. </p>
<p>I appreciate your response!</p>
<div class="reply">
<a aria-label="Reply to Liliana" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421219#respond" onclick='return addComment.moveForm( "comment-421219", "421219", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-421282">
<div class="comment-container" id="li-comment-421282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We don’t one hot encode the labels, we one hot encode the words.</p>
<p>Perhaps this post will help you better understand one hot encoding:<br/>
<a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" rel="nofollow">https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421282#respond" onclick='return addComment.moveForm( "comment-421282", "421282", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-421381">
<div class="comment-container" id="li-comment-421381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wassim</span>
<span class="date">November 28, 2017 at 1:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your excellent tutorial. Do you know if there is a way to build a network for a classification using both text embedded data and categorical data ?<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Wassim" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421381#respond" onclick='return addComment.moveForm( "comment-421381", "421381", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421425">
<div class="comment-container" id="li-comment-421425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, you could have a network with two inputs:<br/>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421425#respond" onclick='return addComment.moveForm( "comment-421425", "421425", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-421497">
<div class="comment-container" id="li-comment-421497">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wassim</span>
<span class="date">November 28, 2017 at 10:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421497" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason</p>
<div class="reply">
<a aria-label="Reply to Wassim" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421497#respond" onclick='return addComment.moveForm( "comment-421497", "421497", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421955">
<div class="comment-container" id="li-comment-421955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/676ee322ca9169a53ff21c96a9da10ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/676ee322ca9169a53ff21c96a9da10ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ashish</span>
<span class="date">December 2, 2017 at 8:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to do sentence classification using CNN in keras ? please help</p>
<div class="reply">
<a aria-label="Reply to ashish" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421955#respond" onclick='return addComment.moveForm( "comment-421955", "421955", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421992">
<div class="comment-container" id="li-comment-421992">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 3, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421992" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this tutorial:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=421992#respond" onclick='return addComment.moveForm( "comment-421992", "421992", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422306">
<div class="comment-container" id="li-comment-422306">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4f7c3962f7f48d0dd4659e18c317b8a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4f7c3962f7f48d0dd4659e18c317b8a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 7, 2017 at 12:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422306" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Fantastic explanation, thanks so much. I’m just amazed at how much easier this has become since the last time I looked at it.</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422306#respond" onclick='return addComment.moveForm( "comment-422306", "422306", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422353">
<div class="comment-container" id="li-comment-422353">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422353" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad the post helped Stuart!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422353#respond" onclick='return addComment.moveForm( "comment-422353", "422353", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422756">
<div class="comment-container" id="li-comment-422756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 11, 2017 at 3:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason …the 14 word vocab from your docs is “well done good work great effort nice excellent weak poor not could have better” For a vocab_size of 14, this one_shot encodes to [13  8  7  6  10 13  3  6 10  4  9  2 10 12]. Why does 10 appear 3 times, for “great”, “weak” and “have”?</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422756#respond" onclick='return addComment.moveForm( "comment-422756", "422756", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422771">
<div class="comment-container" id="li-comment-422771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow Stuart. Could you please restate the question?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422771#respond" onclick='return addComment.moveForm( "comment-422771", "422771", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422788">
<div class="comment-container" id="li-comment-422788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 11, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, the encodings that I provided in the example above came from kerasR with a vocab_size of 14. So let me ask the same question about the uniqueness of encodings using your Part 3 one_hot example above with a vocab_size of 50.<br/>
Here different encodings are produced for different new kernels (using Spyder3/Python 3.4):<br/>
[[31, 33], [27, 33], [48, 41], [34, 33], [32], [5], [14, 41], [43, 27], [14, 33], [22, 26, 33, 26]]<br/>
[[6, 21], [48, 44], [7, 26], [46, 44], [45], [45], [10, 26], [45, 48], [10, 44], [47, 3, 21, 27]]<br/>
[[7, 8], [16, 42], [24, 13], [45, 42], [23], [17], [34, 13], [13, 16], [34, 42], [17, 31, 8, 19]]</p>
<p>Pleas note that in the first line, “33” encodes for the words “done”, “work”, “work”, “work” &amp; “done”. In the second line “45” encodes for the words “excellent” &amp; “weak” &amp; “not”. In the third line, “13” encodes “effort”, “effort” &amp; “not”.</p>
<p>So I’m wondering why the encodings are not unique? Secondly, if vocab_size must be much larger then the actual size of the vocabulary?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422788#respond" onclick='return addComment.moveForm( "comment-422788", "422788", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422827">
<div class="comment-container" id="li-comment-422827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The one_hot() function does not map words to unique integers, it uses a hash function that can have collisions, learn more here<br/>
<a href="https://keras.io/preprocessing/text/#one_hot" rel="nofollow">https://keras.io/preprocessing/text/#one_hot</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422827#respond" onclick='return addComment.moveForm( "comment-422827", "422827", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422840">
<div class="comment-container" id="li-comment-422840">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 12, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422840" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, In your Part 4 example, the Tokenizer approach always gives the same encodings and these appear to be unique.</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422840#respond" onclick='return addComment.moveForm( "comment-422840", "422840", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422871">
<div class="comment-container" id="li-comment-422871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I recommend using Tokenizer, see this post for more:<br/>
<a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=422871#respond" onclick='return addComment.moveForm( "comment-422871", "422871", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-424718">
<div class="comment-container" id="li-comment-424718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e3f2ce8688757df67390f03cb7b5bf2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e3f2ce8688757df67390f03cb7b5bf2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nadav</span>
<span class="date">December 25, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-424718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article Jason.<br/>
How do you convert back from an embedding to a one-hot? For example if you have a seq2seq model, and you feed the inputs as word embeddings, in your decoder you need to convert back from the embedding to a one-hot representing the dictionary. If you do it by using matrix multiplication that can be quite a large matrix (e.g embedding size 300, and vocab of 400k).</p>
<div class="reply">
<a aria-label="Reply to Nadav" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=424718#respond" onclick='return addComment.moveForm( "comment-424718", "424718", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424760">
<div class="comment-container" id="li-comment-424760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 26, 2017 at 5:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-424760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The output layer can predict integers directly that you can map to words in your vocabulary. There would be no embedding layer on the output.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=424760#respond" onclick='return addComment.moveForm( "comment-424760", "424760", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425991">
<div class="comment-container" id="li-comment-425991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b9b1cfed1408b16d19c2e4f1a8c29a8a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b9b1cfed1408b16d19c2e4f1a8c29a8a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hitkul</span>
<span class="date">January 9, 2018 at 9:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-425991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Very helpful article.<br/>
I have created word2vec matrix of a sentence using gensim and pre-trained Google News vector. Can I just flatten this matrix to a vector and use that as a input to my neural network.<br/>
For example:<br/>
each sentence is of length 140 and I am using a pre-trained model of 100 dimensions, therefore:- I have a 140*100 matrix representing the sentence, can i just flatten it to a 14000 length vector and feed it to my input layer?</p>
<div class="reply">
<a aria-label="Reply to Hitkul" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=425991#respond" onclick='return addComment.moveForm( "comment-425991", "425991", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426058">
<div class="comment-container" id="li-comment-426058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It depends on what you’re trying to model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426058#respond" onclick='return addComment.moveForm( "comment-426058", "426058", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426319">
<div class="comment-container" id="li-comment-426319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">January 12, 2018 at 6:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, could you shed some light on how do Param # of 400 and 1500 in two neural networks come from? Thanks</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426319#respond" onclick='return addComment.moveForm( "comment-426319", "426319", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-426324">
<div class="comment-container" id="li-comment-426324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul Lo</span>
<span class="date">January 12, 2018 at 9:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Oh! Is it just vocab_size * # of dimension of embedding space?<br/>
1.  50 * 8 = 400<br/>
2.  15* 100 = 1500</p>
<div class="reply">
<a aria-label="Reply to Paul Lo" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426324#respond" onclick='return addComment.moveForm( "comment-426324", "426324", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426363">
<div class="comment-container" id="li-comment-426363">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2018 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426363" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426363#respond" onclick='return addComment.moveForm( "comment-426363", "426363", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426530">
<div class="comment-container" id="li-comment-426530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy Brown</span>
<span class="date">January 14, 2018 at 2:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post! I’m working with my own corpus. How would I save the weight vector of the embedding layer in a text file like the glove data set?</p>
<p>My thinking is it would be easier for me to apply the vector representations to new data sets and/or machine learning platforms (mxnet etc) and make the output human readable (since the word is associated with the vector).</p>
<div class="reply">
<a aria-label="Reply to Andy Brown" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426530#respond" onclick='return addComment.moveForm( "comment-426530", "426530", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426583">
<div class="comment-container" id="li-comment-426583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2018 at 6:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could use get_weights() in the Keras API to retrieve the vectors and save directly as a CSV file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426583#respond" onclick='return addComment.moveForm( "comment-426583", "426583", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426707">
<div class="comment-container" id="li-comment-426707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd689991ae81222c938880a365cb0a63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd689991ae81222c938880a365cb0a63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://jaedukseo.me/" rel="external nofollow">jae</a></span>
<span class="date">January 17, 2018 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Clear Short Good reading, always thank you for your work!</p>
<div class="reply">
<a aria-label="Reply to jae" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426707#respond" onclick='return addComment.moveForm( "comment-426707", "426707", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426729">
<div class="comment-container" id="li-comment-426729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 17, 2018 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426729#respond" onclick='return addComment.moveForm( "comment-426729", "426729", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426743">
<div class="comment-container" id="li-comment-426743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3062a979b2735f8e46d13900965638d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3062a979b2735f8e46d13900965638d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Murali Manohar</span>
<span class="date">January 17, 2018 at 4:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
                     I have a dataset with which I’ve attained 0.87 fscore by 5 fold cross validation using SVM.Maximum context window is 20 and one hot encoded.</p>
<p>Now, I’ve done whatever has been mentioned and getting an accuracy of 13-15 percent for RNN models where each one has one LSTM cell with 3,20,150,300 hidden units. Dimensions of my pre-trained embeddings is 300.</p>
<p>Loss is decreasing and even reaching negative values, but no change in accuracy.</p>
<p>I’ve tried the same with your CNN,basic ANN models you’ve mentioned for text classification .</p>
<p>Would you please suggest some solution. Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Murali Manohar" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426743#respond" onclick='return addComment.moveForm( "comment-426743", "426743", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426792">
<div class="comment-container" id="li-comment-426792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some ideas here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426792#respond" onclick='return addComment.moveForm( "comment-426792", "426792", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426751">
<div class="comment-container" id="li-comment-426751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97ebc4f3e4d828a5204631108989324a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97ebc4f3e4d828a5204631108989324a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carsten</span>
<span class="date">January 17, 2018 at 8:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I copy the code of the first box I get the error:</p>
<p>  AttributeError: ‘int’ object has no attribute ‘ndim’</p>
<p>in the line :</p>
<p>  model.fit(padded_docs, labels, epochs=50, verbose=0)</p>
<p>Where is the problem?</p>
<div class="reply">
<a aria-label="Reply to Carsten" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426751#respond" onclick='return addComment.moveForm( "comment-426751", "426751", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426795">
<div class="comment-container" id="li-comment-426795">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426795" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Copy the the code from the “complete example”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426795#respond" onclick='return addComment.moveForm( "comment-426795", "426795", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426755">
<div class="comment-container" id="li-comment-426755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">January 17, 2018 at 9:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>If I have unkown words in training set, how can I assign the same  random initialize vector to all of the unkown words when using pretrained vector model like glove or w2v. thanks!!!</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426755#respond" onclick='return addComment.moveForm( "comment-426755", "426755", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426799">
<div class="comment-container" id="li-comment-426799">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426799" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would you want to do that?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426799#respond" onclick='return addComment.moveForm( "comment-426799", "426799", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-426824">
<div class="comment-container" id="li-comment-426824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">January 18, 2018 at 1:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If my data is in specific domain and I still want to leverage general word embedding model(e.g. glove.6b.100d trained from wiki), then it must has some OOV in domain data, so. no no mather in training time or inference time it propably may appear some unkown words.</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426824#respond" onclick='return addComment.moveForm( "comment-426824", "426824", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-426871">
<div class="comment-container" id="li-comment-426871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may. </p>
<p>You could ignore these words.</p>
<p>You could create a new embedding, set vectors from existing embedding and learn the new words.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=426871#respond" onclick='return addComment.moveForm( "comment-426871", "426871", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427067">
<div class="comment-container" id="li-comment-427067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://silversurfer0.github.io" rel="external nofollow">Vladimir</a></span>
<span class="date">January 21, 2018 at 1:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Amazing Dr. Jason!<br/>
Thanks for a great walkthrough.</p>
<p>Kindly advice on the following.<br/>
On the step of encoding each word to integer you said: “We could experiment with other more sophisticated bag of word model encoding like counts or TF-IDF”. Could you kindly elaborate on how can it be implemented, as tfidf encodes tokens with floats. And how to tie it with Keras, passing it to an Embedding layer please? I’m keen to experiment with it, hope it could yield better results.</p>
<p>Another question is about input docs. Suppose I’ve preprocessed text by the means of nltk up to lemmatization, thus, each sample is a list of tokens. What is the best approach to pass it to Keras embedding layer in this case then?</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=427067#respond" onclick='return addComment.moveForm( "comment-427067", "427067", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427086">
<div class="comment-container" id="li-comment-427086">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 22, 2018 at 4:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427086" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have most posts on BoW, learn more here:<br/>
<a href="https://machinelearningmastery.com/?s=bag+of+words&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=bag+of+words&amp;submit=Search</a></p>
<p>You can encode your tokens as integers manually or use the Keras Tokenizer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/?replytocom=427086#respond" onclick='return addComment.moveForm( "comment-427086", "427086", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/use-word-embedding-layers-deep-learning-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4346"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="33f8d2aea9"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="54"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-43"> <div class="textwidget"><p></p><center>
<h3>Deep Learning for Text Data</h3>
<p>Cut through the math and research papers.<br/>
Discover Word Embeddings, Text Translation and more.</p>
<p><a href="/deep-learning-for-nlp/">Get Started With Deep Learning for NLP Today!</a><br/>
<a href="/deep-learning-for-nlp/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>