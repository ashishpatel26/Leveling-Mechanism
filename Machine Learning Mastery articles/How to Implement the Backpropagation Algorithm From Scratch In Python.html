<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Implement the Backpropagation Algorithm From Scratch In Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Implement the Backpropagation Algorithm From Scratch In Python - Machine Learning Mastery" property="og:title"/>
<meta content="The backpropagation algorithm is the classical feed-forward artificial neural network. It is the technique still used to train large deep learning networks. In this tutorial, you will discover how to implement the backpropagation algorithm from scratch with Python. After completing this tutorial, you will know: How to forward-propagate an input to calculate an output. How …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-07T05:00:52+11:00" property="article:published_time"/>
<meta content="2017-09-18T07:39:27+11:00" property="article:modified_time"/>
<meta content="2017-09-18T07:39:27+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="512" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/implement-backpropagation-algorithm-scratch-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Implement the Backpropagation Algorithm From Scratch In Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3349" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3349 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Need help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3349 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How to Implement the Backpropagation Algorithm From Scratch In Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-07T05:00:52+1100">November 7, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Algorithms From Scratch">Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/&amp;summary=The+backpropagation+algorithm+is+the+classical+feed-forward+artificial+neural+network.%0D%0A%0D%0AIt+is+the+..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/&amp;summary=The+backpropagation+algorithm+is+the+classical+feed-forward+artificial+neural+network.%0D%0A%0D%0AIt+is+the+...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>The backpropagation algorithm is the classical feed-forward artificial neural network.</p>
<p>It is the technique still used to train large <a href="http://machinelearningmastery.com/what-is-deep-learning/">deep learning</a> networks.</p>
<p>In this tutorial, you will discover how to implement the backpropagation algorithm from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to forward-propagate an input to calculate an output.</li>
<li>How to back-propagate error and train a network.</li>
<li>How to apply the backpropagation algorithm to a real-world predictive modeling problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2016</strong>: Fixed a bug in the activate() function. Thanks Alex!</li>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Jan/2017</strong>: Updated small bug in update_weights(). Thanks Tomasz!</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3350" style="max-width: 650px"><img alt="How to Implement the Backpropagation Algorithm From Scratch In Python" class="size-full wp-image-3350" height="512" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python-300x240.jpg 300w" width="640"/><p class="wp-caption-text">How to Implement the Backpropagation Algorithm From Scratch In Python<br/>Photo by <a href="https://www.flickr.com/photos/nichd/21086425615/">NICHD</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Backpropagation Algorithm and the Wheat Seeds dataset that we will be using in this tutorial.</p>
<h3>Backpropagation Algorithm</h3>
<p>The Backpropagation algorithm is a supervised learning method for multilayer feed-forward networks from the field of Artificial Neural Networks.</p>
<p>Feed-forward neural networks are inspired by the information processing of one or more neural cells, called a neuron. A neuron accepts input signals via its dendrites, which pass the electrical signal down to the cell body. The axon carries the signal out to synapses, which are the connections of a cell’s axon to other cell’s dendrites.</p>
<p>The principle of the backpropagation approach is to model a given function by modifying internal weightings of input signals to produce an expected output signal. The system is trained using a supervised learning method, where the error between the system’s output and a known expected output is presented to the system and used to modify its internal state.</p>
<p>Technically, the backpropagation algorithm is a method for training the weights in a multilayer feed-forward neural network. As such, it requires a network structure to be defined of one or more layers where one layer is fully connected to the next layer. A standard network structure is one input layer, one hidden layer, and one output layer.</p>
<p>Backpropagation can be used for both classification and regression problems, but we will focus on classification in this tutorial.</p>
<p>In classification problems, best results are achieved when the network has one neuron in the output layer for each class value. For example, a 2-class or binary classification problem with the class values of A and B. These expected outputs would have to be transformed into binary vectors with one column for each class value. Such as [1, 0] and [0, 1] for A and B respectively. This is called a one hot encoding.</p>
<h3>Wheat Seeds Dataset</h3>
<p>The seeds dataset involves the prediction of species given measurements seeds from different varieties of wheat.</p>
<p>There are 201 records and 7 numerical input variables. It is a classification problem with 3 output classes. The scale for each numeric input value vary, so some data normalization may be required for use with algorithms that weight inputs like the backpropagation algorithm.</p>
<p>Below is a sample of the first 5 rows of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae75672412306" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
15.26,14.84,0.871,5.763,3.312,2.221,5.22,1
14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1
14.29,14.09,0.905,5.291,3.337,2.699,4.825,1
13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1
16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae75672412306-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae75672412306-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae75672412306-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae75672412306-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae75672412306-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae75672412306-1">15.26,14.84,0.871,5.763,3.312,2.221,5.22,1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae75672412306-2">14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1</div><div class="crayon-line" id="crayon-5a659397eae75672412306-3">14.29,14.09,0.905,5.291,3.337,2.699,4.825,1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae75672412306-4">13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1</div><div class="crayon-line" id="crayon-5a659397eae75672412306-5">16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Using the Zero Rule algorithm that predicts the most common class value, the baseline accuracy for the problem is 28.095%.</p>
<p>You can learn more and download the seeds dataset from the <a href="http://archive.ics.uci.edu/ml/datasets/seeds">UCI Machine Learning Repository</a>.</p>
<p>Download the seeds dataset and place it into your current working directory with the filename <strong>seeds_dataset.csv</strong>. The dataset is in tab-separated format, so you must convert it to CSV using a text editor or a spreadsheet program.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 6 parts:</p>
<ol>
<li>Initialize Network.</li>
<li>Forward Propagate.</li>
<li>Back Propagate Error.</li>
<li>Train Network.</li>
<li>Predict.</li>
<li>Seeds Dataset Case Study.</li>
</ol>
<p>These steps will provide the foundation that you need to implement the backpropagation algorithm from scratch and apply it to your own predictive modeling problems.</p>
<h3>1. Initialize Network</h3>
<p>Let’s start with something easy, the creation of a new network ready for training.</p>
<p>Each neuron has a set of weights that need to be maintained. One weight for each input connection and an additional weight for the bias. We will need to store additional properties for a neuron during training, therefore we will use a dictionary to represent each neuron and store properties by names such as ‘<strong>weights</strong>‘ for the weights.</p>
<p>A network is organized into layers. The input layer is really just a row from our training dataset. The first real layer is the hidden layer. This is followed by the output layer that has one neuron for each class value.</p>
<p>We will organize layers as arrays of dictionaries and treat the whole network as an array of layers.</p>
<p>It is good practice to initialize the network weights to small random numbers. In this case, will we use random numbers in the range of 0 to 1.</p>
<p>Below is a function named <strong>initialize_network()</strong> that creates a new neural network ready for training. It accepts three parameters, the number of inputs, the number of neurons to have in the hidden layer and the number of outputs.</p>
<p>You can see that for the hidden layer we create <strong>n_hidden</strong> neurons and each neuron in the hidden layer has <strong>n_inputs + 1</strong> weights, one for each input column in a dataset and an additional one for the bias.</p>
<p>You can also see that the output layer that connects to the hidden layer has <strong>n_outputs</strong> neurons, each with <strong>n_hidden + 1</strong> weights. This means that each neuron in the output layer connects to (has a weight for) each neuron in the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae81800191627" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae81800191627-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae81800191627-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae81800191627-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae81800191627-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae81800191627-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae81800191627-6">6</div><div class="crayon-num" data-line="crayon-5a659397eae81800191627-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae81800191627-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae81800191627-1"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae81800191627-2"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae81800191627-3"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae81800191627-4"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eae81800191627-5"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae81800191627-6"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eae81800191627-7"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae81800191627-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Let’s test out this function. Below is a complete example that creates a small network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae85467181030" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

seed(1)
network = initialize_network(2, 1, 2)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae85467181030-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-6">6</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-8">8</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-10">10</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-12">12</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-14">14</div><div class="crayon-num" data-line="crayon-5a659397eae85467181030-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae85467181030-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae85467181030-1"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">random</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-4"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-5"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-6"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-7"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-8"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-9"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-10"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-12"> </div><div class="crayon-line" id="crayon-5a659397eae85467181030-13"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-14"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae85467181030-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae85467181030-16"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Running the example, you can see that the code prints out each layer one by one. You can see the hidden layer has one neuron with 2 input weights plus the bias. The output layer has 2 neurons, each with 1 weight plus the bias.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae87628021735" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]
[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae87628021735-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae87628021735-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae87628021735-1">[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae87628021735-2">[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now that we know how to create and initialized a network, let’s see how we can use it to calculate an output.</p>
<h3>2. Forward Propagate</h3>
<p>We can calculate an output from a neural network by propagating an input signal through each layer until the output layer outputs its values.</p>
<p>We call this forward-propagation.</p>
<p>It is the technique we will need to generate predictions during training that will need to be corrected, and it is the method we will need after the network is trained to make predictions on new data.</p>
<p>We can break forward propagation down into three parts:</p>
<ol>
<li>Neuron Activation.</li>
<li>Neuron Transfer.</li>
<li>Forward Propagation.</li>
</ol>
<h4>2.1. Neuron Activation</h4>
<p>The first step is to calculate the activation of one neuron given an input.</p>
<p>The input could be a row from our training dataset, as in the case of the hidden layer. It may also be the outputs from each neuron in the hidden layer, in the case of the output layer.</p>
<p>Neuron activation is calculated as the weighted sum of the inputs. Much like linear regression.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae8b331654645" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
activation = sum(weight_i * input_i) + bias</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae8b331654645-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae8b331654645-1">activation = sum(weight_i * input_i) + bias</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>weight</strong> is a network weight, <strong>input</strong> is an input, <strong>i</strong> is the index of a weight or an input and <strong>bias</strong> is a special weight that has no input to multiply with (or you can think of the input as always being 1.0).</p>
<p>Below is an implementation of this in a function named <strong>activate()</strong>. You can see that the function assumes that the bias is the last weight in the list of weights. This helps here and later to make the code easier to read.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae8e856464825" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae8e856464825-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae8e856464825-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae8e856464825-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae8e856464825-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae8e856464825-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae8e856464825-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae8e856464825-1"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae8e856464825-2"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae8e856464825-3"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae8e856464825-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae8e856464825-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae8e856464825-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Now, let’s see how to use the neuron activation.</p>
<h4>2.2. Neuron Transfer</h4>
<p>Once a neuron is activated, we need to transfer the activation to see what the neuron output actually is.</p>
<p>Different transfer functions can be used. It is traditional to use the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid activation function</a>, but you can also use the tanh (<a href="https://en.wikipedia.org/wiki/Hyperbolic_function">hyperbolic tangent</a>) function to transfer outputs. More recently, the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">rectifier transfer function</a> has been popular with large deep learning networks.</p>
<p>The sigmoid activation function looks like an S shape, it’s also called the logistic function. It can take any input value and produce a number between 0 and 1 on an S-curve. It is also a function of which we can easily calculate the derivative (slope) that we will need later when backpropagating error.</p>
<p>We can transfer an activation function using the sigmoid function as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae91857123636" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
output = 1 / (1 + e^(-activation))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae91857123636-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae91857123636-1">output = 1 / (1 + e^(-activation))</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>e</strong> is the base of the natural logarithms (<a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">Euler’s number</a>).</p>
<p>Below is a function named <strong>transfer()</strong> that implements the sigmoid equation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae93076637935" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae93076637935-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae93076637935-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae93076637935-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae93076637935-1"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae93076637935-2"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae93076637935-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Now that we have the pieces, let’s see how they are used.</p>
<h4>2.3. Forward Propagation</h4>
<p>Forward propagating an input is straightforward.</p>
<p>We work through each layer of our network calculating the outputs for each neuron. All of the outputs from one layer become inputs to the neurons on the next layer.</p>
<p>Below is a function named <strong>forward_propagate()</strong> that implements the forward propagation for a row of data from our dataset with our neural network.</p>
<p>You can see that a neuron’s output value is stored in the neuron with the name ‘<strong>output</strong>‘. You can also see that we collect the outputs for a layer in an array named <strong>new_inputs</strong> that becomes the array <strong>inputs</strong> and is used as inputs for the following layer.</p>
<p>The function returns the outputs from the last layer also called the output layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae96755483009" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae96755483009-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae96755483009-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae96755483009-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae96755483009-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae96755483009-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae96755483009-6">6</div><div class="crayon-num" data-line="crayon-5a659397eae96755483009-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae96755483009-8">8</div><div class="crayon-num" data-line="crayon-5a659397eae96755483009-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae96755483009-10">10</div><div class="crayon-num" data-line="crayon-5a659397eae96755483009-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae96755483009-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae96755483009-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae96755483009-3"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae96755483009-4"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae96755483009-5"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae96755483009-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae96755483009-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae96755483009-8"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae96755483009-9"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae96755483009-10"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5a659397eae96755483009-11"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Let’s put all of these pieces together and test out the forward propagation of our network.</p>
<p>We define our network inline with one hidden neuron that expects 2 input values and an output layer with two neurons.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae99457795216" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# test forward propagation
network = [[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]]
row = [1, 0, None]
output = forward_propagate(network, row)
print(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae99457795216-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-2">2</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-4">4</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-6">6</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-8">8</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-10">10</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-12">12</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-14">14</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-16">16</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-18">18</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-20">20</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-22">22</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-24">24</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-26">26</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-28">28</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eae99457795216-30">30</div><div class="crayon-num" data-line="crayon-5a659397eae99457795216-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae99457795216-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-2"> </div><div class="crayon-line" id="crayon-5a659397eae99457795216-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-16"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-17"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-18"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-20"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-22"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-23"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-24"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-26"><span class="crayon-p"># test forward propagation</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-27"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-28"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-29"><span class="crayon-v">row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eae99457795216-30"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eae99457795216-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Running the example propagates the input pattern [1, 0] and produces an output value that is printed. Because the output layer has two neurons, we get a list of two numbers as output.</p>
<p>The actual output values are just nonsense for now, but next, we will start to learn how to make the weights in the neurons more useful.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae9c738398116" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[0.6629970129852887, 0.7253160725279748]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae9c738398116-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae9c738398116-1">[0.6629970129852887, 0.7253160725279748]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>3. Back Propagate Error</h3>
<p>The backpropagation algorithm is named for the way in which weights are trained.</p>
<p>Error is calculated between the expected outputs and the outputs forward propagated from the network. These errors are then propagated backward through the network from the output layer to the hidden layer, assigning blame for the error and updating weights as they go.</p>
<p>The math for backpropagating error is rooted in calculus, but we will remain high level in this section and focus on what is calculated and how rather than why the calculations take this particular form.</p>
<p>This part is broken down into two sections.</p>
<ol>
<li>Transfer Derivative.</li>
<li>Error Backpropagation.</li>
</ol>
<h4>3.1. Transfer Derivative</h4>
<p>Given an output value from a neuron, we need to calculate it’s slope.</p>
<p>We are using the sigmoid transfer function, the derivative of which can be calculated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eae9e147050684" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
derivative = output * (1.0 - output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eae9e147050684-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eae9e147050684-1">derivative = output * (1.0 - output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is a function named <strong>transfer_derivative()</strong> that implements this equation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaea1007182986" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaea1007182986-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea1007182986-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaea1007182986-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaea1007182986-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea1007182986-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaea1007182986-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Now, let’s see how this can be used.</p>
<h4>3.2. Error Backpropagation</h4>
<p>The first step is to calculate the error for each output neuron, this will give us our error signal (input) to propagate backwards through the network.</p>
<p>The error for a given neuron can be calculated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaea3639962387" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
error = (expected - output) * transfer_derivative(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaea3639962387-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaea3639962387-1">error = (expected - output) * transfer_derivative(output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Where <strong>expected</strong> is the expected output value for the neuron, <strong>output</strong> is the output value for the neuron and <strong>transfer_derivative()</strong> calculates the slope of the neuron’s output value, as shown above.</p>
<p>This error calculation is used for neurons in the output layer. The expected value is the class value itself. In the hidden layer, things are a little more complicated.</p>
<p>The error signal for a neuron in the hidden layer is calculated as the weighted error of each neuron in the output layer. Think of the error traveling back along the weights of the output layer to the neurons in the hidden layer.</p>
<p>The back-propagated error signal is accumulated and then used to determine the error for the neuron in the hidden layer, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaea6834441706" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
error = (weight_k * error_j) * transfer_derivative(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaea6834441706-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaea6834441706-1">error = (weight_k * error_j) * transfer_derivative(output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>error_j</strong> is the error signal from the <strong>j</strong>th neuron in the output layer, <strong>weight_k</strong> is the weight that connects the <strong>k</strong>th neuron to the current neuron and output is the output for the current neuron.</p>
<p>Below is a function named <strong>backward_propagate_error()</strong> that implements this procedure.</p>
<p>You can see that the error signal calculated for each neuron is stored with the name ‘delta’. You can see that the layers of the network are iterated in reverse order, starting at the output and working backwards. This ensures that the neurons in the output layer have ‘delta’ values calculated first that neurons in the hidden layer can use in the subsequent iteration. I chose the name ‘delta’ to reflect the change the error implies on the neuron (e.g. the weight delta).</p>
<p>You can see that the error signal for neurons in the hidden layer is accumulated from neurons in the output layer where the hidden neuron number <strong>j</strong> is also the index of the neuron’s weight in the output layer <strong>neuron[‘weights’][j]</strong>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaea9450528104" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaea9450528104-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaea9450528104-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaea9450528104-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-4"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-5"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-6"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-8"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-10"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-11"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-12"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-14"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-15"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-16"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaea9450528104-17"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaea9450528104-18"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Let’s put all of the pieces together and see how it works.</p>
<p>We define a fixed neural network with output values and backpropagate an expected output pattern. The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaeab215798453" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# test backpropagation of error
network = [[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095]}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763]}]]
expected = [0, 1]
backward_propagate_error(network, expected)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-18">18</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-20">20</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-22">22</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-24">24</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-26">26</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-28">28</div><div class="crayon-num" data-line="crayon-5a659397eaeab215798453-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeab215798453-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaeab215798453-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-4"> </div><div class="crayon-line" id="crayon-5a659397eaeab215798453-5"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-6"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-8"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-9"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-10"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-12"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-14"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-15"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-16"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-18"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-19"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-22"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-24"><span class="crayon-p"># test backpropagation of error</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-25"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.7105668883115941</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-26"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6213859615555266</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6573693455986976</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-27"><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-28"><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaeab215798453-29"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeab215798453-30"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>Running the example prints the network after the backpropagation of error is complete. You can see that error values are calculated and stored in the neurons for the output layer and the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaeaf084530996" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]
[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaeaf084530996-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeaf084530996-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaeaf084530996-1">[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeaf084530996-2">[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now let’s use the backpropagation of error to train the network.</p>
<h3>4. Train Network</h3>
<p>The network is trained using stochastic gradient descent.</p>
<p>This involves multiple iterations of exposing a training dataset to the network and for each row of data forward propagating the inputs, backpropagating the error and updating the network weights.</p>
<p>This part is broken down into two sections:</p>
<ol>
<li>Update Weights.</li>
<li>Train Network.</li>
</ol>
<h4>4.1. Update Weights</h4>
<p>Once errors are calculated for each neuron in the network via the back propagation method above, they can be used to update weights.</p>
<p>Network weights are updated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaeb1972914171" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
weight = weight + learning_rate * error * input</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaeb1972914171-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaeb1972914171-1">weight = weight + learning_rate * error * input</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>weight</strong> is a given weight, <strong>learning_rate</strong> is a parameter that you must specify, <strong>error</strong> is the error calculated by the backpropagation procedure for the neuron and <strong>input</strong> is the input value that caused the error.</p>
<p>The same procedure can be used for updating the bias weight, except there is no input term, or input is the fixed value of 1.0.</p>
<p>Learning rate controls how much to change the weight to correct for the error. For example, a value of 0.1 will update the weight 10% of the amount that it possibly could be updated. Small learning rates are preferred that cause slower learning over a large number of training iterations. This increases the likelihood of the network finding a good set of weights across all layers rather than the fastest set of weights that minimize error (called premature convergence).</p>
<p>Below is a function named <strong>update_weights()</strong> that updates the weights for a network given an input row of data, a learning rate and assume that a forward and backward propagation have already been performed.</p>
<p>Remember that the input for the output layer is a collection of outputs from the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaeb4688019828" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaeb4688019828-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb4688019828-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaeb4688019828-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb4688019828-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaeb4688019828-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb4688019828-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaeb4688019828-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb4688019828-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaeb4688019828-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb4688019828-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaeb4688019828-1"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb4688019828-2"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeb4688019828-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb4688019828-4"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaeb4688019828-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb4688019828-6"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaeb4688019828-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb4688019828-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeb4688019828-9"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb4688019828-10"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Now we know how to update network weights, let’s see how we can do it repeatedly.</p>
<h4>4.2. Train Network</h4>
<p>As mentioned, the network is updated using stochastic gradient descent.</p>
<p>This involves first looping for a fixed number of epochs and within each epoch updating the network for each row in the training dataset.</p>
<p>Because updates are made for each training pattern, this type of learning is called online learning. If errors were accumulated across an epoch before updating the weights, this is called batch learning or batch gradient descent.</p>
<p>Below is a function that implements the training of an already initialized neural network with a given training dataset, learning rate, fixed number of epochs and an expected number of output values.</p>
<p>The expected number of output values is used to transform class values in the training data into a one hot encoding. That is a binary vector with one column for each class value to match the output of the network. This is required to calculate the error for the output layer.</p>
<p>You can also see that the sum squared error between the expected output and the network output is accumulated each epoch and printed. This is helpful to create a trace of how much the network is learning and improving each epoch.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaeb8428278440" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaeb8428278440-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaeb8428278440-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaeb8428278440-1"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-2"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaeb8428278440-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-4"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5a659397eaeb8428278440-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-6"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaeb8428278440-7"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-8"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659397eaeb8428278440-9"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-10"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaeb8428278440-11"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaeb8428278440-12"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>We now have all of the pieces to train the network. We can put together an example that includes everything we’ve seen so far including network initialization and train a network on a small dataset.</p>
<p>Below is a small contrived dataset that we can use to test out training our neural network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaebf798318495" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1			X2			Y
2.7810836		2.550537003		0
1.465489372		2.362125076		0
3.396561688		4.400293529		0
1.38807019		1.850220317		0
3.06407232		3.005305973		0
7.627531214		2.759262235		1
5.332441248		2.088626775		1
6.922596716		1.77106367		1
8.675418651		-0.242068655		1
7.673756466		3.508563011		1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaebf798318495-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaebf798318495-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaebf798318495-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaebf798318495-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaebf798318495-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaebf798318495-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaebf798318495-1">X1			X2			Y</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaebf798318495-2">2.7810836		2.550537003		0</div><div class="crayon-line" id="crayon-5a659397eaebf798318495-3">1.465489372		2.362125076		0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaebf798318495-4">3.396561688		4.400293529		0</div><div class="crayon-line" id="crayon-5a659397eaebf798318495-5">1.38807019		1.850220317		0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaebf798318495-6">3.06407232		3.005305973		0</div><div class="crayon-line" id="crayon-5a659397eaebf798318495-7">7.627531214		2.759262235		1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaebf798318495-8">5.332441248		2.088626775		1</div><div class="crayon-line" id="crayon-5a659397eaebf798318495-9">6.922596716		1.77106367		1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaebf798318495-10">8.675418651		-0.242068655		1</div><div class="crayon-line" id="crayon-5a659397eaebf798318495-11">7.673756466		3.508563011		1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Below is the complete example. We will use 2 neurons in the hidden layer. It is a binary classification problem (2 classes) so there will be two neurons in the output layer. The network will be trained for 20 epochs with a learning rate of 0.5, which is high because we are training for so few iterations.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaec2947592100" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp
from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))

# Test training backprop algorithm
seed(1)
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
n_inputs = len(dataset[0]) - 1
n_outputs = len(set([row[-1] for row in dataset]))
network = initialize_network(n_inputs, 2, n_outputs)
train_network(network, dataset, 0.5, 20, n_outputs)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-18">18</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-20">20</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-22">22</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-24">24</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-26">26</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-28">28</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-30">30</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-32">32</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-34">34</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-36">36</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-38">38</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-40">40</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-42">42</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-44">44</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-46">46</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-48">48</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-50">50</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-52">52</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-54">54</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-56">56</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-58">58</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-60">60</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-62">62</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-64">64</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-66">66</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-68">68</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-70">70</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-72">72</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-74">74</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-76">76</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-78">78</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-80">80</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-82">82</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-84">84</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-86">86</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-88">88</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-90">90</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-92">92</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-94">94</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-96">96</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-98">98</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec2947592100-100">100</div><div class="crayon-num" data-line="crayon-5a659397eaec2947592100-101">101</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaec2947592100-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-4"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-5"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-6"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-7"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-8"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-9"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-10"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-11"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-14"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-15"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-16"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-18"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-20"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-21"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-22"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-23"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-24"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-25"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-26"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-27"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-28"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-29"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-31"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-32"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-33"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-34"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-35"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-36"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-37"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-38"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-39"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-40"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-41"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-42"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-44"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-45"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-46"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-47"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-48"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-49"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-50"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-51"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-52"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-53"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-54"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-55"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-56"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-57"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-58"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-59"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-60"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-61"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-62"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-63"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-64"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-65"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-66"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-67"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-68"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-69"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-70"> </div><div class="crayon-line" id="crayon-5a659397eaec2947592100-71"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-72"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-73"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-74"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-75"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-76"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-77"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-78"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-79"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-80"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-81"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-82"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-83"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-84"><span class="crayon-p"># Test training backprop algorithm</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-85"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-86"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-87"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-88"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-89"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-90"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-91"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-92"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-93"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-94"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-95"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-96"><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-97"><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-98"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-99"><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec2947592100-100"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaec2947592100-101"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0085 seconds] -->
<p>Running the example first prints the sum squared error each training epoch. We can see a trend of this error decreasing with each epoch.</p>
<p>Once trained, the network is printed, showing the learned weights. Also still in the network are output and delta values that can be ignored. We could update our training function to delete these data if we wanted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaec7879243783" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
&gt;epoch=0, lrate=0.500, error=6.350
&gt;epoch=1, lrate=0.500, error=5.531
&gt;epoch=2, lrate=0.500, error=5.221
&gt;epoch=3, lrate=0.500, error=4.951
&gt;epoch=4, lrate=0.500, error=4.519
&gt;epoch=5, lrate=0.500, error=4.173
&gt;epoch=6, lrate=0.500, error=3.835
&gt;epoch=7, lrate=0.500, error=3.506
&gt;epoch=8, lrate=0.500, error=3.192
&gt;epoch=9, lrate=0.500, error=2.898
&gt;epoch=10, lrate=0.500, error=2.626
&gt;epoch=11, lrate=0.500, error=2.377
&gt;epoch=12, lrate=0.500, error=2.153
&gt;epoch=13, lrate=0.500, error=1.953
&gt;epoch=14, lrate=0.500, error=1.774
&gt;epoch=15, lrate=0.500, error=1.614
&gt;epoch=16, lrate=0.500, error=1.472
&gt;epoch=17, lrate=0.500, error=1.346
&gt;epoch=18, lrate=0.500, error=1.233
&gt;epoch=19, lrate=0.500, error=1.132
[{'output': 0.029980305604426185, 'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'delta': -0.0059546604162323625}, {'output': 0.9456229000211323, 'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'delta': 0.0026279652850863837}]
[{'output': 0.23648794202357587, 'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'delta': -0.04270059278364587}, {'output': 0.7790535202438367, 'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'delta': 0.03803132596437354}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-18">18</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-20">20</div><div class="crayon-num" data-line="crayon-5a659397eaec7879243783-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaec7879243783-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaec7879243783-1">&gt;epoch=0, lrate=0.500, error=6.350</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-2">&gt;epoch=1, lrate=0.500, error=5.531</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-3">&gt;epoch=2, lrate=0.500, error=5.221</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-4">&gt;epoch=3, lrate=0.500, error=4.951</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-5">&gt;epoch=4, lrate=0.500, error=4.519</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-6">&gt;epoch=5, lrate=0.500, error=4.173</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-7">&gt;epoch=6, lrate=0.500, error=3.835</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-8">&gt;epoch=7, lrate=0.500, error=3.506</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-9">&gt;epoch=8, lrate=0.500, error=3.192</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-10">&gt;epoch=9, lrate=0.500, error=2.898</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-11">&gt;epoch=10, lrate=0.500, error=2.626</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-12">&gt;epoch=11, lrate=0.500, error=2.377</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-13">&gt;epoch=12, lrate=0.500, error=2.153</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-14">&gt;epoch=13, lrate=0.500, error=1.953</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-15">&gt;epoch=14, lrate=0.500, error=1.774</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-16">&gt;epoch=15, lrate=0.500, error=1.614</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-17">&gt;epoch=16, lrate=0.500, error=1.472</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-18">&gt;epoch=17, lrate=0.500, error=1.346</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-19">&gt;epoch=18, lrate=0.500, error=1.233</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-20">&gt;epoch=19, lrate=0.500, error=1.132</div><div class="crayon-line" id="crayon-5a659397eaec7879243783-21">[{'output': 0.029980305604426185, 'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'delta': -0.0059546604162323625}, {'output': 0.9456229000211323, 'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'delta': 0.0026279652850863837}]</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaec7879243783-22">[{'output': 0.23648794202357587, 'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'delta': -0.04270059278364587}, {'output': 0.7790535202438367, 'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'delta': 0.03803132596437354}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Once a network is trained, we need to use it to make predictions.</p>
<h3>5. Predict</h3>
<p>Making predictions with a trained neural network is easy enough.</p>
<p>We have already seen how to forward-propagate an input pattern to get an output. This is all we need to do to make a prediction. We can use the output values themselves directly as the probability of a pattern belonging to each output class.</p>
<p>It may be more useful to turn this output back into a crisp class prediction. We can do this by selecting the class value with the larger probability. This is also called the <a href="https://en.wikipedia.org/wiki/Arg_max">arg max function</a>.</p>
<p>Below is a function named <strong>predict()</strong> that implements this procedure. It returns the index in the network output that has the largest probability. It assumes that class values have been converted to integers starting at 0.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaecb483495596" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaecb483495596-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaecb483495596-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaecb483495596-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaecb483495596-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaecb483495596-1"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaecb483495596-2"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaecb483495596-3"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaecb483495596-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can put this together with our code above for forward propagating input and with our small contrived dataset to test making predictions with an already-trained network. The example hardcodes a network trained from the previous step.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaece054564885" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Test making predictions with the network
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
network = [[{'weights': [-1.482313569067226, 1.8308790073202204, 1.078381922048799]}, {'weights': [0.23244990332399884, 0.3621998343835864, 0.40289821191094327]}],
	[{'weights': [2.5001872433501404, 0.7887233511355132, -1.1026649757805829]}, {'weights': [-2.429350576245497, 0.8357651039198697, 1.0699217181280656]}]]
for row in dataset:
	prediction = predict(network, row)
	print('Expected=%d, Got=%d' % (row[-1], prediction))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaece054564885-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-18">18</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-20">20</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-22">22</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-24">24</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-26">26</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-28">28</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-30">30</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-32">32</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-34">34</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-36">36</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-38">38</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-40">40</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-42">42</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-44">44</div><div class="crayon-num" data-line="crayon-5a659397eaece054564885-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaece054564885-46">46</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaece054564885-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-2"> </div><div class="crayon-line" id="crayon-5a659397eaece054564885-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-16"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-17"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-18"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-20"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-22"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-23"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-24"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-26"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-27"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-28"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-30"> </div><div class="crayon-line" id="crayon-5a659397eaece054564885-31"><span class="crayon-p"># Test making predictions with the network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-32"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-33"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-34"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-35"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-36"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-37"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-38"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-39"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-40"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-41"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-42"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1.482313569067226</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.8308790073202204</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.078381922048799</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.23244990332399884</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3621998343835864</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.40289821191094327</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-43"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.5001872433501404</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7887233511355132</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1.1026649757805829</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2.429350576245497</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8357651039198697</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0699217181280656</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-44"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaece054564885-45"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaece054564885-46"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected=%d, Got=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>Running the example prints the expected output for each record in the training dataset, followed by the crisp prediction made by the network.</p>
<p>It shows that the network achieves 100% accuracy on this small dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaed2707777169" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaed2707777169-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed2707777169-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaed2707777169-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed2707777169-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaed2707777169-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed2707777169-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaed2707777169-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed2707777169-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaed2707777169-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed2707777169-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaed2707777169-1">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed2707777169-2">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5a659397eaed2707777169-3">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed2707777169-4">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5a659397eaed2707777169-5">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed2707777169-6">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5a659397eaed2707777169-7">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed2707777169-8">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5a659397eaed2707777169-9">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed2707777169-10">Expected=1, Got=1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now we are ready to apply our backpropagation algorithm to a real world dataset.</p>
<h3>6. Wheat Seeds Dataset</h3>
<p>This section applies the Backpropagation algorithm to the wheat seeds dataset.</p>
<p>The first step is to load the dataset and convert the loaded data to numbers that we can use in our neural network. For this we will use the helper function <strong>load_csv()</strong> to load the file, <strong>str_column_to_float()</strong> to convert string numbers to floats and <strong>str_column_to_int()</strong> to convert the class column to integer values.</p>
<p>Input values vary in scale and need to be normalized to the range of 0 and 1. It is generally good practice to normalize input values to the range of the chosen transfer function, in this case, the sigmoid function that outputs values between 0 and 1. The <strong>dataset_minmax()</strong> and <strong>normalize_dataset()</strong> helper functions were used to normalize the input values.</p>
<p>We will evaluate the algorithm using k-fold cross-validation with 5 folds. This means that 201/5=40.2 or 40 records will be in each fold. We will use the helper functions <strong>evaluate_algorithm()</strong> to evaluate the algorithm with cross-validation and <strong>accuracy_metric()</strong> to calculate the accuracy of predictions.</p>
<p>A new function named <strong>back_propagation()</strong> was developed to manage the application of the Backpropagation algorithm, first initializing a network, training it on the training dataset and then using the trained network to make predictions on a test dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaed5191638340" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Backprop on the Seeds Dataset
from random import seed
from random import randrange
from random import random
from csv import reader
from math import exp

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Find the min and max values for each column
def dataset_minmax(dataset):
	minmax = list()
	stats = [[min(column), max(column)] for column in zip(*dataset)]
	return stats

# Rescale dataset columns to the range 0-1
def normalize_dataset(dataset, minmax):
	for row in dataset:
		for i in range(len(row)-1):
			row[i] = (row[i] - minmax[i][0]) / (minmax[i][1] - minmax[i][0])

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Backpropagation Algorithm With Stochastic Gradient Descent
def back_propagation(train, test, l_rate, n_epoch, n_hidden):
	n_inputs = len(train[0]) - 1
	n_outputs = len(set([row[-1] for row in train]))
	network = initialize_network(n_inputs, n_hidden, n_outputs)
	train_network(network, train, l_rate, n_epoch, n_outputs)
	predictions = list()
	for row in test:
		prediction = predict(network, row)
		predictions.append(prediction)
	return(predictions)

# Test Backprop on Seeds dataset
seed(1)
# load and prepare data
filename = 'seeds_dataset.csv'
dataset = load_csv(filename)
for i in range(len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# normalize input variables
minmax = dataset_minmax(dataset)
normalize_dataset(dataset, minmax)
# evaluate algorithm
n_folds = 5
l_rate = 0.3
n_epoch = 500
n_hidden = 5
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)
print('Scores: %s' % scores)
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-2">2</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-4">4</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-6">6</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-8">8</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-10">10</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-12">12</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-14">14</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-16">16</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-18">18</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-20">20</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-22">22</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-24">24</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-26">26</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-28">28</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-30">30</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-32">32</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-34">34</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-36">36</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-38">38</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-40">40</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-42">42</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-44">44</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-46">46</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-48">48</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-50">50</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-52">52</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-54">54</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-56">56</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-58">58</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-60">60</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-62">62</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-64">64</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-66">66</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-68">68</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-70">70</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-72">72</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-74">74</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-76">76</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-78">78</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-80">80</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-82">82</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-84">84</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-86">86</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-88">88</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-90">90</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-92">92</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-94">94</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-96">96</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-98">98</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-100">100</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-102">102</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-104">104</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-106">106</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-108">108</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-110">110</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-112">112</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-114">114</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-116">116</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-118">118</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-120">120</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-122">122</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-124">124</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-126">126</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-128">128</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-130">130</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-132">132</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-134">134</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-136">136</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-138">138</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-140">140</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-142">142</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-144">144</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-146">146</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-148">148</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-150">150</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-152">152</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-154">154</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-156">156</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-158">158</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-160">160</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-162">162</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-164">164</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-166">166</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-168">168</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-170">170</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-172">172</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-174">174</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-176">176</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-178">178</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-180">180</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-182">182</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-184">184</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-186">186</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-188">188</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-190">190</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-192">192</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-194">194</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-196">196</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaed5191638340-198">198</div><div class="crayon-num" data-line="crayon-5a659397eaed5191638340-199">199</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaed5191638340-1"><span class="crayon-p"># Backprop on the Seeds Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-4"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-5"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-8"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-9"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-10"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-11"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-12"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-15"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-16"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-18"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-19"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-20"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-21"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-22"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-24"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-25"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-26"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-27"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-28"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-30"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-31"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-32"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-33"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-34"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-35"><span class="crayon-p"># Find the min and max values for each column</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-36"><span class="crayon-e">def </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-37"><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-38"><span class="crayon-h"> </span><span class="crayon-v">stats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-39"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">stats</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-40"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-41"><span class="crayon-p"># Rescale dataset columns to the range 0-1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-42"><span class="crayon-e">def </span><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-44"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-45"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-46"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-47"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-48"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-49"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-50"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-51"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-52"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-53"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-54"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-55"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-56"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-57"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-58"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-59"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-60"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-61"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-62"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-63"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-64"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-65"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-66"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-67"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-68"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-69"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-70"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-71"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-72"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-73"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-74"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-75"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-76"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-77"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-78"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-79"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-80"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-81"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-82"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-83"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-84"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-85"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-86"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-87"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-88"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-89"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-90"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-91"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-92"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-93"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-94"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-95"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-96"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-97"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-98"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-99"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-100"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-101"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-102"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-103"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-104"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-105"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-106"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-107"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-108"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-109"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-110"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-111"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-112"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-113"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-114"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-115"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-116"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-117"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-118"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-119"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-120"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-121"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-122"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-123"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-124"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-125"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-126"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-127"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-128"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-129"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-130"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-131"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-132"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-133"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-134"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-135"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-136"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-137"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-138"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-139"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-140"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-141"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-142"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-143"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-144"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-145"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-146"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-147"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-148"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-149"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-150"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-151"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-152"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-153"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-154"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-155"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-156"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-157"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-158"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-159"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-160"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-161"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-162"> </div><div class="crayon-line" id="crayon-5a659397eaed5191638340-163"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-164"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-165"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-166"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-167"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-168"><span class="crayon-p"># Backpropagation Algorithm With Stochastic Gradient Descent</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-169"><span class="crayon-e">def </span><span class="crayon-e">back_propagation</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-170"><span class="crayon-h"> </span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-171"><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-172"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-173"><span class="crayon-h"> </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-174"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-175"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-176"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-177"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-178"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-179"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-180"><span class="crayon-p"># Test Backprop on Seeds dataset</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-181"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-182"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-183"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'seeds_dataset.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-184"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-185"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-186"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-187"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-188"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-189"><span class="crayon-p"># normalize input variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-190"><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-191"><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-192"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-193"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-194"><span class="crayon-v">l_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-195"><span class="crayon-v">n_epoch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-196"><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-197"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">back_propagation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaed5191638340-198"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eaed5191638340-199"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0154 seconds] -->
<p>A network with 5 neurons in the hidden layer and 3 neurons in the output layer was constructed. The network was trained for 500 epochs with a learning rate of 0.3. These parameters were found with a little trial and error, but you may be able to do much better.</p>
<p>Running the example prints the average classification accuracy on each fold as well as the average performance across all folds.</p>
<p>You can see that backpropagation and the chosen configuration achieved a mean classification accuracy of 95.238% which is dramatically better than the Zero Rule algorithm that did slightly better than 28.095% accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eaedd443135030" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Scores: [95.23809523809523, 97.61904761904762, 95.23809523809523, 92.85714285714286, 95.23809523809523]
Mean Accuracy: 95.238%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eaedd443135030-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eaedd443135030-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eaedd443135030-1">Scores: [95.23809523809523, 97.61904761904762, 95.23809523809523, 92.85714285714286, 95.23809523809523]</div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eaedd443135030-2">Mean Accuracy: 95.238%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Algorithm Parameters</strong>. Try larger or smaller networks trained for longer or shorter. See if you can get better performance on the seeds dataset.</li>
<li><strong>Additional Methods</strong>. Experiment with different weight initialization techniques (such as small random numbers) and different transfer functions (such as tanh).</li>
<li><strong>More Layers</strong>. Add support for more hidden layers, trained in just the same way as the one hidden layer used in this tutorial.</li>
<li><strong>Regression</strong>. Change the network so that there is only one neuron in the output layer and that a real value is predicted. Pick a regression dataset to practice on. A linear transfer function could be used for neurons in the output layer, or the output values of the chosen dataset could be scaled to values between 0 and 1.</li>
<li><strong>Batch Gradient Descent</strong>. Change the training procedure from online to batch gradient descent and update the weights only at the end of each epoch.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the Backpropagation algorithm from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to forward propagate an input to calculate a network output.</li>
<li>How to back propagate error and update network weights.</li>
<li>How to apply the backpropagation algorithm to a real world dataset.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/&amp;summary=The+backpropagation+algorithm+is+the+classical+feed-forward+artificial+neural+network.%0D%0A%0D%0AIt+is+the+..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20the%20Backpropagation%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/&amp;summary=The+backpropagation+algorithm+is+the+classical+feed-forward+artificial+neural+network.%0D%0A%0D%0AIt+is+the+...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Implement Learning Vector Quantization From Scratch With Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="next">How To Implement The Decision Tree Algorithm From Scratch In Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">229 Responses to <em>How to Implement the Backpropagation Algorithm From Scratch In Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-369793">
<div class="comment-container" id="li-comment-369793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7f661305b54a2c0f68f8faa81007e23?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7f661305b54a2c0f68f8faa81007e23?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.facebook.com/talkdatatome/" rel="external nofollow">Talk Data To Me</a></span>
<span class="date">November 7, 2016 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That’s what I was looking for. Write a neural network without any libraries (scikit, keras etc.) Thnak you very much!</p>
<div class="reply">
<a aria-label="Reply to Talk Data To Me" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=369793#respond" onclick='return addComment.moveForm( "comment-369793", "369793", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369865">
<div class="comment-container" id="li-comment-369865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear it!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=369865#respond" onclick='return addComment.moveForm( "comment-369865", "369865", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-369860">
<div class="comment-container" id="li-comment-369860">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da4244fdf35bb00ddf81b5953121443a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da4244fdf35bb00ddf81b5953121443a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MO</span>
<span class="date">November 8, 2016 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369860" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>where can i see your data set, i want to see how it looked like</p>
<div class="reply">
<a aria-label="Reply to MO" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=369860#respond" onclick='return addComment.moveForm( "comment-369860", "369860", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369876">
<div class="comment-container" id="li-comment-369876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi MO.</p>
<p>The small contrived dataset used for testing is listed inline in the post in section 4.2</p>
<p>The dataset used for the full example is on the UCI ML repository, linked in the section titled “Wheat Seeds Dataset”. Here is the direct link:<br/>
<a href="http://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow">http://archive.ics.uci.edu/ml/datasets/seeds</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=369876#respond" onclick='return addComment.moveForm( "comment-369876", "369876", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370232">
<div class="comment-container" id="li-comment-370232">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa64e188d54ba89fd88ee384a0591548?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa64e188d54ba89fd88ee384a0591548?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">prakash</span>
<span class="date">November 11, 2016 at 12:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370232" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>in two class classification for 0 the expected value is [1,0] for 1 its is [0,1].<br/>
how will be the output vectors for more than two class??</p>
<div class="reply">
<a aria-label="Reply to prakash" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370232#respond" onclick='return addComment.moveForm( "comment-370232", "370232", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370268">
<div class="comment-container" id="li-comment-370268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2016 at 10:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi prakash,</p>
<p>For multi-class classification, we can extend the one hot encoding.</p>
<p>Three class values for “red”, “green” “blue” can be represented as an output vector like:<br/>
1, 0, 0 for red<br/>
0, 1, 0 for green<br/>
0, 0, 1 for blue</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370268#respond" onclick='return addComment.moveForm( "comment-370268", "370268", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-370436">
<div class="comment-container" id="li-comment-370436">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05d3a6b3db274552359f0329beacfeb6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05d3a6b3db274552359f0329beacfeb6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rakesh</span>
<span class="date">November 13, 2016 at 3:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370436" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason.<br/>
You’ve mentioned that there are 3 output classes.<br/>
How do we check the values which come under the 3 classes / clusters?<br/>
Could we print the data which fall under each class?</p>
<div class="reply">
<a aria-label="Reply to Rakesh" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370436#respond" onclick='return addComment.moveForm( "comment-370436", "370436", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370498">
<div class="comment-container" id="li-comment-370498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2016 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Rakesh,</p>
<p>The data does belong to 3 classes. We can check the skill of our model by comparing the predicted classes to the actual/expected classes and calculate an accuracy measure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370498#respond" onclick='return addComment.moveForm( "comment-370498", "370498", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370823">
<div class="comment-container" id="li-comment-370823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 16, 2016 at 12:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m confused why the activation method iterates from 0 to len(inputs) – 1 instead of from 0 to len(weights) – 1. Am I missing something?</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370823#respond" onclick='return addComment.moveForm( "comment-370823", "370823", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370925">
<div class="comment-container" id="li-comment-370925">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2016 at 9:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370925" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Alex,</p>
<p>The length of weights is the length of the input + 1 (to accommodate the bias term).</p>
<p>We add the bias term first, then we add the weighted inputs. This is why we iterate over input values.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370925#respond" onclick='return addComment.moveForm( "comment-370925", "370925", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-370953">
<div class="comment-container" id="li-comment-370953">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 17, 2016 at 12:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370953" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I step through the code above for the ‘forward_propagate’ test case, I see the code correctly generate the output for the single hidden node but that output doesn’t get correctly processed when determining the outputs for the output layer. As written above in the activate function ‘for i in range(len(inputs)-1):’, when the calculation gets to the activate function for the output node for class=0, since ‘inputs’ has a single element in it (the output from the single hidden node), ‘len(inputs) – 1’ equals 0 so the for loop never executes. I’m assuming the code is supposed to read ‘for i in range(len(weights) -1):’ Does that make sense?</p>
<p>I’m just trying to make sure I don’t fundamentally misunderstand something and improve this post for other readers. This site has been really, really helpful for me.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=370953#respond" onclick='return addComment.moveForm( "comment-370953", "370953", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371044">
<div class="comment-container" id="li-comment-371044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2016 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m with you now, thanks for helping me catch-up. </p>
<p>Nice spot. I’ll fix up the tutorial.</p>
<p>Update: Fixed. Thanks again mate!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=371044#respond" onclick='return addComment.moveForm( "comment-371044", "371044", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-371350">
<div class="comment-container" id="li-comment-371350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomasz Panek</span>
<span class="date">November 21, 2016 at 1:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p># Update network weights with error<br/>
def update_weights(network, row, l_rate):<br/>
	for i in range(len(network)):<br/>
		inputs = row<br/>
		if i != 0:<br/>
			inputs = [neuron[‘output’] for neuron in network[i – 1]]<br/>
		for neuron in network[i]:<br/>
			for j in range(len(inputs)-1):<br/>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br/>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>In this fragment:<br/>
			for j in range(len(inputs)-1):<br/>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br/>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>If inputs length = 1, you are not updating weights, it’s correct? You are updating only bias, because in hidden layer is only one neuron.</p>
<div class="reply">
<a aria-label="Reply to Tomasz Panek" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=371350#respond" onclick='return addComment.moveForm( "comment-371350", "371350", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-371352">
<div class="comment-container" id="li-comment-371352">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomasz</span>
<span class="date">November 21, 2016 at 1:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371352" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello. In method update_weight you are doing for j in range(len(inputs) – 1). If inputs lenght = 1, you aren’t updating weights. It’s correct? Hidden layer have one neuron so in output layer weights aren’t updated</p>
<div class="reply">
<a aria-label="Reply to Tomasz" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=371352#respond" onclick='return addComment.moveForm( "comment-371352", "371352", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371489">
<div class="comment-container" id="li-comment-371489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2016 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Tomasz, </p>
<p>The assumption here is that the input vector always contains at least one input value and an output value, even if the output is set to None.</p>
<p>You may have found a bug though when updating the layers. I’ll investigate and get back to you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=371489#respond" onclick='return addComment.moveForm( "comment-371489", "371489", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-379663">
<div class="comment-container" id="li-comment-379663">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-379663" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Tomasz, this was indeed a bug.</p>
<p>I have updated the update_weights() function in the above code examples.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=379663#respond" onclick='return addComment.moveForm( "comment-379663", "379663", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-374990">
<div class="comment-container" id="li-comment-374990">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">December 13, 2016 at 4:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-374990" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thanks for the tutorial, I’m doing a backpropagation project at the moment so its been really useful. </p>
<p>I was a little confused on the back-propagation error calculation function. Does “if i != len(network)-1:” mean that if the current layer isn’t the output layer then this following code is run or does it mean that the current layer is an output layer?</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=374990#respond" onclick='return addComment.moveForm( "comment-374990", "374990", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375013">
<div class="comment-container" id="li-comment-375013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2016 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-375013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Michael.</p>
<p>The line means if the index i is not equal to the index of the last layer of the network (the output layer), then run code inside the block.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=375013#respond" onclick='return addComment.moveForm( "comment-375013", "375013", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-380227">
<div class="comment-container" id="li-comment-380227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">January 5, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have another question.<br/>
Would it be possible to extend the code from this tutorial and create a network that trains using the MNIST handwritten digit set? using a input unit to represent each pixel in the image. I’m also not sure whether/how I could use feature extractors for the images.</p>
<p>I have a project where I have to implement the Backpropagation algorithm with possibly the MNIST handwritten digit training set. </p>
<p>I hope my question makes sense!</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=380227#respond" onclick='return addComment.moveForm( "comment-380227", "380227", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-380268">
<div class="comment-container" id="li-comment-380268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure Michael, but I would recommend using a library like Keras instead as this code is not written for performance.</p>
<p>Load an image as a long list of pixel integer values, convert to floats and away you go. No feature extraction needed for a simple MLP implementation. You should get performance above 90%.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=380268#respond" onclick='return addComment.moveForm( "comment-380268", "380268", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-380650">
<div class="comment-container" id="li-comment-380650">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Calin</span>
<span class="date">January 6, 2017 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380650" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great post!</p>
<p>I have a concern though:</p>
<p>In train_network method there are these two lines of code:</p>
<p>expected = [0 for i in range(n_outputs)]<br/>
expected[row[-1]] = 1</p>
<p>Couldn’t be the case that expected[row[-1]] = 1 will throw IndexError, as n_outputs is the size of the training set which is a subset of the dataset and row basically contains values from the whole dataset?</p>
<div class="reply">
<a aria-label="Reply to Calin" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=380650#respond" onclick='return addComment.moveForm( "comment-380650", "380650", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-380745">
<div class="comment-container" id="li-comment-380745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 7, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Calin,</p>
<p>If I understand you correctly, No. The n_outputs var is the length of the number of possible output values.</p>
<p>Maybe put some print() statements in to help you better understand what values variables have.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=380745#respond" onclick='return addComment.moveForm( "comment-380745", "380745", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-380871">
<div class="comment-container" id="li-comment-380871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Calin</span>
<span class="date">January 7, 2017 at 9:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hmm..I ran the entire code (with the csv file downloaded from <a href="http://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow">http://archive.ics.uci.edu/ml/datasets/seeds</a>), added some breakpoints and this is what I got after a few iterations:</p>
<p>n_outputs  = 168<br/>
row[-1] = 201</p>
<p>which is causing IndexError: list assignment index out of range.</p>
<div class="reply">
<a aria-label="Reply to Calin" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=380871#respond" onclick='return addComment.moveForm( "comment-380871", "380871", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-381390">
<div class="comment-container" id="li-comment-381390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adriaan</span>
<span class="date">January 11, 2017 at 4:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ve got the same error, That my list assignment index is out of range</p>
<div class="reply">
<a aria-label="Reply to Adriaan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381390#respond" onclick='return addComment.moveForm( "comment-381390", "381390", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-381425">
<div class="comment-container" id="li-comment-381425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 11, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, did you try running the updated code?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-382373">
<div class="comment-container" id="li-comment-382373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c75c4ffacd0596bbc93dfd651e247031?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c75c4ffacd0596bbc93dfd651e247031?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ivan</span>
<span class="date">January 16, 2017 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is error of csv read. Try to reformat it with commas. For me it worked</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-382386">
<div class="comment-container" id="li-comment-382386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 16, 2017 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What was the problem and fix exactly Ivan?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-386073">
<div class="comment-container" id="li-comment-386073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5f1007e2bd7d86e697779ce73d978fd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5f1007e2bd7d86e697779ce73d978fd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bob</span>
<span class="date">February 5, 2017 at 10:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The data file (<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt" rel="nofollow">http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt</a>) has a few lines with double tabs (\t\t) as the delimiter — removing the double tabs and changing tabs to commas fixed it.</p>
<p>Thanks for the good article.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-386187">
<div class="comment-container" id="li-comment-386187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the note Bob.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-381397">
<div class="comment-container" id="li-comment-381397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adriaan</span>
<span class="date">January 11, 2017 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ve had the same error at the ‘train_network’ function. Is your dataset fine? I’ve had some problems because the CSV file wasn’t loaded correctly due to my regional windows settings. I’ve had to adjust my settings and everything worked out alright. </p>
<p><a href="http://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead" rel="nofollow">http://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead</a></p>
<div class="reply">
<a aria-label="Reply to Adriaan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381397#respond" onclick='return addComment.moveForm( "comment-381397", "381397", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-381009">
<div class="comment-container" id="li-comment-381009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa1374086d343aae43a869f23438e00d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa1374086d343aae43a869f23438e00d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stanley</span>
<span class="date">January 8, 2017 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for such a good article. </p>
<p>Just one question: in the equation “weight = weight + learning_rate * error * input”, why there is an “input”? IMO it should be: “weight = weight + learning_rate * error”?</p>
<div class="reply">
<a aria-label="Reply to Stanley" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381009#respond" onclick='return addComment.moveForm( "comment-381009", "381009", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381130">
<div class="comment-container" id="li-comment-381130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The var names and explanation are correct.</p>
<p>The update equation is:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397f1803140350282" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
weight = weight + learning_rate * error * input</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397f1803140350282-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397f1803140350282-1"><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">learning_rate *</span><span class="crayon-h"> </span><span class="crayon-e ">error *</span><span class="crayon-h"> </span><span class="crayon-v">input</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>For the input layer the input are the input data, for hidden layers the input is the output of the prior layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381130#respond" onclick='return addComment.moveForm( "comment-381130", "381130", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-381762">
<div class="comment-container" id="li-comment-381762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6aa4516178a87bb39c050f8b940057c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6aa4516178a87bb39c050f8b940057c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Madwadasa</span>
<span class="date">January 13, 2017 at 3:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>           Thanks for the code and post.<br/>
Why is “expected”  in expected = [0 for i in range(n_outputs)]  initialized to  [0,0] ?<br/>
Should not the o/p values be taken as expected when training the model ?<br/>
i.e for example in case of Xor should not 1 be taken as the expected ?</p>
<div class="reply">
<a aria-label="Reply to Madwadasa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381762#respond" onclick='return addComment.moveForm( "comment-381762", "381762", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381810">
<div class="comment-container" id="li-comment-381810">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2017 at 9:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381810" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Madwadasa,</p>
<p>Expected is a one-hot encoding. All classes are “0” expect the actual class for the row which is marked as a “1” on the next line.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=381810#respond" onclick='return addComment.moveForm( "comment-381810", "381810", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-382858">
<div class="comment-container" id="li-comment-382858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">January 19, 2017 at 3:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I have a couple more questions. When training the network with a dataset, does the error at each epoch indicate the distance between the predicted outcomes and the expected outcomes together for the whole dataset? Also when the mean accuracy is given in my case being 13% when I used the MNIST digit set, does this mean that the network will be correct 13% of the time and would have an error rate of 87%?</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=382858#respond" onclick='return addComment.moveForm( "comment-382858", "382858", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-382900">
<div class="comment-container" id="li-comment-382900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Michael,</p>
<p>The epoch error does capture how wrong the algorithm is on all training data. This may or may not be a distance depending on the error measure used. RMSE is technically not a distance measure, you could use Euclidean distance if you like, but I would not recommend it.</p>
<p>Yes, in generally when the model makes predictions your understanding is correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=382900#respond" onclick='return addComment.moveForm( "comment-382900", "382900", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-383717">
<div class="comment-container" id="li-comment-383717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9840a8441afca615aaa5f7234692111b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9840a8441afca615aaa5f7234692111b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bernardo Galvão</span>
<span class="date">January 24, 2017 at 3:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-383717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>in the excerpt regarding error of a neuron in a hidden layer:</p>
<p>“Where error_j is the error signal from the jth neuron in the output layer, weight_k is the weight that connects the kth neuron to the current neuron and output is the output for the current neuron.”</p>
<p>is the k-th neuron a neuron in the output layer or a neuron in the hidden layer we’re “on”? What about the current neuron, are you referring to the neuron in the output layer? Sorry, english is not my native tongue.</p>
<p>Appreciate your work!</p>
<p>Bernardo</p>
<div class="reply">
<a aria-label="Reply to Bernardo Galvão" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=383717#respond" onclick='return addComment.moveForm( "comment-383717", "383717", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385291">
<div class="comment-container" id="li-comment-385291">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/403b88a973dc51dc9ef64bbae6c0e28e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/403b88a973dc51dc9ef64bbae6c0e28e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">anonymous</span>
<span class="date">February 1, 2017 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385291" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It would have been better if recall and precision were printed. Can somebody tell me how to print them in the above code.</p>
<div class="reply">
<a aria-label="Reply to anonymous" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=385291#respond" onclick='return addComment.moveForm( "comment-385291", "385291", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385423">
<div class="comment-container" id="li-comment-385423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about precision and recall here:<br/>
<a href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="nofollow">https://en.wikipedia.org/wiki/Precision_and_recall</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=385423#respond" onclick='return addComment.moveForm( "comment-385423", "385423", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386259">
<div class="comment-container" id="li-comment-386259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7592c1dd8cb9f45f6b1d89412534feb5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7592c1dd8cb9f45f6b1d89412534feb5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kehinde kolade</span>
<span class="date">February 6, 2017 at 8:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, great tutorial, I am developer and I do not really know much about this machine learning thing but I need to extend this your code to incorporate the Momentum aspect to the training, can you please explain how I can achieve this extension?</p>
<div class="reply">
<a aria-label="Reply to kehinde kolade" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=386259#respond" onclick='return addComment.moveForm( "comment-386259", "386259", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-386365">
<div class="comment-container" id="li-comment-386365">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 7, 2017 at 10:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386365" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have the capacity to write or spell out this change for you.</p>
<p>My advice would be to read a good book on the topic, such as Neural Smithing: <a href="http://amzn.to/2ld9ds0" rel="nofollow">http://amzn.to/2ld9ds0</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=386365#respond" onclick='return addComment.moveForm( "comment-386365", "386365", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-388719">
<div class="comment-container" id="li-comment-388719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8aa40a517f98cb5534e0e6dc6f83cc0b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8aa40a517f98cb5534e0e6dc6f83cc0b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ibrahim</span>
<span class="date">February 18, 2017 at 2:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have my own code written in C++, which works similar to your code. My intention is to extend my code to convolutional deep neural nets, and i have actually written the convolution, Relu and pooling functions however i could not begin to apply the backpropagation i have used in my shallow neural net, to the convolutional deep net, cause i really cant imagine the transition of the backpropagation calculation between the convolutional layers and the standard shallow layers existing in the same system. I hoped to find a source for this issue however i always come to the point that there is a standard backpropagation algorithm given for shallow nets that i applied already. Can you please guide me on this problem?</p>
<div class="reply">
<a aria-label="Reply to ibrahim" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=388719#respond" onclick='return addComment.moveForm( "comment-388719", "388719", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-388796">
<div class="comment-container" id="li-comment-388796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 18, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I”d love to guide you but I don’t have my own from scratch implementation of CNNs, sorry. I’m not best placed to help at the moment.</p>
<p>I’d recommend reading code from existing open source implementations.</p>
<p>Good luck with your project.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=388796#respond" onclick='return addComment.moveForm( "comment-388796", "388796", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389517">
<div class="comment-container" id="li-comment-389517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e12ea245a7de8e243d4972c06c1df332?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e12ea245a7de8e243d4972c06c1df332?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://cingkleung.com" rel="external nofollow">matias</a></span>
<span class="date">February 22, 2017 at 3:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, I was looking for exactly this kind of ann algorith. A simple thank won’t be enough tho lol</p>
<div class="reply">
<a aria-label="Reply to matias" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=389517#respond" onclick='return addComment.moveForm( "comment-389517", "389517", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-389639">
<div class="comment-container" id="li-comment-389639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 23, 2017 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<p>The best way to help is to share the post with other people, or maybe purchase one of my books to support my ongoing work:<br/>
<a href="http://machinelearningmastery.com/products" rel="nofollow">http://machinelearningmastery.com/products</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=389639#respond" onclick='return addComment.moveForm( "comment-389639", "389639", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-390209">
<div class="comment-container" id="li-comment-390209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manohar Katam</span>
<span class="date">February 26, 2017 at 3:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great one! .. I have one doubt .. the dataset seeds contains missing features/fields for some rows.. how you are handling that …</p>
<div class="reply">
<a aria-label="Reply to Manohar Katam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390209#respond" onclick='return addComment.moveForm( "comment-390209", "390209", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390313">
<div class="comment-container" id="li-comment-390313">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390313" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could set the missing values to 0, you could remove the rows with missing values, you could impute the missing values with mean column values, etc.</p>
<p>Try a few different methods and see what results in the best performing models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390313#respond" onclick='return addComment.moveForm( "comment-390313", "390313", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-390756">
<div class="comment-container" id="li-comment-390756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manohar Katam</span>
<span class="date">March 1, 2017 at 2:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What if I have canonical forms like “male” or “female” in my dataset… Will this program work even with string data..</p>
<div class="reply">
<a aria-label="Reply to Manohar Katam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390756#respond" onclick='return addComment.moveForm( "comment-390756", "390756", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-390866">
<div class="comment-container" id="li-comment-390866">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2017 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390866" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Manohar,</p>
<p>No, you will need to convert them to integers (integer encoding) or similar.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390866#respond" onclick='return addComment.moveForm( "comment-390866", "390866", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390434">
<div class="comment-container" id="li-comment-390434">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa831d998404b4907410de6085d69ba2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa831d998404b4907410de6085d69ba2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wissal ARGOUBI</span>
<span class="date">February 27, 2017 at 11:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390434" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great job! this is what i was looking for ! thank you very much .<br/>
However i already have a data base and i didn’t know how to make it work with this code how can i adapt it on my data<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Wissal ARGOUBI" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390434#respond" onclick='return addComment.moveForm( "comment-390434", "390434", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390485">
<div class="comment-container" id="li-comment-390485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 28, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your predictive modeling problem:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=390485#respond" onclick='return addComment.moveForm( "comment-390485", "390485", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-391271">
<div class="comment-container" id="li-comment-391271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bbdf9cfbf33951aaf35751f379d1fd84?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bbdf9cfbf33951aaf35751f379d1fd84?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shweta Gupta</span>
<span class="date">March 5, 2017 at 4:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for such a great article..<br/>
I have one question, in update_weights why you have used weight=weight+l_rate*delta*input rather than weight=weight+l_rate*delta?</p>
<div class="reply">
<a aria-label="Reply to Shweta Gupta" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=391271#respond" onclick='return addComment.moveForm( "comment-391271", "391271", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-391461">
<div class="comment-container" id="li-comment-391461">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2017 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391461" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about the math in the book on the topic. </p>
<p>I recommend Neural Smithing: <a href="http://amzn.to/2ld9ds0" rel="nofollow">http://amzn.to/2ld9ds0</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=391461#respond" onclick='return addComment.moveForm( "comment-391461", "391461", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392458">
<div class="comment-container" id="li-comment-392458">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a025e68c7374439da69e52541bef6625?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a025e68c7374439da69e52541bef6625?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sittha</span>
<span class="date">March 13, 2017 at 1:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392458" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for a good tutorial.<br/>
I have some  IndexError: list assignment index out of range. And I cannot fix it with comma or full-stop separator.</p>
<div class="reply">
<a aria-label="Reply to Sittha" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=392458#respond" onclick='return addComment.moveForm( "comment-392458", "392458", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-392571">
<div class="comment-container" id="li-comment-392571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the full error you are getting?</p>
<p>Did you copy-paste the full final example and run it on the same dataset?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=392571#respond" onclick='return addComment.moveForm( "comment-392571", "392571", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-393944">
<div class="comment-container" id="li-comment-393944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c2a8dcd39c95bf5660785a37f988adc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c2a8dcd39c95bf5660785a37f988adc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sittha</span>
<span class="date">March 24, 2017 at 3:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>line 151 :<br/>
expected[row[-1]] = 1<br/>
IndexError : list assignment  index out of range</p>
<div class="reply">
<a aria-label="Reply to Sittha" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=393944#respond" onclick='return addComment.moveForm( "comment-393944", "393944", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-393980">
<div class="comment-container" id="li-comment-393980">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393980" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is this with a different dataset?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=393980#respond" onclick='return addComment.moveForm( "comment-393980", "393980", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-399327">
<div class="comment-container" id="li-comment-399327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92af1d38e899cd89b71d01c566b67cd0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92af1d38e899cd89b71d01c566b67cd0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benji Weiss</span>
<span class="date">May 11, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>if it is a different dataset, what do i need to do to not get this error</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-392903">
<div class="comment-container" id="li-comment-392903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 16, 2017 at 6:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The dataset that was given was for training the network. Now how do we test the network by providing the 7 features without giving the class label(1,2 or 3) ?</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=392903#respond" onclick='return addComment.moveForm( "comment-392903", "392903", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392984">
<div class="comment-container" id="li-comment-392984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 17, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will have to adapt the example to fit the model on all of the training data, then you can call predict() to make predictions on new data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=392984#respond" onclick='return addComment.moveForm( "comment-392984", "392984", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-393320">
<div class="comment-container" id="li-comment-393320">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 19, 2017 at 7:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393320" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok Jason, i’ll try that and get back to you! Thank you!</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=393320#respond" onclick='return addComment.moveForm( "comment-393320", "393320", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393321">
<div class="comment-container" id="li-comment-393321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 19, 2017 at 7:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just a suggestion for the people who would be using their own dataset(not the seeds_dataset) for training their network, make sure you add an IF loop as follows before the 45th line :<br/>
if minmax[i][1]!=minmax[i][0]</p>
<p>This is because your own dataset might contain same values in the same column and that might cause a divide by zero error.</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=393321#respond" onclick='return addComment.moveForm( "comment-393321", "393321", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393371">
<div class="comment-container" id="li-comment-393371">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 20, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393371" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tip Karan.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=393371#respond" onclick='return addComment.moveForm( "comment-393371", "393371", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394130">
<div class="comment-container" id="li-comment-394130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://liquntang.wordpress.com/" rel="external nofollow">Li Qun</a></span>
<span class="date">March 25, 2017 at 5:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks jason for the amazing posts of your from scratch pyhton implementations! i have learned so much from you!</p>
<p>I have followed through both your naive bayes and backprop posts, and I have a (perhaps quite naive) question: </p>
<p>what is the relationship between the two? did backprop actually implement bayesian inference (after all, what i understand is that bayesian = weights being updated every cycle) already? perhaps just non-gaussian? so.. are non-gaussian PDF weight updates not bayesian inference?</p>
<p>i guess to put it simply : is backpropagation essentially a bayesian inference loop for an n number of epochs?</p>
<p>I came from the naive bayes tutorial wanting to implement backpropagation together with your naive bayes implementation but got a bit lost along the way.</p>
<p>sorry if i was going around in circles, i sincerely hope someone would be able to at least point me on the right direction.</p>
<div class="reply">
<a aria-label="Reply to Li Qun" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394130#respond" onclick='return addComment.moveForm( "comment-394130", "394130", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394185">
<div class="comment-container" id="li-comment-394185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 26, 2017 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>No, they are both very different. Naive bayes is a direct use of the probabilities and bayes theorem. The neural net is approximating a mapping function from inputs and outputs – a very different approach that does not directly use the joint probability.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394185#respond" onclick='return addComment.moveForm( "comment-394185", "394185", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394245">
<div class="comment-container" id="li-comment-394245">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80c8454bf99969c638d56da27d2e546c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80c8454bf99969c638d56da27d2e546c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiraag</span>
<span class="date">March 26, 2017 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394245" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How did you decide that the number of folds will be 5 ? Could you please explain the significance of this number. Thank You.</p>
<div class="reply">
<a aria-label="Reply to Chiraag" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394245#respond" onclick='return addComment.moveForm( "comment-394245", "394245", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394290">
<div class="comment-container" id="li-comment-394290">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394290" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In this case, it was pretty arbitary.</p>
<p>Generally, you want to split the data so that each fold is representative of the dataset. The objective measure is how closely the mean performance reflect the actual performance of the model on unseen data. We can only estimate this in practice (standard error?).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394290#respond" onclick='return addComment.moveForm( "comment-394290", "394290", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394355">
<div class="comment-container" id="li-comment-394355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://liquntang.wordpress.com/" rel="external nofollow">Li Qun</a></span>
<span class="date">March 27, 2017 at 10:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>thank you for the reply! I read up a bit more about the differences between Naive Bayes (or Bayesian Nets in general) and Neural Networks and found this Quora answer that i thought was very clear. I’ll put it up here to give other readers a good point to go from: </p>
<p><a href="https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network" rel="nofollow">https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network</a></p>
<p>TL:DR :<br/>
– they look the same, but every node in a Bayesian Network has meaning, in that you can read a Bayesian network structure (like a mind map) and see what’s happening where and why.<br/>
– a Neural Network structure doesn’t have explicit meaning, its just dots that link previous dots.<br/>
– there are more reasons, but the above two highlighted the biggest difference.</p>
<p>Just a quick guess after playing around with backpropagation a little: the way NB and backprop NN would work together is by running Naive Bayes to get a good ‘first guess’ of initial weights that are then run through and Neural Network and Backpropagated?</p>
<div class="reply">
<a aria-label="Reply to Li Qun" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394355#respond" onclick='return addComment.moveForm( "comment-394355", "394355", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394407">
<div class="comment-container" id="li-comment-394407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please note that a Bayesian network and naive bayes are very different algorithms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394407#respond" onclick='return addComment.moveForm( "comment-394407", "394407", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394359">
<div class="comment-container" id="li-comment-394359">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melissa</span>
<span class="date">March 27, 2017 at 10:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394359" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Further to this update:</p>
<p> Update Jan/2017: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</p>
<p>I’m still having this same problem whilst using python 3, on both the seeds data set and my own. It returns an error at line 75 saying ‘list object has no attribute ‘sum” and also saying than ‘an integer is required.’</p>
<p>Any help would be very much appreciated.<br/>
Overall this code is very helpful. Thank you!</p>
<div class="reply">
<a aria-label="Reply to Melissa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394359#respond" onclick='return addComment.moveForm( "comment-394359", "394359", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394408">
<div class="comment-container" id="li-comment-394408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, did you try copy-paste the complete working example from the end of the post and run it on the same dataset from the command line?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394408#respond" onclick='return addComment.moveForm( "comment-394408", "394408", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-394418">
<div class="comment-container" id="li-comment-394418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melissa</span>
<span class="date">March 28, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I’ve done that, but still the same problem!</p>
<div class="reply">
<a aria-label="Reply to Melissa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394418#respond" onclick='return addComment.moveForm( "comment-394418", "394418", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394538">
<div class="comment-container" id="li-comment-394538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38ac56634f0c251e5dbf113ab668fb35?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38ac56634f0c251e5dbf113ab668fb35?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">david</span>
<span class="date">March 29, 2017 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello jason,</p>
<p>please i need help on how to pass the output of the trained network into a fuzzy logic system if possible a code or link which can help understand better. Thank you</p>
<div class="reply">
<a aria-label="Reply to david" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=394538#respond" onclick='return addComment.moveForm( "comment-394538", "394538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395134">
<div class="comment-container" id="li-comment-395134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/27234cc290919180762b7218c7be4893?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/27234cc290919180762b7218c7be4893?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aditya</span>
<span class="date">April 2, 2017 at 3:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome Explanation</p>
<div class="reply">
<a aria-label="Reply to Aditya" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395134#respond" onclick='return addComment.moveForm( "comment-395134", "395134", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395321">
<div class="comment-container" id="li-comment-395321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395321#respond" onclick='return addComment.moveForm( "comment-395321", "395321", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395516">
<div class="comment-container" id="li-comment-395516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e2a3c6d3d507b984c6c32865cfa727f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e2a3c6d3d507b984c6c32865cfa727f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Raunak Jain</span>
<span class="date">April 6, 2017 at 5:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason<br/>
I m getting list assignment index out or range error. How to handle this error?</p>
<div class="reply">
<a aria-label="Reply to Raunak Jain" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395516#respond" onclick='return addComment.moveForm( "comment-395516", "395516", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395789">
<div class="comment-container" id="li-comment-395789">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395789" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The example was developed for Python 2, perhaps this is Python version issue?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395789#respond" onclick='return addComment.moveForm( "comment-395789", "395789", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395538">
<div class="comment-container" id="li-comment-395538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51ffefd98dda8a19c7c8196cb75be6fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51ffefd98dda8a19c7c8196cb75be6fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">April 6, 2017 at 9:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks but I think python is not a good choice…</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395538#respond" onclick='return addComment.moveForm( "comment-395538", "395538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395796">
<div class="comment-container" id="li-comment-395796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think it is a good choice for learning how backprop works.</p>
<p>What would be a better choice?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395796#respond" onclick='return addComment.moveForm( "comment-395796", "395796", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395539">
<div class="comment-container" id="li-comment-395539">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/110197b76f8099b9dff15e9c0a0db52a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/110197b76f8099b9dff15e9c0a0db52a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Agrawal</span>
<span class="date">April 6, 2017 at 9:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395539" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey, Jason Thanks for this wonderful lecture on Neural Network.</p>
<p>As I am working on Iris Recognition, I have extracted the features of each eye and store it in .csv file, Can u suggest how further can I build my Backpropagation code.<br/>
As when I run your code I am getting many errors.<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Agrawal" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395539#respond" onclick='return addComment.moveForm( "comment-395539", "395539", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395797">
<div class="comment-container" id="li-comment-395797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your modeling problem:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395797#respond" onclick='return addComment.moveForm( "comment-395797", "395797", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395606">
<div class="comment-container" id="li-comment-395606">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63bd4d0145d8be1d9218724edb89cbfa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63bd4d0145d8be1d9218724edb89cbfa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">April 7, 2017 at 3:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395606" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you please convert this iterative implementation into matrix implementation?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395606#respond" onclick='return addComment.moveForm( "comment-395606", "395606", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395815">
<div class="comment-container" id="li-comment-395815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps in the future Jack.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=395815#respond" onclick='return addComment.moveForm( "comment-395815", "395815", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396152">
<div class="comment-container" id="li-comment-396152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jk</span>
<span class="date">April 12, 2017 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>In section 4.1 , may you please explain why you used ###  inputs = row[:-1] ###  ?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Jk" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396152#respond" onclick='return addComment.moveForm( "comment-396152", "396152", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396174">
<div class="comment-container" id="li-comment-396174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 12, 2017 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. By default we are back-propagating the error of the expected output vs the network output (inputs = row[:-1]), but if we are not the output layer, propagate the error from the previous layer in the network (inputs = [neuron[‘output’] for neuron in network[i – 1]]).</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396174#respond" onclick='return addComment.moveForm( "comment-396174", "396174", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-396257">
<div class="comment-container" id="li-comment-396257">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JK</span>
<span class="date">April 13, 2017 at 3:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396257" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your respond. I understand what you said , the part I am no understanding is the [:-1] . why eliminating the last list item ?</p>
<div class="reply">
<a aria-label="Reply to JK" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396257#respond" onclick='return addComment.moveForm( "comment-396257", "396257", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-396295">
<div class="comment-container" id="li-comment-396295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 10:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a range from 0 to the second last item in the list, e.g. (0 to n-1)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396295#respond" onclick='return addComment.moveForm( "comment-396295", "396295", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396220">
<div class="comment-container" id="li-comment-396220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prem Puri</span>
<span class="date">April 12, 2017 at 8:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In function call, def backward_propagate_error(network, expected):<br/>
 how much i understand is , it sequentially pass upto<br/>
if i != len(network)-1:<br/>
			for j in range(len(layer)):<br/>
				error = 0.0<br/>
				for neuron in network[i + 1]:<br/>
					error += (neuron[‘weights’][j] * neuron[‘delta’])<br/>
My question is which value is used in neuron[‘delta’]</p>
<div class="reply">
<a aria-label="Reply to Prem Puri" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396220#respond" onclick='return addComment.moveForm( "comment-396220", "396220", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396284">
<div class="comment-container" id="li-comment-396284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>delta is set in the previous code block. It is the error signal that is being propagated backward.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396284#respond" onclick='return addComment.moveForm( "comment-396284", "396284", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396366">
<div class="comment-container" id="li-comment-396366">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prem Puri</span>
<span class="date">April 14, 2017 at 3:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396366" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks very much!</p>
<div class="reply">
<a aria-label="Reply to Prem Puri" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396366#respond" onclick='return addComment.moveForm( "comment-396366", "396366", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396395">
<div class="comment-container" id="li-comment-396395">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 14, 2017 at 8:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396395" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=396395#respond" onclick='return addComment.moveForm( "comment-396395", "396395", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397669">
<div class="comment-container" id="li-comment-397669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">youssef oumate</span>
<span class="date">April 26, 2017 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason </p>
<p>Thank you very much for this awesome implementation of neural network,<br/>
I have a question for you : I want to replace the activation function from Sigmoid<br/>
to RELU . So, what are the changes that I should perform in order to get<br/>
correct predictions?</p>
<div class="reply">
<a aria-label="Reply to youssef oumate" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=397669#respond" onclick='return addComment.moveForm( "comment-397669", "397669", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397730">
<div class="comment-container" id="li-comment-397730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 27, 2017 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think just a change to the transfer() and transfer_derivative() functions will do the trick.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=397730#respond" onclick='return addComment.moveForm( "comment-397730", "397730", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-397752">
<div class="comment-container" id="li-comment-397752">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">youssef oumate</span>
<span class="date">April 27, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397752" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome !</p>
<p>Thank you so much</p>
<div class="reply">
<a aria-label="Reply to youssef oumate" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=397752#respond" onclick='return addComment.moveForm( "comment-397752", "397752", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-397833">
<div class="comment-container" id="li-comment-397833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=397833#respond" onclick='return addComment.moveForm( "comment-397833", "397833", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-398019">
<div class="comment-container" id="li-comment-398019">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">April 30, 2017 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398019" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you very much for this wonderful implementation of Neural Network, it really helped me a lot to understand neural networks concept,</p>
<p>n_inputs = len(dataset[0]) – 1<br/>
n_outputs = len(set([row[-1] for row in dataset]))<br/>
network = initialize_network(n_inputs, 2, n_outputs)<br/>
train_network(network, dataset, 0.5, 20, n_outputs)</p>
<p>What do n_inputs and n_outputs refer to? According to the small dataset used in this section, is n_inputs only 2 and n_outputs only 2 (0 or 1) or I am missing something?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398019#respond" onclick='return addComment.moveForm( "comment-398019", "398019", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398039">
<div class="comment-container" id="li-comment-398039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 30, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Input/outputs refers to the number of input and output features (columns) in your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398039#respond" onclick='return addComment.moveForm( "comment-398039", "398039", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-398392">
<div class="comment-container" id="li-comment-398392">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 3, 2017 at 1:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398392" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is the program training the network for 500 epochs for each one of the k-folds and then testing the network with the testing data set?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398392#respond" onclick='return addComment.moveForm( "comment-398392", "398392", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-398484">
<div class="comment-container" id="li-comment-398484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Yahya,</p>
<p>5-fold cross validation is used.</p>
<p>That means that 5 models are fit and evaluated on 5 different hold out sets. Each model is trained for 500 epochs.</p>
<p>I hope that makes things clearer Yahya.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398484#respond" onclick='return addComment.moveForm( "comment-398484", "398484", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-398496">
<div class="comment-container" id="li-comment-398496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 4, 2017 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes you made things clear to me, Thank you.<br/>
I have two other questions,<br/>
How to know when to stop training the network to avoid overfitting?<br/>
How to choose the number of neurons in the hidden layer?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398496#respond" onclick='return addComment.moveForm( "comment-398496", "398496", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-398571">
<div class="comment-container" id="li-comment-398571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use early stopping, to save network weights when the skill on a validation set stops improving.</p>
<p>The number of neurons can be found through trial and error.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-398753">
<div class="comment-container" id="li-comment-398753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 6, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am working on a program that recognizes handwritten digits, the dataset is consisting of pictures (45*45) pixels each, which is 2025 input neurons, this causes me a problem in the activation function, the summation of (weight[i] * input[i]) is big, then it gives me always a result of (0.99 -&gt; 1) after putting the value of the activation function in the Sigmoid function, any suggestions?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-398864">
<div class="comment-container" id="li-comment-398864">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 7, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398864" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a Convolutional Neural Network rather than a Multilayer Perceptron.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398029">
<div class="comment-container" id="li-comment-398029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92bd7933f25006410472c346379b36d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92bd7933f25006410472c346379b36d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">morok</span>
<span class="date">April 30, 2017 at 3:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In section 3.2. Error Backpropagation, where did output numbers came from for testing backpropagation</p>
<p>‘output’: 0.7105668883115941<br/>
‘output’: 0.6213859615555266<br/>
‘output’: 0.6573693455986976</p>
<p>Perhaps from outputs on test forward propagation [0.6629970129852887, 0.7253160725279748] taking dd -&gt; derivative = output * (1.0 – output), problem is they don’t match, so I’m a bit lost here…</p>
<p>thanks!</p>
<p>Awesome article!!!</p>
<div class="reply">
<a aria-label="Reply to morok" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398029#respond" onclick='return addComment.moveForm( "comment-398029", "398029", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398041">
<div class="comment-container" id="li-comment-398041">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 30, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398041" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In that example, the output and weights were contrived to test back propagation of error. Note the “delta” in those outputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=398041#respond" onclick='return addComment.moveForm( "comment-398041", "398041", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-421124">
<div class="comment-container" id="li-comment-421124">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Massa</span>
<span class="date">November 25, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421124" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Dr Jason…</p>
<p>I was wondering …</p>
<p>n_outputs = len(set([row[-1] for row in dataset]))</p>
<p>this line, how does it give the number of output features?<br/>
when I print it gives the number of the dataset(number of rows, not columns)</p>
<div class="reply">
<a aria-label="Reply to Massa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=421124#respond" onclick='return addComment.moveForm( "comment-421124", "421124", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-421146">
<div class="comment-container" id="li-comment-421146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The length of the set of values in the final column.</p>
<p>Perhaps this post will help with Python syntax:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=421146#respond" onclick='return addComment.moveForm( "comment-421146", "421146", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-421189">
<div class="comment-container" id="li-comment-421189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Massa</span>
<span class="date">November 26, 2017 at 4:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>but I thought it gives the number of outputs…I mean the number of neurons in the output layer.</p>
<p>here it’s giving the number of the dataset ….if I have 200 input/output pairs it prints 200</p>
<p>so I am confused…how would it be?</p>
<div class="reply">
<a aria-label="Reply to Massa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=421189#respond" onclick='return addComment.moveForm( "comment-421189", "421189", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-421205">
<div class="comment-container" id="li-comment-421205">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 26, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421205" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If there are two class values, it should print 2. It should not print the number of examples.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399034">
<div class="comment-container" id="li-comment-399034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bf0ef567a0b7edfe1a2924da1068804a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bf0ef567a0b7edfe1a2924da1068804a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Umamaheswaran</span>
<span class="date">May 8, 2017 at 9:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p> I am using the MNIST data set to implement a handwritten digit classifier. How many training examples will be needed to get a perfomance above 90%.</p>
<div class="reply">
<a aria-label="Reply to Umamaheswaran" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399034#respond" onclick='return addComment.moveForm( "comment-399034", "399034", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399092">
<div class="comment-container" id="li-comment-399092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2017 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a CNN on MNIST. See this tutorial:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399092#respond" onclick='return addComment.moveForm( "comment-399092", "399092", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-399149">
<div class="comment-container" id="li-comment-399149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huyen</span>
<span class="date">May 9, 2017 at 6:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Your blog is totally awesome not only by this post but also for the whole series about neural network. Some of them explained so much useful thing than others on Internet. They help me a lot to understand the core of network instead of applying directly Keras or Tensorflow.</p>
<p>Just one question, if I would like to change the result from classification to regression, which part in back propagation I need to change and how?</p>
<p>Thank you in advance for your answer</p>
<div class="reply">
<a aria-label="Reply to Huyen" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399149#respond" onclick='return addComment.moveForm( "comment-399149", "399149", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399253">
<div class="comment-container" id="li-comment-399253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Huyen.</p>
<p>You would change the activation function in the output layer to linear (e.g. no transform).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399253#respond" onclick='return addComment.moveForm( "comment-399253", "399253", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399412">
<div class="comment-container" id="li-comment-399412">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdbeeeaf0542e8d50c5e867c44074a2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdbeeeaf0542e8d50c5e867c44074a2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TGoritsky</span>
<span class="date">May 12, 2017 at 12:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399412" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am playing around with your code to better understand how the ANN works. Right now I am trying to do predictions with a NN, that is trained on my own dataset, but the program returns me one class label for all rows in a test dataset. I understand, that normalizing dataset should help, but it doesn`t work (I am using your minmax and normalize_dataset functions). Also, is there a way to return prediction for one-dimensional dataset?<br/>
Here is the code (sorry for lack of formatting):<br/>
def make_predictions():<br/>
    dataset = [[29,46,107,324,56,44,121,35,1],<br/>
            [29,46,109,327,51,37,123,38,1],<br/>
            [28,42,107,309,55,32,124,38,1],<br/>
            [40,112,287,59,35,121,36,1],<br/>
            [27,43,129,306,75,41,107,38,1],<br/>
            [28,38,127,289,79,40,109,37,1],<br/>
            [29,37,126,292,77,35,100,34,1],<br/>
            [30,40,87,48,77,51,272,80,2],<br/>
            [26,37,88,47,84,44,250,80,2],<br/>
            [29,39,91,47,84,46,247,79,2],<br/>
            [28,38,85,45,80,47,249,78,2],<br/>
            [28,36,81,43,76,50,337,83,2],<br/>
            [28,34,75,41,83,52,344,81,2],<br/>
            [30,38,80,46,71,53,347,92,2],<br/>
            [28,35,72,45,64,47,360,101,2]]<br/>
    network = [[{‘weights’: [0.09640510259345969, 0.37923370996257266, 0.5476265202749506, 0.9144446394025773, 0.837692750149296, 0.5343300438262426, 0.7679511829130964, 0.5325204151469501, 0.06532276962299033]}],<br/>
            [{‘weights’: [0.040400453542770665, 0.13301701225112483]}, {‘weights’: [0.1665525504275246, 0.5382087395561351]}, {‘weights’: [0.26800994395551214, 0.3322334781304659]}]]<br/>
#    minmax = dataset_minmax(dataset)<br/>
 #   normalize_dataset(dataset, minmax)<br/>
    for row in dataset:<br/>
        prediction = predict(network, row)<br/>
        print(‘Expected=%d, Got=%d’ % (row[-1], prediction))</p>
<div class="reply">
<a aria-label="Reply to TGoritsky" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399412#respond" onclick='return addComment.moveForm( "comment-399412", "399412", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399443">
<div class="comment-container" id="li-comment-399443">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399443" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would suggest exploring your problem with the Keras framework:<br/>
<a href="http://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">http://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399443#respond" onclick='return addComment.moveForm( "comment-399443", "399443", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-399961">
<div class="comment-container" id="li-comment-399961">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c4015dec2450cccdd3df863dd23040f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c4015dec2450cccdd3df863dd23040f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomo</span>
<span class="date">May 18, 2017 at 6:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399961" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
In the function “backward_propagate_error”, when you do this:</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])</p>
<p>The derivative should be applied on the activation of that neuron, not to the output . Am I right??</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(activate(neuron[‘weights’], inputs))</p>
<p>And inputs is:<br/>
		inputs = row[-1]<br/>
		if i != 0:<br/>
			inputs = [neuron[‘output’] for neuron in self.network[i-1]]</p>
<p>Thank you! The post was really helpful!</p>
<div class="reply">
<a aria-label="Reply to Tomo" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=399961#respond" onclick='return addComment.moveForm( "comment-399961", "399961", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400540">
<div class="comment-container" id="li-comment-400540">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b49655a25d156960f928a2b25430b9ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b49655a25d156960f928a2b25430b9ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tina</span>
<span class="date">May 26, 2017 at 3:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400540" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason!</p>
<p>This is a very interesting contribution to the community 🙂<br/>
Have you tried using the algorithm with other activation functions?<br/>
I tried with Gaussian, tanh and sinx, but the accuracy was not that high, so I think that I omitted something. What I altered were the activation functions and the derivatives. Is there something else that needs to be changed?</p>
<div class="reply">
<a aria-label="Reply to Tina" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400540#respond" onclick='return addComment.moveForm( "comment-400540", "400540", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401137">
<div class="comment-container" id="li-comment-401137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sigmoid was the defacto standard for many years because it performs well on many different problems. </p>
<p>Now the defacto standard is ReLU.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401137#respond" onclick='return addComment.moveForm( "comment-401137", "401137", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401683">
<div class="comment-container" id="li-comment-401683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manu</span>
<span class="date">June 6, 2017 at 8:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sigmoid and ReLU are transfer functions right ?<br/>
Activation function is just the sum of all weights and inputs</p>
<div class="reply">
<a aria-label="Reply to Manu" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401683#respond" onclick='return addComment.moveForm( "comment-401683", "401683", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-401731">
<div class="comment-container" id="li-comment-401731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 7, 2017 at 7:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are correct, but in some frameworks, transfer functions are called activation functions:<br/>
<a href="https://keras.io/activations/" rel="nofollow">https://keras.io/activations/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401731#respond" onclick='return addComment.moveForm( "comment-401731", "401731", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400644">
<div class="comment-container" id="li-comment-400644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 8:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great post. Here is some observation that I am not able to understand. In the back ward propagate you are not taking all the weights and only considering the jth. Can you kindly help understand. I was under the impression that the delta from output is applied across all the weights,<br/>
				for neuron in network[i + 1]:<br/>
					error += (neuron[‘weights’][j] * neuron[‘delta’])</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400644#respond" onclick='return addComment.moveForm( "comment-400644", "400644", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-400645">
<div class="comment-container" id="li-comment-400645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 8:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I understand you do not want to take in the bias weight hence the exclusion of the last weight in neuron. I kind of get stumped on bias.</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400645#respond" onclick='return addComment.moveForm( "comment-400645", "400645", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400646">
<div class="comment-container" id="li-comment-400646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 9:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great article. In the backward propagate, the delta value is applied for each weight across the neuron and the error is summed. I am curious why is the delta not applied to individual weights of the neuron and the error summed for that neuron. Can you please clarify?</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400646#respond" onclick='return addComment.moveForm( "comment-400646", "400646", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400706">
<div class="comment-container" id="li-comment-400706">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0707154c61049f645af6783bec2b9725?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0707154c61049f645af6783bec2b9725?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://jgjgjh" rel="external nofollow">Josue</a></span>
<span class="date">May 29, 2017 at 3:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400706" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why don’t you split the data into TrainData and TestData, like 80% of the dataset for training and 20% for testing, because if you train with 100% of rows of the dataset and then test some rows of the dataset the accuracy will be good . But if you put new data on the seeds.csv the model will work with less accuracy, Right?</p>
<div class="reply">
<a aria-label="Reply to Josue" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400706#respond" onclick='return addComment.moveForm( "comment-400706", "400706", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401170">
<div class="comment-container" id="li-comment-401170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can, k-fold cross validation generally gives a better estimate of model performance.</p>
<p>Once we have the estimate and choose our model, we can fit the final model on all available data and make predictions on new data:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401170#respond" onclick='return addComment.moveForm( "comment-401170", "401170", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400727">
<div class="comment-container" id="li-comment-400727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67d241041014f0f5d9ebdcc9debacf33?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67d241041014f0f5d9ebdcc9debacf33?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://donthave" rel="external nofollow">Josue</a></span>
<span class="date">May 29, 2017 at 11:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the post! I have a question about cross-validation. The dataset of seeds is perfect for 5 folds but for a dataset of 211? I’ll have uniformly sized subset right? (211/5) Can you give me a suggestion how I could handle that ?<br/>
Thanks in advanced.</p>
<div class="reply">
<a aria-label="Reply to Josue" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400727#respond" onclick='return addComment.moveForm( "comment-400727", "400727", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401176">
<div class="comment-container" id="li-comment-401176">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401176" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One way is that some records can be discarded to give even sized groups.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401176#respond" onclick='return addComment.moveForm( "comment-401176", "401176", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400803">
<div class="comment-container" id="li-comment-400803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5bf824ed810d04fcbe552afbc0768ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5bf824ed810d04fcbe552afbc0768ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sebastián</span>
<span class="date">May 30, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks so much for the tutorial. It was really helpful!</p>
<div class="reply">
<a aria-label="Reply to Sebastián" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=400803#respond" onclick='return addComment.moveForm( "comment-400803", "400803", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401194">
<div class="comment-container" id="li-comment-401194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=401194#respond" onclick='return addComment.moveForm( "comment-401194", "401194", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402132">
<div class="comment-container" id="li-comment-402132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manu</span>
<span class="date">June 10, 2017 at 9:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>any advice on how to handle multi-classifier problems when the classes have high cardinality ?<br/>
I’m thinking about input data of search engines linked to choosen urls.</p>
<div class="reply">
<a aria-label="Reply to Manu" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=402132#respond" onclick='return addComment.moveForm( "comment-402132", "402132", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402178">
<div class="comment-container" id="li-comment-402178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2017 at 8:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch, consider modeling it as regression instead (e.g. a rating or recommender system).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=402178#respond" onclick='return addComment.moveForm( "comment-402178", "402178", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-402304">
<div class="comment-container" id="li-comment-402304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manuel</span>
<span class="date">June 13, 2017 at 1:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok thank you very much Jason.<br/>
But it wont work with searches unseen by the algorithm.<br/>
I red something in the books “Programming collective intelligence” about a neural net from scratch for this king of problem but I don’t understang how it works for the moments…</p>
<div class="reply">
<a aria-label="Reply to Manuel" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=402304#respond" onclick='return addComment.moveForm( "comment-402304", "402304", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-402350">
<div class="comment-container" id="li-comment-402350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider focusing on one measure/metric that really matters in your domain, then try a suite of framings of the problem and different algorithms to get a feeling for what might work best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=402350#respond" onclick='return addComment.moveForm( "comment-402350", "402350", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402977">
<div class="comment-container" id="li-comment-402977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/959d5fe77a415801a0e4749065d2d60f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/959d5fe77a415801a0e4749065d2d60f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yash</span>
<span class="date">June 18, 2017 at 6:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am not able to understand the above code.So, I request you to explain me the above code</p>
<div class="reply">
<a aria-label="Reply to Yash" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=402977#respond" onclick='return addComment.moveForm( "comment-402977", "402977", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403024">
<div class="comment-container" id="li-comment-403024">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 19, 2017 at 8:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403024" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Which part do you not understand exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=403024#respond" onclick='return addComment.moveForm( "comment-403024", "403024", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-403300">
<div class="comment-container" id="li-comment-403300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cce0b8ebf653dba6ba6c64769cf1417c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cce0b8ebf653dba6ba6c64769cf1417c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tathagat</span>
<span class="date">June 21, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason..am a novice in machine learning..have a small question…how can I track the timesteps involved in the algorithm with accordance with the code?</p>
<div class="reply">
<a aria-label="Reply to Tathagat" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=403300#respond" onclick='return addComment.moveForm( "comment-403300", "403300", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403364">
<div class="comment-container" id="li-comment-403364">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2017 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403364" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean by time steps?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=403364#respond" onclick='return addComment.moveForm( "comment-403364", "403364", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404185">
<div class="comment-container" id="li-comment-404185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/194495195e7bc8c0f21b8cc71273be40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/194495195e7bc8c0f21b8cc71273be40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">bazooka</span>
<span class="date">June 29, 2017 at 6:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason. I am so confused, in the result, why there are 4 set of [output,weight,delta]</p>
<p>like this:<br/>
[{‘output’: 0.9999930495852168, ‘weights’: [0.9315463130784808, 1.0639526745114607, 0.9274685127907779], ‘delta’: -4.508489650980804e-09}, {‘output’: 0.9992087809233077, ‘weights’: [-2.4595353900551125, 5.153506472345162, -0.5778256160239431], ‘delta’: 1.940550145482836e-06}]<br/>
[{‘output’: 0.01193860966265472, ‘weights’: [2.3512725698865053, -8.719060612965613, 1.944330467290268], ‘delta’: -0.0001408287858584854}, {‘output’: 0.988067899681387, ‘weights’: [-2.2568526798573116, 8.720113230271012, -2.0392501730513253], ‘delta’: 0.0001406761850156443}]</p>
<p>after the backpropagation we find the optimal weights to get minimum error, what does these 4 group means?<br/>
E</p>
<div class="reply">
<a aria-label="Reply to bazooka" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=404185#respond" onclick='return addComment.moveForm( "comment-404185", "404185", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404190">
<div class="comment-container" id="li-comment-404190">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404190" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is the internal state of the whole trained network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=404190#respond" onclick='return addComment.moveForm( "comment-404190", "404190", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404189">
<div class="comment-container" id="li-comment-404189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e1242e2b42e73cede3549da144ed6d57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e1242e2b42e73cede3549da144ed6d57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">hassan</span>
<span class="date">June 29, 2017 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason<br/>
thanks for your code and good description here, i like it so much.<br/>
i run your  example code and encounter with an error same others whom left note here<br/>
 the error is:<br/>
expected[row[-1]] = 1<br/>
IndexError: list assignment index out of range</p>
<p>how i can fix this error?</p>
<div class="reply">
<a aria-label="Reply to hassan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=404189#respond" onclick='return addComment.moveForm( "comment-404189", "404189", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404193">
<div class="comment-container" id="li-comment-404193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Python 2.7, confirm that this is your Python version.</p>
<p>Also confirm that you have copied the code exactly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=404193#respond" onclick='return addComment.moveForm( "comment-404193", "404193", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404812">
<div class="comment-container" id="li-comment-404812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c135376b695ae35d060f01a1151c43d6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c135376b695ae35d060f01a1151c43d6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jerome</span>
<span class="date">July 5, 2017 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>i have this question about Back Propagate Error</p>
<p>1- derivative sigmoid  = output * (1.0 – output)<br/>
That is ok </p>
<p>2- error = (expected – output) * transfer_derivative(output)<br/>
Ok but it also means that error == 0 for output = 1 whatever the expected is because transfer_derivative(1) ==0</p>
<p>So, whatever the expected , error is nil if output is 1 …<br/>
Is there something rotten here?</p>
<p>Thanks</p>
<p>Jerome</p>
<div class="reply">
<a aria-label="Reply to Jerome" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=404812#respond" onclick='return addComment.moveForm( "comment-404812", "404812", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405420">
<div class="comment-container" id="li-comment-405420">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/75cf6d43b9e8929ba9253a185be4c699?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/75cf6d43b9e8929ba9253a185be4c699?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wddddds</span>
<span class="date">July 10, 2017 at 10:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405420" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason, It’s a great tutorial and really helpful for me! </p>
<p>But I have to say that trying to reimplement your code strongly increased my ability of debugging 🙂</p>
<div class="reply">
<a aria-label="Reply to wddddds" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=405420#respond" onclick='return addComment.moveForm( "comment-405420", "405420", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405483">
<div class="comment-container" id="li-comment-405483">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405483" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=405483#respond" onclick='return addComment.moveForm( "comment-405483", "405483", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406233">
<div class="comment-container" id="li-comment-406233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Victor</span>
<span class="date">July 17, 2017 at 7:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for sharing your code. I’m a PhD candidate in machine learning, and I have a doubt about the weights update in section 4.1:</p>
<p>weight = weight + learning_rate * error * input</p>
<p>Should not it be as follows?</p>
<p>weight = weight – learning_rate * error * input</p>
<p>Thanks again for sharing this.</p>
<p>Regards,<br/>
Victor.</p>
<div class="reply">
<a aria-label="Reply to Victor" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=406233#respond" onclick='return addComment.moveForm( "comment-406233", "406233", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-408545">
<div class="comment-container" id="li-comment-408545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Víctor</span>
<span class="date">August 4, 2017 at 11:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I didn’t say anything, my mistake in understanding.</p>
<p>Thanks again for sharing your work.</p>
<div class="reply">
<a aria-label="Reply to Víctor" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408545#respond" onclick='return addComment.moveForm( "comment-408545", "408545", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-406881">
<div class="comment-container" id="li-comment-406881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu priya</span>
<span class="date">July 22, 2017 at 4:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi..<br/>
Thanks for ur coding. It was too helpful. can u suggest me how to use this code for classifying tamil characters. i have tried in cnn and now i need to compare the result with bpn. can u pls suggest me.</p>
<p>thank you</p>
<div class="reply">
<a aria-label="Reply to vishnu priya" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=406881#respond" onclick='return addComment.moveForm( "comment-406881", "406881", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406962">
<div class="comment-container" id="li-comment-406962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 23, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this tutorial on classifying with a CNN would be more useful to you:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=406962#respond" onclick='return addComment.moveForm( "comment-406962", "406962", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407012">
<div class="comment-container" id="li-comment-407012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu priya</span>
<span class="date">July 23, 2017 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you sir.  With this tutorial i have implemented cnn sir. but for BPN i am getting error rate 687.203 sir. i dnt know what to do sir. can u help me sir.</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to vishnu priya" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407012#respond" onclick='return addComment.moveForm( "comment-407012", "407012", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407079">
<div class="comment-container" id="li-comment-407079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 24, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the problem exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407079#respond" onclick='return addComment.moveForm( "comment-407079", "407079", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-407137">
<div class="comment-container" id="li-comment-407137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishnupriya</span>
<span class="date">July 24, 2017 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Classification of Tamil characters sir. I have 144 different classes. I have taken 7 glcm features of each character and I need to train this features in backpropagation and predict the character to which class it belongs.</p>
<div class="reply">
<a aria-label="Reply to Vishnupriya" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407137#respond" onclick='return addComment.moveForm( "comment-407137", "407137", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407218">
<div class="comment-container" id="li-comment-407218">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407218" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sound like a great project!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407218#respond" onclick='return addComment.moveForm( "comment-407218", "407218", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407398">
<div class="comment-container" id="li-comment-407398">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">codeo</span>
<span class="date">July 26, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407398" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, so I wasn’t following this tutorial when implementing my neural network from scratch, and mine is in JavaScript. I just need help with the theory. How do I calculate the error for each node in the net so that I can incrementally change the weights? Great tutorial btw</p>
<div class="reply">
<a aria-label="Reply to codeo" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407398#respond" onclick='return addComment.moveForm( "comment-407398", "407398", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-407408">
<div class="comment-container" id="li-comment-407408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">codeo</span>
<span class="date">July 26, 2017 at 6:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hahaha nevermind, it was my code<br/>
Multidimensional arrays and stuff boggle the mind hah</p>
<div class="reply">
<a aria-label="Reply to codeo" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407408#respond" onclick='return addComment.moveForm( "comment-407408", "407408", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-407476">
<div class="comment-container" id="li-comment-407476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear you worked it out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=407476#respond" onclick='return addComment.moveForm( "comment-407476", "407476", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408006">
<div class="comment-container" id="li-comment-408006">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PRABHAKARAN M</span>
<span class="date">July 31, 2017 at 4:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408006" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>[ 6.38491205	5.333345	4.81565798	5.43552204	9.96445304	2.57268919	4.07671018	1.5258789	6.19728301	0	1	]<br/>
Dear sir,<br/>
the above mentioned numerical values are extracted from the dental x-ray image using gray level co occurrence matrix [10 inputs and 1 output]. This dataset is used as a input for BPN classifier. whether the same data set as[.csv] file can be used as the input for DEEP Convolutional Neural Network technique ? and can i get the output as image ? for example if i give the dental x ray images as numerical values i have to get the caries affected teeth as the output for the given dataset.</p>
<div class="reply">
<a aria-label="Reply to PRABHAKARAN M" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408006#respond" onclick='return addComment.moveForm( "comment-408006", "408006", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408079">
<div class="comment-container" id="li-comment-408079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That sounds like a great problem. It may be possible.</p>
<p>I would recommend using deep CNNs.</p>
<p>Perhaps this tutorial will give you some ideas on how to get started:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<p>You may want to look at some papers on object localization in images. I don’t have material on it sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408079#respond" onclick='return addComment.moveForm( "comment-408079", "408079", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-408007">
<div class="comment-container" id="li-comment-408007">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PRABHAKARAN M</span>
<span class="date">July 31, 2017 at 4:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408007" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can i get the example code for dental caries detection using deep Convolutional Neural Network for the given dataset as x ray images.</p>
<div class="reply">
<a aria-label="Reply to PRABHAKARAN M" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408007#respond" onclick='return addComment.moveForm( "comment-408007", "408007", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408080">
<div class="comment-container" id="li-comment-408080">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408080" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do not have sample code for this problem, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408080#respond" onclick='return addComment.moveForm( "comment-408080", "408080", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408057">
<div class="comment-container" id="li-comment-408057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">August 1, 2017 at 3:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice explanation, thank you.<br/>
I have some questions.</p>
<p>1) weight = weight + learning_rate * error * input</p>
<p>Do I really need to multiply it with input ? For example here <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a> they dont it multiply it with input. At least, I think that…</p>
<p>2) Is your method same as in <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a>?<br/>
i think yes, but again, Im not sure and Im confused by that input multiplication. </p>
<p>3) What is exactly loss function in your example (I usually found some derivations of loss (cost ?) function (in other explanations), not transfer function derivation)? Im actually very confused by notation which I find around …</p>
<p>4) momentum and weight decay. In  your example, you can implement them that you substract calculated decay and add calculated momentum (to weight update) ? Again, I found forms which substract both and weight update as w + deltaW, so again I’m mega confused by notation for backpropagation which I found…</p>
<p>Sorry for dumb questions, … math is not my strong side, so many things which can be inferred by math sense are simply hidden for me.</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408057#respond" onclick='return addComment.moveForm( "comment-408057", "408057", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-408058">
<div class="comment-container" id="li-comment-408058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">August 1, 2017 at 3:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>*substract both and weight update as w + deltaW, so again</p>
<p>I found above sentence as nonsense, must be side effect of my confusion …</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408058#respond" onclick='return addComment.moveForm( "comment-408058", "408058", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-408096">
<div class="comment-container" id="li-comment-408096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hang in there. </p>
<p>Pick one tutorial and focus on it. Jumping from place to place will make things worse for sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408096#respond" onclick='return addComment.moveForm( "comment-408096", "408096", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408094">
<div class="comment-container" id="li-comment-408094">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408094" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi John, good questions.</p>
<p>According to my textbook, yes.<br/>
I can’t speak for random sites on the internet sorry.</p>
<p>Loss is prediction error. You can change this to other forms like MAE or MSE.</p>
<p>No decay or momentum in this example. Easy to add if you want. There are many ways to dial in the learning process. No hard and fast rules, just some norms that people reuse.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408094#respond" onclick='return addComment.moveForm( "comment-408094", "408094", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-408748">
<div class="comment-container" id="li-comment-408748">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a11dc1ca672ffee4c876eee33b7ac7ca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a11dc1ca672ffee4c876eee33b7ac7ca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Parminder Kaur</span>
<span class="date">August 6, 2017 at 7:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408748" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A VERY GOOD TUTORIAL SIR…<br/>
Sir i am implementing remote sensed image classification using BPN neural network using IDL.<br/>
I am not finding good resources on constructing features for input dataset and also number of hidden layers and number of neurons in hidden layer.<br/>
Any resources you know, can help me?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Parminder Kaur" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408748#respond" onclick='return addComment.moveForm( "comment-408748", "408748", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408800">
<div class="comment-container" id="li-comment-408800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 7, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The CNN will perform feature extraction automatically, you could explore using different filters on the data to see if it helps the network.</p>
<p>The number of layers and neurons/filters per layer must be found using trial and error. It is common to copy the designs from other papers as a starting point.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=408800#respond" onclick='return addComment.moveForm( "comment-408800", "408800", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-409003">
<div class="comment-container" id="li-comment-409003">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1268ae50179722425c7c57aaa5984486?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1268ae50179722425c7c57aaa5984486?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pero</span>
<span class="date">August 9, 2017 at 1:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409003" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial, very clean and readable code. =)  thank you!</p>
<div class="reply">
<a aria-label="Reply to pero" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=409003#respond" onclick='return addComment.moveForm( "comment-409003", "409003", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409043">
<div class="comment-container" id="li-comment-409043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 9, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks pero.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=409043#respond" onclick='return addComment.moveForm( "comment-409043", "409043", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409615">
<div class="comment-container" id="li-comment-409615">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f50075a51189a6ad3ba2f2e313965e54?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f50075a51189a6ad3ba2f2e313965e54?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vatandas</span>
<span class="date">August 15, 2017 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409615" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1. I expect that this code is deep learning (many hidden layer) but not. One sentence is easy (“you can add more hidden layer as explained”) but to do is not as easy as you said.</p>
<p>2. I think your code is wrong.<br/>
neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br/>
but<br/>
Error = Target – ActivatedOutputNode<br/>
Delta = Error * Derivative(NONActivatedOutputNode)</p>
<p>I mean you use the same ‘output’ variable both error and delta. But in error it must be activated one, in delta it must be NONactivated one.</p>
<div class="reply">
<a aria-label="Reply to Vatandas" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=409615#respond" onclick='return addComment.moveForm( "comment-409615", "409615", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410043">
<div class="comment-container" id="li-comment-410043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">8CG_256</span>
<span class="date">August 18, 2017 at 9:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial, very clean code and beginner-friendly. Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to 8CG_256" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410043#respond" onclick='return addComment.moveForm( "comment-410043", "410043", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410090">
<div class="comment-container" id="li-comment-410090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2017 at 4:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad you found it useful!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410090#respond" onclick='return addComment.moveForm( "comment-410090", "410090", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-410125">
<div class="comment-container" id="li-comment-410125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">8CG_256</span>
<span class="date">August 18, 2017 at 9:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I only have one slight issue: I implemented this in Ruby and I tried to train it using the IRIS dataset, keeping the network simple (1 input layer, 1 hidden layer, 1 output layer) and after decreasing for a while the error rate keeps increasing. I tried lowering the learning rate, even making it dynamic so it decreases whenever the error increases but it doesn’t seem to help. Could you give me some advice? P.S sorry for my bad English</p>
<div class="reply">
<a aria-label="Reply to 8CG_256" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410125#respond" onclick='return addComment.moveForm( "comment-410125", "410125", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-410183">
<div class="comment-container" id="li-comment-410183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example of backprop I developed in Ruby:<br/>
<a href="http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html" rel="nofollow">http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410183#respond" onclick='return addComment.moveForm( "comment-410183", "410183", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-410592">
<div class="comment-container" id="li-comment-410592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26b98e129350b612628d7ba5094429dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26b98e129350b612628d7ba5094429dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Derek Martins</span>
<span class="date">August 22, 2017 at 9:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I enjoy so much your tutorials. Can you do a tutorial implementing BackPropagation Through Time? Thanks man.</p>
<div class="reply">
<a aria-label="Reply to Derek Martins" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410592#respond" onclick='return addComment.moveForm( "comment-410592", "410592", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410658">
<div class="comment-container" id="li-comment-410658">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410658" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>I have a few posts on the general topic, for example:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410658#respond" onclick='return addComment.moveForm( "comment-410658", "410658", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410863">
<div class="comment-container" id="li-comment-410863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7cb65695fb2f8b52ea5917dca40d2d4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7cb65695fb2f8b52ea5917dca40d2d4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://xprilion.com" rel="external nofollow">Anubhav Singh</a></span>
<span class="date">August 24, 2017 at 1:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thank you for the great tutorial!</p>
<p>I would like to know how I can obtain the weight*input for every single neuron in the network…</p>
<p>I’ve been trying these lines – </p>
<p>for layer in network:<br/>
		new_inputs = []<br/>
		for neuron in layer:<br/>
			activation = activate(neuron[‘weights’], inputs)<br/>
			neuron[‘output’] = transfer(activation)<br/>
			new_inputs.append(neuron[‘output’])</p>
<p>but the activation variable here is a single value…what I understand is that if I have set n_hidden = 5 (number of hidden layers), I should get N*5 (N = number of features in the dataset) outputs if I print the activation…</p>
<p>Kindly help 🙂</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Anubhav Singh" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=410863#respond" onclick='return addComment.moveForm( "comment-410863", "410863", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411028">
<div class="comment-container" id="li-comment-411028">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3cc61772448f5917d23ae1e3487635f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3cc61772448f5917d23ae1e3487635f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jose Panakkel</span>
<span class="date">August 25, 2017 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-411028" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I have a question on the delta calculation at the output layer, where<br/>
the primary value is the difference between the neuron output and<br/>
the expected output. And we are then multiplying this difference<br/>
with the transfer_derivative. where transfer_derivative is a function<br/>
of neuron’s output.</p>
<p>My question is, is it correct to find the difference between the<br/>
neuron’s output and the expected output?</p>
<p>In this case of the example, you have chosen digital outputs [0,1]<br/>
and hence it may not have come up .. but my point is…<br/>
one is already subjected to a transfer function, and one is not.</p>
<p>The neuron’s output is always subjected to a transfer function and<br/>
hence will be in a specific range, say -.5 to +.5 or something..<br/>
But the expected output is the user’s choice .. isnt it?<br/>
user can have an expected value of say 488.34, for some stock price<br/>
learning.. then is it still correct to find this primary difference<br/>
between the expected output and the neuron output, at the output<br/>
layer delta calculation?</p>
<p>shoulnt the expected output also be subjected to the same transfer<br/>
function before finding the difference? Or the otherway, like<br/>
shoulnt the neuron ouptut be subjected to a reverse transfer function<br/>
before comparing with the expected output directly?</p>
<p>Thanks and Regards,<br/>
Jose Panakkel</p>
<div class="reply">
<a aria-label="Reply to Jose Panakkel" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=411028#respond" onclick='return addComment.moveForm( "comment-411028", "411028", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-412837">
<div class="comment-container" id="li-comment-412837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6508606fe9489601d669f5cdc283d7b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6508606fe9489601d669f5cdc283d7b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">RealUser404</span>
<span class="date">September 6, 2017 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, great tutorial that helped me a lot!</p>
<p>I have a question concerning the back-propagation : what if instead of having an error function I only have a desired gradient for the output (in the case of an actor-critic model for example)?<br/>
How can I change your backprop function to make it work? Or can I just use the gradient as the error?</p>
<div class="reply">
<a aria-label="Reply to RealUser404" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=412837#respond" onclick='return addComment.moveForm( "comment-412837", "412837", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412962">
<div class="comment-container" id="li-comment-412962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow, perhaps you can restate your question with an example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=412962#respond" onclick='return addComment.moveForm( "comment-412962", "412962", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413123">
<div class="comment-container" id="li-comment-413123">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6225bd61d073fc6ba733e76c0b6499bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6225bd61d073fc6ba733e76c0b6499bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">user28</span>
<span class="date">September 8, 2017 at 9:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413123" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason , thank you for providing this tutorial. I’m confused  of how can I implement the same backpropagation algorithm with output not binary. Since I noticed that your example has binary output. Like predicting for stock price given the  open, high, low and close values. Regards.</p>
<div class="reply">
<a aria-label="Reply to user28" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413123#respond" onclick='return addComment.moveForm( "comment-413123", "413123", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413225">
<div class="comment-container" id="li-comment-413225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 11:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use a library like Keras. Start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413225#respond" onclick='return addComment.moveForm( "comment-413225", "413225", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413386">
<div class="comment-container" id="li-comment-413386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8283c11827ba7552e4edc668aa74e2c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8283c11827ba7552e4edc668aa74e2c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://na" rel="external nofollow">Lewis</a></span>
<span class="date">September 11, 2017 at 2:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>great article. I have an interest in NN but I am not that good at python. </p>
<p>Want I wanted to try was to withhold say 5 rows from the dataset and have the trained network predict the results for those rows. these is is different from what I think the example does which is rolling predictions with the learning. Removing 5 rows from the dataset is of course easy but my pitiful attempts at predicting with unseen data like below fail ((I guess network is not in scope at the end): any help appreciated!</p>
<p># predict unseen data<br/>
unseendataset = [[12.37,13.47,0.8567,5.204,2.96,3.919,5.001],<br/>
[12.19,13.2,0.8783,5.137,2.981,3.631,4.87],<br/>
[11.23,12.88,0.8511,5.14,2.795,4.325,5.003],<br/>
[13.2,13.66,0.8883,5.236,3.232,8.315,5.056],<br/>
[11.84,13.21,0.8521,5.175,2.836,3.598,5.044],<br/>
[12.3,13.34,0.8684,5.243,2.974,5.637,5.063]]</p>
<p>for row in unseendataset:<br/>
    prediction2 = predict(network, row)<br/>
    print(‘Predicted=%d’ % (prediction2))</p>
<div class="reply">
<a aria-label="Reply to Lewis" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413386#respond" onclick='return addComment.moveForm( "comment-413386", "413386", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413434">
<div class="comment-container" id="li-comment-413434">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413434" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend starting with Keras rather than coding the algorithm from scratch.</p>
<p>Start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413434#respond" onclick='return addComment.moveForm( "comment-413434", "413434", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413775">
<div class="comment-container" id="li-comment-413775">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce124181d0a03bb5edf4f647f95b9fad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce124181d0a03bb5edf4f647f95b9fad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/kmagdy/" rel="external nofollow">Karim</a></span>
<span class="date">September 14, 2017 at 1:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413775" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I am trying to generalize your implementation to work with a variable number of layers and nodes. However, whenever I try to increase the number of nodes too much it stops working (the network freezes at one error rate and all output nodes are active, i.e. giving 1). Although the code would work if I decreased the layers and the errors will go down.<br/>
Is there something I am missing when using too many layers? The concepts should be the same. </p>
<p>I trained a network with 4 layers: [14,10,10,4] and it worked.<br/>
I trained a network with 4 layers [14,100,40,4] and it is stuck. Same dataset. </p>
<p>My code is here if you are looking in more details:<br/>
<a href="https://github.com/KariMagdy/Implementing-a-neural-network" rel="nofollow">https://github.com/KariMagdy/Implementing-a-neural-network</a></p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Karim" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413775#respond" onclick='return addComment.moveForm( "comment-413775", "413775", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413891">
<div class="comment-container" id="li-comment-413891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 12:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What problem do you get exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=413891#respond" onclick='return addComment.moveForm( "comment-413891", "413891", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415614">
<div class="comment-container" id="li-comment-415614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bc803c364515901e16bbc203c53d3ca2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bc803c364515901e16bbc203c53d3ca2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Laksh</span>
<span class="date">October 4, 2017 at 11:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason Brownlee,<br/>
can we extend this code for 2 or more hidden layers ?</p>
<div class="reply">
<a aria-label="Reply to Laksh" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=415614#respond" onclick='return addComment.moveForm( "comment-415614", "415614", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415653">
<div class="comment-container" id="li-comment-415653">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415653" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=415653#respond" onclick='return addComment.moveForm( "comment-415653", "415653", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416085">
<div class="comment-container" id="li-comment-416085">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 9, 2017 at 1:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416085" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Mr. Brownlee,</p>
<p>I’m trying to alter the code to represent a regression problem (sigmoid on hidden layer, linear on output layer). As far as I know, the main part of the code that would have to be modified is the FF algorithm. I’ve rewritten the code as below:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397eefd3985666663" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Forward propagate input to a network output
def forward_propagate_regression(network, row):
    inputs = row
    new_inputs = []
    #gets the 1st layer, applies sigmoid activation
    hiddenlayer = network[0]
    for neuron in hiddenlayer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = transfer(activation)
        new_inputs.append(neuron['output'])
    inputs = new_inputs
    #gets the last layer, applies linear activation
    outputlayer = network[-1]
    for neuron in outputlayer:
            activation = activate(neuron['weights'], inputs)
            neuron['output'] = activation
            new_inputs.append(neuron['output'])
    inputs = new_inputs
    return inputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-2">2</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-4">4</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-6">6</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-8">8</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-10">10</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-12">12</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-14">14</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-16">16</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397eefd3985666663-18">18</div><div class="crayon-num" data-line="crayon-5a659397eefd3985666663-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397eefd3985666663-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate_regression</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-3"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-4"><span class="crayon-e">    </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-5"><span class="crayon-h">    </span><span class="crayon-p">#gets the 1st layer, applies sigmoid activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-6"><span class="crayon-h">    </span><span class="crayon-v">hiddenlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-7"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">hiddenlayer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-8"><span class="crayon-h">        </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-9"><span class="crayon-h">        </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-10"><span class="crayon-h">        </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-11"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-12"><span class="crayon-h">    </span><span class="crayon-p">#gets the last layer, applies linear activation</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-13"><span class="crayon-h">    </span><span class="crayon-v">outputlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-14"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">outputlayer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-15"><span class="crayon-h">            </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-16"><span class="crayon-h">            </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activation</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-17"><span class="crayon-e">            </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397eefd3985666663-18"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5a659397eefd3985666663-19"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p></p>
<p>With this code, I’m getting an “OverflowError: (34, ‘Result too large’)” error. Could you please tell what I’m doing wrong? All the other parts of the code are as you’ve written.</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416085#respond" onclick='return addComment.moveForm( "comment-416085", "416085", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416100">
<div class="comment-container" id="li-comment-416100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What did you change exactly? Can you highlight the change for me?</p>
<p>Also, try using pre tags.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416100#respond" onclick='return addComment.moveForm( "comment-416100", "416100", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-416157">
<div class="comment-container" id="li-comment-416157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 10, 2017 at 4:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>(I don’t know how to highlight the change, sorry!)</p>
<p>I got the hidden layer (network[0]), and I applied your algorithm (calculate activation, transfer the activation to the output, append that to a new list called “new_inputs”). </p>
<p>After that, I get the output layer (network[-1]), I calculate the activation with the “new_inputs”, but I do NOT apply the sigmoid transfer function (so, the outputs should be linear). The results are appended to a new list, which is set to be the return of the function. </p>
<p>Would that be the best way to remove the sigmoid function from the output layer, making the code a regression, instead of a classification?</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416157#respond" onclick='return addComment.moveForm( "comment-416157", "416157", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-416186">
<div class="comment-container" id="li-comment-416186">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416186" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds good. I don’t have any good ideas, I’d recommend stepping through some calculations to help spot where it is going wrong.</p>
<p>You may want to consider moving to an open source neural net library, such as Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416186#respond" onclick='return addComment.moveForm( "comment-416186", "416186", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-417956">
<div class="comment-container" id="li-comment-417956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam McGoldrick</span>
<span class="date">October 26, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am having the same issue with mine. i made alterations and they are just the same as yours. Did you find a solution?</p>
<div class="reply">
<a aria-label="Reply to Liam McGoldrick" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=417956#respond" onclick='return addComment.moveForm( "comment-417956", "417956", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-417963">
<div class="comment-container" id="li-comment-417963">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam McGoldrick</span>
<span class="date">October 26, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417963" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I GOT IT TO WORK!!! You have to normalize your output data. Then you can apply the transfer function to the output layer just the same! After that it will work!</p>
<div class="reply">
<a aria-label="Reply to Liam McGoldrick" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=417963#respond" onclick='return addComment.moveForm( "comment-417963", "417963", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416406">
<div class="comment-container" id="li-comment-416406">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ad03bc88f93977eb58a0a21c943632?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ad03bc88f93977eb58a0a21c943632?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">October 12, 2017 at 11:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416406" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, nice posting and it really helps a lot<br/>
for j in range(len(layer)):<br/>
	neuron = layer[j]<br/>
	neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br/>
Should the neuron[‘output’] be the output of the activation function instead of the transfer function here?</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416406#respond" onclick='return addComment.moveForm( "comment-416406", "416406", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416652">
<div class="comment-container" id="li-comment-416652">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Asad</span>
<span class="date">October 14, 2017 at 3:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416652" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason, nice post its really helps alot.</p>
<p>please tell me how we can change the neuron in hidden layer and in output layer?<br/>
and what will be the result when we change the neuron in hidden layer and in output layer?<br/>
in this tutorial u take one hidden layer,so can we use more than one hidden layer? and how?</p>
<p>please tell me i m waiting</p>
<div class="reply">
<a aria-label="Reply to Asad" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416652#respond" onclick='return addComment.moveForm( "comment-416652", "416652", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416721">
<div class="comment-container" id="li-comment-416721">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 15, 2017 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416721" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you would be better served by starting with a neural network library such as Keras:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416721#respond" onclick='return addComment.moveForm( "comment-416721", "416721", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416872">
<div class="comment-container" id="li-comment-416872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 16, 2017 at 2:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Mr. Brownlee,</p>
<p>I’m trying to adapt the code to support many hidden layers. I’ve adapted the code as below, with a new input called “n_layers”, to insert N hidden layers in the network. </p>
<p># Initialize a network with “n_layers” hidden layers<br/>
def initialize_network3(n_inputs, n_hidden, n_layers, n_outputs):<br/>
    network = list()<br/>
    for i in range(n_layers):<br/>
        hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br/>
        network.append(hidden_layer)<br/>
    output_layer = [{‘weights’:[random() for i in range(n_hidden)]} for i in range(n_outputs)]<br/>
    network.append(output_layer)<br/>
    return network</p>
<p>When I try to run the code, it shows the error below. Do you have any idea why?</p>
<p> in backward_propagate_error(network, expected)<br/>
     78                 error = 0.0<br/>
     79                 for neuron in network[i + 1]:<br/>
—&gt; 80                     error += (neuron[‘weights’][j] * neuron[‘delta’])<br/>
     81                 errors.append(error)<br/>
     82         else:</p>
<p>IndexError: list index out of range</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416872#respond" onclick='return addComment.moveForm( "comment-416872", "416872", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416944">
<div class="comment-container" id="li-comment-416944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7218da6c248a3829926f473bf0c9905c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7218da6c248a3829926f473bf0c9905c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arijit Mukherjee</span>
<span class="date">October 17, 2017 at 1:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, </p>
<p>In the output/last layer when we are calculating the backprop error why are we multiplying  with the transfer derivative with the (expected-output)?? transfer derivative is already canceled out for the the last layer , the update should be only (expected-output)*previous_layer_input , ???<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Arijit Mukherjee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=416944#respond" onclick='return addComment.moveForm( "comment-416944", "416944", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417112">
<div class="comment-container" id="li-comment-417112">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b451c3e1b17fc81e5bf84cc05b98ffb0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b451c3e1b17fc81e5bf84cc05b98ffb0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanoh Henry</span>
<span class="date">October 18, 2017 at 8:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417112" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really good article. Thanks a lot.<br/>
Need a little bit of clarification.<br/>
For backward propagation starting at the output layer,<br/>
you get the error by appending to errors expected[j] – neuron[‘output’].<br/>
Isn’t  Error = 0.5 * sum(errors)?<br/>
and then using this sum of errors for back-propagation?<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Tanoh Henry" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=417112#respond" onclick='return addComment.moveForm( "comment-417112", "417112", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417341">
<div class="comment-container" id="li-comment-417341">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam</span>
<span class="date">October 21, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417341" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial! I am trying to modify your code to do a regression  model and I am stuck. I have an input data set (4 columns and many rows) and a single variable output data set (in range of tens of thousands). I fed them into the train procedure and I get an error when it reaches “expected = [0 for i in range(n_outputs)]” in the train portion. The error reads “only length-1 arrays can be converted to Python scalar”. Now I understand this is because of the intended purpose for the code was a categorization problem but I am wondering what I would need to modify to get this to work? Any help would go a long way as I have been stuck on this issue for some time now.</p>
<p>Thanks, and again wonderful tutorial!</p>
<div class="reply">
<a aria-label="Reply to Liam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=417341#respond" onclick='return addComment.moveForm( "comment-417341", "417341", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417348">
<div class="comment-container" id="li-comment-417348">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417348" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start with Keras, it will be much easier for you:<br/>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=417348#respond" onclick='return addComment.moveForm( "comment-417348", "417348", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418032">
<div class="comment-container" id="li-comment-418032">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33f8d2acc9ddf62eb3c18d23d372b459?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33f8d2acc9ddf62eb3c18d23d372b459?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">October 26, 2017 at 11:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418032" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi<br/>
I am implementing a 2 layer neural network with 100 hidden units in the first layer and 50<br/>
in the next using your code. Implement sigmoid activation function in each layer. Train/test your<br/>
model on the MNIST dataset subset.<br/>
But it is always giving same prediction.<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=418032#respond" onclick='return addComment.moveForm( "comment-418032", "418032", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418053">
<div class="comment-container" id="li-comment-418053">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418053" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a framework like Keras:<br/>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=418053#respond" onclick='return addComment.moveForm( "comment-418053", "418053", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418240">
<div class="comment-container" id="li-comment-418240">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f8452cbd8c2a63adc828d8146220a2b0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f8452cbd8c2a63adc828d8146220a2b0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">October 28, 2017 at 6:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418240" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>help, I dont know why i got this error.</p>
<p>Traceback (most recent call last):<br/>
  File “a.py”, line 185, in<br/>
    for i in range(len(dataset[0])-1):<br/>
TypeError: ‘NoneType’ object has no attribute ‘__getitem__’</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=418240#respond" onclick='return addComment.moveForm( "comment-418240", "418240", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418288">
<div class="comment-container" id="li-comment-418288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You cannot have the “-1” within the call to len()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=418288#respond" onclick='return addComment.moveForm( "comment-418288", "418288", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419811">
<div class="comment-container" id="li-comment-419811">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a192ed79ebd87633f7b3f4b422175e4d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a192ed79ebd87633f7b3f4b422175e4d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">João Costa</span>
<span class="date">November 12, 2017 at 12:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419811" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, thanks for your post!</p>
<p>This is helping me a lot with a college work. But in this NN, how can I set manually not the number of input neuros, the input values? </p>
<p>For example, if I have 1 input neuro, I wan’t to set this value to 0.485.</p>
<p>Best regards!</p>
<div class="reply">
<a aria-label="Reply to João Costa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=419811#respond" onclick='return addComment.moveForm( "comment-419811", "419811", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419867">
<div class="comment-container" id="li-comment-419867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2017 at 10:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow.</p>
<p>Perhaps you’d be better off using a library like Keras:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=419867#respond" onclick='return addComment.moveForm( "comment-419867", "419867", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420277">
<div class="comment-container" id="li-comment-420277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2de5bbda17e93bc53aa17350c13f6837?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2de5bbda17e93bc53aa17350c13f6837?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">yesta</span>
<span class="date">November 17, 2017 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
Thank you for this amazing tutorial!</p>
<p>I have a question that may be out of the topic. How do you call models or type of DL models where you feed a model with new test data in order to make the model adaptive to the environment?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to yesta" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=420277#respond" onclick='return addComment.moveForm( "comment-420277", "420277", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420299">
<div class="comment-container" id="li-comment-420299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can update a model after it has been trained.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=420299#respond" onclick='return addComment.moveForm( "comment-420299", "420299", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422285">
<div class="comment-container" id="li-comment-422285">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">December 6, 2017 at 7:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422285" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Dr. Jason,</p>
<p>I have been studying how to develop a neural network from scratch and this tutorial is the main one I have been following because it is helping me so much.<br/>
I have a doubt: When I study the theory I see the neural network scheme carrying only the weights and bias. And here in practice I see that the network is also carrying the output values and the delta i.e (weights, bias, output and delta). Will the final model be saved like this? with the latter (weights, bias, output and delta)? would this be the rule in practice?</p>
<p>I would appreciate it if you could help with this issue so that I could get out of where I left off.</p>
<p>Your posts are really very good there is where I find my way in to learning in Machine Learning.</p>
<p>Best Regards</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422285#respond" onclick='return addComment.moveForm( "comment-422285", "422285", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422347">
<div class="comment-container" id="li-comment-422347">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422347" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The final model (e.g. trained) only needs to perform the forward pass.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422347#respond" onclick='return addComment.moveForm( "comment-422347", "422347", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422467">
<div class="comment-container" id="li-comment-422467">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">December 8, 2017 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422467" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Understood.<br/>
Thank you Dr. Jason</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422467#respond" onclick='return addComment.moveForm( "comment-422467", "422467", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422514">
<div class="comment-container" id="li-comment-422514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MohamedElshazly</span>
<span class="date">December 8, 2017 at 9:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , there’s something i don’t understand  : </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659397ee9b2787850986" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659397ee9b2787850986-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397ee9b2787850986-2">2</div><div class="crayon-num" data-line="crayon-5a659397ee9b2787850986-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397ee9b2787850986-4">4</div><div class="crayon-num" data-line="crayon-5a659397ee9b2787850986-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659397ee9b2787850986-6">6</div><div class="crayon-num" data-line="crayon-5a659397ee9b2787850986-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659397ee9b2787850986-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397ee9b2787850986-2"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659397ee9b2787850986-3"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397ee9b2787850986-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659397ee9b2787850986-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659397ee9b2787850986-6"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a659397ee9b2787850986-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p>wouldn’t the last line be out of range because  the current ‘ i ‘ is the last one and i can’t go beyond it by 1  ?  thanks in advance</p>
<div class="reply">
<a aria-label="Reply to MohamedElshazly" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422514#respond" onclick='return addComment.moveForm( "comment-422514", "422514", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422538">
<div class="comment-container" id="li-comment-422538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, because of the “if” check on the 4th line down.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422538#respond" onclick='return addComment.moveForm( "comment-422538", "422538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-422524">
<div class="comment-container" id="li-comment-422524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Olu</span>
<span class="date">December 9, 2017 at 3:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mr Brownlee,</p>
<p>Thank you for your tutorial. The training for the example worked however when I try to implement the code for the Wheat Seeds Dataset I get an error from my line 210:</p>
<p>for i in range(len(dataset[0]) – 1):<br/>
    str_column_to_float(dataset, i)</p>
<p>The error is: IndexError: list index out of range</p>
<p>Can you please explain why it is (dataset[0])? Does (dataset[0]) means the 1st column in the dataset?</p>
<div class="reply">
<a aria-label="Reply to Olu" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422524#respond" onclick='return addComment.moveForm( "comment-422524", "422524", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422544">
<div class="comment-container" id="li-comment-422544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I recommend learning more about Python arrays here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<p>The example was written for Python 2.7, confirm your Python version.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422544#respond" onclick='return addComment.moveForm( "comment-422544", "422544", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422862">
<div class="comment-container" id="li-comment-422862">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8a063be39857787086c58ac99ea0e076?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8a063be39857787086c58ac99ea0e076?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://optimistic.ninja" rel="external nofollow">Jonesy</a></span>
<span class="date">December 12, 2017 at 3:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422862" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Fantastic stuff here. I had a question about the network configuration. This 2 input, 2 hidden and 2 output seems a bit odd to me. I’m used to seeing 2, 2, 1 for XOR – can you explain why you have two output nodes and how they work with the max function? I think it would better explain this line for me in train():</p>
<p>expected[row[-1]] = 1</p>
<p>And lastly, why would one choose this configuration over a 2, 2, 1.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jonesy" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422862#respond" onclick='return addComment.moveForm( "comment-422862", "422862", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422877">
<div class="comment-container" id="li-comment-422877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The final model has the shape [7, 5, 3]. Perhaps check the tutorial again? It has 3 outputs, one for each of the 3 classes in the dataset.</p>
<p>Configuration was chosen via trial and error. There is no analytical way to choose a configuration for a neural network.</p>
<p>Finally, you can learn more about array indexing in Python here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=422877#respond" onclick='return addComment.moveForm( "comment-422877", "422877", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423629">
<div class="comment-container" id="li-comment-423629">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohamed Elshazly</span>
<span class="date">December 17, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423629" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason  </p>
<p>In the tain_network function  the line “expected[row[-1]] = 1”  what i understand is that you take the Y value of every row (which is either 0 or 1 ) and use it as an index in the expected array and you change the value at that index to 1   ,First i don’t know if i understand that correctly in the first place or not  but if so, Wouldn’t the modification to the expected array be locked down to just only the first and second index because “expected[row[-1]] = 1” would only be expected[0] or expected[1] ? and how would that help in our algorithm . </p>
<p>looking forward to your response   and thanks for the Great Tutorial</p>
<div class="reply">
<a aria-label="Reply to Mohamed Elshazly" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=423629#respond" onclick='return addComment.moveForm( "comment-423629", "423629", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423671">
<div class="comment-container" id="li-comment-423671">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 18, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423671" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We are one hot encoding the variable.</p>
<p>Learn more about it here:<br/>
<a href="https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=423671#respond" onclick='return addComment.moveForm( "comment-423671", "423671", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-423734">
<div class="comment-container" id="li-comment-423734">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MohamedElshazly</span>
<span class="date">December 18, 2017 at 4:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423734" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI again Jason </p>
<p>  If I’m implementing this algorithm in python 3 what should i change in expected[row[-1]]=1  in order for it to work because I’m having this error : list assignment index out of range<br/>
thanks in advance</p>
<div class="reply">
<a aria-label="Reply to MohamedElshazly" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=423734#respond" onclick='return addComment.moveForm( "comment-423734", "423734", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423779">
<div class="comment-container" id="li-comment-423779">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423779" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know off the cuff, I will look into porting the example to Py3 in the new year.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=423779#respond" onclick='return addComment.moveForm( "comment-423779", "423779", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423941">
<div class="comment-container" id="li-comment-423941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa6eacd3b9c219f3f48252f7a13e8d47?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa6eacd3b9c219f3f48252f7a13e8d47?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.tusharahuja.in" rel="external nofollow">Tushar</a></span>
<span class="date">December 19, 2017 at 5:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are just awesome Jason. You are adding more value to people’s ML skills than most average graduate schools do in the US.</p>
<p>Thanks a ton!</p>
<div class="reply">
<a aria-label="Reply to Tushar" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=423941#respond" onclick='return addComment.moveForm( "comment-423941", "423941", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424039">
<div class="comment-container" id="li-comment-424039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-424039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Tushar.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=424039#respond" onclick='return addComment.moveForm( "comment-424039", "424039", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425739">
<div class="comment-container" id="li-comment-425739">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://n.a" rel="external nofollow">mark</a></span>
<span class="date">January 6, 2018 at 3:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425739" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, thanks for your codes. I have a question, what if I want to add regularisation term like L2 during back propagation, what should i do?</p>
<div class="reply">
<a aria-label="Reply to mark" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=425739#respond" onclick='return addComment.moveForm( "comment-425739", "425739", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425753">
<div class="comment-container" id="li-comment-425753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 6, 2018 at 5:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend moving to a platform like Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=425753#respond" onclick='return addComment.moveForm( "comment-425753", "425753", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-425829">
<div class="comment-container" id="li-comment-425829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mark</span>
<span class="date">January 7, 2018 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for replying. I know the keras and have been using keras for a while. But in the problem I am focusing on, I need to make changes on the back propagation. That’s why I didn’t use keras.<br/>
So let’s go back to my original question, is the error term the cost function? Thanks.</p>
<div class="reply">
<a aria-label="Reply to mark" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=425829#respond" onclick='return addComment.moveForm( "comment-425829", "425829", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-425849">
<div class="comment-container" id="li-comment-425849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot work-through adding regularization to this tutorial for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=425849#respond" onclick='return addComment.moveForm( "comment-425849", "425849", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-427014">
<div class="comment-container" id="li-comment-427014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mojo</span>
<span class="date">January 20, 2018 at 7:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jeson,<br/>
Thanks for the informative tutorial. I have a question.<br/>
if i want to change the error equation and as well as the equation between input with hidden and hidden with output layer. How can i change it?<br/>
Hope you will reply in a short time.</p>
<p>Regards,<br/>
Mojo</p>
<div class="reply">
<a aria-label="Reply to Mojo" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=427014#respond" onclick='return addComment.moveForm( "comment-427014", "427014", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427048">
<div class="comment-container" id="li-comment-427048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a library instead, it will be much easier for you.</p>
<p>Here’s how to get started with Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/?replytocom=427048#respond" onclick='return addComment.moveForm( "comment-427048", "427048", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-backpropagation-algorithm-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3349"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="de41a1d59c"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="17"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center>
<h3>Code Algorithms From Scratch in Python</h3>
<p>Discover how to code top machine learning algorithms from first principles with Python.</p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Code Machine Learning Algorithms From Scratch Today!</a></p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>