<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Use the Keras Functional API for Deep Learning - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Use the Keras Functional API for Deep Learning - Machine Learning Mastery" property="og:title"/>
<meta content="The Keras Python library makes creating deep learning models fast and easy. The sequential API allows you to create models layer-by-layer for most problems. It is limited in that it does not allow you to create models that share layers or have multiple inputs or outputs. The functional API in Keras is an alternate way …" property="og:description"/>
<meta content="https://machinelearningmastery.com/keras-functional-api-deep-learning/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2017-10-27T05:00:20+11:00" property="article:published_time"/>
<meta content="2017-11-25T10:24:22+11:00" property="article:modified_time"/>
<meta content="2017-11-25T10:24:22+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" property="og:image:secure_url"/>
<meta content="600" property="og:image:width"/>
<meta content="936" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/keras-functional-api-deep-learning\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/keras-functional-api-deep-learning/feed/" rel="alternate" title="Machine Learning Mastery » How to Use the Keras Functional API for Deep Learning Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4392" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4392 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4392 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">How to Use the Keras Functional API for Deep Learning</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-27T05:00:20+1100">October 27, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/&amp;summary=The+Keras+Python+library+makes+creating+deep+learning+models+fast+and+easy.%0D%0A%0D%0AThe+sequential+API+al..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/&amp;summary=The+Keras+Python+library+makes+creating+deep+learning+models+fast+and+easy.%0D%0A%0D%0AThe+sequential+API+al...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>The Keras Python library makes creating deep learning models fast and easy.</p>
<p>The sequential API allows you to create models layer-by-layer for most problems. It is limited in that it does not allow you to create models that share layers or have multiple inputs or outputs.</p>
<p>The functional API in Keras is an alternate way of creating models that offers a lot more flexibility, including creating more complex models.</p>
<p>In this tutorial, you will discover how to use the more flexible functional API in Keras to define deep learning models.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>The difference between the Sequential and Functional APIs.</li>
<li>How to define simple Multilayer Perceptron, Convolutional Neural Network, and Recurrent Neural Network models using the functional API.</li>
<li>How to define more complex models with shared layers and multiple inputs and outputs.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2017</strong>: Update note about hanging dimension for input layers only affecting 1D input, thanks Joe.</li>
</ul>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 6 parts; they are:</p>
<ol>
<li>Keras Sequential Models</li>
<li>Keras Functional Models</li>
<li>Standard Network Models</li>
<li>Shared Layers Model</li>
<li>Multiple Input and Output Models</li>
<li>Best Practices</li>
</ol>
<h2>1. Keras Sequential Models</h2>
<p>As a review, Keras provides a Sequential model API.</p>
<p>This is a way of creating deep learning models where an instance of the Sequential class is created and model layers are created and added to it.</p>
<p>For example, the layers can be defined and passed to the Sequential as an array:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bc5702580786" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Sequential
from keras.layers import Dense
model = Sequential([Dense(2, input_dim=1), Dense(1)])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bc5702580786-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bc5702580786-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bc5702580786-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bc5702580786-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bc5702580786-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a658e6d18bc5702580786-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Layers can also be added piecewise:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bcf525886250" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Sequential
from keras.layers import Dense
model = Sequential()
model.add(Dense(2, input_dim=1))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bcf525886250-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bcf525886250-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bcf525886250-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bcf525886250-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bcf525886250-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bcf525886250-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bcf525886250-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a658e6d18bcf525886250-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bcf525886250-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bcf525886250-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The Sequential model API is great for developing deep learning models in most situations, but it also has some limitations.</p>
<p>For example, it is not straightforward to define models that may have multiple different input sources, produce multiple output destinations or models that re-use layers.</p>
<h2>2. Keras Functional Models</h2>
<p>The Keras functional API provides a more flexible way for defining models.</p>
<p>It specifically allows you to define multiple input or output models as well as models that share layers. More than that, it allows you to define ad hoc acyclic network graphs.</p>
<p>Models are defined by creating instances of layers and connecting them directly to each other in pairs, then defining a Model that specifies the layers to act as the input and output to the model.</p>
<p>Let’s look at the three unique aspects of Keras functional API in turn:</p>
<h3>1. Defining Input</h3>
<p>Unlike the Sequential model, you must create and define a standalone Input layer that specifies the shape of input data.</p>
<p>The input layer takes a shape argument that is a tuple that indicates the dimensionality of the input data.</p>
<p>When input data is one-dimensional, such as for a multilayer Perceptron, the shape must explicitly leave room for the shape of the mini-batch size used when splitting the data when training the network. Therefore, the shape tuple is always defined with a hanging last dimension when the input is one-dimensional (2,), for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bd3634968107" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.layers import Input
visible = Input(shape=(2,))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bd3634968107-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd3634968107-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bd3634968107-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd3634968107-2"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h3>2. Connecting Layers</h3>
<p>The layers in the model are connected pairwise.</p>
<p>This is done by specifying where the input comes from when defining each new layer. A bracket notation is used, such that after the layer is created, the layer from which the input to the current layer comes from is specified.</p>
<p>Let’s make this clear with a short example. We can create the input layer as above, then create a hidden layer as a Dense that receives input only from the input layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bd6181942571" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(2,))
hidden = Dense(2)(visible)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bd6181942571-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd6181942571-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bd6181942571-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd6181942571-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bd6181942571-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd6181942571-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a658e6d18bd6181942571-3"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd6181942571-4"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Note the (visible) after the creation of the Dense layer that connects the input layer output as the input to the dense hidden layer.</p>
<p>It is this way of connecting layers piece by piece that gives the functional API its flexibility. For example, you can see how easy it would be to start defining ad hoc graphs of layers.</p>
<h3>3. Creating the Model</h3>
<p>After creating all of your model layers and connecting them together, you must define the model.</p>
<p>As with the Sequential API, the model is the thing you can summarize, fit, evaluate, and use to make predictions.</p>
<p>Keras provides a Model class that you can use to create a model from your created layers. It requires that you only specify the input and output layers. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bd9585250443" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(2,))
hidden = Dense(2)(visible)
model = Model(inputs=visible, outputs=hidden)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bd9585250443-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd9585250443-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bd9585250443-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd9585250443-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bd9585250443-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bd9585250443-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bd9585250443-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd9585250443-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18bd9585250443-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd9585250443-4"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bd9585250443-5"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bd9585250443-6"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Now that we know all of the key pieces of the Keras functional API, let’s work through defining a suite of different models and build up some practice with it.</p>
<p>Each example is executable and prints the structure and creates a diagram of the graph. I recommend doing this for your own models to make it clear what exactly you have defined.</p>
<p>My hope is that these examples provide templates for you when you want to define your own models using the functional API in the future.</p>
<h2>3. Standard Network Models</h2>
<p>When getting started with the functional API, it is a good idea to see how some standard neural network models are defined.</p>
<p>In this section, we will look at defining a simple multilayer Perceptron, convolutional neural network, and recurrent neural network.</p>
<p>These examples will provide a foundation for understanding the more elaborate examples later.</p>
<h3>Multilayer Perceptron</h3>
<p>In this section, we define a multilayer Perceptron model for binary classification.</p>
<p>The model has 10 inputs, 3 hidden layers with 10, 20, and 10 neurons, and an output layer with 1 output. Rectified linear activation functions are used in each hidden layer and a sigmoid activation function is used in the output layer, for binary classification.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bdc491239703" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multilayer Perceptron
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(10,))
hidden1 = Dense(10, activation='relu')(visible)
hidden2 = Dense(20, activation='relu')(hidden1)
hidden3 = Dense(10, activation='relu')(hidden2)
output = Dense(1, activation='sigmoid')(hidden3)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multilayer_perceptron_graph.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bdc491239703-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bdc491239703-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-1"><span class="crayon-p"># Multilayer Perceptron</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-6"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-7"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-8"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-9"><span class="crayon-v">hidden3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-10"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-12"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bdc491239703-14"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5a658e6d18bdc491239703-15"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multilayer_perceptron_graph.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Running the example prints the structure of the network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bde701531935" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 10)                0
_________________________________________________________________
dense_1 (Dense)              (None, 10)                110
_________________________________________________________________
dense_2 (Dense)              (None, 20)                220
_________________________________________________________________
dense_3 (Dense)              (None, 10)                210
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 11
=================================================================
Total params: 551
Trainable params: 551
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bde701531935-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18bde701531935-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bde701531935-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-4">input_1 (InputLayer)         (None, 10)                0</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-6">dense_1 (Dense)              (None, 10)                110</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-8">dense_2 (Dense)              (None, 20)                220</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-10">dense_3 (Dense)              (None, 10)                210</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-12">dense_4 (Dense)              (None, 1)                 11</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-13">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-14">Total params: 551</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-15">Trainable params: 551</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bde701531935-16">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5a658e6d18bde701531935-17">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4393" style="max-width: 193px"><img alt="Multilayer Perceptron Network Graph" class="size-full wp-image-4393" height="449" sizes="(max-width: 183px) 100vw, 183px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph.png 183w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph-122x300.png 122w" width="183"/><p class="wp-caption-text">Multilayer Perceptron Network Graph</p></div>
<h3>Convolutional Neural Network</h3>
<p>In this section, we will define a convolutional neural network for image classification.</p>
<p>The model receives black and white 64×64 images as input, then has a sequence of two convolutional and pooling layers as feature extractors, followed by a fully connected layer to interpret the features and an output layer with a sigmoid activation for two-class predictions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18be1692819185" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Convolutional Neural Network
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
visible = Input(shape=(64,64,1))
conv1 = Conv2D(32, kernel_size=4, activation='relu')(visible)
pool1 = MaxPooling2D(pool_size=(2, 2))(conv1)
conv2 = Conv2D(16, kernel_size=4, activation='relu')(pool1)
pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)
hidden1 = Dense(10, activation='relu')(pool2)
output = Dense(1, activation='sigmoid')(hidden1)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='convolutional_neural_network.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be1692819185-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18be1692819185-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18be1692819185-1"><span class="crayon-p"># Convolutional Neural Network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-8"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-9"><span class="crayon-v">conv1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-10"><span class="crayon-v">pool1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-11"><span class="crayon-v">conv2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-12"><span class="crayon-v">pool2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-13"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-14"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-15"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-16"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be1692819185-18"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5a658e6d18be1692819185-19"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'convolutional_neural_network.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18be4497518981" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 64, 64, 1)         0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 61, 61, 32)        544
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 32)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 27, 27, 16)        8208
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 13, 13, 16)        0
_________________________________________________________________
dense_1 (Dense)              (None, 13, 13, 10)        170
_________________________________________________________________
dense_2 (Dense)              (None, 13, 13, 1)         11
=================================================================
Total params: 8,933
Trainable params: 8,933
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be4497518981-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18be4497518981-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18be4497518981-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-4">input_1 (InputLayer)         (None, 64, 64, 1)         0</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-6">conv2d_1 (Conv2D)            (None, 61, 61, 32)        544</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-8">max_pooling2d_1 (MaxPooling2 (None, 30, 30, 32)        0</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-10">conv2d_2 (Conv2D)            (None, 27, 27, 16)        8208</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-12">max_pooling2d_2 (MaxPooling2 (None, 13, 13, 16)        0</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-13">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-14">dense_1 (Dense)              (None, 13, 13, 10)        170</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-15">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-16">dense_2 (Dense)              (None, 13, 13, 1)         11</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-17">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-18">Total params: 8,933</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-19">Trainable params: 8,933</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be4497518981-20">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5a658e6d18be4497518981-21">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4394" style="max-width: 303px"><img alt="Convolutional Neural Network Graph" class="size-full wp-image-4394" height="644" sizes="(max-width: 293px) 100vw, 293px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/convolutional_neural_network.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/convolutional_neural_network.png 293w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/convolutional_neural_network-136x300.png 136w" width="293"/><p class="wp-caption-text">Convolutional Neural Network Graph</p></div>
<h3>Recurrent Neural Network</h3>
<p>In this section, we will define a long short-term memory recurrent neural network for sequence classification.</p>
<p>The model expects 100 time steps of one feature as input. The model has a single LSTM hidden layer to extract features from the sequence, followed by a fully connected layer to interpret the LSTM output, followed by an output layer for making binary predictions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18be8178674893" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Recurrent Neural Network
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
visible = Input(shape=(100,1))
hidden1 = LSTM(10)(visible)
hidden2 = Dense(10, activation='relu')(hidden1)
output = Dense(1, activation='sigmoid')(hidden2)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='recurrent_neural_network.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18be8178674893-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18be8178674893-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18be8178674893-1"><span class="crayon-p"># Recurrent Neural Network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-7"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-8"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-9"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-10"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-12"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18be8178674893-14"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5a658e6d18be8178674893-15"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'recurrent_neural_network.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bed107530446" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 100, 1)            0
_________________________________________________________________
lstm_1 (LSTM)                (None, 10)                480
_________________________________________________________________
dense_1 (Dense)              (None, 10)                110
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 11
=================================================================
Total params: 601
Trainable params: 601
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bed107530446-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bed107530446-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bed107530446-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-4">input_1 (InputLayer)         (None, 100, 1)            0</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-6">lstm_1 (LSTM)                (None, 10)                480</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-8">dense_1 (Dense)              (None, 10)                110</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-10">dense_2 (Dense)              (None, 1)                 11</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-11">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-12">Total params: 601</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-13">Trainable params: 601</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bed107530446-14">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5a658e6d18bed107530446-15">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4395" style="max-width: 193px"><img alt="Recurrent Neural Network Graph" class="size-full wp-image-4395" height="352" sizes="(max-width: 183px) 100vw, 183px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network.png 183w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network-156x300.png 156w" width="183"/><p class="wp-caption-text">Recurrent Neural Network Graph</p></div>
<h2>4. Shared Layers Model</h2>
<p>Multiple layers can share the output from one layer.</p>
<p>For example, there may be multiple different feature extraction layers from an input, or multiple layers used to interpret the output from a feature extraction layer.</p>
<p>Let’s look at both of these examples.</p>
<h3>Shared Input Layer</h3>
<p>In this section, we define multiple convolutional layers with differently sized kernels to interpret an image input.</p>
<p>The model takes black and white images with the size 64×64 pixels. There are two CNN feature extraction submodels that share this input; the first has a kernel size of 4 and the second a kernel size of 8. The outputs from these feature extraction submodels are flattened into vectors and concatenated into one long vector and passed on to a fully connected layer for interpretation before a final output layer makes a binary classification.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bf0491901272" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Shared Input Layer
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
from keras.layers.merge import concatenate
# input layer
visible = Input(shape=(64,64,1))
# first feature extractor
conv1 = Conv2D(32, kernel_size=4, activation='relu')(visible)
pool1 = MaxPooling2D(pool_size=(2, 2))(conv1)
flat1 = Flatten()(pool1)
# second feature extractor
conv2 = Conv2D(16, kernel_size=8, activation='relu')(visible)
pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)
flat2 = Flatten()(pool2)
# merge feature extractors
merge = concatenate([flat1, flat2])
# interpretation layer
hidden1 = Dense(10, activation='relu')(merge)
# prediction output
output = Dense(1, activation='sigmoid')(hidden1)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='shared_input_layer.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-24">24</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-26">26</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-28">28</div><div class="crayon-num" data-line="crayon-5a658e6d18bf0491901272-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf0491901272-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-1"><span class="crayon-p"># Shared Input Layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-10"><span class="crayon-p"># input layer</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-11"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-12"><span class="crayon-p"># first feature extractor</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-13"><span class="crayon-v">conv1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-14"><span class="crayon-v">pool1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-15"><span class="crayon-v">flat1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-16"><span class="crayon-p"># second feature extractor</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-17"><span class="crayon-v">conv2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-18"><span class="crayon-v">pool2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-19"><span class="crayon-v">flat2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-20"><span class="crayon-p"># merge feature extractors</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-21"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">flat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">flat2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-22"><span class="crayon-p"># interpretation layer</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-23"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-24"><span class="crayon-p"># prediction output</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-25"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-26"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-27"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf0491901272-29"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf0491901272-30"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'shared_input_layer.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bf3921783496" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 64, 64, 1)     0
____________________________________________________________________________________________________
conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]
____________________________________________________________________________________________________
conv2d_2 (Conv2D)                (None, 57, 57, 16)    1040        input_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)   (None, 28, 28, 16)    0           conv2d_2[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 28800)         0           max_pooling2d_1[0][0]
____________________________________________________________________________________________________
flatten_2 (Flatten)              (None, 12544)         0           max_pooling2d_2[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 41344)         0           flatten_1[0][0]
                                                                   flatten_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            413450      concatenate_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]
====================================================================================================
Total params: 415,045
Trainable params: 415,045
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-24">24</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-26">26</div><div class="crayon-num" data-line="crayon-5a658e6d18bf3921783496-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf3921783496-28">28</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-4">input_1 (InputLayer)             (None, 64, 64, 1)     0</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-6">conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-8">conv2d_2 (Conv2D)                (None, 57, 57, 16)    1040        input_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-10">max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-12">max_pooling2d_2 (MaxPooling2D)   (None, 28, 28, 16)    0           conv2d_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-14">flatten_1 (Flatten)              (None, 28800)         0           max_pooling2d_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-16">flatten_2 (Flatten)              (None, 12544)         0           max_pooling2d_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-17">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-18">concatenate_1 (Concatenate)      (None, 41344)         0           flatten_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-19">                                                                   flatten_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-20">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-21">dense_1 (Dense)                  (None, 10)            413450      concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-22">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-23">dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-24">====================================================================================================</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-25">Total params: 415,045</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-26">Trainable params: 415,045</div><div class="crayon-line" id="crayon-5a658e6d18bf3921783496-27">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf3921783496-28">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4396" style="max-width: 610px"><img alt="Neural Network Graph With Shared Inputs" class="size-full wp-image-4396" height="644" sizes="(max-width: 600px) 100vw, 600px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer.png 600w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer-280x300.png 280w" width="600"/><p class="wp-caption-text">Neural Network Graph With Shared Inputs</p></div>
<h3>Shared Feature Extraction Layer</h3>
<p>In this section, we will two parallel submodels to interpret the output of an LSTM feature extractor for sequence classification.</p>
<p>The input to the model is 100 time steps of 1 feature. An LSTM layer with 10 memory cells interprets this sequence. The first interpretation model is a shallow single fully connected layer, the second is a deep 3 layer model. The output of both interpretation models are concatenated into one long vector that is passed to the output layer used to make a binary prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bf8178041484" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Shared Feature Extraction Layer
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
from keras.layers.merge import concatenate
# define input
visible = Input(shape=(100,1))
# feature extraction
extract1 = LSTM(10)(visible)
# first interpretation model
interp1 = Dense(10, activation='relu')(extract1)
# second interpretation model
interp11 = Dense(10, activation='relu')(extract1)
interp12 = Dense(20, activation='relu')(interp11)
interp13 = Dense(10, activation='relu')(interp12)
# merge interpretation
merge = concatenate([interp1, interp13])
# output
output = Dense(1, activation='sigmoid')(merge)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='shared_feature_extractor.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-24">24</div><div class="crayon-num" data-line="crayon-5a658e6d18bf8178041484-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bf8178041484-26">26</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-1"><span class="crayon-p"># Shared Feature Extraction Layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-8"><span class="crayon-p"># define input</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-9"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-10"><span class="crayon-p"># feature extraction</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-11"><span class="crayon-v">extract1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-12"><span class="crayon-p"># first interpretation model</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-13"><span class="crayon-v">interp1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-14"><span class="crayon-p"># second interpretation model</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-15"><span class="crayon-v">interp11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-16"><span class="crayon-v">interp12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">interp11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-17"><span class="crayon-v">interp13</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">interp12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-18"><span class="crayon-p"># merge interpretation</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-19"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">interp1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interp13</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-20"><span class="crayon-p"># output</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-21"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-22"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-23"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18bf8178041484-25"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bf8178041484-26"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'shared_feature_extractor.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18bfb568826146" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 100, 1)        0
____________________________________________________________________________________________________
lstm_1 (LSTM)                    (None, 10)            480         input_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 10)            110         lstm_1[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 20)            220         dense_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            110         lstm_1[0][0]
____________________________________________________________________________________________________
dense_4 (Dense)                  (None, 10)            210         dense_3[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 20)            0           dense_1[0][0]
                                                                   dense_4[0][0]
____________________________________________________________________________________________________
dense_5 (Dense)                  (None, 1)             21          concatenate_1[0][0]
====================================================================================================
Total params: 1,151
Trainable params: 1,151
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18bfb568826146-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18bfb568826146-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-4">input_1 (InputLayer)             (None, 100, 1)        0</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-6">lstm_1 (LSTM)                    (None, 10)            480         input_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-8">dense_2 (Dense)                  (None, 10)            110         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-10">dense_3 (Dense)                  (None, 20)            220         dense_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-12">dense_1 (Dense)                  (None, 10)            110         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-14">dense_4 (Dense)                  (None, 10)            210         dense_3[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-16">concatenate_1 (Concatenate)      (None, 20)            0           dense_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-17">                                                                   dense_4[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-18">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-19">dense_5 (Dense)                  (None, 1)             21          concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-20">====================================================================================================</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-21">Total params: 1,151</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-22">Trainable params: 1,151</div><div class="crayon-line" id="crayon-5a658e6d18bfb568826146-23">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18bfb568826146-24">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4397" style="max-width: 325px"><img alt="Neural Network Graph With Shared Feature Extraction Layer" class="size-full wp-image-4397" height="644" sizes="(max-width: 315px) 100vw, 315px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor.png 315w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor-147x300.png 147w" width="315"/><p class="wp-caption-text">Neural Network Graph With Shared Feature Extraction Layer</p></div>
<h2>5. Multiple Input and Output Models</h2>
<p>The functional API can also be used to develop more complex models with multiple inputs, possibly with different modalities. It can also be used to develop models that produce multiple outputs.</p>
<p>We will look at examples of each in this section.</p>
<h3>Multiple Input Model</h3>
<p>We will develop an image classification model that takes two versions of the image as input, each of a different size. Specifically a black and white 64×64 version and a color 32×32 version. Separate feature extraction CNN models operate on each, then the results from both models are concatenated for interpretation and ultimate prediction.</p>
<p>Note that in the creation of the Model() instance, that we define the two input layers as an array. Specifically:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18c00605796472" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Model(inputs=[visible1, visible2], outputs=output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18c00605796472-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18c00605796472-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">visible1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">visible2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18c02811597460" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multiple Inputs
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
from keras.layers.merge import concatenate
# first input model
visible1 = Input(shape=(64,64,1))
conv11 = Conv2D(32, kernel_size=4, activation='relu')(visible1)
pool11 = MaxPooling2D(pool_size=(2, 2))(conv11)
conv12 = Conv2D(16, kernel_size=4, activation='relu')(pool11)
pool12 = MaxPooling2D(pool_size=(2, 2))(conv12)
flat1 = Flatten()(pool12)
# second input model
visible2 = Input(shape=(32,32,3))
conv21 = Conv2D(32, kernel_size=4, activation='relu')(visible2)
pool21 = MaxPooling2D(pool_size=(2, 2))(conv21)
conv22 = Conv2D(16, kernel_size=4, activation='relu')(pool21)
pool22 = MaxPooling2D(pool_size=(2, 2))(conv22)
flat2 = Flatten()(pool22)
# merge input models
merge = concatenate([flat1, flat2])
# interpretation model
hidden1 = Dense(10, activation='relu')(merge)
hidden2 = Dense(10, activation='relu')(hidden1)
output = Dense(1, activation='sigmoid')(hidden2)
model = Model(inputs=[visible1, visible2], outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multiple_inputs.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-24">24</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-26">26</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-28">28</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-30">30</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-32">32</div><div class="crayon-num" data-line="crayon-5a658e6d18c02811597460-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c02811597460-34">34</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18c02811597460-1"><span class="crayon-p"># Multiple Inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-10"><span class="crayon-p"># first input model</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-11"><span class="crayon-v">visible1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-12"><span class="crayon-v">conv11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-13"><span class="crayon-v">pool11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv11</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-14"><span class="crayon-v">conv12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-15"><span class="crayon-v">pool12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-16"><span class="crayon-v">flat1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-17"><span class="crayon-p"># second input model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-18"><span class="crayon-v">visible2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-19"><span class="crayon-v">conv21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-20"><span class="crayon-v">pool21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-21"><span class="crayon-v">conv22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool21</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-22"><span class="crayon-v">pool22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv22</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-23"><span class="crayon-v">flat2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool22</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-24"><span class="crayon-p"># merge input models</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-25"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">flat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">flat2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-26"><span class="crayon-p"># interpretation model</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-27"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-28"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-29"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-30"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">visible1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">visible2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-31"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c02811597460-33"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c02811597460-34"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multiple_inputs.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0034 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18c05908493646" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 64, 64, 1)     0
____________________________________________________________________________________________________
input_2 (InputLayer)             (None, 32, 32, 3)     0
____________________________________________________________________________________________________
conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]
____________________________________________________________________________________________________
conv2d_3 (Conv2D)                (None, 29, 29, 32)    1568        input_2[0][0]
____________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)   (None, 14, 14, 32)    0           conv2d_3[0][0]
____________________________________________________________________________________________________
conv2d_2 (Conv2D)                (None, 27, 27, 16)    8208        max_pooling2d_1[0][0]
____________________________________________________________________________________________________
conv2d_4 (Conv2D)                (None, 11, 11, 16)    8208        max_pooling2d_3[0][0]
____________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)   (None, 13, 13, 16)    0           conv2d_2[0][0]
____________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)   (None, 5, 5, 16)      0           conv2d_4[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 2704)          0           max_pooling2d_2[0][0]
____________________________________________________________________________________________________
flatten_2 (Flatten)              (None, 400)           0           max_pooling2d_4[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 3104)          0           flatten_1[0][0]
                                                                   flatten_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            31050       concatenate_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 10)            110         dense_1[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 1)             11          dense_2[0][0]
====================================================================================================
Total params: 49,699
Trainable params: 49,699
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-24">24</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-26">26</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-28">28</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-30">30</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-32">32</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-34">34</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-36">36</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-38">38</div><div class="crayon-num" data-line="crayon-5a658e6d18c05908493646-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c05908493646-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18c05908493646-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-4">input_1 (InputLayer)             (None, 64, 64, 1)     0</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-6">input_2 (InputLayer)             (None, 32, 32, 3)     0</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-8">conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-10">conv2d_3 (Conv2D)                (None, 29, 29, 32)    1568        input_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-12">max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-14">max_pooling2d_3 (MaxPooling2D)   (None, 14, 14, 32)    0           conv2d_3[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-16">conv2d_2 (Conv2D)                (None, 27, 27, 16)    8208        max_pooling2d_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-17">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-18">conv2d_4 (Conv2D)                (None, 11, 11, 16)    8208        max_pooling2d_3[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-19">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-20">max_pooling2d_2 (MaxPooling2D)   (None, 13, 13, 16)    0           conv2d_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-21">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-22">max_pooling2d_4 (MaxPooling2D)   (None, 5, 5, 16)      0           conv2d_4[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-23">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-24">flatten_1 (Flatten)              (None, 2704)          0           max_pooling2d_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-25">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-26">flatten_2 (Flatten)              (None, 400)           0           max_pooling2d_4[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-27">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-28">concatenate_1 (Concatenate)      (None, 3104)          0           flatten_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-29">                                                                   flatten_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-30">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-31">dense_1 (Dense)                  (None, 10)            31050       concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-32">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-33">dense_2 (Dense)                  (None, 10)            110         dense_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-34">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-35">dense_3 (Dense)                  (None, 1)             11          dense_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-36">====================================================================================================</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-37">Total params: 49,699</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-38">Trainable params: 49,699</div><div class="crayon-line" id="crayon-5a658e6d18c05908493646-39">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c05908493646-40">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4398" style="max-width: 610px"><img alt="Neural Network Graph With Multiple Inputs" class="size-full wp-image-4398" height="936" sizes="(max-width: 600px) 100vw, 600px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png 600w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs-192x300.png 192w" width="600"/><p class="wp-caption-text">Neural Network Graph With Multiple Inputs</p></div>
<h3>Multiple Output Model</h3>
<p>In this section, we will develop a model that makes two different types of predictions. Given an input sequence of 100 time steps of one feature, the model will both classify the sequence and output a new sequence with the same length.</p>
<p>An LSTM layer interprets the input sequence and returns the hidden state for each time step. The first output model creates a stacked LSTM, interprets the features, and makes a binary prediction. The second output model uses the same output layer to make a real-valued prediction for each input time step.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18c0a033161737" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multiple Outputs
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
from keras.layers.wrappers import TimeDistributed
# input layer
visible = Input(shape=(100,1))
# feature extraction
extract = LSTM(10, return_sequences=True)(visible)
# classification output
class11 = LSTM(10)(extract)
class12 = Dense(10, activation='relu')(class11)
output1 = Dense(1, activation='sigmoid')(class12)
# sequence output
output2 = TimeDistributed(Dense(1, activation='linear'))(extract)
# output
model = Model(inputs=visible, outputs=[output1, output2])
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multiple_outputs.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-20">20</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0a033161737-22">22</div><div class="crayon-num" data-line="crayon-5a658e6d18c0a033161737-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-1"><span class="crayon-p"># Multiple Outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">wrappers </span><span class="crayon-e">import </span><span class="crayon-v">TimeDistributed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-8"><span class="crayon-p"># input layer</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-9"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-10"><span class="crayon-p"># feature extraction</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-11"><span class="crayon-v">extract</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-12"><span class="crayon-p"># classification output</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-13"><span class="crayon-v">class11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-14"><span class="crayon-v">class12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">class11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-15"><span class="crayon-v">output1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">class12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-16"><span class="crayon-p"># sequence output</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-17"><span class="crayon-v">output2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-18"><span class="crayon-p"># output</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-19"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">output1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-20"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0a033161737-22"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5a658e6d18c0a033161737-23"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multiple_outputs.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d18c0e374871504" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 100, 1)        0
____________________________________________________________________________________________________
lstm_1 (LSTM)                    (None, 100, 10)       480         input_1[0][0]
____________________________________________________________________________________________________
lstm_2 (LSTM)                    (None, 10)            840         lstm_1[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            110         lstm_2[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]
____________________________________________________________________________________________________
time_distributed_1 (TimeDistribu (None, 100, 1)        11          lstm_1[0][0]
====================================================================================================
Total params: 1,452
Trainable params: 1,452
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d18c0e374871504-18">18</div><div class="crayon-num" data-line="crayon-5a658e6d18c0e374871504-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-4">input_1 (InputLayer)             (None, 100, 1)        0</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-6">lstm_1 (LSTM)                    (None, 100, 10)       480         input_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-8">lstm_2 (LSTM)                    (None, 10)            840         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-10">dense_1 (Dense)                  (None, 10)            110         lstm_2[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-12">dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-14">time_distributed_1 (TimeDistribu (None, 100, 1)        11          lstm_1[0][0]</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-15">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-16">Total params: 1,452</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-17">Trainable params: 1,452</div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d18c0e374871504-18">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5a658e6d18c0e374871504-19">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4399" style="max-width: 611px"><img alt="Neural Network Graph With Multiple Outputs" class="size-full wp-image-4399" height="449" sizes="(max-width: 601px) 100vw, 601px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs.png 601w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs-300x224.png 300w" width="601"/><p class="wp-caption-text">Neural Network Graph With Multiple Outputs</p></div>
<h2>6. Best Practices</h2>
<p>In this section, I want to give you some tips to get the most out of the functional API when you are defining your own models.</p>
<ul>
<li><strong>Consistent Variable Names</strong>. Use the same variable name for the input (visible) and output layers (output) and perhaps even the hidden layers (hidden1, hidden2). It will help to connect things together correctly.</li>
<li><strong>Review Layer Summary</strong>. Always print the model summary and review the layer outputs to ensure that the model was connected together as you expected.</li>
<li><strong>Review Graph Plots</strong>. Always create a plot of the model graph and review it to ensure that everything was put together as you intended.</li>
<li><strong>Name the layers</strong>. You can assign names to layers that are used when reviewing summaries and plots of the model graph. For example: Dense(1, name=’hidden1′).</li>
<li><strong>Separate Submodels</strong>. Consider separating out the development of submodels and combine the submodels together at the end.</li>
</ul>
<p>Do you have your own best practice tips when using the functional API?<br/>
Let me know in the comments.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://keras.io/models/model/">The Sequential model API</a></li>
<li><a href="https://keras.io/models/model/">Getting started with the Keras Sequential model</a></li>
<li><a href="https://keras.io/models/model/">Getting started with the Keras functional API</a></li>
<li><a href="https://keras.io/models/model/">Model class Functional API</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to use the functional API in Keras for defining simple and complex deep learning models.</p>
<p>Specifically, you learned:</p>
<ul>
<li>The difference between the Sequential and Functional APIs.</li>
<li>How to define simple Multilayer Perceptron, Convolutional Neural Network, and Recurrent Neural Network models using the functional API.</li>
<li>How to define more complex models with shared layers and multiple inputs and outputs.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/&amp;summary=The+Keras+Python+library+makes+creating+deep+learning+models+fast+and+easy.%0D%0A%0D%0AThe+sequential+API+al..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Use%20the%20Keras%20Functional%20API%20for%20Deep%20Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/&amp;summary=The+Keras+Python+library+makes+creating+deep+learning+models+fast+and+easy.%0D%0A%0D%0AThe+sequential+API+al...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/define-encoder-decoder-sequence-sequence-model-neural-machine-translation-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Define an Encoder-Decoder Sequence-to-Sequence Model for Neural Machine Translation in Keras</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="next">How to Develop a Word Embedding Model for Predicting Movie Review Sentiment <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">34 Responses to <em>How to Use the Keras Functional API for Deep Learning</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-418060">
<div class="comment-container" id="li-comment-418060">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Salameh</span>
<span class="date">October 27, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418060" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you<br/>
I have been waiting fir this tutorial</p>
<div class="reply">
<a aria-label="Reply to Salameh" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418060#respond" onclick='return addComment.moveForm( "comment-418060", "418060", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418101">
<div class="comment-container" id="li-comment-418101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I hope it helps!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418101#respond" onclick='return addComment.moveForm( "comment-418101", "418101", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418066">
<div class="comment-container" id="li-comment-418066">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet Ali</span>
<span class="date">October 27, 2017 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418066" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re awesome Jason!</p>
<p>I just can’t wait to see more from you on this wonderful blog, where did you hide all of this 😉<br/>
Can you please write a book where you implement more of the functional API?<br/>
I’m sure the book will be a real success</p>
<p>Best regards<br/>
Thabet</p>
<div class="reply">
<a aria-label="Reply to Thabet Ali" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418066#respond" onclick='return addComment.moveForm( "comment-418066", "418066", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-418095">
<div class="comment-container" id="li-comment-418095">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">October 27, 2017 at 12:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418095" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree with Thabet Ali, need a book on advance functional API part.</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418095#respond" onclick='return addComment.moveForm( "comment-418095", "418095", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-418108">
<div class="comment-container" id="li-comment-418108">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418108" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What aspects of the functional API do you need more help with Tom?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418108#respond" onclick='return addComment.moveForm( "comment-418108", "418108", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418104">
<div class="comment-container" id="li-comment-418104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<p>What problems are you having with the functional API?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418104#respond" onclick='return addComment.moveForm( "comment-418104", "418104", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418126">
<div class="comment-container" id="li-comment-418126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">October 27, 2017 at 7:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to know more on how to implement autoencoders on multi input time series signals with a single output categorical classification, using the functional API</p>
<div class="reply">
<a aria-label="Reply to Thabet" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418126#respond" onclick='return addComment.moveForm( "comment-418126", "418126", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-418167">
<div class="comment-container" id="li-comment-418167">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418167" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>LSTMs, for example, can take multiple time series directly and don’t require parallel input models.</p>
<p>Why do you want to use autoencoders for time series?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418167#respond" onclick='return addComment.moveForm( "comment-418167", "418167", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-418189">
<div class="comment-container" id="li-comment-418189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">October 28, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I think it’s because the output sequence is shorter than the input sequence<br/>
Like seen in this dataset:</p>
<p><a href="https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones" rel="nofollow">https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones</a></p>
<p>Where there are three time series inputs and 5 different classes as output</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-418125">
<div class="comment-container" id="li-comment-418125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexander</span>
<span class="date">October 27, 2017 at 6:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thank you for very interest blog. Beautiful article which can open new doors.</p>
<div class="reply">
<a aria-label="Reply to Alexander" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418125#respond" onclick='return addComment.moveForm( "comment-418125", "418125", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418164">
<div class="comment-container" id="li-comment-418164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Alexander.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418164#respond" onclick='return addComment.moveForm( "comment-418164", "418164", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418223">
<div class="comment-container" id="li-comment-418223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7649fe4efabb5c624ecfba7c28e72dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7649fe4efabb5c624ecfba7c28e72dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Leon</span>
<span class="date">October 28, 2017 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dr. Brownlee,<br/>
How do you study mathematics behind so many algorithms that you implement?<br/>
regards<br/>
Leon</p>
<div class="reply">
<a aria-label="Reply to Leon" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418223#respond" onclick='return addComment.moveForm( "comment-418223", "418223", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418287">
<div class="comment-container" id="li-comment-418287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I read a lot 🙂</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418287#respond" onclick='return addComment.moveForm( "comment-418287", "418287", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-418955">
<div class="comment-container" id="li-comment-418955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 4, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can I consider the initial_state of an LSTM layer as an input branch of the architecture? Say that for each data I have a sequence s1, s2, s3 and a context feature X. I define an LSTM with 128 neurons, for each batch I want to map X to a 128 dimensional feature through a Dense(128) layer and set the initial_state for that batch training, meanwhile the sequence s1, s2,s3 is fed to the LSTM as the input sequence.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418955#respond" onclick='return addComment.moveForm( "comment-418955", "418955", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418958">
<div class="comment-container" id="li-comment-418958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Alex, I’m not sure I follow. If you have some ideas, perhaps design an experiment to test them?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=418958#respond" onclick='return addComment.moveForm( "comment-418958", "418958", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419145">
<div class="comment-container" id="li-comment-419145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3300cae8ccaeba68b768bafc5cd605ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3300cae8ccaeba68b768bafc5cd605ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://jithurjacob.in" rel="external nofollow">Jithu R Jacob</a></span>
<span class="date">November 6, 2017 at 8:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for the awesome tutorial. </p>
<p>For anyone wants to directly visualize in Jupyter Notebooks use the following lines.</p>
<p>from IPython.display import SVG<br/>
from keras.utils.vis_utils import model_to_dot</p>
<p>SVG(model_to_dot(model).create(prog=’dot’, format=’svg’))</p>
<div class="reply">
<a aria-label="Reply to Jithu R Jacob" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=419145#respond" onclick='return addComment.moveForm( "comment-419145", "419145", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419196">
<div class="comment-container" id="li-comment-419196">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419196" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome, thanks for the tip!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=419196#respond" onclick='return addComment.moveForm( "comment-419196", "419196", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419166">
<div class="comment-container" id="li-comment-419166">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c442e5fec2ad69d4f2995af55cbdd45f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c442e5fec2ad69d4f2995af55cbdd45f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luis</span>
<span class="date">November 7, 2017 at 2:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419166" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this blog. It is really helpful and well explained.</p>
<div class="reply">
<a aria-label="Reply to Luis" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=419166#respond" onclick='return addComment.moveForm( "comment-419166", "419166", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419203">
<div class="comment-container" id="li-comment-419203">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419203" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Luis, I’m glad to hear that. I appreciate your support!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=419203#respond" onclick='return addComment.moveForm( "comment-419203", "419203", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419687">
<div class="comment-container" id="li-comment-419687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/977ae5464383586a39323e6192561e8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/977ae5464383586a39323e6192561e8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cal Almodovar</span>
<span class="date">November 11, 2017 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason – I am wondering if the code should be:</p>
<p>visible = Input(image_file, shape=( height, width, color channels)) </p>
<p>if not, I wonder how the code references the image in question….</p>
<p>Surprised no one else asked this…</p>
<p>YOU ROCK JASON!</p>
<div class="reply">
<a aria-label="Reply to Cal Almodovar" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=419687#respond" onclick='return addComment.moveForm( "comment-419687", "419687", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421119">
<div class="comment-container" id="li-comment-421119">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da0eb62236eeacad969362f77b31642e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da0eb62236eeacad969362f77b31642e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">joe</span>
<span class="date">November 25, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421119" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In section 1 you write that “the shape tuple is always defined with a hanging last dimension”, but when you define the convolutional network, you define it as such:</p>
<p>visible = Input(shape=(64,64,1))</p>
<p>without any hanging last dimension. Am I missing something here?</p>
<div class="reply">
<a aria-label="Reply to joe" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421119#respond" onclick='return addComment.moveForm( "comment-421119", "421119", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421145">
<div class="comment-container" id="li-comment-421145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I was incorrect. This is only the case for 1D input. I have updated the post, thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421145#respond" onclick='return addComment.moveForm( "comment-421145", "421145", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421865">
<div class="comment-container" id="li-comment-421865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franek</span>
<span class="date">December 1, 2017 at 9:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I’ve been reading about keras and AI for some time and I always find your articles more clear and straightforward than all the other stuff on the net 🙂<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to Franek" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421865#respond" onclick='return addComment.moveForm( "comment-421865", "421865", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421910">
<div class="comment-container" id="li-comment-421910">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421910" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Franek.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421910#respond" onclick='return addComment.moveForm( "comment-421910", "421910", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421867">
<div class="comment-container" id="li-comment-421867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franek</span>
<span class="date">December 1, 2017 at 9:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, for some reasons I need to know the output tensors of the layers in my model. I’ve tried to experiment with the layer.get_output, get_output_et etc following the keras documentation, but I always fail to get anything sensible.</p>
<p>I tried to look for this subject on your blog, but I couldn’t find anything. Are you planning to write a post on this? 🙂 That would really help!</p>
<div class="reply">
<a aria-label="Reply to Franek" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421867#respond" onclick='return addComment.moveForm( "comment-421867", "421867", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421911">
<div class="comment-container" id="li-comment-421911">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 8:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421911" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have good advice for getting the output tensor. Perhaps post to the keras google group or slack channel?</p>
<p>See here:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421911#respond" onclick='return addComment.moveForm( "comment-421911", "421911", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421879">
<div class="comment-container" id="li-comment-421879">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac4a6c04cc463e0a52c5e43382ecbdfd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac4a6c04cc463e0a52c5e43382ecbdfd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nicola</span>
<span class="date">December 2, 2017 at 12:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421879" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, yet another great post.<br/>
Using one of your past posts I created an LSTM that, using multiple time series, predicts several step ahead of a specific time series. Currently I have this structure:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d1a33c705378625" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
#reshape the time series
x_tr, y_tr = get_data(training, back, ahead)
	
n_samples = x_tr.shape[0]
features = x_tr.shape[2]

hidden = 50

#LSTM
model = Sequential()
model.add(LSTM(input_dim=features, output_dim=hidden,  return_sequences=True))
model.add(Dropout(0.2))
model.add(LSTM(50))
model.add(Dropout(0.2))
model.add(Dense(input_dim=hidden, output_dim=ahead))
model.add(Activation('linear'))
model.compile(loss='mae', optimizer='adam')
model.fit(x_tr, y_tr)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-8">8</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-10">10</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-12">12</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-14">14</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-16">16</div><div class="crayon-num" data-line="crayon-5a658e6d1a33c705378625-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a33c705378625-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-1"><span class="crayon-p">#reshape the time series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-2"><span class="crayon-v">x_tr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_tr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_data</span><span class="crayon-sy">(</span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ahead</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-4"><span class="crayon-v">n_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_tr</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-5"><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_tr</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-6"> </div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-7"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-8"> </div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-9"><span class="crayon-p">#LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-10"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-11"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_dim</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">,</span><span class="crayon-h">  </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-12"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-13"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-14"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-15"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_dim</span><span class="crayon-o">=</span><span class="crayon-v">ahead</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Activation</span><span class="crayon-sy">(</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a33c705378625-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a33c705378625-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">x_tr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_tr</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<p>where:<br/>
– x_tr has (440, 7, 6) dimensions (440 samples, 7 past time steps, 6 variables/time series)<br/>
– y_tr has (440, 21) dimensions, that is 440 samples and 21 ahead predicted values.</p>
<p>Now, I’d like to extend my network so that it predicts the (multi-step ahead) values of two time series. I tried this code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658e6d1a343695865102" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
inputs = Input(shape=(7,6)) # 7 steps ahead and 6 variables
m = Dense(64,activation='relu')(inputs)
m = Dense(64,activation='relu')(m)
outputA = Dense(1,activation='tanh')(m)
outputB = Dense(1,activation='tanh')(m)

m = Model(inputs=[inputs], outputs=[outputA, outputB])
m.fit(x,[y1,y2])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658e6d1a343695865102-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a343695865102-2">2</div><div class="crayon-num" data-line="crayon-5a658e6d1a343695865102-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a343695865102-4">4</div><div class="crayon-num" data-line="crayon-5a658e6d1a343695865102-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a343695865102-6">6</div><div class="crayon-num" data-line="crayon-5a658e6d1a343695865102-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658e6d1a343695865102-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658e6d1a343695865102-1"><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># 7 steps ahead and 6 variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a343695865102-2"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a343695865102-3"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a343695865102-4"><span class="crayon-v">outputA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658e6d1a343695865102-5"><span class="crayon-v">outputB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a343695865102-6"> </div><div class="crayon-line" id="crayon-5a658e6d1a343695865102-7"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">inputs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">outputA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputB</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658e6d1a343695865102-8"><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-v">y2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>where y1 and y2 both have (440, 21) dimensions, but I have this error:</p>
<p>“Error when checking target: expected dense_4 to have 3 dimensions, but got array with shape (440, 21)”.</p>
<p>How should I reshape y1 and y2 so that they fit with the network?</p>
<div class="reply">
<a aria-label="Reply to Nicola" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421879#respond" onclick='return addComment.moveForm( "comment-421879", "421879", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421919">
<div class="comment-container" id="li-comment-421919">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421919" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot debug your code for you, perhaps post to stack overflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=421919#respond" onclick='return addComment.moveForm( "comment-421919", "421919", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-424355">
<div class="comment-container" id="li-comment-424355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1426482080549d9648a26ee5d3907fd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1426482080549d9648a26ee5d3907fd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Davor</span>
<span class="date">December 22, 2017 at 3:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-424355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial, it really helped me understand Model API better! THANKS!</p>
<div class="reply">
<a aria-label="Reply to Davor" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=424355#respond" onclick='return addComment.moveForm( "comment-424355", "424355", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424379">
<div class="comment-container" id="li-comment-424379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 22, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-424379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=424379#respond" onclick='return addComment.moveForm( "comment-424379", "424379", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425641">
<div class="comment-container" id="li-comment-425641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb705225085798eef63d5bf88b60410b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb705225085798eef63d5bf88b60410b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Debarati Bhattacharjee</span>
<span class="date">January 5, 2018 at 2:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hii Jason, this was a great post, specially for beginners to learn the Functional API. Would you mind to write a post to explain the code for a image segmentation problem step by step for beginners?</p>
<div class="reply">
<a aria-label="Reply to Debarati Bhattacharjee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=425641#respond" onclick='return addComment.moveForm( "comment-425641", "425641", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425668">
<div class="comment-container" id="li-comment-425668">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425668" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=425668#respond" onclick='return addComment.moveForm( "comment-425668", "425668", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425788">
<div class="comment-container" id="li-comment-425788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harminder</span>
<span class="date">January 6, 2018 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for such a great post. It helped me a lot to understand functional API’s in keras.<br/>
Could you please explain how we define the model.compile statement in multiple output case where each sub-model has a different objective function. For example, one output might be regression and the other classification as you mentioned in this post.</p>
<div class="reply">
<a aria-label="Reply to Harminder" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=425788#respond" onclick='return addComment.moveForm( "comment-425788", "425788", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425807">
<div class="comment-container" id="li-comment-425807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 7, 2018 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe you must have one objective function for the whole model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/keras-functional-api-deep-learning/?replytocom=425807#respond" onclick='return addComment.moveForm( "comment-425807", "425807", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/keras-functional-api-deep-learning/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4392"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="d8e4f11f79"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="191"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>