<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How To Implement The Decision Tree Algorithm From Scratch In Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How To Implement The Decision Tree Algorithm From Scratch In Python - Machine Learning Mastery" property="og:title"/>
<meta content="Decision trees are a powerful prediction method and extremely popular. They are popular because the final model is so easy to understand by practitioners and domain experts alike. The final decision tree can explain exactly why a specific prediction was made, making it very attractive for operational use. Decision trees also provide the foundation for …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-09T05:00:40+11:00" property="article:published_time"/>
<meta content="2017-08-12T09:10:18+11:00" property="article:modified_time"/>
<meta content="2017-08-12T09:10:18+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/implement-decision-tree-algorithm-scratch-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How To Implement The Decision Tree Algorithm From Scratch In Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3353" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-decision-tree-algorithm-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-decision-tree-algorithm-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3353 single-format-standard safari alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Need help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3353 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How To Implement The Decision Tree Algorithm From Scratch In Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-09T05:00:40+1100">November 9, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Algorithms From Scratch">Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-decision-tree-algorithm-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/&amp;summary=Decision+trees+are+a+powerful+prediction+method+and+extremely+popular.%0D%0A%0D%0AThey+are+popular+because+t..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/&amp;summary=Decision+trees+are+a+powerful+prediction+method+and+extremely+popular.%0D%0A%0D%0AThey+are+popular+because+t...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Decision trees are a powerful prediction method and extremely popular.</p>
<p>They are popular because the final model is so easy to understand by practitioners and domain experts alike. The final decision tree can explain exactly why a specific prediction was made, making it very attractive for operational use.</p>
<p>Decision trees also provide the foundation for more advanced ensemble methods such as bagging, random forests and gradient boosting.</p>
<p>In this tutorial, you will discover how to implement the <a href="http://machinelearningmastery.com/classification-and-regression-trees-for-machine-learning/">Classification And Regression Tree algorithm</a> from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to calculate and evaluate candidate split points in a data.</li>
<li>How to arrange splits into a decision tree structure.</li>
<li>How to apply the classification and regression tree algorithm to a real problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Feb/2017</strong>: Fixed a bug in build_tree.</li>
<li><strong>Update Aug/2017</strong>: Fixed a bug in Gini calculation, added the missing weighting of group Gini scores by group size (thanks Michael!).</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3355" style="max-width: 650px"><img alt="How To Implement The Decision Tree Algorithm From Scratch In Python" class="size-full wp-image-3355" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How To Implement The Decision Tree Algorithm From Scratch In Python<br/>Photo by <a href="https://www.flickr.com/photos/suckamc/4325870801/">Martin Cathrae</a>, some rights reserved.</p></div>
<h2>Descriptions</h2>
<p>This section provides a brief introduction to the Classification and Regression Tree algorithm and the Banknote dataset used in this tutorial.</p>
<h3>Classification and Regression Trees</h3>
<p>Classification and Regression Trees or CART for short is an acronym introduced by Leo Breiman to refer to Decision Tree algorithms that can be used for classification or regression predictive modeling problems.</p>
<p>We will focus on using CART for classification in this tutorial.</p>
<p>The representation of the CART model is a binary tree. This is the same binary tree from algorithms and data structures, nothing too fancy (each node can have zero, one or two child nodes).</p>
<p>A node represents a single input variable (X) and a split point on that variable, assuming the variable is numeric. The leaf nodes (also called terminal nodes) of the tree contain an output variable (y) which is used to make a prediction.</p>
<p>Once created, a tree can be navigated with a new row of data following each branch with the splits until a final prediction is made.</p>
<p>Creating a binary decision tree is actually a process of dividing up the input space. A greedy approach is used to divide the space called recursive binary splitting. This is a numerical procedure where all the values are lined up and different split points are tried and tested using a cost function.</p>
<p>The split with the best cost (lowest cost because we minimize cost) is selected. All input variables and all possible split points are evaluated and chosen in a greedy manner based on the cost function.</p>
<ul>
<li><strong>Regression</strong>: The cost function that is minimized to choose split points is the sum squared error across all training samples that fall within the rectangle.</li>
<li><strong>Classification</strong>: The Gini cost function is used which provides an indication of how pure the nodes are, where node purity refers to how mixed the training data assigned to each node is.</li>
</ul>
<p>Splitting continues until nodes contain a minimum number of training examples or a maximum tree depth is reached.</p>
<h3>Banknote Dataset</h3>
<p>The banknote dataset involves predicting whether a given banknote is authentic given a number of measures taken from a photograph.</p>
<p>The dataset contains 1,372 with 5 numeric variables. It is a classification problem with two classes (binary classification).</p>
<p>Below provides a list of the five variables in the dataset.</p>
<ol>
<li>variance of Wavelet Transformed image (continuous).</li>
<li>skewness of Wavelet Transformed image (continuous).</li>
<li>kurtosis of Wavelet Transformed image (continuous).</li>
<li>entropy of image (continuous).</li>
<li>class (integer).</li>
</ol>
<p>Below is a sample of the first 5 rows of the dataset</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3467155915855" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
3.6216,8.6661,-2.8073,-0.44699,0
4.5459,8.1674,-2.4586,-1.4621,0
3.866,-2.6383,1.9242,0.10645,0
3.4566,9.5228,-4.0112,-3.5944,0
0.32924,-4.4552,4.5718,-0.9888,0
4.3684,9.6718,-3.9606,-3.1625,0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3467155915855-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3467155915855-2">2</div><div class="crayon-num" data-line="crayon-5a65916af3467155915855-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3467155915855-4">4</div><div class="crayon-num" data-line="crayon-5a65916af3467155915855-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3467155915855-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3467155915855-1">3.6216,8.6661,-2.8073,-0.44699,0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3467155915855-2">4.5459,8.1674,-2.4586,-1.4621,0</div><div class="crayon-line" id="crayon-5a65916af3467155915855-3">3.866,-2.6383,1.9242,0.10645,0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3467155915855-4">3.4566,9.5228,-4.0112,-3.5944,0</div><div class="crayon-line" id="crayon-5a65916af3467155915855-5">0.32924,-4.4552,4.5718,-0.9888,0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3467155915855-6">4.3684,9.6718,-3.9606,-3.1625,0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Using the Zero Rule Algorithm to predict the most common class value, the baseline accuracy on the problem is about 50%.</p>
<p>You can learn more and download the dataset from the <a href="http://archive.ics.uci.edu/ml/datasets/banknote+authentication">UCI Machine Learning Repository</a>.</p>
<p>Download the dataset and place it in your current working directory with the filename <strong>data_banknote_authentication.csv</strong>.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 5 parts:</p>
<ol>
<li>Gini Index.</li>
<li>Create Split.</li>
<li>Build a Tree.</li>
<li>Make a Prediction.</li>
<li>Banknote Case Study.</li>
</ol>
<p>These steps will give you the foundation that you need to implement the CART algorithm from scratch and apply it to your own predictive modeling problems.</p>
<h3>1. Gini Index</h3>
<p>The Gini index is the name of the cost function used to evaluate splits in the dataset.</p>
<p>A split in the dataset involves one input attribute and one value for that attribute. It can be used to divide training patterns into two groups of rows.</p>
<p>A Gini score gives an idea of how good a split is by how mixed the classes are in the two groups created by the split. A perfect separation results in a Gini score of 0, whereas the worst case split that results in 50/50 classes in each group result in a Gini score of 0.5 (for a 2 class problem).</p>
<p>Calculating Gini is best demonstrated with an example.</p>
<p>We have two groups of data with 2 rows in each group. The rows in the first group all belong to class 0 and the rows in the second group belong to class 1, so it’s a perfect split.</p>
<p>We first need to calculate the proportion of classes in each group.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af347e046197383" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
proportion = count(class_value) / count(rows)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af347e046197383-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af347e046197383-1">proportion = count(class_value) / count(rows)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The proportions for this example would be:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3481650000309" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
group_1_class_0 = 2 / 2 = 1
group_1_class_1 = 0 / 2 = 0
group_2_class_0 = 0 / 2 = 0
group_2_class_1 = 2 / 2 = 1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3481650000309-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3481650000309-2">2</div><div class="crayon-num" data-line="crayon-5a65916af3481650000309-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3481650000309-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3481650000309-1">group_1_class_0 = 2 / 2 = 1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3481650000309-2">group_1_class_1 = 0 / 2 = 0</div><div class="crayon-line" id="crayon-5a65916af3481650000309-3">group_2_class_0 = 0 / 2 = 0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3481650000309-4">group_2_class_1 = 2 / 2 = 1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Gini is then calculated for each child node as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3484349006264" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
gini_index = sum(proportion * (1.0 - proportion))
gini_index = 1.0 - sum(proportion * proportion)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3484349006264-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3484349006264-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3484349006264-1">gini_index = sum(proportion * (1.0 - proportion))</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3484349006264-2">gini_index = 1.0 - sum(proportion * proportion)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The Gini index for each group must then be weighted by the size of the group, relative to all of the samples in the parent, e.g. all samples that are currently being grouped. We can add this weighting to the Gini calculation for a group as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3486666118509" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
gini_index = (1.0 - sum(proportion * proportion)) * (group_size/total_samples)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3486666118509-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3486666118509-1">gini_index = (1.0 - sum(proportion * proportion)) * (group_size/total_samples)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>In this example the Gini scores for each group are calculated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3488748746282" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Gini(group_1) = (1 - (1*1 + 0*0)) * 2/4
Gini(group_1) = 0.0 * 0.5 
Gini(group_1) = 0.0 
Gini(group_2) = (1 - (0*0 + 1*1)) * 2/4
Gini(group_2) = 0.0 * 0.5 
Gini(group_2) = 0.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3488748746282-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3488748746282-2">2</div><div class="crayon-num" data-line="crayon-5a65916af3488748746282-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3488748746282-4">4</div><div class="crayon-num" data-line="crayon-5a65916af3488748746282-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3488748746282-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3488748746282-1">Gini(group_1) = (1 - (1*1 + 0*0)) * 2/4</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3488748746282-2">Gini(group_1) = 0.0 * 0.5 </div><div class="crayon-line" id="crayon-5a65916af3488748746282-3">Gini(group_1) = 0.0 </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3488748746282-4">Gini(group_2) = (1 - (0*0 + 1*1)) * 2/4</div><div class="crayon-line" id="crayon-5a65916af3488748746282-5">Gini(group_2) = 0.0 * 0.5 </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3488748746282-6">Gini(group_2) = 0.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The scores are then added across each child node at the split point to give a final Gini score for the split point that can be compared to other candidate split points.</p>
<p>The Gini for this split point would then be calculated as 0.0 + 0.0 or a perfect Gini score of 0.0.</p>
<p>Below is a function named <strong>gini_index()</strong> the calculates the Gini index for a list of groups and a list of known class values.</p>
<p>You can see that there are some safety checks in there to avoid a divide by zero for an empty group.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af348b727188760" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af348b727188760-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-2">2</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-4">4</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-6">6</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-8">8</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-10">10</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-12">12</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-14">14</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-16">16</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348b727188760-18">18</div><div class="crayon-num" data-line="crayon-5a65916af348b727188760-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af348b727188760-1"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-2"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-3"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-4"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-5"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-6"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-8"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-9"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-10"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-11"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-12"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-13"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-14"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-15"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-16"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-17"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348b727188760-18"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348b727188760-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>We can test this function with our worked example above. We can also test it for the worst case of a 50/50 split in each group. The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af348d729259510" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# test Gini values
print(gini_index([[[1, 1], [1, 0]], [[1, 1], [1, 0]]], [0, 1]))
print(gini_index([[[1, 0], [1, 0]], [[1, 1], [1, 1]]], [0, 1]))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af348d729259510-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-2">2</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-4">4</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-6">6</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-8">8</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-10">10</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-12">12</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-14">14</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-16">16</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-18">18</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-20">20</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af348d729259510-22">22</div><div class="crayon-num" data-line="crayon-5a65916af348d729259510-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af348d729259510-1"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-2"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-3"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-4"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-5"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-6"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-8"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-9"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-10"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-11"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-12"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-13"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-14"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-15"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-16"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-17"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-18"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-20"> </div><div class="crayon-line" id="crayon-5a65916af348d729259510-21"><span class="crayon-p"># test Gini values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af348d729259510-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af348d729259510-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example prints the two Gini scores, first the score for the worst case at 0.5 followed by the score for the best case at 0.0.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3490852012261" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.5
0.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3490852012261-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3490852012261-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3490852012261-1">0.5</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3490852012261-2">0.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now that we know how to evaluate the results of a split, let’s look at creating splits.</p>
<h3>2. Create Split</h3>
<p>A split is comprised of an attribute in the dataset and a value.</p>
<p>We can summarize this as the index of an attribute to split and the value by which to split rows on that attribute. This is just a useful shorthand for indexing into rows of data.</p>
<p>Creating a split involves three parts, the first we have already looked at which is calculating the Gini score. The remaining two parts are:</p>
<ol>
<li>Splitting a Dataset.</li>
<li>Evaluating All Splits.</li>
</ol>
<p>Let’s take a look at each.</p>
<h4>2.1. Splitting a Dataset</h4>
<p>Splitting a dataset means separating a dataset into two lists of rows given the index of an attribute and a split value for that attribute.</p>
<p>Once we have the two groups, we can then use our Gini score above to evaluate the cost of the split.</p>
<p>Splitting a dataset involves iterating over each row, checking if the attribute value is below or above the split value and assigning it to the left or right group respectively.</p>
<p>Below is a function named <strong>test_split()</strong> that implements this procedure.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af3497387349613" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af3497387349613-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3497387349613-2">2</div><div class="crayon-num" data-line="crayon-5a65916af3497387349613-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3497387349613-4">4</div><div class="crayon-num" data-line="crayon-5a65916af3497387349613-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3497387349613-6">6</div><div class="crayon-num" data-line="crayon-5a65916af3497387349613-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af3497387349613-8">8</div><div class="crayon-num" data-line="crayon-5a65916af3497387349613-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af3497387349613-1"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3497387349613-2"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af3497387349613-3"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3497387349613-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af3497387349613-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3497387349613-6"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af3497387349613-7"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af3497387349613-8"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af3497387349613-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Not much to it.</p>
<p>Note that the right group contains all rows with a value at the index above or equal to the split value.</p>
<h4>2.2. Evaluating All Splits</h4>
<p>With the Gini function above and the test split function we now have everything we need to evaluate splits.</p>
<p>Given a dataset, we must check every value on each attribute as a candidate split, evaluate the cost of the split and find the best possible split we could make.</p>
<p>Once the best split is found, we can use it as a node in our decision tree.</p>
<p>This is an exhaustive and greedy algorithm.</p>
<p>We will use a dictionary to represent a node in the decision tree as we can store data by name. When selecting the best split and using it as a new node for the tree we will store the index of the chosen attribute, the value of that attribute by which to split and the two groups of data split by the chosen split point.</p>
<p>Each group of data is its own small dataset of just those rows assigned to the left or right group by the splitting process. You can imagine how we might split each group again, recursively as we build out our decision tree.</p>
<p>Below is a function named <strong>get_split()</strong> that implements this procedure. You can see that it iterates over each attribute (except the class value) and then each value for that attribute, splitting and evaluating splits as it goes.</p>
<p>The best split is recorded and then returned after all checks are complete.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af349a924310373" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Select the best split point for a dataset
def get_split(dataset):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	for index in range(len(dataset[0])-1):
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af349a924310373-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349a924310373-2">2</div><div class="crayon-num" data-line="crayon-5a65916af349a924310373-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349a924310373-4">4</div><div class="crayon-num" data-line="crayon-5a65916af349a924310373-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349a924310373-6">6</div><div class="crayon-num" data-line="crayon-5a65916af349a924310373-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349a924310373-8">8</div><div class="crayon-num" data-line="crayon-5a65916af349a924310373-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349a924310373-10">10</div><div class="crayon-num" data-line="crayon-5a65916af349a924310373-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af349a924310373-1"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349a924310373-2"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af349a924310373-3"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349a924310373-4"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a65916af349a924310373-5"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349a924310373-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af349a924310373-7"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349a924310373-8"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af349a924310373-9"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349a924310373-10"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line" id="crayon-5a65916af349a924310373-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>We can contrive a small dataset to test out this function and our whole dataset splitting process.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af349d915827751" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1			X2			Y
2.771244718		1.784783929		0
1.728571309		1.169761413		0
3.678319846		2.81281357		0
3.961043357		2.61995032		0
2.999208922		2.209014212		0
7.497545867		3.162953546		1
9.00220326		3.339047188		1
7.444542326		0.476683375		1
10.12493903		3.234550982		1
6.642287351		3.319983761		1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af349d915827751-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349d915827751-2">2</div><div class="crayon-num" data-line="crayon-5a65916af349d915827751-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349d915827751-4">4</div><div class="crayon-num" data-line="crayon-5a65916af349d915827751-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349d915827751-6">6</div><div class="crayon-num" data-line="crayon-5a65916af349d915827751-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349d915827751-8">8</div><div class="crayon-num" data-line="crayon-5a65916af349d915827751-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af349d915827751-10">10</div><div class="crayon-num" data-line="crayon-5a65916af349d915827751-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af349d915827751-1">X1			X2			Y</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349d915827751-2">2.771244718		1.784783929		0</div><div class="crayon-line" id="crayon-5a65916af349d915827751-3">1.728571309		1.169761413		0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349d915827751-4">3.678319846		2.81281357		0</div><div class="crayon-line" id="crayon-5a65916af349d915827751-5">3.961043357		2.61995032		0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349d915827751-6">2.999208922		2.209014212		0</div><div class="crayon-line" id="crayon-5a65916af349d915827751-7">7.497545867		3.162953546		1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349d915827751-8">9.00220326		3.339047188		1</div><div class="crayon-line" id="crayon-5a65916af349d915827751-9">7.444542326		0.476683375		1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af349d915827751-10">10.12493903		3.234550982		1</div><div class="crayon-line" id="crayon-5a65916af349d915827751-11">6.642287351		3.319983761		1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can plot this dataset using separate colors for each class. You can see that it would not be difficult to manually pick a value of X1 (x-axis on the plot) to split this dataset.</p>
<div class="wp-caption aligncenter" id="attachment_3354" style="max-width: 764px"><img alt="CART Contrived Dataset" class="size-full wp-image-3354" height="454" sizes="(max-width: 754px) 100vw, 754px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/CART-Contrived-Dataset.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/CART-Contrived-Dataset.png 754w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/CART-Contrived-Dataset-300x181.png 300w" width="754"/><p class="wp-caption-text">CART Contrived Dataset</p></div>
<p>The example below puts all of this together.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34a2990764436" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	for index in range(len(dataset[0])-1):
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			print('X%d &lt; %.3f Gini=%.3f' % ((index+1), row[index], gini))
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

dataset = [[2.771244718,1.784783929,0],
	[1.728571309,1.169761413,0],
	[3.678319846,2.81281357,0],
	[3.961043357,2.61995032,0],
	[2.999208922,2.209014212,0],
	[7.497545867,3.162953546,1],
	[9.00220326,3.339047188,1],
	[7.444542326,0.476683375,1],
	[10.12493903,3.234550982,1],
	[6.642287351,3.319983761,1]]
split = get_split(dataset)
print('Split: [X%d &lt; %.3f]' % ((split['index']+1), split['value']))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-22">22</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-24">24</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-26">26</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-28">28</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-30">30</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-32">32</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-34">34</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-36">36</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-38">38</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-40">40</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-42">42</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-44">44</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-46">46</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-48">48</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-50">50</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-52">52</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a2990764436-54">54</div><div class="crayon-num" data-line="crayon-5a65916af34a2990764436-55">55</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34a2990764436-1"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-2"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-3"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-6"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-7"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-8"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-10"> </div><div class="crayon-line" id="crayon-5a65916af34a2990764436-11"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-12"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-13"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-14"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-15"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-16"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-18"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-19"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-20"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-21"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-22"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-23"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-24"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-25"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-26"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-27"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-28"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-30"> </div><div class="crayon-line" id="crayon-5a65916af34a2990764436-31"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-32"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-33"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-34"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-35"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-36"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-37"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-38"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-39"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'X%d &lt; %.3f Gini=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-40"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-41"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-42"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-43"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-44"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.771244718</span><span class="crayon-sy">,</span><span class="crayon-cn">1.784783929</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-45"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.728571309</span><span class="crayon-sy">,</span><span class="crayon-cn">1.169761413</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-46"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.678319846</span><span class="crayon-sy">,</span><span class="crayon-cn">2.81281357</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-47"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.961043357</span><span class="crayon-sy">,</span><span class="crayon-cn">2.61995032</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-48"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.999208922</span><span class="crayon-sy">,</span><span class="crayon-cn">2.209014212</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-49"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.497545867</span><span class="crayon-sy">,</span><span class="crayon-cn">3.162953546</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-50"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9.00220326</span><span class="crayon-sy">,</span><span class="crayon-cn">3.339047188</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-51"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.444542326</span><span class="crayon-sy">,</span><span class="crayon-cn">0.476683375</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-52"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10.12493903</span><span class="crayon-sy">,</span><span class="crayon-cn">3.234550982</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-53"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.642287351</span><span class="crayon-sy">,</span><span class="crayon-cn">3.319983761</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a2990764436-54"><span class="crayon-v">split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34a2990764436-55"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Split: [X%d &lt; %.3f]'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">split</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">split</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0049 seconds] -->
<p>The <strong>get_split()</strong> function was modified to print out each split point and it’s Gini index as it was evaluated.</p>
<p>Running the example prints all of the Gini scores and then prints the score of best split in the dataset of X1 &lt; 6.642 with a Gini Index of 0.0 or a perfect split.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34a6306625804" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1 &lt; 2.771 Gini=0.444
X1 &lt; 1.729 Gini=0.500
X1 &lt; 3.678 Gini=0.286
X1 &lt; 3.961 Gini=0.167
X1 &lt; 2.999 Gini=0.375
X1 &lt; 7.498 Gini=0.286
X1 &lt; 9.002 Gini=0.375
X1 &lt; 7.445 Gini=0.167
X1 &lt; 10.125 Gini=0.444
X1 &lt; 6.642 Gini=0.000
X2 &lt; 1.785 Gini=0.500
X2 &lt; 1.170 Gini=0.444
X2 &lt; 2.813 Gini=0.320
X2 &lt; 2.620 Gini=0.417
X2 &lt; 2.209 Gini=0.476
X2 &lt; 3.163 Gini=0.167
X2 &lt; 3.339 Gini=0.444
X2 &lt; 0.477 Gini=0.500
X2 &lt; 3.235 Gini=0.286
X2 &lt; 3.320 Gini=0.375
Split: [X1 &lt; 6.642]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a6306625804-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34a6306625804-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34a6306625804-1">X1 &lt; 2.771 Gini=0.444</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-2">X1 &lt; 1.729 Gini=0.500</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-3">X1 &lt; 3.678 Gini=0.286</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-4">X1 &lt; 3.961 Gini=0.167</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-5">X1 &lt; 2.999 Gini=0.375</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-6">X1 &lt; 7.498 Gini=0.286</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-7">X1 &lt; 9.002 Gini=0.375</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-8">X1 &lt; 7.445 Gini=0.167</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-9">X1 &lt; 10.125 Gini=0.444</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-10">X1 &lt; 6.642 Gini=0.000</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-11">X2 &lt; 1.785 Gini=0.500</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-12">X2 &lt; 1.170 Gini=0.444</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-13">X2 &lt; 2.813 Gini=0.320</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-14">X2 &lt; 2.620 Gini=0.417</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-15">X2 &lt; 2.209 Gini=0.476</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-16">X2 &lt; 3.163 Gini=0.167</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-17">X2 &lt; 3.339 Gini=0.444</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-18">X2 &lt; 0.477 Gini=0.500</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-19">X2 &lt; 3.235 Gini=0.286</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a6306625804-20">X2 &lt; 3.320 Gini=0.375</div><div class="crayon-line" id="crayon-5a65916af34a6306625804-21">Split: [X1 &lt; 6.642]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we know how to find the best split points in a dataset or list of rows, let’s see how we can use it to build out a decision tree.</p>
<h3>3. Build a Tree</h3>
<p>Creating the root node of the tree is easy.</p>
<p>We call the above <strong>get_split()</strong> function using the entire dataset.</p>
<p>Adding more nodes to our tree is more interesting.</p>
<p>Building a tree may be divided into 3 main parts:</p>
<ol>
<li>Terminal Nodes.</li>
<li>Recursive Splitting.</li>
<li>Building a Tree.</li>
</ol>
<h4>3.1. Terminal Nodes</h4>
<p>We need to decide when to stop growing a tree.</p>
<p>We can do that using the depth and the number of rows that the node is responsible for in the training dataset.</p>
<ul>
<li><strong>Maximum Tree Depth</strong>. This is the maximum number of nodes from the root node of the tree. Once a maximum depth of the tree is met, we must stop splitting adding new nodes. Deeper trees are more complex and are more likely to overfit the training data.</li>
<li><strong>Minimum Node Records</strong>. This is the minimum number of training patterns that a given node is responsible for. Once at or below this minimum, we must stop splitting and adding new nodes. Nodes that account for too few training patterns are expected to be too specific and are likely to overfit the training data.</li>
</ul>
<p>These two approaches will be user-specified arguments to our tree building procedure.</p>
<p>There is one more condition. It is possible to choose a split in which all rows belong to one group. In this case, we will be unable to continue splitting and adding child nodes as we will have no records to split on one side or another.</p>
<p>Now we have some ideas of when to stop growing the tree. When we do stop growing at a given point, that node is called a terminal node and is used to make a final prediction.</p>
<p>This is done by taking the group of rows assigned to that node and selecting the most common class value in the group. This will be used to make predictions.</p>
<p>Below is a function named <strong>to_terminal()</strong> that will select a class value for a group of rows. It returns the most common output value in a list of rows.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34a9112318991" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34a9112318991-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a9112318991-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34a9112318991-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34a9112318991-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34a9112318991-1"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a9112318991-2"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34a9112318991-3"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34a9112318991-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<h4>3.2. Recursive Splitting</h4>
<p>We know how and when to create terminal nodes, now we can build our tree.</p>
<p>Building a decision tree involves calling the above developed <strong>get_split()</strong> function over and over again on the groups created for each node.</p>
<p>New nodes added to an existing node are called child nodes. A node may have zero children (a terminal node), one child (one side makes a prediction directly) or two child nodes. We will refer to the child nodes as left and right in the dictionary representation of a given node.</p>
<p>Once a node is created, we can create child nodes recursively on each group of data from the split by calling the same function again.</p>
<p>Below is a function that implements this recursive procedure. It takes a node as an argument as well as the maximum depth, minimum number of patterns in a node and the current depth of a node.</p>
<p>You can imagine how this might be first called passing in the root node and the depth of 1. This function is best explained in steps:</p>
<ol>
<li>Firstly, the two groups of data split by the node are extracted for use and deleted from the node. As we work on these groups the node no longer requires access to these data.</li>
<li>Next, we check if either left or right group of rows is empty and if so we create a terminal node using what records we do have.</li>
<li>We then check if we have reached our maximum depth and if so we create a terminal node.</li>
<li>We then process the left child, creating a terminal node if the group of rows is too small, otherwise creating and adding the left node in a depth first fashion until the bottom of the tree is reached on this branch.</li>
<li>The right side is then processed in the same manner, as we rise back up the constructed tree to the root.</li>
</ol>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34ad936283979" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create child splits for a node or make terminal
def split(node, max_depth, min_size, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left)
		split(node['left'], max_depth, min_size, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right)
		split(node['right'], max_depth, min_size, depth+1)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-22">22</div><div class="crayon-num" data-line="crayon-5a65916af34ad936283979-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ad936283979-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34ad936283979-1"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-2"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-3"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-4"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-5"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-6"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-7"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-8"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-9"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-10"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-11"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-12"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-13"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-15"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-16"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-17"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-18"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-19"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-20"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-21"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-22"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34ad936283979-23"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ad936283979-24"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<h4>3.3. Building a Tree</h4>
<p>We can now put all of the pieces together.</p>
<p>Building the tree involves creating the root node and calling the <strong>split()</strong> function that then calls itself recursively to build out the whole tree.</p>
<p>Below is the small <strong>build_tree()</strong> function that implements this procedure.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34b0392831287" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Build a decision tree
def build_tree(train, max_depth, min_size):
	root = get_split(train)
	split(root, max_depth, min_size, 1)
	return root</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34b0392831287-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b0392831287-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34b0392831287-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b0392831287-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34b0392831287-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34b0392831287-1"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b0392831287-2"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b0392831287-3"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b0392831287-4"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b0392831287-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can test out this whole procedure using the small dataset we contrived above.</p>
<p>Below is the complete example.</p>
<p>Also included is a small <strong>print_tree()</strong> function that recursively prints out nodes of the decision tree with one line per node. Although not as striking as a real decision tree diagram, it gives an idea of the tree structure and decisions made throughout.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34b2717276548" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	for index in range(len(dataset[0])-1):
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)

# Create child splits for a node or make terminal
def split(node, max_depth, min_size, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left)
		split(node['left'], max_depth, min_size, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right)
		split(node['right'], max_depth, min_size, depth+1)

# Build a decision tree
def build_tree(train, max_depth, min_size):
	root = get_split(train)
	split(root, max_depth, min_size, 1)
	return root

# Print a decision tree
def print_tree(node, depth=0):
	if isinstance(node, dict):
		print('%s[X%d &lt; %.3f]' % ((depth*' ', (node['index']+1), node['value'])))
		print_tree(node['left'], depth+1)
		print_tree(node['right'], depth+1)
	else:
		print('%s[%s]' % ((depth*' ', node)))

dataset = [[2.771244718,1.784783929,0],
	[1.728571309,1.169761413,0],
	[3.678319846,2.81281357,0],
	[3.961043357,2.61995032,0],
	[2.999208922,2.209014212,0],
	[7.497545867,3.162953546,1],
	[9.00220326,3.339047188,1],
	[7.444542326,0.476683375,1],
	[10.12493903,3.234550982,1],
	[6.642287351,3.319983761,1]]
tree = build_tree(dataset, 1, 1)
print_tree(tree)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-22">22</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-24">24</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-26">26</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-28">28</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-30">30</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-32">32</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-34">34</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-36">36</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-38">38</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-40">40</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-42">42</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-44">44</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-46">46</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-48">48</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-50">50</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-52">52</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-54">54</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-56">56</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-58">58</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-60">60</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-62">62</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-64">64</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-66">66</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-68">68</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-70">70</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-72">72</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-74">74</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-76">76</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-78">78</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-80">80</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-82">82</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-84">84</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-86">86</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-88">88</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-90">90</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-92">92</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-94">94</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-96">96</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b2717276548-98">98</div><div class="crayon-num" data-line="crayon-5a65916af34b2717276548-99">99</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34b2717276548-1"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-2"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-3"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-6"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-7"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-8"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-10"> </div><div class="crayon-line" id="crayon-5a65916af34b2717276548-11"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-12"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-13"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-14"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-15"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-16"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-18"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-19"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-20"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-21"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-22"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-23"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-24"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-25"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-26"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-27"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-28"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-30"> </div><div class="crayon-line" id="crayon-5a65916af34b2717276548-31"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-32"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-33"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-34"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-35"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-36"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-37"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-38"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-39"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-40"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-41"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-42"> </div><div class="crayon-line" id="crayon-5a65916af34b2717276548-43"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-44"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-45"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-46"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-47"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-48"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-49"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-50"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-51"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-52"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-53"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-54"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-55"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-56"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-57"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-58"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-59"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-60"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-61"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-62"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-63"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-64"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-65"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-66"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-67"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-68"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-69"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-70"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-71"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-72"> </div><div class="crayon-line" id="crayon-5a65916af34b2717276548-73"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-74"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-75"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-76"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-77"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-78"> </div><div class="crayon-line" id="crayon-5a65916af34b2717276548-79"><span class="crayon-p"># Print a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-80"><span class="crayon-e">def </span><span class="crayon-e">print_tree</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-81"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-82"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%s[X%d &lt; %.3f]'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">depth*</span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-83"><span class="crayon-h"> </span><span class="crayon-e">print_tree</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-84"><span class="crayon-h"> </span><span class="crayon-e">print_tree</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-85"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-86"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%s[%s]'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">depth*</span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-87"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-88"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.771244718</span><span class="crayon-sy">,</span><span class="crayon-cn">1.784783929</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-89"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.728571309</span><span class="crayon-sy">,</span><span class="crayon-cn">1.169761413</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-90"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.678319846</span><span class="crayon-sy">,</span><span class="crayon-cn">2.81281357</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-91"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.961043357</span><span class="crayon-sy">,</span><span class="crayon-cn">2.61995032</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-92"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.999208922</span><span class="crayon-sy">,</span><span class="crayon-cn">2.209014212</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-93"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.497545867</span><span class="crayon-sy">,</span><span class="crayon-cn">3.162953546</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-94"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9.00220326</span><span class="crayon-sy">,</span><span class="crayon-cn">3.339047188</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-95"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.444542326</span><span class="crayon-sy">,</span><span class="crayon-cn">0.476683375</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-96"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10.12493903</span><span class="crayon-sy">,</span><span class="crayon-cn">3.234550982</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-97"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.642287351</span><span class="crayon-sy">,</span><span class="crayon-cn">3.319983761</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b2717276548-98"><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34b2717276548-99"><span class="crayon-e">print_tree</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0079 seconds] -->
<p>We can vary the maximum depth argument as we run this example and see the effect on the printed tree.</p>
<p>With a maximum depth of 1 (the second parameter in the call to the <strong>build_tree()</strong> function), we can see that the tree uses the perfect split we discovered in the previous section. This is a tree with one node, also called a decision stump.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34b7270656796" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[X1 &lt; 6.642]
 [0]
 [1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34b7270656796-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34b7270656796-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34b7270656796-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34b7270656796-1">[X1 &lt; 6.642]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34b7270656796-2"> [0]</div><div class="crayon-line" id="crayon-5a65916af34b7270656796-3"> [1]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Increasing the maximum depth to 2, we are forcing the tree to make splits even when none are required. The <strong>X1</strong> attribute is then used again by both the left and right children of the root node to split up the already perfect mix of classes.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34ba330213608" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[X1 &lt; 6.642]
 [X1 &lt; 2.771]
  [0]
  [0]
 [X1 &lt; 7.498]
  [1]
  [1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34ba330213608-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ba330213608-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34ba330213608-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ba330213608-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34ba330213608-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34ba330213608-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34ba330213608-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34ba330213608-1">[X1 &lt; 6.642]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ba330213608-2"> [X1 &lt; 2.771]</div><div class="crayon-line" id="crayon-5a65916af34ba330213608-3">  [0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ba330213608-4">  [0]</div><div class="crayon-line" id="crayon-5a65916af34ba330213608-5"> [X1 &lt; 7.498]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34ba330213608-6">  [1]</div><div class="crayon-line" id="crayon-5a65916af34ba330213608-7">  [1]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Finally, and perversely, we can force one more level of splits with a maximum depth of 3.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34bc809203273" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[X1 &lt; 6.642]
 [X1 &lt; 2.771]
  [0]
  [X1 &lt; 2.771]
   [0]
   [0]
 [X1 &lt; 7.498]
  [X1 &lt; 7.445]
   [1]
   [1]
  [X1 &lt; 7.498]
   [1]
   [1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bc809203273-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34bc809203273-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34bc809203273-1">[X1 &lt; 6.642]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-2"> [X1 &lt; 2.771]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-3">  [0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-4">  [X1 &lt; 2.771]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-5">   [0]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-6">   [0]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-7"> [X1 &lt; 7.498]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-8">  [X1 &lt; 7.445]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-9">   [1]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-10">   [1]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-11">  [X1 &lt; 7.498]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bc809203273-12">   [1]</div><div class="crayon-line" id="crayon-5a65916af34bc809203273-13">   [1]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>These tests show that there is great opportunity to refine the implementation to avoid unnecessary splits. This is left as an extension.</p>
<p>Now that we can create a decision tree, let’s see how we can use it to make predictions on new data.</p>
<h3>4. Make a Prediction</h3>
<p>Making predictions with a decision tree involves navigating the tree with the specifically provided row of data.</p>
<p>Again, we can implement this using a recursive function, where the same prediction routine is called again with the left or the right child nodes, depending on how the split affects the provided data.</p>
<p>We must check if a child node is either a terminal value to be returned as the prediction, or if it is a dictionary node containing another level of the tree to be considered.</p>
<p>Below is the <strong>predict()</strong> function that implements this procedure. You can see how the index and value in a given node</p>
<p>You can see how the index and value in a given node is used to evaluate whether the row of provided data falls on the left or the right of the split.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34bf331492629" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34bf331492629-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34bf331492629-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34bf331492629-1"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-2"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34bf331492629-3"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34bf331492629-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-6"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34bf331492629-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-8"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34bf331492629-9"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-10"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34bf331492629-11"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34bf331492629-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>We can use our contrived dataset to test this function. Below is an example that uses a hard-coded decision tree with a single node that best splits the data (a decision stump).</p>
<p>The example makes a prediction for each row in the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34c2499666546" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']

dataset = [[2.771244718,1.784783929,0],
	[1.728571309,1.169761413,0],
	[3.678319846,2.81281357,0],
	[3.961043357,2.61995032,0],
	[2.999208922,2.209014212,0],
	[7.497545867,3.162953546,1],
	[9.00220326,3.339047188,1],
	[7.444542326,0.476683375,1],
	[10.12493903,3.234550982,1],
	[6.642287351,3.319983761,1]]

#  predict with a stump
stump = {'index': 0, 'right': 1, 'value': 6.642287351, 'left': 0}
for row in dataset:
	prediction = predict(stump, row)
	print('Expected=%d, Got=%d' % (row[-1], prediction))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-22">22</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-24">24</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-26">26</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c2499666546-28">28</div><div class="crayon-num" data-line="crayon-5a65916af34c2499666546-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34c2499666546-1"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-2"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-3"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-6"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-8"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-9"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-10"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-11"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-14"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.771244718</span><span class="crayon-sy">,</span><span class="crayon-cn">1.784783929</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-15"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.728571309</span><span class="crayon-sy">,</span><span class="crayon-cn">1.169761413</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-16"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.678319846</span><span class="crayon-sy">,</span><span class="crayon-cn">2.81281357</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-17"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.961043357</span><span class="crayon-sy">,</span><span class="crayon-cn">2.61995032</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-18"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.999208922</span><span class="crayon-sy">,</span><span class="crayon-cn">2.209014212</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-19"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.497545867</span><span class="crayon-sy">,</span><span class="crayon-cn">3.162953546</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-20"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9.00220326</span><span class="crayon-sy">,</span><span class="crayon-cn">3.339047188</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-21"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.444542326</span><span class="crayon-sy">,</span><span class="crayon-cn">0.476683375</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-22"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10.12493903</span><span class="crayon-sy">,</span><span class="crayon-cn">3.234550982</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-23"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.642287351</span><span class="crayon-sy">,</span><span class="crayon-cn">3.319983761</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-24"> </div><div class="crayon-line" id="crayon-5a65916af34c2499666546-25"><span class="crayon-p">#  predict with a stump</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-26"><span class="crayon-v">stump</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6.642287351</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c2499666546-28"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">stump</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34c2499666546-29"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected=%d, Got=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example prints the correct prediction for each row, as expected.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34c5079752564" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34c5079752564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c5079752564-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34c5079752564-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c5079752564-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34c5079752564-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c5079752564-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34c5079752564-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c5079752564-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34c5079752564-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34c5079752564-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34c5079752564-1">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c5079752564-2">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5a65916af34c5079752564-3">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c5079752564-4">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5a65916af34c5079752564-5">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c5079752564-6">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5a65916af34c5079752564-7">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c5079752564-8">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5a65916af34c5079752564-9">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34c5079752564-10">Expected=1, Got=1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We now know how to create a decision tree and use it to make predictions. Now, let’s apply it to a real dataset.</p>
<h3>5. Banknote Case Study</h3>
<p>This section applies the CART algorithm to the Bank Note dataset.</p>
<p>The first step is to load the dataset and convert the loaded data to numbers that we can use to calculate split points. For this we will use the helper function <strong>load_csv()</strong> to load the file and <strong>str_column_to_float()</strong> to convert string numbers to floats.</p>
<p>We will evaluate the algorithm using k-fold cross-validation with 5 folds. This means that 1372/5=274.4 or just over 270 records will be used in each fold. We will use the helper functions <strong>evaluate_algorithm()</strong> to evaluate the algorithm with cross-validation and <strong>accuracy_metric()</strong> to calculate the accuracy of predictions.</p>
<p>A new function named <strong>decision_tree()</strong> was developed to manage the application of the CART algorithm, first creating the tree from the training dataset, then using the tree to make predictions on a test dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34cf208219927" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# CART on the Bank Note dataset
from random import seed
from random import randrange
from csv import reader

# Load a CSV file
def load_csv(filename):
	file = open(filename, "rb")
	lines = reader(file)
	dataset = list(lines)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	for index in range(len(dataset[0])-1):
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)

# Create child splits for a node or make terminal
def split(node, max_depth, min_size, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left)
		split(node['left'], max_depth, min_size, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right)
		split(node['right'], max_depth, min_size, depth+1)

# Build a decision tree
def build_tree(train, max_depth, min_size):
	root = get_split(train)
	split(root, max_depth, min_size, 1)
	return root

# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']

# Classification and Regression Tree Algorithm
def decision_tree(train, test, max_depth, min_size):
	tree = build_tree(train, max_depth, min_size)
	predictions = list()
	for row in test:
		prediction = predict(tree, row)
		predictions.append(prediction)
	return(predictions)

# Test CART on Bank Note dataset
seed(1)
# load and prepare data
filename = 'data_banknote_authentication.csv'
dataset = load_csv(filename)
# convert string attributes to integers
for i in range(len(dataset[0])):
	str_column_to_float(dataset, i)
# evaluate algorithm
n_folds = 5
max_depth = 5
min_size = 10
scores = evaluate_algorithm(dataset, decision_tree, n_folds, max_depth, min_size)
print('Scores: %s' % scores)
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-2">2</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-4">4</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-6">6</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-8">8</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-10">10</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-12">12</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-14">14</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-16">16</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-18">18</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-20">20</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-22">22</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-24">24</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-26">26</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-28">28</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-30">30</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-32">32</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-34">34</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-36">36</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-38">38</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-40">40</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-42">42</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-44">44</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-46">46</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-48">48</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-50">50</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-52">52</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-54">54</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-56">56</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-58">58</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-60">60</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-62">62</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-64">64</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-66">66</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-68">68</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-70">70</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-72">72</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-74">74</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-76">76</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-78">78</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-80">80</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-82">82</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-84">84</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-86">86</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-88">88</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-90">90</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-92">92</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-94">94</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-96">96</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-98">98</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-100">100</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-102">102</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-104">104</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-106">106</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-108">108</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-110">110</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-112">112</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-114">114</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-116">116</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-118">118</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-120">120</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-122">122</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-124">124</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-126">126</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-128">128</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-130">130</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-132">132</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-134">134</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-136">136</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-138">138</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-140">140</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-142">142</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-144">144</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-146">146</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-148">148</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-150">150</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-152">152</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-154">154</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-156">156</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-158">158</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-160">160</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-162">162</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-164">164</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-166">166</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-168">168</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-170">170</div><div class="crayon-num" data-line="crayon-5a65916af34cf208219927-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34cf208219927-172">172</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34cf208219927-1"><span class="crayon-p"># CART on the Bank Note dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-v">reader</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-6"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-7"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-8"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-9"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-10"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-12"> </div><div class="crayon-line" id="crayon-5a65916af34cf208219927-13"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-14"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-15"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-16"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-18"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-19"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-20"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-21"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-22"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-24"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-25"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-26"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-27"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-28"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-30"> </div><div class="crayon-line" id="crayon-5a65916af34cf208219927-31"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-32"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-33"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-34"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-35"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-36"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-37"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-38"> </div><div class="crayon-line" id="crayon-5a65916af34cf208219927-39"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-40"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-41"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-42"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-44"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-45"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-46"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-47"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-48"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-49"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-50"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-51"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-52"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-53"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-54"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-55"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-56"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-57"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-58"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-59"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-60"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-61"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-62"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-63"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-64"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-65"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-66"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-67"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-68"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-69"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-70"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-71"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-72"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-73"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-74"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-75"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-76"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-77"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-78"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-79"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-80"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-81"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-82"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-83"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-84"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-85"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-86"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-87"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-88"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-89"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-90"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-91"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-92"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-93"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-94"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-95"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-96"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-97"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-98"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-99"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-100"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-101"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-102"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-103"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-104"> </div><div class="crayon-line" id="crayon-5a65916af34cf208219927-105"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-106"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-107"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-108"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-109"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-110"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-111"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-112"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-113"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-114"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-115"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-116"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-117"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-118"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-119"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-120"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-121"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-122"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-123"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-124"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-125"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-126"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-127"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-128"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-129"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-130"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-131"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-132"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-133"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-134"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-135"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-136"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-137"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-138"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-139"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-140"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-141"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-142"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-143"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-144"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-145"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-146"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-147"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-148"> </div><div class="crayon-line" id="crayon-5a65916af34cf208219927-149"><span class="crayon-p"># Classification and Regression Tree Algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-150"><span class="crayon-e">def </span><span class="crayon-e">decision_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-151"><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-152"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-153"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-154"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-155"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-156"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-157"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-158"><span class="crayon-p"># Test CART on Bank Note dataset</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-159"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-160"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-161"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'data_banknote_authentication.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-162"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-163"><span class="crayon-p"># convert string attributes to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-164"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-165"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-166"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-167"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-168"><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-169"><span class="crayon-v">min_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-170"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decision_tree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916af34cf208219927-171"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34cf208219927-172"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0126 seconds] -->
<p>The example uses the max tree depth of 5 layers and the minimum number of rows per node to 10. These parameters to CART were chosen with a little experimentation, but are by no means are they optimal.</p>
<p>Running the example prints the average classification accuracy on each fold as well as the average performance across all folds.</p>
<p>You can see that CART and the chosen configuration achieved a mean classification accuracy of about 97% which is dramatically better than the Zero Rule algorithm that achieved 50% accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916af34d5498151056" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Scores: [96.35036496350365, 97.08029197080292, 97.44525547445255, 98.17518248175182, 97.44525547445255]
Mean Accuracy: 97.299%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916af34d5498151056-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916af34d5498151056-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916af34d5498151056-1">Scores: [96.35036496350365, 97.08029197080292, 97.44525547445255, 98.17518248175182, 97.44525547445255]</div><div class="crayon-line crayon-striped-line" id="crayon-5a65916af34d5498151056-2">Mean Accuracy: 97.299%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to this tutorial that you may wish to explore.</p>
<ul>
<li><strong>Algorithm Tuning</strong>. The application of CART to the Bank Note dataset was not tuned. Experiment with different parameter values and see if you can achieve better performance.</li>
<li><strong>Cross Entropy</strong>. Another cost function for evaluating splits is cross entropy (logloss). You could implement and experiment with this alternative cost function.</li>
<li><strong>Tree Pruning</strong>. An important technique for reducing overfitting of the training dataset is to prune the trees. Investigate and implement tree pruning methods.</li>
<li><strong>Categorical Dataset</strong>. The example was designed for input data with numerical or ordinal input attributes, experiment with categorical input data and splits that may use equality instead of ranking.</li>
<li><strong>Regression</strong>. Adapt the tree for regression using a different cost function and method for creating terminal nodes.</li>
<li><strong>More Datasets</strong>. Apply the algorithm to more datasets on the UCI Machine Learning Repository.</li>
</ul>
<p style="text-align: center;"><strong>Did you explore any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the decision tree algorithm from scratch with Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to select and evaluate split points in a training dataset.</li>
<li>How to recursively build a decision tree from multiple splits.</li>
<li>How to apply the CART algorithm to a real world classification predictive modeling problem.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer them.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-decision-tree-algorithm-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/&amp;summary=Decision+trees+are+a+powerful+prediction+method+and+extremely+popular.%0D%0A%0D%0AThey+are+popular+because+t..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20The%20Decision%20Tree%20Algorithm%20From%20Scratch%20In%20Python&amp;url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/&amp;summary=Decision+trees+are+a+powerful+prediction+method+and+extremely+popular.%0D%0A%0D%0AThey+are+popular+because+t...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How to Implement the Backpropagation Algorithm From Scratch In Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/" rel="next">How to Implement Bagging From Scratch With Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">138 Responses to <em>How To Implement The Decision Tree Algorithm From Scratch In Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-371621">
<div class="comment-container" id="li-comment-371621">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0bbb336b191b1ed977e97c73c0a826b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0bbb336b191b1ed977e97c73c0a826b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">steve</span>
<span class="date">November 23, 2016 at 4:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-371621" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Super good .. Thanks a lot for sharing</p>
<div class="reply">
<a aria-label="Reply to steve" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=371621#respond" onclick='return addComment.moveForm( "comment-371621", "371621", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-371696">
<div class="comment-container" id="li-comment-371696">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 9:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-371696" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found it useful steve.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=371696#respond" onclick='return addComment.moveForm( "comment-371696", "371696", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-411203">
<div class="comment-container" id="li-comment-411203">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e805c74e2f3ac906c44b1e937c234b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e805c74e2f3ac906c44b1e937c234b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MAk</span>
<span class="date">August 26, 2017 at 1:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-411203" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , Could you explain what do it mean ?</p>
<p>[X1 &lt; 6.642]<br/>
 [X1 &lt; 2.771]<br/>
  [0]<br/>
  [0]<br/>
 [X1 &lt; 7.498]<br/>
  [1]<br/>
  [1]</p>
<p>Does it mean if X1 &lt;6.642 and X1 &lt;2.771, it belongs to class 0, if X1 &lt;6.642 and X1 &lt; 7.498, it belong to class 1 ?<br/>
Thanks for your help.<br/>
Mak</p>
<div class="reply">
<a aria-label="Reply to MAk" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=411203#respond" onclick='return addComment.moveForm( "comment-411203", "411203", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-411290">
<div class="comment-container" id="li-comment-411290">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 27, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-411290" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, [X1 &lt; 6.642] is the root node with two child nodes, each leaf node has a classification label.
</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=411290#respond" onclick='return addComment.moveForm( "comment-411290", "411290", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-372517">
<div class="comment-container" id="li-comment-372517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fe0ada848e3684885525bebc0c6434f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fe0ada848e3684885525bebc0c6434f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jonathan</span>
<span class="date">November 27, 2016 at 9:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-372517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can this code be used for a multinomial Decision tree dataset?</p>
<div class="reply">
<a aria-label="Reply to jonathan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=372517#respond" onclick='return addComment.moveForm( "comment-372517", "372517", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-372529">
<div class="comment-container" id="li-comment-372529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2016 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-372529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It can with some modification.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=372529#respond" onclick='return addComment.moveForm( "comment-372529", "372529", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-372757">
<div class="comment-container" id="li-comment-372757">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bcd525ad170f757d4296534b77f0801b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bcd525ad170f757d4296534b77f0801b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">STORM RICK</span>
<span class="date">November 29, 2016 at 1:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-372757" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What modifications would you recommend?</p>
<div class="reply">
<a aria-label="Reply to STORM RICK" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=372757#respond" onclick='return addComment.moveForm( "comment-372757", "372757", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-372819">
<div class="comment-container" id="li-comment-372819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2016 at 8:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-372819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Specifically the handling of evaluating and selecting nominal values at split points.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=372819#respond" onclick='return addComment.moveForm( "comment-372819", "372819", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-377301">
<div class="comment-container" id="li-comment-377301">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f4bf55c2ce2482ec6ba18ea0b97b3d1d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f4bf55c2ce2482ec6ba18ea0b97b3d1d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike</span>
<span class="date">December 24, 2016 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-377301" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for detailed description and code.</p>
<p>I tried to run and got ‘ValueError: empty range for randrange()’ in line 26:</p>
<p>index = randrange(len(dataset_copy))</p>
<p>if replace dataset_copy to list(dataset) and run this line manually it works.</p>
<div class="reply">
<a aria-label="Reply to Mike" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=377301#respond" onclick='return addComment.moveForm( "comment-377301", "377301", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-377642">
<div class="comment-container" id="li-comment-377642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 26, 2016 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-377642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a Python 3 issue Mike.</p>
<p>Replace</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916b03d99493372514" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
fold_size = len(dataset) / n_folds</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916b03d99493372514-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916b03d99493372514-1"><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>With:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916b03da2244259849" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
fold_size = int(len(dataset) / n_folds)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916b03da2244259849-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916b03da2244259849-1"><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=377642#respond" onclick='return addComment.moveForm( "comment-377642", "377642", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-379658">
<div class="comment-container" id="li-comment-379658">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-379658" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have updated the cross_validation_split() function in the above example to address issues with Python 3.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=379658#respond" onclick='return addComment.moveForm( "comment-379658", "379658", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-379854">
<div class="comment-container" id="li-comment-379854">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/83c779ea07d83b40b4059773f53057d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/83c779ea07d83b40b4059773f53057d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohendra Roy</span>
<span class="date">January 4, 2017 at 12:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-379854" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How about to use of euclidian distance instead of calculating for each element in the dataset?</p>
<div class="reply">
<a aria-label="Reply to Mohendra Roy" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=379854#respond" onclick='return addComment.moveForm( "comment-379854", "379854", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-379958">
<div class="comment-container" id="li-comment-379958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2017 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-379958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly? Are you able to elaborate?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=379958#respond" onclick='return addComment.moveForm( "comment-379958", "379958", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-381673">
<div class="comment-container" id="li-comment-381673">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/877561b4fb6c9f7421b3c343523b063d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/877561b4fb6c9f7421b3c343523b063d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Selva Rani B</span>
<span class="date">January 12, 2017 at 4:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-381673" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Selva Rani B" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=381673#respond" onclick='return addComment.moveForm( "comment-381673", "381673", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-381804">
<div class="comment-container" id="li-comment-381804">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2017 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-381804" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=381804#respond" onclick='return addComment.moveForm( "comment-381804", "381804", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-383197">
<div class="comment-container" id="li-comment-383197">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/88efd4ac47e4117e7b2eb1cc3e6727cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/88efd4ac47e4117e7b2eb1cc3e6727cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sokrates</span>
<span class="date">January 21, 2017 at 4:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-383197" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Great tutorial on CART! </p>
<p>The results of decision trees are quite dependent on the training vs test data. With this in mind, how do I set the amount of training vs test data in the code right now to changes in the result? From what I can see, it looks like they are being set in the evaluate_algorithm method. </p>
<p>//Kind regards<br/>
Sokrates</p>
<div class="reply">
<a aria-label="Reply to Sokrates" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=383197#respond" onclick='return addComment.moveForm( "comment-383197", "383197", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-383252">
<div class="comment-container" id="li-comment-383252">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2017 at 10:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-383252" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is correct Sokrates.</p>
<p>The example uses k-fold cross validation to evaluate the performance of the algorithm on the dataset.</p>
<p>You can change the number of folds by setting the “n_folds” variable.</p>
<p>You can use a different resampling method, like train/test splits, see this post:<br/>
<a href="http://machinelearningmastery.com/implement-resampling-methods-scratch-python/" rel="nofollow">http://machinelearningmastery.com/implement-resampling-methods-scratch-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=383252#respond" onclick='return addComment.moveForm( "comment-383252", "383252", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-384388">
<div class="comment-container" id="li-comment-384388">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bcdc57ffadae54048df3e124fdd27f53?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bcdc57ffadae54048df3e124fdd27f53?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adeshina Alani</span>
<span class="date">January 27, 2017 at 3:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-384388" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice Post. I will like to ask if i this implementation can be used for time series data with only one feature</p>
<div class="reply">
<a aria-label="Reply to Adeshina Alani" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=384388#respond" onclick='return addComment.moveForm( "comment-384388", "384388", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384501">
<div class="comment-container" id="li-comment-384501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 27, 2017 at 12:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-384501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes it could, but the time series data would have to be re-framed as a supervised learning problem.</p>
<p>See this post for more information:<br/>
<a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=384501#respond" onclick='return addComment.moveForm( "comment-384501", "384501", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384967">
<div class="comment-container" id="li-comment-384967">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95e3419b88a11f42966bd8c26036311b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95e3419b88a11f42966bd8c26036311b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishal</span>
<span class="date">January 30, 2017 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-384967" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really helpful. Thanks a lot for sharing.</p>
<div class="reply">
<a aria-label="Reply to vishal" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=384967#respond" onclick='return addComment.moveForm( "comment-384967", "384967", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385393">
<div class="comment-container" id="li-comment-385393">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-385393" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found the post useful vishal.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=385393#respond" onclick='return addComment.moveForm( "comment-385393", "385393", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385829">
<div class="comment-container" id="li-comment-385829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf41acfc911e6f184652848281ce7bfa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf41acfc911e6f184652848281ce7bfa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">elberiver</span>
<span class="date">February 3, 2017 at 6:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-385829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>there is a minor point in your code. Specifically, in the follwing procedure:<br/>
——<br/>
# Build a decision tree<br/>
def build_tree(train, max_depth, min_size):<br/>
	root = get_split(dataset)<br/>
	split(root, max_depth, min_size, 1)<br/>
	return root<br/>
——<br/>
I think it should be  root = get_split(train), eventhough your code is still running correctly since dataset is the global variable.</p>
<p>Thank you for your nice posts.<br/>
I like your blog very much.</p>
<div class="reply">
<a aria-label="Reply to elberiver" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=385829#respond" onclick='return addComment.moveForm( "comment-385829", "385829", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385933">
<div class="comment-container" id="li-comment-385933">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 4, 2017 at 9:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-385933" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think you’re right, nice catch!</p>
<p>I’ll investigate and fix up the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=385933#respond" onclick='return addComment.moveForm( "comment-385933", "385933", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391812">
<div class="comment-container" id="li-comment-391812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4997148d66712332ede22552bde59b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4997148d66712332ede22552bde59b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">from Thailand</span>
<span class="date">March 8, 2017 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-391812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot Jason, really helpful</p>
<div class="reply">
<a aria-label="Reply to from Thailand" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=391812#respond" onclick='return addComment.moveForm( "comment-391812", "391812", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-391931">
<div class="comment-container" id="li-comment-391931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 9, 2017 at 9:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-391931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=391931#respond" onclick='return addComment.moveForm( "comment-391931", "391931", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395078">
<div class="comment-container" id="li-comment-395078">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amit Moondra</span>
<span class="date">April 2, 2017 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395078" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m slowly going through your code and I’m confused about a line in your <code>get_split function</code></p>
<p><code>groups = test_split(index, row[index], dataset)</code></p>
<p>Doesn’t this only return the left group? It seems we need both groups to calculate the gini_index?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Amit Moondra" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395078#respond" onclick='return addComment.moveForm( "comment-395078", "395078", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395083">
<div class="comment-container" id="li-comment-395083">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 2, 2017 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395083" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Amit,</p>
<p>The get_split() function evaluates all possible split points and returns a dict of the best found split point, gini score, split data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395083#respond" onclick='return addComment.moveForm( "comment-395083", "395083", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-395115">
<div class="comment-container" id="li-comment-395115">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amit Moondra</span>
<span class="date">April 2, 2017 at 12:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395115" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>After playing around with the code for a bit, I realized that function returns both groups (left and right) under one variable.</p>
<div class="reply">
<a aria-label="Reply to Amit Moondra" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395115#respond" onclick='return addComment.moveForm( "comment-395115", "395115", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395106">
<div class="comment-container" id="li-comment-395106">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amit Moondra</span>
<span class="date">April 2, 2017 at 9:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395106" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the function <code>split</code></p>
<p>if not left or not right:<br/>
		node[‘left’] = node[‘right’] = to_terminal(left + right)<br/>
		return</p>
<p>Why do you add (left + right)? Are you adding the two groups together into one group? </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Amit Moondra" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395106#respond" onclick='return addComment.moveForm( "comment-395106", "395106", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395318">
<div class="comment-container" id="li-comment-395318">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395318" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395318#respond" onclick='return addComment.moveForm( "comment-395318", "395318", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395116">
<div class="comment-container" id="li-comment-395116">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac8aae457a12764002726721bcce9e44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amit Moondra</span>
<span class="date">April 2, 2017 at 12:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395116" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Another question  (line 132)</p>
<p>if isinstance(node[‘left’], dict):<br/>
			return predict(node[‘left’], row)</p>
<p>isinstance is just checking if we have already created such a dictionary instance?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Amit Moondra" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395116#respond" onclick='return addComment.moveForm( "comment-395116", "395116", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395320">
<div class="comment-container" id="li-comment-395320">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395320" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is checking if the type of the variable is a dict.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395320#respond" onclick='return addComment.moveForm( "comment-395320", "395320", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395214">
<div class="comment-container" id="li-comment-395214">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ea777bafc33f8f92dc7a325ec8527f9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ea777bafc33f8f92dc7a325ec8527f9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ann</span>
<span class="date">April 3, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395214" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>I’ve been trying some stuff out with this code and I thought I was understanding what was going on but when I tried it on a dataset with binary values it doesn’t seem to work and I can’t figure out why. Could you help me out please?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Ann" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395214#respond" onclick='return addComment.moveForm( "comment-395214", "395214", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395327">
<div class="comment-container" id="li-comment-395327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-395327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The example assumes real-valued inputs, binary or categorical inputs should be handled differently.</p>
<p>I don’t have an example at hand, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=395327#respond" onclick='return addComment.moveForm( "comment-395327", "395327", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396645">
<div class="comment-container" id="li-comment-396645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/54e334bae91556fcb3abbf7a9db91f6f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/54e334bae91556fcb3abbf7a9db91f6f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dimple</span>
<span class="date">April 17, 2017 at 1:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>Could you tell me how decision trees are used for predicting an unknown function when a sample dataset is given. What i mean how it is used for regression?</p>
<div class="reply">
<a aria-label="Reply to Dimple" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396645#respond" onclick='return addComment.moveForm( "comment-396645", "396645", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396660">
<div class="comment-container" id="li-comment-396660">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396660" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, sorry, I don’t have an example of decision trees for regression from scratch.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396660#respond" onclick='return addComment.moveForm( "comment-396660", "396660", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396673">
<div class="comment-container" id="li-comment-396673">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/54e334bae91556fcb3abbf7a9db91f6f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/54e334bae91556fcb3abbf7a9db91f6f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dimple</span>
<span class="date">April 17, 2017 at 10:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396673" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can we use weka for regression using decision trees?</p>
<div class="reply">
<a aria-label="Reply to Dimple" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396673#respond" onclick='return addComment.moveForm( "comment-396673", "396673", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396774">
<div class="comment-container" id="li-comment-396774">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396774" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider using the search function of this blog.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/use-regression-machine-learning-algorithms-weka/" rel="nofollow">http://machinelearningmastery.com/use-regression-machine-learning-algorithms-weka/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396774#respond" onclick='return addComment.moveForm( "comment-396774", "396774", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396733">
<div class="comment-container" id="li-comment-396733">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9959bc7cdb7f9c5ee0e754a0b2bd52a8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9959bc7cdb7f9c5ee0e754a0b2bd52a8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joe</span>
<span class="date">April 18, 2017 at 1:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396733" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, this is exactly what I was looking for!</p>
<div class="reply">
<a aria-label="Reply to Joe" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396733#respond" onclick='return addComment.moveForm( "comment-396733", "396733", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396783">
<div class="comment-container" id="li-comment-396783">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2017 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396783" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m really glad to hear that Joe!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396783#respond" onclick='return addComment.moveForm( "comment-396783", "396783", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396855">
<div class="comment-container" id="li-comment-396855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdbc6dd08d83f4f174a44b5e623655ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdbc6dd08d83f4f174a44b5e623655ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ansar</span>
<span class="date">April 19, 2017 at 3:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am new to machine learning … successfully ran the code with the given data set</p>
<p>Now I want to run it for my own data set … will the algo always treat the last column as the column to classify?</p>
<p>thanks</p>
<div class="reply">
<a aria-label="Reply to ansar" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396855#respond" onclick='return addComment.moveForm( "comment-396855", "396855", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396880">
<div class="comment-container" id="li-comment-396880">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396880" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, that is how it was coded.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396880#respond" onclick='return addComment.moveForm( "comment-396880", "396880", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-396955">
<div class="comment-container" id="li-comment-396955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2773b6ba6de430f3145eff0cd715c6e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2773b6ba6de430f3145eff0cd715c6e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ansar</span>
<span class="date">April 20, 2017 at 2:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you!  It works beautifully</p>
<div class="reply">
<a aria-label="Reply to Ansar" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396955#respond" onclick='return addComment.moveForm( "comment-396955", "396955", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-396999">
<div class="comment-container" id="li-comment-396999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-396999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=396999#respond" onclick='return addComment.moveForm( "comment-396999", "396999", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397148">
<div class="comment-container" id="li-comment-397148">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdbc6dd08d83f4f174a44b5e623655ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdbc6dd08d83f4f174a44b5e623655ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ansar</span>
<span class="date">April 21, 2017 at 10:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-397148" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Apologies if I am taking too much time but I tried to run this algo on the below scenario with 10 folds</p>
<p>#<br/>
#https://www.youtube.com/watch?v=eKD5gxPPeY0&amp;list=PLBv09BD7ez_4temBw7vLA19p3tdQH6FYO<br/>
#<br/>
#outlook<br/>
#<br/>
#1 = sunny<br/>
#2 = overcast<br/>
#3 = rain<br/>
#<br/>
#humidity<br/>
#<br/>
#1 = high<br/>
#2 = normal<br/>
#<br/>
#wind<br/>
#<br/>
#1 = weak<br/>
#2 = strong<br/>
#<br/>
#play<br/>
#<br/>
#0 = no<br/>
#1 = yes</p>
<p>The tree generated does not cater to x2, x3 variables (for some reason), just generates for x1 (what am I doing wrong?) … the accuracy has dropped to 60%</p>
<p>[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 3.000]<br/>
 [X1 &lt; 1.000]<br/>
  [1.0]<br/>
  [1.0]<br/>
 [0.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
[X1 &lt; 1.000]<br/>
 [1.0]<br/>
 [1.0]<br/>
Scores: [100.0, 100.0, 0.0, 100.0, 0.0, 100.0, 0.0, 0.0, 100.0, 100.0]<br/>
Mean Accuracy: 60.000%</p>
<div class="reply">
<a aria-label="Reply to Ansar" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=397148#respond" onclick='return addComment.moveForm( "comment-397148", "397148", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397192">
<div class="comment-container" id="li-comment-397192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2017 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-397192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ensure that you have loaded your data correctly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=397192#respond" onclick='return addComment.moveForm( "comment-397192", "397192", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397502">
<div class="comment-container" id="li-comment-397502">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2773b6ba6de430f3145eff0cd715c6e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2773b6ba6de430f3145eff0cd715c6e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ansar</span>
<span class="date">April 25, 2017 at 3:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-397502" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, working fine now 🙂</p>
<p>Would love to get my hands on a script that would print the tree in a more graphical (readable) format.  The current format helps but does get confusing at times.</p>
<p>Thanks a lot!</p>
<div class="reply">
<a aria-label="Reply to Ansar" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=397502#respond" onclick='return addComment.moveForm( "comment-397502", "397502", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-398759">
<div class="comment-container" id="li-comment-398759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/74d24ef58f81a0174d4dc4b1845eb0e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/74d24ef58f81a0174d4dc4b1845eb0e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Greg</span>
<span class="date">May 6, 2017 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-398759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This will generate a graphviz dot file that you can use to generate a .pnj, jpeg etc. </p>
<p>e.g:</p>
<p>dot -Tpng graph1.dot &gt; graph.png</p>
<p>Note it generates a new file each time it is called – graph1.dot … graphN.dot</p>
<p># code begin</p>
<p>def graph_node(f, node):<br/>
    if isinstance(node, dict):<br/>
        f.write(‘  %d [label=\”[X%d  %d;\n’ % ((id(node), id(node[‘left’]))))<br/>
        f.write(‘  %d -&gt; %d;\n’ % ((id(node), id(node[‘right’]))))<br/>
        graph_node(f, node[‘left’])<br/>
        graph_node(f, node[‘right’])<br/>
    else:<br/>
        f.write(‘  %d [label=\”[%s]\”];\n’ % ((id(node), node)))</p>
<p>def graph_tree(node):<br/>
    if not hasattr(graph_tree, ‘n’): graph_tree.n = 0<br/>
    graph_tree.n += 1<br/>
    fn = ‘graph’ + str(graph_tree.n) + ‘.dot’<br/>
    f = open(fn, ‘w’)<br/>
    f.write(‘digraph {\n’)<br/>
    f.write(‘  node[shape=box];\n’)<br/>
    graph_node(f, node)<br/>
    f.write(‘}\n’)</p>
<div class="reply">
<a aria-label="Reply to Greg" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=398759#respond" onclick='return addComment.moveForm( "comment-398759", "398759", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397804">
<div class="comment-container" id="li-comment-397804">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa0e2255138eced0bcc8dd6b404e6702?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa0e2255138eced0bcc8dd6b404e6702?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">katana</span>
<span class="date">April 28, 2017 at 1:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-397804" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot for this, Dr. Brownlee!</p>
<div class="reply">
<a aria-label="Reply to katana" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=397804#respond" onclick='return addComment.moveForm( "comment-397804", "397804", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397853">
<div class="comment-container" id="li-comment-397853">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-397853" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found it useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=397853#respond" onclick='return addComment.moveForm( "comment-397853", "397853", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398544">
<div class="comment-container" id="li-comment-398544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51a682a4ee6c99232b8a55daa703a7be?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51a682a4ee6c99232b8a55daa703a7be?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">godavari</span>
<span class="date">May 4, 2017 at 11:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-398544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>excellent explanation</p>
<div class="reply">
<a aria-label="Reply to godavari" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=398544#respond" onclick='return addComment.moveForm( "comment-398544", "398544", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398575">
<div class="comment-container" id="li-comment-398575">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-398575" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found it useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=398575#respond" onclick='return addComment.moveForm( "comment-398575", "398575", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399614">
<div class="comment-container" id="li-comment-399614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d1bc4c05ff7967cc6a467445ec32c02?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d1bc4c05ff7967cc6a467445ec32c02?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">King Deng</span>
<span class="date">May 14, 2017 at 7:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-399614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m implementing AdaBoost from scratch now, and I have a tough time understanding how to apply the sample weights calculated in each iteration to build the decision tree? I guess I should modify the gini index in this regard, but I’m not specifically sure how to do that. Could you shed some light? Thanks!</p>
<div class="reply">
<a aria-label="Reply to King Deng" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=399614#respond" onclick='return addComment.moveForm( "comment-399614", "399614", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399636">
<div class="comment-container" id="li-comment-399636">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 14, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-399636" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I offer a step-by-step example in this book:<br/>
<a href="https://machinelearningmastery.com/master-machine-learning-algorithms/" rel="nofollow">https://machinelearningmastery.com/master-machine-learning-algorithms/</a></p>
<p>I would also recommend this book for a great explanation:<br/>
<a href="http://www-bcf.usc.edu/~gareth/ISL/" rel="nofollow">http://www-bcf.usc.edu/~gareth/ISL/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=399636#respond" onclick='return addComment.moveForm( "comment-399636", "399636", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400046">
<div class="comment-container" id="li-comment-400046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5ab309d35a64ad3a3d5568c0201f722?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5ab309d35a64ad3a3d5568c0201f722?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pavithra</span>
<span class="date">May 19, 2017 at 7:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-400046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Part of the code: predicted = algorithm(train_set, test_set, *args)</p>
<p>TypeError: ‘int’ object is not callable</p>
<p>Issue: I’m getting error like this. Please help me</p>
<div class="reply">
<a aria-label="Reply to Pavithra" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=400046#respond" onclick='return addComment.moveForm( "comment-400046", "400046", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400088">
<div class="comment-container" id="li-comment-400088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-400088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that.</p>
<p>Ensure that you have copied all of the code without any extra white space.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=400088#respond" onclick='return addComment.moveForm( "comment-400088", "400088", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400485">
<div class="comment-container" id="li-comment-400485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4a12f3c68308bfc23ebbb2c4205bf69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4a12f3c68308bfc23ebbb2c4205bf69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://Ilabacl@labcorp.com" rel="external nofollow">Luis Ilabaca</a></span>
<span class="date">May 25, 2017 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-400485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hey jason</p>
<p>honestly dude stuff like this is no joke man.</p>
<p>I did BA in math and one year of MA in math<br/>
then MA in Statistical Computing and Data Mining<br/>
and then sas certifications and a lot of R and man let me tell you,<br/>
when I read your work and see how you have such a strong understanding of the unifications of all the different fields needed to be successful at applying machine learning.</p>
<p>you my friend, are a killer.</p>
<div class="reply">
<a aria-label="Reply to Luis Ilabaca" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=400485#respond" onclick='return addComment.moveForm( "comment-400485", "400485", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401120">
<div class="comment-container" id="li-comment-401120">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-401120" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=401120#respond" onclick='return addComment.moveForm( "comment-401120", "401120", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400512">
<div class="comment-container" id="li-comment-400512">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e03e19c20c18e4d16a6c482ee19a2c0f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e03e19c20c18e4d16a6c482ee19a2c0f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saurabh</span>
<span class="date">May 25, 2017 at 7:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-400512" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir!!<br/>
First of all Thank You for such a great tutorial.</p>
<p>I would like to make a suggestion for function get_split()-<br/>
In this function instead of calculating gini index considering every value of that attribute in data set , we can just use the mean of that attribute as the split_value for test_split function.</p>
<p>This is just my idea please do correct me if this approach is wrong.</p>
<p>Thank You!!</p>
<div class="reply">
<a aria-label="Reply to Saurabh" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=400512#respond" onclick='return addComment.moveForm( "comment-400512", "400512", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401127">
<div class="comment-container" id="li-comment-401127">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-401127" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=401127#respond" onclick='return addComment.moveForm( "comment-401127", "401127", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401399">
<div class="comment-container" id="li-comment-401399">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/50925a65da279978700e3982819e8373?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/50925a65da279978700e3982819e8373?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Habiba</span>
<span class="date">June 4, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-401399" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,<br/>
I am a student and i need to develop an algorithm for both Decision Tree and Ensemble(Preferably,Random Forest) both using python and R.  i really need the book that contains everything that is,the super bundle.</p>
<p>Thank you so very much for the post and the tutorials. They have been really helpful.</p>
<div class="reply">
<a aria-label="Reply to Habiba" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=401399#respond" onclick='return addComment.moveForm( "comment-401399", "401399", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401417">
<div class="comment-container" id="li-comment-401417">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 4, 2017 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-401417" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can grab the super bundle here:<br/>
<a href="https://machinelearningmastery.com/super-bundle/" rel="nofollow">https://machinelearningmastery.com/super-bundle/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=401417#respond" onclick='return addComment.moveForm( "comment-401417", "401417", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403319">
<div class="comment-container" id="li-comment-403319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/695d8e6c9877a5be60a3c0b65ddd8861?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/695d8e6c9877a5be60a3c0b65ddd8861?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dev</span>
<span class="date">June 21, 2017 at 9:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-403319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,<br/>
First of all Thank You for such a great tutorial<br/>
I am new to machine learning and python as well.I’m slowly going through your code<br/>
I have a doubt in the below section</p>
<p># Build a decision tree<br/>
def build_tree(train, max_depth, min_size):<br/>
	root = get_split(train)<br/>
	split(root, max_depth, min_size, 1)<br/>
	return root</p>
<p>In this section the “split” function returns “none”,Then how the changes made in “split” function are reflecting in the variable “root”<br/>
To know what values are stored in “root” variable, I run the code as below</p>
<p># Build a decision tree<br/>
def build_tree(train, max_depth, min_size):<br/>
	root = get_split(train)<br/>
	print(root)	— Before calling split function<br/>
	split(root, max_depth, min_size, 1)<br/>
	print(root)	— after calling split function</p>
<p>The values in both cases are different.But I’m confused how it happens<br/>
Can anybody help me out please?<br/>
Thank you.</p>
<div class="reply">
<a aria-label="Reply to Dev" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=403319#respond" onclick='return addComment.moveForm( "comment-403319", "403319", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403366">
<div class="comment-container" id="li-comment-403366">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2017 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-403366" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The split function adds child nodes to the passed in root node to build the tree.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=403366#respond" onclick='return addComment.moveForm( "comment-403366", "403366", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403667">
<div class="comment-container" id="li-comment-403667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7bf2baa469194849ebe9fd4b5f50d16?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7bf2baa469194849ebe9fd4b5f50d16?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xinglong Li</span>
<span class="date">June 24, 2017 at 12:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-403667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello sir<br/>
  Thanks for this tutorial.<br/>
  I guess that when sum the Gini indexes of subgroups into a total one, their corresponding group sizes should be taken into consideration, that is, I think it should be a weighted sum.</p>
<div class="reply">
<a aria-label="Reply to Xinglong Li" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=403667#respond" onclick='return addComment.moveForm( "comment-403667", "403667", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-408590">
<div class="comment-container" id="li-comment-408590">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow">Michael</a></span>
<span class="date">August 5, 2017 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-408590" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think I have the same question.  The Gini Index computed in the above examples are not weighted by the size of the partitions.  Shouldn’t they be?  I posted a detailed example, but it has not been excepted (yet?).</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=408590#respond" onclick='return addComment.moveForm( "comment-408590", "408590", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404008">
<div class="comment-container" id="li-comment-404008">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4755ac6dc4eb1a81183e5b7d9fdf46c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4755ac6dc4eb1a81183e5b7d9fdf46c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-403325" rel="external nofollow">sanju</a></span>
<span class="date">June 27, 2017 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404008" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,</p>
<p>Assume we have created a model using the above algorithm.<br/>
Then if we go for prediction using this model ,will this model process on the whole training data.? </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to sanju" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404008#respond" onclick='return addComment.moveForm( "comment-404008", "404008", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404049">
<div class="comment-container" id="li-comment-404049">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 28, 2017 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404049" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We do not need to evaluate the model when we want to make predictions. We fit it on all the training data then start using it.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404049#respond" onclick='return addComment.moveForm( "comment-404049", "404049", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404104">
<div class="comment-container" id="li-comment-404104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4db1020cfe74dc20b26d386008cec08?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4db1020cfe74dc20b26d386008cec08?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404008" rel="external nofollow">Rohit</a></span>
<span class="date">June 28, 2017 at 7:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,</p>
<p>Assume I have 1 million training data,and I created and saved a model to predict whether the patient is diabetic or not ,Every thing is ok with the model and the model is deployed in client side(hospital).consider the case below</p>
<p>1. If a new patient come then based on some input from the patient the model will predict whether the patient is diabetic or not.</p>
<p>2.If another patient come then also our model will predict </p>
<p>my doubt is in the both case will the model process on one million training data.?<br/>
that is if 100 patient come at different time, will this model process 100 times over one million data(training data).?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Rohit" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404104#respond" onclick='return addComment.moveForm( "comment-404104", "404104", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404173">
<div class="comment-container" id="li-comment-404173">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404173" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, after you fit the model you save it. Later you load it and make a prediction.</p>
<p>See this post on creating a final model for making predictions:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404173#respond" onclick='return addComment.moveForm( "comment-404173", "404173", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404188">
<div class="comment-container" id="li-comment-404188">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dff64537b93fe65a897033a9e2dd3878?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dff64537b93fe65a897033a9e2dd3878?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael Shparber</span>
<span class="date">June 29, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404188" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent, thank you for sharing!<br/>
Are there tools that allow to do this without ANY coding?<br/>
I mean drag-n-drop / right-click-options.<br/>
It is very useful to understand behind-the-scenes but much faster in many cases to use some sort of UI.<br/>
What would you recommend?<br/>
Thank you,<br/>
Michael</p>
<div class="reply">
<a aria-label="Reply to Michael Shparber" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404188#respond" onclick='return addComment.moveForm( "comment-404188", "404188", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404192">
<div class="comment-container" id="li-comment-404192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, Weka:<br/>
<a href="http://machinelearningmastery.com/start-here/#weka" rel="nofollow">http://machinelearningmastery.com/start-here/#weka</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404192#respond" onclick='return addComment.moveForm( "comment-404192", "404192", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404744">
<div class="comment-container" id="li-comment-404744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/721c59608de5f20683f19b28a2229766?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/721c59608de5f20683f19b28a2229766?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali Mesbahi</span>
<span class="date">July 5, 2017 at 12:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Excellent post. It has been really helpful for me!<br/>
Is there a similar article/tutorial for the C4.5 algorithm?<br/>
Is there any implementations in R?</p>
<p>Thank you,<br/>
Ali.</p>
<div class="reply">
<a aria-label="Reply to Ali Mesbahi" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404744#respond" onclick='return addComment.moveForm( "comment-404744", "404744", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404895">
<div class="comment-container" id="li-comment-404895">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-404895" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See here for R examples:<br/>
<a href="http://machinelearningmastery.com/non-linear-classification-in-r-with-decision-trees/" rel="nofollow">http://machinelearningmastery.com/non-linear-classification-in-r-with-decision-trees/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=404895#respond" onclick='return addComment.moveForm( "comment-404895", "404895", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405314">
<div class="comment-container" id="li-comment-405314">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8631f7f4a9236495ffdb935e7374644a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8631f7f4a9236495ffdb935e7374644a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jeet</span>
<span class="date">July 9, 2017 at 9:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-405314" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>dataset = list(lines)</p>
<p>Error: iterator should return strings, not bytes (did you open the file in text mode?)</p>
<p>How can i solve this issue ?</p>
<div class="reply">
<a aria-label="Reply to Jeet" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=405314#respond" onclick='return addComment.moveForm( "comment-405314", "405314", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405464">
<div class="comment-container" id="li-comment-405464">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-405464" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This might be a Python version issue.</p>
<p>Try changing the loading of the file to ‘rt’ format.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=405464#respond" onclick='return addComment.moveForm( "comment-405464", "405464", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405651">
<div class="comment-container" id="li-comment-405651">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be7d93551664ee8a6b3f7533c4e5d3b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be7d93551664ee8a6b3f7533c4e5d3b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AJENG SHILVIE NURLATIFAH</span>
<span class="date">July 12, 2017 at 6:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-405651" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason, thanks for sharing about this algorithm,<br/>
i have a final task to use some classification model like decision tree to fill missing values in data set, is it possible ?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to AJENG SHILVIE NURLATIFAH" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=405651#respond" onclick='return addComment.moveForm( "comment-405651", "405651", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405719">
<div class="comment-container" id="li-comment-405719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-405719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post for ideas:<br/>
<a href="http://machinelearningmastery.com/handle-missing-data-python/" rel="nofollow">http://machinelearningmastery.com/handle-missing-data-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=405719#respond" onclick='return addComment.moveForm( "comment-405719", "405719", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406659">
<div class="comment-container" id="li-comment-406659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/246c82f8593db362c548785a91a35ae9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/246c82f8593db362c548785a91a35ae9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nghi</span>
<span class="date">July 21, 2017 at 12:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-406659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I tried running the modified version by adding labels for the data</p>
<p>#to add label but not part of the training<br/>
data = pd.read_csv(r’H:\Python\Tree\data_banknote_authentication.txt’, header = None )<br/>
dataset = pd.DataFrame(data)<br/>
dataset.columns = [‘var’, ‘skew’, ‘curt’, ‘ent’, ‘bin’] </p>
<p>so on the last step, i only ran </p>
<p>n_folds = 5<br/>
max_depth = 5<br/>
min_size = 10<br/>
scores = evaluate_algorithm(dataset, decision_tree, n_folds, max_depth, min_size)<br/>
print(‘Scores: %s’ % scores)<br/>
print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p>and i got the error message saying </p>
<p>ValueError: empty range for randrange() </p>
<p>Could you help explain why?</p>
<p>Also on this section to load the CSV file</p>
<p># Load a CSV file<br/>
def load_csv(filename):<br/>
    file = open(filename, “rb”)<br/>
    lines = reader(file)<br/>
    dataset = list(lines)<br/>
    return dataset</p>
<p>could you help explain how to add the location of the file if it’s on local drive?</p>
<p>Thank you very much,</p>
<div class="reply">
<a aria-label="Reply to Nghi" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=406659#respond" onclick='return addComment.moveForm( "comment-406659", "406659", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-407163">
<div class="comment-container" id="li-comment-407163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6828c6eb734d330ba86ec7519d1a7311?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6828c6eb734d330ba86ec7519d1a7311?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">preet shah</span>
<span class="date">July 24, 2017 at 9:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-407163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What changes would you suggest i should make to solve the following problem: </p>
<p>A premium payer wants to improve the medical care using Machine Learning. They want to predict next events of Diagnosis, Procedure or Treatment that is going to be happen to patients. They’ve provided with patient journey information coded using ICD9. </p>
<p> You have to predict the next 10 events reported by patient in order of occurrence in 2014.</p>
<p>Data Description</p>
<p>There are three files given to download: train.csv, test.csv and sample_submission.csv<br/>
The train data consists of patients information from Jan 2011 to Dec 2013. The test data consists of Patient IDs for the year 2014.</p>
<p>Variable	Description<br/>
ID	        Patient ID<br/>
Date	Period of Diagnosis<br/>
Event	Event ID (ICD9 Format) – Target Variable</p>
<div class="reply">
<a aria-label="Reply to preet shah" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=407163#respond" onclick='return addComment.moveForm( "comment-407163", "407163", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407226">
<div class="comment-container" id="li-comment-407226">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-407226" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like homework.</p>
<p>If not, I recommend this process for working through new predictive modeling problems:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=407226#respond" onclick='return addComment.moveForm( "comment-407226", "407226", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-407426">
<div class="comment-container" id="li-comment-407426">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be41effb0730f26ea6698e19e4207fc5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be41effb0730f26ea6698e19e4207fc5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ikib Kilam</span>
<span class="date">July 26, 2017 at 10:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-407426" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, </p>
<p>Thanks for this wonderful example.  I rewrote your code, exactly as you wrote it, but cannot replicate your scores and mean accuracy.  I get the following:</p>
<p>Scores: [28.467153284671532, 37.591240875912405, 76.64233576642336, 68.97810218978103, 70.43795620437956]<br/>
Mean Accuracy: 56.42335766423357</p>
<p>As another run, I changed nFolds to be 7, maxDepth to be 4 and minSize to be 4 and got:</p>
<p>Scores: [40.30612244897959, 38.775510204081634, 37.755102040816325, 71.42857142857143, 70.91836734693877, 70.91836734693877, 69.89795918367348]<br/>
Mean Accuracy: 57.142857142857146</p>
<p>I have tried all types of combinations for nFolds, minSize and maxDepth, and even tried stopping randomizing the selection of data instances into Folds.  However, my scores do not change, and my mean accuracy has never exceeded 60%, and in fact consistently is in the 55%+ range.  Strangely, my first two scores are low and then they increase, though not to 80%.  I am at my wits end, why I cannot replicate your high (80%+) scores/accuracy.</p>
<p>Any ideas on what might be happening?  Thanks for taking the time to read my comment and again thanks for the wonderful illustration.</p>
<p>Ikib</p>
<div class="reply">
<a aria-label="Reply to Ikib Kilam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=407426#respond" onclick='return addComment.moveForm( "comment-407426", "407426", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407485">
<div class="comment-container" id="li-comment-407485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-407485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is odd.</p>
<p>Perhaps a copy-paste error somewhere? That would be my best guess.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=407485#respond" onclick='return addComment.moveForm( "comment-407485", "407485", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408535">
<div class="comment-container" id="li-comment-408535">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb81109d7c2d856615c414875e7ab5f9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb81109d7c2d856615c414875e7ab5f9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">buzznizz</span>
<span class="date">August 4, 2017 at 9:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-408535" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>It’s not usefull splitting on groups with size 1 (as you do now with groups size 0) and you can make them directly terminal.</p>
<p>BR</p>
<div class="reply">
<a aria-label="Reply to buzznizz" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=408535#respond" onclick='return addComment.moveForm( "comment-408535", "408535", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-408587">
<div class="comment-container" id="li-comment-408587">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow">Michael</a></span>
<span class="date">August 5, 2017 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-408587" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for a very well put together tutorial!</p>
<p>Read through all the replies here to see if someone had asked the question I had.  I think the question Xinglong Li asked on June 24, 2017 is the same one I have, but it wasn’t answered so I’ll rephrase:</p>
<p>Isn’t the calculation of the Gini Index suppose to be weighted by the count in each group?</p>
<p>For example, in the table just above section “3. Build a Tree”, on line 15, the output lists:<br/>
X2 &lt; 2.209 Gini=0.934</p>
<p>When I compute this by hand, I get this exact value if I do NOT weight the calculation by the size of the partitions.  When I do this calculation the way I think it's supposed to be done (weighting by partition size), I get Gini=0.4762.  This is how I compute this value:</p>
<p>1) Start with the test data sorted by X1 so we can easily do the split (expressed in csv format):</p>
<p>X1,X2,Y<br/>
7.444542326,0.476683375,1<br/>
1.728571309,1.169761413,0<br/>
2.771244718,1.784783929,0<br/>
— group 1 above this line, group 2 below this line —<br/>
2.999208922,2.209014212,0<br/>
3.961043357,2.61995032,0<br/>
3.678319846,2.81281357,0<br/>
7.497545867,3.162953546,1<br/>
10.12493903,3.234550982,1<br/>
6.642287351,3.319983761,1<br/>
9.00220326,3.339047188,1</p>
<p>2) Compute the proportions (computing to 9 places, displaying 4):</p>
<p>P(1, 0) = group 1 (above line), class 0 = 0.6667<br/>
P(1, 1) = group 1 (above line), class 1 = 0.3333<br/>
P(2, 0) = group 2 (below line), class 0 = 0.4286<br/>
P(2, 1) = group 2 (below line), class 1 = 0.5714</p>
<p>3) Compute Gini Score WITHOUT weighting (computing to 9 places, displaying 4):</p>
<p>Gini Score =<br/>
[P(1, 0) x (1 – P(1, 0))] +<br/>
[P(1, 1) x (1 – P(1, 1))] +<br/>
[P(2, 0) x (1 – P(2, 0))] +<br/>
[P(2, 1) x (1 – P(2, 1))] =<br/>
0.2222 + 0.2222 + 0.2449 + 0.2449 = 0.934 (just what you got)</p>
<p>4) Compute Gini Score WITH weighting (computing to 9 places, displaying 4):</p>
<p>[(3/10) x (0.2222 + 0.2222)] + [(7/10) x (0.2449 + 0.2449)] = 0.4762</p>
<p>Could you explain why you don't weight by partition size when you compute your Gini Index?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=408587#respond" onclick='return addComment.moveForm( "comment-408587", "408587", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408687">
<div class="comment-container" id="li-comment-408687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 6, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-408687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Michael, I believe the counts are weighted. </p>
<p>See “proportion” both in the description of the algorithm and the code calculation of gini for each class group.</p>
<p>See “an introduction to statistical learning with applications in r” pages 311 onwards for the equations.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=408687#respond" onclick='return addComment.moveForm( "comment-408687", "408687", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-409053">
<div class="comment-container" id="li-comment-409053">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow">Michael</a></span>
<span class="date">August 9, 2017 at 7:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409053" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thanks for the reply.  After reading and re-reading pages 311 and 312 several times, it seems to me that equation (8.6) in the ISL (love this book BTW, but in this rare case, it is lacking some important details) should really have a subscript m on the G because it is computing the Gini score for a particular region.  Notice that in this equation: 1) the summation is over K (the total number of classes) and 2) the mk subscript on p hat.  These imply that both the proportion (p hat sub mk) and G are with respect to a particular region m.</p>
<p>Eqn. (8.6) in the ISL is correct, but it’s not the final quanitity that should be used for determining the quality of the split.  There is an additional step (not described in the ISL) which needs to be done: weighting the Gini scores by the size of the proposed split regions as shown in this example:</p>
<p><a href="https://www.researchgate.net/post/How_to_compute_impurity_using_Gini_Index" rel="nofollow">https://www.researchgate.net/post/How_to_compute_impurity_using_Gini_Index</a></p>
<p>I think the gini_index function should look something like what is shown below.  This version gives me the values I expect and is consistent with how the gini score of a split is computed in the above example:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916b02af3142371521" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def gini_index2(groups, class_values):
    group_sizes = [len(group) for group in groups]
    sample_count = sum(group_sizes)
    gini_groups = []
    for idx, group in enumerate(groups):
        gini_group = 0.0
        group_size = len(group)
        for class_value in class_values:
            if group_size == 0:
                continue
            proportion = [row[-1] for row in group].count(class_value) / \
                         float(group_size)
            gini_group += (proportion * (1.0 - proportion))
        # weight the group gini score by the size of the group
        partition_weight = group_sizes[idx] / sample_count
        gini_groups.append(partition_weight * gini_group)
        
    return sum(gini_groups)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-2">2</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-4">4</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-6">6</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-8">8</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-10">10</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-12">12</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-14">14</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-16">16</div><div class="crayon-num" data-line="crayon-5a65916b02af3142371521-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b02af3142371521-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916b02af3142371521-1"><span class="crayon-e">def </span><span class="crayon-e">gini_index2</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-2"><span class="crayon-h">    </span><span class="crayon-v">group_sizes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-3"><span class="crayon-h">    </span><span class="crayon-v">sample_count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">group_sizes</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-4"><span class="crayon-h">    </span><span class="crayon-v">gini_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-5"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">idx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-6"><span class="crayon-h">        </span><span class="crayon-v">gini_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-7"><span class="crayon-h">        </span><span class="crayon-v">group_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-8"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-9"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">group_size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-10"><span class="crayon-h">                </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-11"><span class="crayon-h">            </span><span class="crayon-v">proportion</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-12"><span class="crayon-h">                         </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">group_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-13"><span class="crayon-h">            </span><span class="crayon-v">gini_group</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">proportion *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">proportion</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-14"><span class="crayon-h">        </span><span class="crayon-p"># weight the group gini score by the size of the group</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-15"><span class="crayon-h">        </span><span class="crayon-v">partition_weight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">group_sizes</span><span class="crayon-sy">[</span><span class="crayon-v">idx</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">sample_count</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-16"><span class="crayon-e">        </span><span class="crayon-v">gini_groups</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e ">partition_weight *</span><span class="crayon-h"> </span><span class="crayon-v">gini_group</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916b02af3142371521-17"><span class="crayon-h">        </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b02af3142371521-18"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">gini_groups</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p>Thoughts?</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=409053#respond" onclick='return addComment.moveForm( "comment-409053", "409053", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-409054">
<div class="comment-container" id="li-comment-409054">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow">Michael</a></span>
<span class="date">August 9, 2017 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409054" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry about the loss of indentation in the code…  Seems like the webapp parses these out before posting.</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=409054#respond" onclick='return addComment.moveForm( "comment-409054", "409054", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-409136">
<div class="comment-container" id="li-comment-409136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2017 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I added some pre tags for you.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-409135">
<div class="comment-container" id="li-comment-409135">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2017 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409135" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ll take a look, thanks for sharing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=409135#respond" onclick='return addComment.moveForm( "comment-409135", "409135", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-409178">
<div class="comment-container" id="li-comment-409178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d67e1fe659c67d1b88b212bd6220220?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow">Michael</a></span>
<span class="date">August 10, 2017 at 11:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your eyeballs.  The original code I proposed works, but it has some unnecessary stuff in it.  This is a cleaner (less lines) implementation (hopefully the pre tags I insert work…):</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65916b0299b624010882" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# groups - tuple or list of samples corresponding to a split group
# class_values - tuple or list of unique class labels
# TODO class_values can be obtained from groups - no need to pass in
def gini_index2(groups, class_values):
    sample_count = sum([len(group) for group in groups])
    gini_groups = []
    for group in groups:
        gini_group = 0.0
        group_size = len(group)
        for class_value in class_values:
            if group_size == 0:
                continue
            proportion = [row[-1] for row in group].count(class_value) / \
                         float(group_size)
            gini_group += (proportion * (1.0 - proportion))
        # weight the group gini score by the size of the group
        partition_weight = group_size / sample_count
        gini_groups.append(partition_weight * gini_group)
        
    return sum(gini_groups)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-2">2</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-4">4</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-6">6</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-8">8</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-10">10</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-12">12</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-14">14</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-16">16</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-18">18</div><div class="crayon-num" data-line="crayon-5a65916b0299b624010882-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65916b0299b624010882-20">20</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65916b0299b624010882-1"><span class="crayon-p"># groups - tuple or list of samples corresponding to a split group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-2"><span class="crayon-p"># class_values - tuple or list of unique class labels</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-3"><span class="crayon-p"># TODO class_values can be obtained from groups - no need to pass in</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-4"><span class="crayon-e">def </span><span class="crayon-e">gini_index2</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-5"><span class="crayon-h">    </span><span class="crayon-v">sample_count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-6"><span class="crayon-h">    </span><span class="crayon-v">gini_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-7"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-8"><span class="crayon-h">        </span><span class="crayon-v">gini_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-9"><span class="crayon-h">        </span><span class="crayon-v">group_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-10"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-11"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">group_size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-12"><span class="crayon-h">                </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-13"><span class="crayon-h">            </span><span class="crayon-v">proportion</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-14"><span class="crayon-h">                         </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">group_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-15"><span class="crayon-h">            </span><span class="crayon-v">gini_group</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">proportion *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">proportion</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-16"><span class="crayon-h">        </span><span class="crayon-p"># weight the group gini score by the size of the group</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-17"><span class="crayon-h">        </span><span class="crayon-v">partition_weight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">group_size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">sample_count</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-18"><span class="crayon-e">        </span><span class="crayon-v">gini_groups</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e ">partition_weight *</span><span class="crayon-h"> </span><span class="crayon-v">gini_group</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65916b0299b624010882-19"><span class="crayon-h">        </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65916b0299b624010882-20"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">gini_groups</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-409214">
<div class="comment-container" id="li-comment-409214">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2017 at 4:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-409214" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks. Added to my trello to review.</p>
<p>Update: Yes, you are 100% correct. Thank you so much for pointing this out and helping me see the fault Michael! I really appreciate it!</p>
<p>I did some homework on the calculation (checked some textbooks and read sklearns source) and wrote a new version of the gini calculation function from scratch. I then update the tutorial.</p>
<p>I think it’s good now, but shout if you see anything off.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410021">
<div class="comment-container" id="li-comment-410021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/797a6e98d9e489c72171374fd40bf235?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/797a6e98d9e489c72171374fd40bf235?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nehasharma</span>
<span class="date">August 18, 2017 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-410021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,In your code:<br/>
print(gini_index([[[1, 1], [1, 0]], [[1, 1], [1, 0]]], [0, 1]))</p>
<p>how should i interpret the number of ZEROES and ONES(distribution of classes in group)?I am new to this..</p>
<div class="reply">
<a aria-label="Reply to nehasharma" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=410021#respond" onclick='return addComment.moveForm( "comment-410021", "410021", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410029">
<div class="comment-container" id="li-comment-410029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2017 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-410029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question!</p>
<p>No, each array is a pattern, the final value in each array is a class value. The final array are the valid classes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=410029#respond" onclick='return addComment.moveForm( "comment-410029", "410029", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-417526">
<div class="comment-container" id="li-comment-417526">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/15e190f2d703f3f81791cf8024e8269a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/15e190f2d703f3f81791cf8024e8269a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John Sobola</span>
<span class="date">October 22, 2017 at 10:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417526" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I did not notice any difference in the split point and prediction when I used both the old and revised gini codes</p>
<div class="reply">
<a aria-label="Reply to John Sobola" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417526#respond" onclick='return addComment.moveForm( "comment-417526", "417526", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411391">
<div class="comment-container" id="li-comment-411391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ae8a1fcd2b747242fc1b6948d975073?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ae8a1fcd2b747242fc1b6948d975073?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">aaaaa</span>
<span class="date">August 28, 2017 at 12:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-411391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how to apply this for discrete value ?</p>
<div class="reply">
<a aria-label="Reply to aaaaa" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=411391#respond" onclick='return addComment.moveForm( "comment-411391", "411391", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413914">
<div class="comment-container" id="li-comment-413914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e6eb2e38bd483694da3098b68ec80f07?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e6eb2e38bd483694da3098b68ec80f07?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">scssek</span>
<span class="date">September 15, 2017 at 1:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-413914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you recommend this decision tree model for binary file based data?</p>
<div class="reply">
<a aria-label="Reply to scssek" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=413914#respond" onclick='return addComment.moveForm( "comment-413914", "413914", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413986">
<div class="comment-container" id="li-comment-413986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-413986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do not recommend an algorithm. I recommend testing a suite of algorithms to see what works best.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/" rel="nofollow">http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=413986#respond" onclick='return addComment.moveForm( "comment-413986", "413986", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414133">
<div class="comment-container" id="li-comment-414133">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0fc7c82d2b3a21b733ffab448cff14cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0fc7c82d2b3a21b733ffab448cff14cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ann</span>
<span class="date">September 18, 2017 at 12:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414133" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good Day sir!<br/>
   I would like to ask why does my code run around 30-46 minutes to get the mean accuracy? I am running about 24100 rows of data with 3 columns. Is it normally this slow? Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Ann" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414133#respond" onclick='return addComment.moveForm( "comment-414133", "414133", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414156">
<div class="comment-container" id="li-comment-414156">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414156" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, because this is just a demonstration.</p>
<p>For a more efficient implementation, use the implementation is scikit-learn.</p>
<p>For more on why you should only code machine learning algorithms from scratch for learning, see this post:<br/>
<a href="http://machinelearningmastery.com/dont-implement-machine-learning-algorithms/" rel="nofollow">http://machinelearningmastery.com/dont-implement-machine-learning-algorithms/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414156#respond" onclick='return addComment.moveForm( "comment-414156", "414156", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414213">
<div class="comment-container" id="li-comment-414213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jarich</span>
<span class="date">September 19, 2017 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you leave an example with a larger hard-coded decision tree, with 2 or even 3 stages?<br/>
I can’t seem to get the syntax right to work with larger decision trees.</p>
<div class="reply">
<a aria-label="Reply to Jarich" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414213#respond" onclick='return addComment.moveForm( "comment-414213", "414213", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414249">
<div class="comment-container" id="li-comment-414249">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414249" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion. Note that the code can develop such a tree.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414249#respond" onclick='return addComment.moveForm( "comment-414249", "414249", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-414282">
<div class="comment-container" id="li-comment-414282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jarich</span>
<span class="date">September 19, 2017 at 5:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yeah I just found that out myself, might be better to not even give the example and let us think for some time.</p>
<div class="reply">
<a aria-label="Reply to jarich" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414282#respond" onclick='return addComment.moveForm( "comment-414282", "414282", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414530">
<div class="comment-container" id="li-comment-414530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maria</span>
<span class="date">September 22, 2017 at 1:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to ask if there is a way to store the already learned decision tree? so that when the predict function is called for one test data only, it can be run at a much faster speed. Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Maria" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414530#respond" onclick='return addComment.moveForm( "comment-414530", "414530", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-414551">
<div class="comment-container" id="li-comment-414551">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5af00a8fc079175a31614652aaa7f420?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jarich</span>
<span class="date">September 22, 2017 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414551" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Maria, you could save it to a .txt file and then read it back in for the prediction. I did it that way and it works flawlessly!</p>
<div class="reply">
<a aria-label="Reply to Jarich" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414551#respond" onclick='return addComment.moveForm( "comment-414551", "414551", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-414575">
<div class="comment-container" id="li-comment-414575">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maria</span>
<span class="date">September 22, 2017 at 11:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414575" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>oh okay. I will save the result for build_tree to a text file? Thank you very much for this information! 😀</p>
<div class="reply">
<a aria-label="Reply to Maria" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414575#respond" onclick='return addComment.moveForm( "comment-414575", "414575", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-414598">
<div class="comment-container" id="li-comment-414598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 23, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tip Jarich.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414598#respond" onclick='return addComment.moveForm( "comment-414598", "414598", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414593">
<div class="comment-container" id="li-comment-414593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 23, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I would recommend using the sklearn library then save the fit model using pickle.</p>
<p>I have examples of this on my blog, use the search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414593#respond" onclick='return addComment.moveForm( "comment-414593", "414593", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414797">
<div class="comment-container" id="li-comment-414797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/009570204c39141c5b32aea4e2adbfdf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/009570204c39141c5b32aea4e2adbfdf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chakri</span>
<span class="date">September 26, 2017 at 2:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason : Thank you for a great artcile. Can u provide me the code for generating the tree. I have got scores and accuracy and would like to view the decision tree. Please provide the code related to generating tree</p>
<div class="reply">
<a aria-label="Reply to chakri" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414797#respond" onclick='return addComment.moveForm( "comment-414797", "414797", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-414798">
<div class="comment-container" id="li-comment-414798">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/009570204c39141c5b32aea4e2adbfdf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/009570204c39141c5b32aea4e2adbfdf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chakri</span>
<span class="date">September 26, 2017 at 2:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414798" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i would need to code using graphviz</p>
<div class="reply">
<a aria-label="Reply to chakri" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414798#respond" onclick='return addComment.moveForm( "comment-414798", "414798", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414812">
<div class="comment-container" id="li-comment-414812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 26, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-414812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=414812#respond" onclick='return addComment.moveForm( "comment-414812", "414812", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415211">
<div class="comment-container" id="li-comment-415211">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/512555fb64c10c56e63b0affbb7e9dde?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maria</span>
<span class="date">September 30, 2017 at 11:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-415211" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to know if this tree can also handle multiple classification aside from 0 or 1? for example I need to classify if it is 1,2,3,4,5 Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Maria" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=415211#respond" onclick='return addComment.moveForm( "comment-415211", "415211", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415253">
<div class="comment-container" id="li-comment-415253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 1, 2017 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-415253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It could be extended to multiple classes. I do not have an example sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=415253#respond" onclick='return addComment.moveForm( "comment-415253", "415253", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415496">
<div class="comment-container" id="li-comment-415496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/28759cd88f92b6dee461b5a6bc9e315b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/28759cd88f92b6dee461b5a6bc9e315b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://makersuniversity.com" rel="external nofollow">Leo</a></span>
<span class="date">October 4, 2017 at 3:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-415496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I can’t get started.<br/>
I use Python 3.5 on Spyder 3.0.0.<br/>
Your code doesn’t read the dataset and an error comes out:<br/>
Error: iterator should return strings, not bytes (did you open the file in text mode?)</p>
<p>I’m a beginner in both Python and ML.</p>
<p>Can you help?</p>
<p>Thank you, Leo</p>
<div class="reply">
<a aria-label="Reply to Leo" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=415496#respond" onclick='return addComment.moveForm( "comment-415496", "415496", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415519">
<div class="comment-container" id="li-comment-415519">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-415519" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was developed for Python 2.7. I will update it for Python 3 in the future.</p>
<p>Perhaps start with Weka where no programming is required:<br/>
<a href="https://machinelearningmastery.com/start-here/#weka" rel="nofollow">https://machinelearningmastery.com/start-here/#weka</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=415519#respond" onclick='return addComment.moveForm( "comment-415519", "415519", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416373">
<div class="comment-container" id="li-comment-416373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6d4367ec55f4eb19b47cc11bfff4995?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6d4367ec55f4eb19b47cc11bfff4995?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lightbandit</span>
<span class="date">October 12, 2017 at 4:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-416373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a dataset with titles on both axes (will post example below) and they have 1’s and 0’s signifying if the characteristic is present or not. Where would you suggest I start with altering your code in order to fit this dataset? Right now I am getting an error with the converting string to float function. </p>
<p>       white     blue    tall<br/>
ch1    0          1        1<br/>
ch2     1         0        0<br/>
ch3     1         0        1</p>
<div class="reply">
<a aria-label="Reply to lightbandit" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=416373#respond" onclick='return addComment.moveForm( "comment-416373", "416373", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416390">
<div class="comment-container" id="li-comment-416390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 12, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-416390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure I understand your problem, sorry.</p>
<p>Perhaps this process will help you define and work through your problem end to end:<br/>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=416390#respond" onclick='return addComment.moveForm( "comment-416390", "416390", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416780">
<div class="comment-container" id="li-comment-416780">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d55095b90ece809f99251a2893c2ae4f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d55095b90ece809f99251a2893c2ae4f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liu Yong</span>
<span class="date">October 15, 2017 at 7:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-416780" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is great!<br/>
May I know do you plan to introduce cost-complexity pruning for CART?</p>
<p>Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Liu Yong" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=416780#respond" onclick='return addComment.moveForm( "comment-416780", "416780", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416834">
<div class="comment-container" id="li-comment-416834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 16, 2017 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-416834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not at this stage. Perhaps you could post some links?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=416834#respond" onclick='return addComment.moveForm( "comment-416834", "416834", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417132">
<div class="comment-container" id="li-comment-417132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3e870e440cdd0f8386ceac2a82c51f46?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e870e440cdd0f8386ceac2a82c51f46?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Revi</span>
<span class="date">October 19, 2017 at 3:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello sir, i was trying to use your code on my data, but i find a problem which said ValueError: invalid literal for float(): 1;0.766126609;45;2;0.802982129;9120;13;0;6;0;2 . How could i fix this?</p>
<div class="reply">
<a aria-label="Reply to Revi" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417132#respond" onclick='return addComment.moveForm( "comment-417132", "417132", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417435">
<div class="comment-container" id="li-comment-417435">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fac8ecb668ec8d39e83abbc0c86a0c4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fac8ecb668ec8d39e83abbc0c86a0c4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Frackson</span>
<span class="date">October 21, 2017 at 10:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417435" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,</p>
<p>Thanks for the tutorial. It is quite clear and concise. However, how best can you advise on altering it to suit the following data set:<br/>
my_data=[[‘slashdot’,’USA’,’yes’,18,’None’],         [‘google’,’France’,’yes’,23,’Premium’],         [‘digg’,’USA’,’yes’,24,’Basic’],         [‘kiwitobes’,’France’,’yes’,23,’Basic’],         [‘google’,’UK’,’no’,21,’Premium’],         [‘(direct)’,’New Zealand’,’no’,12,’None’],         [‘(direct)’,’UK’,’no’,21,’Basic’],         [‘google’,’USA’,’no’,24,’Premium’],         [‘slashdot’,’France’,’yes’,19,’None’],         [‘digg’,’USA’,’no’,18,’None’],         [‘google’,’UK’,’no’,18,’None’],         [‘kiwitobes’,’UK’,’no’,19,’None’],         [‘digg’,’New Zealand’,’yes’,12,’Basic’],         [‘slashdot’,’UK’,’no’,21,’None’],         [‘google’,’UK’,’yes’,18,’Basic’],         [‘kiwitobes’,’France’,’yes’,19,’Basic’]</p>
<div class="reply">
<a aria-label="Reply to Frackson" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417435#respond" onclick='return addComment.moveForm( "comment-417435", "417435", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417476">
<div class="comment-container" id="li-comment-417476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This tutorial is advanced.</p>
<p>Perhaps you would be better suited starting with Weka:<br/>
<a href="https://machinelearningmastery.com/start-here/#weka" rel="nofollow">https://machinelearningmastery.com/start-here/#weka</a></p>
<p>Or scikit-learn library in Python:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417476#respond" onclick='return addComment.moveForm( "comment-417476", "417476", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-417527">
<div class="comment-container" id="li-comment-417527">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/15e190f2d703f3f81791cf8024e8269a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/15e190f2d703f3f81791cf8024e8269a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John Sobola</span>
<span class="date">October 22, 2017 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417527" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
Thanks so much for this code. I was able to adapt for my application but can you suggest how to plot the tree diagram in place of the build tree code?</p>
<p>Thanks<br/>
John</p>
<div class="reply">
<a aria-label="Reply to John Sobola" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417527#respond" onclick='return addComment.moveForm( "comment-417527", "417527", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-417568">
<div class="comment-container" id="li-comment-417568">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417568" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry John, I don’t have code to plot the tree.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417568#respond" onclick='return addComment.moveForm( "comment-417568", "417568", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417849">
<div class="comment-container" id="li-comment-417849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2f403e823f1c55742ecd4fed97799fa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2f403e823f1c55742ecd4fed97799fa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steven Lee</span>
<span class="date">October 25, 2017 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Thank you very much for this tutorial. It has been extremely helpful in my understanding of decision trees. I have one point of inquiry which requires clarification. In the ‘def split (node, max_depth, min_size, depth)’ method I can see that you recursively split the left nodes until the max depth or min size condition is met. When you perform the split you add 1 to the current depth to but once you move to the next if statement to process the first right child/partition there is no function that resets the depth.</p>
<p>Is this because in a recursive function you are saving new depth values for every iteration? Meaning unique depth values are saved at each recursion?</p>
<div class="reply">
<a aria-label="Reply to Steven Lee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417849#respond" onclick='return addComment.moveForm( "comment-417849", "417849", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417880">
<div class="comment-container" id="li-comment-417880">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 3:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417880" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Depth is passed down each line of the recursion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417880#respond" onclick='return addComment.moveForm( "comment-417880", "417880", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417858">
<div class="comment-container" id="li-comment-417858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2f403e823f1c55742ecd4fed97799fa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2f403e823f1c55742ecd4fed97799fa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steven Lee</span>
<span class="date">October 25, 2017 at 9:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Also how is the return of build tree read?</p>
<p>i.e.:</p>
<p>in:</p>
<p>tree = build_tree(dataset, 10, 1)<br/>
print tree</p>
<p>out:</p>
<p>{‘index’: 0, ‘right’: {‘index’: 0, ‘right’: {‘index’: 0, ‘right’: 1, ‘value’: 7.497545867, ‘left’: 1}, ‘value’: 7.497545867, ‘left’: {‘index’: 0, ‘right’: 1, ‘value’: 7.444542326, ‘left’: 1}}, ‘value’: 6.642287351, ‘left’: {‘index’: 0, ‘right’: {‘index’: 0, ‘right’: 0, ‘value’: 2.771244718, ‘left’: 0}, ‘value’: 2.771244718, ‘left’: 0}}</p>
<div class="reply">
<a aria-label="Reply to Steven Lee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417858#respond" onclick='return addComment.moveForm( "comment-417858", "417858", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417882">
<div class="comment-container" id="li-comment-417882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 4:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-417882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each node had has references to left and right nodes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=417882#respond" onclick='return addComment.moveForm( "comment-417882", "417882", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418498">
<div class="comment-container" id="li-comment-418498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/60f67498d30b6014e0042d7c92d04fe8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/60f67498d30b6014e0042d7c92d04fe8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Henrik</span>
<span class="date">October 31, 2017 at 12:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-418498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey,<br/>
I have a dataset with numerical and categorical values, so I modified some of the code in load_csv and main to convert categorical values to numerical: </p>
<p>#load_csv<br/>
def load_csv(filename):<br/>
    #file = open(filename, “r”)<br/>
    headers = [“location”,”w”,”final_margin”,”shot_number”,”period”,”game_clock”,”shot_clock”,”dribbles”,”touch_time”,<br/>
               “shot_dist”,”pts_type”,”close_def_dist”,”target”]<br/>
    df = pd.read_csv(filename, header=None, names=headers, na_values=”?”)</p>
<p>    cleanup_nums = {“location”:     {“H”: 1, “A”: 0},<br/>
                “w”: {“W”: 1, “L”: 0},<br/>
                “target”: {“made”: 1, “missed”: 0}}<br/>
    df.replace(cleanup_nums, inplace=True)<br/>
    df.head()</p>
<p>    obj_df=list(df.values.flatten())<br/>
    return obj_df</p>
<p>#main:<br/>
# Test CART on Basketball dataset<br/>
seed(1)<br/>
# load and prepare data<br/>
filename=’data/basketball.train.csv’<br/>
dataset = load_csv(filename)<br/>
i=0<br/>
new_list=[]<br/>
while i&lt;len(dataset):<br/>
    new_list.append(dataset[i:i+13])<br/>
    i+=13<br/>
n_folds = 5<br/>
max_depth = 5<br/>
min_size = 10<br/>
scores = evaluate_algorithm(new_list, decision_tree, n_folds, max_depth, min_size)<br/>
print('Scores: %s' % scores)<br/>
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</p>
<p>The program is still working for your dataset, but when i try to run it on my own, the program freezes in the listcomp in the line p = [row[-1] for row in group].count(class_val) / size, in the method gini_index.</p>
<p>Do you have any idea how i can break this infinite loop?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Henrik" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=418498#respond" onclick='return addComment.moveForm( "comment-418498", "418498", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418529">
<div class="comment-container" id="li-comment-418529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 31, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-418529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps get it working with sklearn first and better understand your data:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=418529#respond" onclick='return addComment.moveForm( "comment-418529", "418529", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421725">
<div class="comment-container" id="li-comment-421725">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/40d7d1069b8693e8e0d16b52635f248a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/40d7d1069b8693e8e0d16b52635f248a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">amitabh</span>
<span class="date">November 30, 2017 at 6:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-421725" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks it helps!</p>
<div class="reply">
<a aria-label="Reply to amitabh" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=421725#respond" onclick='return addComment.moveForm( "comment-421725", "421725", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421793">
<div class="comment-container" id="li-comment-421793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-421793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=421793#respond" onclick='return addComment.moveForm( "comment-421793", "421793", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422774">
<div class="comment-container" id="li-comment-422774">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a90a462beff1fd58ff201e0dae204c02?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a90a462beff1fd58ff201e0dae204c02?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">adan</span>
<span class="date">December 11, 2017 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-422774" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t get this part row [-1] for row in group. please explain what’s happening here</p>
<div class="reply">
<a aria-label="Reply to adan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=422774#respond" onclick='return addComment.moveForm( "comment-422774", "422774", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422820">
<div class="comment-container" id="li-comment-422820">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 5:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-422820" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about Python array indexing in this post:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=422820#respond" onclick='return addComment.moveForm( "comment-422820", "422820", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423138">
<div class="comment-container" id="li-comment-423138">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac38dd5284e71e83490aa383b9720da8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac38dd5284e71e83490aa383b9720da8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Khalida</span>
<span class="date">December 15, 2017 at 2:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-423138" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just thanks &lt;3</p>
<div class="reply">
<a aria-label="Reply to Khalida" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=423138#respond" onclick='return addComment.moveForm( "comment-423138", "423138", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423162">
<div class="comment-container" id="li-comment-423162">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-423162" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=423162#respond" onclick='return addComment.moveForm( "comment-423162", "423162", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425510">
<div class="comment-container" id="li-comment-425510">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c9579d63fba43681f77b50d3f0f9e1e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c9579d63fba43681f77b50d3f0f9e1e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John Wang</span>
<span class="date">January 3, 2018 at 3:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-425510" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really helpful, thanks a lot !</p>
<div class="reply">
<a aria-label="Reply to John Wang" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=425510#respond" onclick='return addComment.moveForm( "comment-425510", "425510", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425511">
<div class="comment-container" id="li-comment-425511">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 3:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/#comment-425511" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/?replytocom=425511#respond" onclick='return addComment.moveForm( "comment-425511", "425511", "respond", "3353" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-decision-tree-algorithm-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3353"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="9f9b7ca6cb"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="6"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center>
<h3>Code Algorithms From Scratch in Python</h3>
<p>Discover how to code top machine learning algorithms from first principles with Python.</p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Code Machine Learning Algorithms From Scratch Today!</a></p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>