<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Implement Random Forest From Scratch in Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/implement-random-forest-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Implement Random Forest From Scratch in Python - Machine Learning Mastery" property="og:title"/>
<meta content="Decision trees can suffer from high variance which makes their results fragile to the specific training data used. Building multiple models from samples of your training data, called bagging, can reduce this variance, but the trees are highly correlated. Random Forest is an extension of bagging that in addition to building trees based on multiple …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-random-forest-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-14T05:00:42+11:00" property="article:published_time"/>
<meta content="2017-08-12T09:15:58+11:00" property="article:modified_time"/>
<meta content="2017-08-12T09:15:58+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/implement-random-forest-scratch-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-random-forest-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Implement Random Forest From Scratch in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3360" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3360 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Need help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3360 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How to Implement Random Forest From Scratch in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-14T05:00:42+1100">November 14, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Algorithms From Scratch">Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/&amp;summary=Decision+trees+can+suffer+from+high+variance+which+makes+their+results+fragile+to+the+specific+train..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/&amp;summary=Decision+trees+can+suffer+from+high+variance+which+makes+their+results+fragile+to+the+specific+train...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Decision trees can suffer from high variance which makes their results fragile to the specific training data used.</p>
<p>Building multiple models from samples of your training data, called bagging, can reduce this variance, but the trees are highly correlated.</p>
<p>Random Forest is an extension of bagging that in addition to building trees based on multiple samples of your training data, it also constrains the features that can be used to build the trees, forcing trees to be different. This, in turn, can give a lift in performance.</p>
<p>In this tutorial, you will discover how to implement the Random Forest algorithm from scratch in Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>The difference between bagged decision trees and the random forest algorithm.</li>
<li>How to construct bagged decision trees with more variance.</li>
<li>How to apply the random forest algorithm to a predictive modeling problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Feb/2017</strong>: Fixed a bug in build_tree.</li>
<li><strong>Update Aug/2017</strong>: Fixed a bug in Gini calculation, added the missing weighting of group Gini scores by group size (thanks Michael!).</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3361" style="max-width: 650px"><img alt="How to Implement Random Forest From Scratch in Python" class="size-full wp-image-3361" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Implement Random Forest From Scratch in Python<br/>Photo by <a href="https://www.flickr.com/photos/inspirefatephotography/7569736320/">InspireFate Photography</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Random Forest algorithm and the Sonar dataset used in this tutorial.</p>
<h3>Random Forest Algorithm</h3>
<p>Decision trees involve the greedy selection of the best split point from the dataset at each step.</p>
<p>This algorithm makes decision trees susceptible to high variance if they are not pruned. This high variance can be harnessed and reduced by creating multiple trees with different samples of the training dataset (different views of the problem) and combining their predictions. This approach is called bootstrap aggregation or bagging for short.</p>
<p>A limitation of bagging is that the same greedy algorithm is used to create each tree, meaning that it is likely that the same or very similar split points will be chosen in each tree making the different trees very similar (trees will be correlated). This, in turn, makes their predictions similar, mitigating the variance originally sought.</p>
<p>We can force the decision trees to be different by limiting the features (rows) that the greedy algorithm can evaluate at each split point when creating the tree. This is called the Random Forest algorithm.</p>
<p>Like bagging, multiple samples of the training dataset are taken and a different tree trained on each. The difference is that at each point a split is made in the data and added to the tree, only a fixed subset of attributes can be considered.</p>
<p>For classification problems, the type of problems we will look at in this tutorial, the number of attributes to be considered for the split is limited to the square root of the number of input features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658faae8aab693658906" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
num_features_for_split = sqrt(total_input_features)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658faae8aab693658906-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658faae8aab693658906-1">num_features_for_split = sqrt(total_input_features)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The result of this one small change are trees that are more different from each other (uncorrelated) resulting predictions that are more diverse and a combined prediction that often has better performance that single tree or bagging alone.</p>
<h3>Sonar Dataset</h3>
<p>The dataset we will use in this tutorial is the Sonar dataset.</p>
<p>This is a dataset that describes sonar chirp returns bouncing off different surfaces. The 60 input variables are the strength of the returns at different angles. It is a binary classification problem that requires a model to differentiate rocks from metal cylinders. There are 208 observations.</p>
<p>It is a well-understood dataset. All of the variables are continuous and generally in the range of 0 to 1. The output variable is a string “M” for mine and “R” for rock, which will need to be converted to integers 1 and 0.</p>
<p>By predicting the class with the most observations in the dataset (M or mines) the Zero Rule Algorithm can achieve an accuracy of 53%.</p>
<p>You can learn more about this dataset at the <a href="https://archive.ics.uci.edu/ml/datasets/Connectionist+Bench+(Sonar,+Mines+vs.+Rocks)">UCI Machine Learning repository</a>.</p>
<p>Download the dataset for free and place it in your working directory with the filename <strong>sonar.all-data.csv</strong>.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 2 steps.</p>
<ol>
<li>Calculating Splits.</li>
<li>Sonar Dataset Case Study.</li>
</ol>
<p>These steps provide the foundation that you need to implement and apply the Random Forest algorithm to your own predictive modeling problems.</p>
<h3>1. Calculating Splits</h3>
<p>In a decision tree, split points are chosen by finding the attribute and the value of that attribute that results in the lowest cost.</p>
<p>For classification problems, this cost function is often the Gini index, that calculates the purity of the groups of data created by the split point. A Gini index of 0 is perfect purity where class values are perfectly separated into two groups, in the case of a two-class classification problem.</p>
<p>Finding the best split point in a decision tree involves evaluating the cost of each value in the training dataset for each input variable.</p>
<p>For bagging and random forest, this procedure is executed upon a sample of the training dataset, made with replacement. Sampling with replacement means that the same row may be chosen and added to the sample more than once.</p>
<p>We can update this procedure for Random Forest. Instead of enumerating all values for input attributes in search if the split with the lowest cost, we can create a sample of the input attributes to consider.</p>
<p>This sample of input attributes can be chosen randomly and without replacement, meaning that each input attribute needs only be considered once when looking for the split point with the lowest cost.</p>
<p>Below is a function name <strong>get_split()</strong> that implements this procedure. It takes a dataset and a fixed number of input features from to evaluate as input arguments, where the dataset may be a sample of the actual training dataset.</p>
<p>The helper function <strong>test_split()</strong> is used to split the dataset by a candidate split point and <strong>gini_index()</strong> is used to evaluate the cost of a given split by the groups of rows created.</p>
<p>We can see that a list of features is created by randomly selecting feature indices and adding them to a list (called <strong>features</strong>), this list of features is then enumerated and specific values in the training dataset evaluated as split points.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658faae8ab6339615414" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Select the best split point for a dataset
def get_split(dataset, n_features):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	features = list()
	while len(features) &lt; n_features:
		index = randrange(len(dataset[0])-1)
		if index not in features:
			features.append(index)
	for index in features:
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-2">2</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-4">4</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-6">6</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-8">8</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-10">10</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-12">12</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-14">14</div><div class="crayon-num" data-line="crayon-5a658faae8ab6339615414-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ab6339615414-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658faae8ab6339615414-1"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-2"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-3"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-4"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-5"><span class="crayon-e"> </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-6"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-7"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-8"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-9"><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-12"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-13"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8ab6339615414-15"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ab6339615414-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Now that we know how a decision tree algorithm can be modified for use with the Random Forest algorithm, we can piece this together with an implementation of bagging and apply it to a real-world dataset.</p>
<h3>2. Sonar Dataset Case Study</h3>
<p>In this section, we will apply the Random Forest algorithm to the Sonar dataset.</p>
<p>The example assumes that a CSV copy of the dataset is in the current working directory with the file name <strong>sonar.all-data.csv</strong>.</p>
<p>The dataset is first loaded, the string values converted to numeric and the output column is converted from strings to the integer values of 0 and 1. This is achieved with helper functions <strong>load_csv()</strong>, <strong>str_column_to_float()</strong> and <strong>str_column_to_int()</strong> to load and prepare the dataset.</p>
<p>We will use k-fold cross validation to estimate the performance of the learned model on unseen data. This means that we will construct and evaluate k models and estimate the performance as the mean model error. Classification accuracy will be used to evaluate each model. These behaviors are provided in the <strong>cross_validation_split()</strong>, <strong>accuracy_metric()</strong> and <strong>evaluate_algorithm()</strong> helper functions.</p>
<p>We will also use an implementation of the Classification and Regression Trees (CART) algorithm adapted for bagging including the helper functions <strong>test_split()</strong> to split a dataset into groups, <strong>gini_index()</strong> to evaluate a split point, our modified <strong>get_split()</strong> function discussed in the previous step, <strong>to_terminal()</strong>, <strong>split()</strong> and <strong>build_tree()</strong> used to create a single decision tree, <strong>predict()</strong> to make a prediction with a decision tree, <strong>subsample()</strong> to make a subsample of the training dataset and <strong>bagging_predict()</strong> to make a prediction with a list of decision trees.</p>
<p>A new function name <strong>random_forest()</strong> is developed that first creates a list of decision trees from subsamples of the training dataset and then uses them to make predictions.</p>
<p>As we stated above, the key difference between Random Forest and bagged decision trees is the one small change to the way that trees are created, here in the <strong>get_split()</strong> function.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658faae8abc778716042" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Forest Algorithm on Sonar Dataset
from random import seed
from random import randrange
from csv import reader
from math import sqrt

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset, n_features):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	features = list()
	while len(features) &lt; n_features:
		index = randrange(len(dataset[0])-1)
		if index not in features:
			features.append(index)
	for index in features:
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)

# Create child splits for a node or make terminal
def split(node, max_depth, min_size, n_features, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left, n_features)
		split(node['left'], max_depth, min_size, n_features, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right, n_features)
		split(node['right'], max_depth, min_size, n_features, depth+1)

# Build a decision tree
def build_tree(train, max_depth, min_size, n_features):
	root = get_split(train, n_features)
	split(root, max_depth, min_size, n_features, 1)
	return root

# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']

# Create a random subsample from the dataset with replacement
def subsample(dataset, ratio):
	sample = list()
	n_sample = round(len(dataset) * ratio)
	while len(sample) &lt; n_sample:
		index = randrange(len(dataset))
		sample.append(dataset[index])
	return sample

# Make a prediction with a list of bagged trees
def bagging_predict(trees, row):
	predictions = [predict(tree, row) for tree in trees]
	return max(set(predictions), key=predictions.count)

# Random Forest Algorithm
def random_forest(train, test, max_depth, min_size, sample_size, n_trees, n_features):
	trees = list()
	for i in range(n_trees):
		sample = subsample(train, sample_size)
		tree = build_tree(sample, max_depth, min_size, n_features)
		trees.append(tree)
	predictions = [bagging_predict(trees, row) for row in test]
	return(predictions)

# Test the random forest algorithm
seed(2)
# load and prepare data
filename = 'sonar.all-data.csv'
dataset = load_csv(filename)
# convert string attributes to integers
for i in range(0, len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# evaluate algorithm
n_folds = 5
max_depth = 10
min_size = 1
sample_size = 1.0
n_features = int(sqrt(len(dataset[0])-1))
for n_trees in [1, 5, 10]:
	scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)
	print('Trees: %d' % n_trees)
	print('Scores: %s' % scores)
	print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-2">2</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-4">4</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-6">6</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-8">8</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-10">10</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-12">12</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-14">14</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-16">16</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-18">18</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-20">20</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-22">22</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-24">24</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-26">26</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-28">28</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-30">30</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-32">32</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-34">34</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-36">36</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-38">38</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-40">40</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-42">42</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-44">44</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-46">46</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-48">48</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-50">50</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-52">52</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-54">54</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-56">56</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-58">58</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-60">60</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-62">62</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-64">64</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-66">66</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-68">68</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-70">70</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-72">72</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-74">74</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-76">76</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-78">78</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-80">80</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-82">82</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-84">84</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-86">86</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-88">88</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-90">90</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-92">92</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-94">94</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-96">96</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-98">98</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-100">100</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-102">102</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-104">104</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-106">106</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-108">108</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-110">110</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-112">112</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-114">114</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-116">116</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-118">118</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-120">120</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-122">122</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-124">124</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-126">126</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-128">128</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-130">130</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-132">132</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-134">134</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-136">136</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-138">138</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-140">140</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-142">142</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-144">144</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-146">146</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-148">148</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-150">150</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-152">152</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-154">154</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-156">156</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-158">158</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-160">160</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-162">162</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-164">164</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-166">166</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-168">168</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-170">170</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-172">172</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-174">174</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-176">176</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-178">178</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-180">180</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-182">182</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-184">184</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-186">186</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-188">188</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-190">190</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-192">192</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-194">194</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-196">196</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-198">198</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-200">200</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-202">202</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-204">204</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-206">206</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-208">208</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-210">210</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-212">212</div><div class="crayon-num" data-line="crayon-5a658faae8abc778716042-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8abc778716042-214">214</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658faae8abc778716042-1"><span class="crayon-p"># Random Forest Algorithm on Sonar Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-5"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-6"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-7"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-8"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-9"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-10"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-11"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-13"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-14"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-15"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-18"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-19"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-21"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-22"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-23"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-24"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-25"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-26"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-27"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-28"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-29"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-31"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-32"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-33"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-34"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-35"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-36"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-37"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-38"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-39"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-40"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-41"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-42"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-43"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-44"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-45"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-46"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-47"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-48"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-49"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-50"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-51"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-52"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-53"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-54"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-55"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-56"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-57"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-58"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-59"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-60"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-61"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-62"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-63"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-64"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-65"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-66"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-67"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-68"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-69"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-70"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-71"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-72"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-74"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-75"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-76"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-77"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-78"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-79"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-80"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-81"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-82"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-83"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-84"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-85"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-86"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-87"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-88"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-89"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-90"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-91"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-92"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-93"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-94"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-95"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-96"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-97"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-98"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-99"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-100"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-101"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-102"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-103"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-104"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-105"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-106"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-107"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-108"><span class="crayon-e"> </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-109"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-110"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-111"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-112"><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-113"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-114"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-115"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-116"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-117"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-118"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-119"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-120"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-121"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-122"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-123"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-124"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-125"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-126"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-127"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-128"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-129"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-130"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-131"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-132"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-133"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-134"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-135"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-136"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-137"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-138"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-139"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-140"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-141"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-142"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-143"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-144"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-145"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-146"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-147"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-148"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-149"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-150"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-151"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-152"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-153"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-154"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-155"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-156"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-157"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-158"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-159"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-160"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-161"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-162"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-163"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-164"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-165"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-166"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-167"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-168"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-169"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-170"><span class="crayon-p"># Create a random subsample from the dataset with replacement</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-171"><span class="crayon-e">def </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-172"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-173"><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-174"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-175"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-176"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-177"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-178"> </div><div class="crayon-line" id="crayon-5a658faae8abc778716042-179"><span class="crayon-p"># Make a prediction with a list of bagged trees</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-180"><span class="crayon-e">def </span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-181"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">tree </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-182"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-183"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-184"><span class="crayon-p"># Random Forest Algorithm</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-185"><span class="crayon-e">def </span><span class="crayon-e">random_forest</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-186"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-187"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-188"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-189"><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-190"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-191"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-192"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-193"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-194"><span class="crayon-p"># Test the random forest algorithm</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-195"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-196"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-197"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sonar.all-data.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-198"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-199"><span class="crayon-p"># convert string attributes to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-200"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-201"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-202"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-203"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-204"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-205"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-206"><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-207"><span class="crayon-v">min_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-208"><span class="crayon-v">sample_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-209"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-210"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">n_trees </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-211"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_forest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-212"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Trees: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a658faae8abc778716042-213"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8abc778716042-214"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0161 seconds] -->
<p>A k value of 5 was used for cross-validation, giving each fold 208/5 = 41.6 or just over 40 records to be evaluated upon each iteration.</p>
<p>Deep trees were constructed with a max depth of 10 and a minimum number of training rows at each node of 1. Samples of the training dataset were created with the same size as the original dataset, which is a default expectation for the Random Forest algorithm.</p>
<p>The number of features considered at each split point was set to sqrt(num_features) or sqrt(60)=7.74 rounded to 7 features.</p>
<p>A suite of 3 different numbers of trees were evaluated for comparison, showing the increasing skill as more trees are added.</p>
<p>Running the example prints the scores for each fold and mean score for each configuration.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658faae8ac4413269085" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Trees: 1
Scores: [56.09756097560976, 63.41463414634146, 60.97560975609756, 58.536585365853654, 73.17073170731707]
Mean Accuracy: 62.439%

Trees: 5
Scores: [70.73170731707317, 58.536585365853654, 85.36585365853658, 75.60975609756098, 63.41463414634146]
Mean Accuracy: 70.732%

Trees: 10
Scores: [82.92682926829268, 75.60975609756098, 97.5609756097561, 80.48780487804879, 68.29268292682927]
Mean Accuracy: 80.976%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ac4413269085-2">2</div><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ac4413269085-4">4</div><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ac4413269085-6">6</div><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ac4413269085-8">8</div><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a658faae8ac4413269085-10">10</div><div class="crayon-num" data-line="crayon-5a658faae8ac4413269085-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658faae8ac4413269085-1">Trees: 1</div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ac4413269085-2">Scores: [56.09756097560976, 63.41463414634146, 60.97560975609756, 58.536585365853654, 73.17073170731707]</div><div class="crayon-line" id="crayon-5a658faae8ac4413269085-3">Mean Accuracy: 62.439%</div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ac4413269085-4"> </div><div class="crayon-line" id="crayon-5a658faae8ac4413269085-5">Trees: 5</div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ac4413269085-6">Scores: [70.73170731707317, 58.536585365853654, 85.36585365853658, 75.60975609756098, 63.41463414634146]</div><div class="crayon-line" id="crayon-5a658faae8ac4413269085-7">Mean Accuracy: 70.732%</div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ac4413269085-8"> </div><div class="crayon-line" id="crayon-5a658faae8ac4413269085-9">Trees: 10</div><div class="crayon-line crayon-striped-line" id="crayon-5a658faae8ac4413269085-10">Scores: [82.92682926829268, 75.60975609756098, 97.5609756097561, 80.48780487804879, 68.29268292682927]</div><div class="crayon-line" id="crayon-5a658faae8ac4413269085-11">Mean Accuracy: 80.976%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to this tutorial that you may be interested in exploring.</p>
<ul>
<li><strong>Algorithm Tuning</strong>. The configuration used in the tutorial was found with a little trial and error but was not optimized. Experiment with larger numbers of trees, different numbers of features and even different tree configurations to improve performance.</li>
<li><strong>More Problems</strong>. Apply the technique to other classification problems and even adapt it for regression with a new cost function and a new method for combining the predictions from trees.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the Random Forest algorithm from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>The difference between Random Forest and Bagged Decision Trees.</li>
<li>How to update the creation of decision trees to accommodate the Random Forest procedure.</li>
<li>How to apply the Random Forest algorithm to a real world predictive modeling problem.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/&amp;summary=Decision+trees+can+suffer+from+high+variance+which+makes+their+results+fragile+to+the+specific+train..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Random%20Forest%20From%20Scratch%20in%20Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/&amp;summary=Decision+trees+can+suffer+from+high+variance+which+makes+their+results+fragile+to+the+specific+train...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How to Implement Bagging From Scratch With Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implementing-stacking-scratch-python/" rel="next">How to Implement Stacked Generalization From Scratch With Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">57 Responses to <em>How to Implement Random Forest From Scratch in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-373493">
<div class="comment-container" id="li-comment-373493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">December 3, 2016 at 7:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Firstly, thanks for your work on this site – I’m finding it to be a great resource to start my exploration in python machine learning!</p>
<p>Now, I’m working through your python machine learning mini course and I’m up to Lesson 09: spot checking algorithms. You suggest testing the random forest which has lead me to this blog post where I’m tyring to run the recipe but get thrown the following:</p>
<p>Traceback (most recent call last):<br/>
  File “test.py”, line 203, in<br/>
    scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
  File “test.py”, line 57, in evaluate_algorithm<br/>
    folds = cross_validation_split(dataset, n_folds)<br/>
  File “test.py”, line 42, in cross_validation_split<br/>
    index = randrange(len(dataset_copy))<br/>
  File “//anaconda/lib/python3.5/random.py”, line 186, in randrange<br/>
    raise ValueError(“empty range for randrange()”)<br/>
ValueError: empty range for randrange()</p>
<p>I’ve spent the better part of the last hour trying to work out what I may be doing wrong.. unfortunately I’m really new to coding so I’m finding it very difficult. I think i’ve narrowed to the following possibilities:<br/>
1. possibly a problem with the evaluate_algorithm function that has been defined..?<br/>
2. possibly an issue using randrange in python 3.5.2?<br/>
3. possibly a problem with the definition of “dataset”? </p>
<p>I think it’s either #1 because I can run the code without issue up until line 202 or #3 because dataset is the common thread in each of the returned lines from the error..?</p>
<p>Your guidance would be greatly appreciated!</p>
<p>thanks again!<br/>
marco</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=373493#respond" onclick='return addComment.moveForm( "comment-373493", "373493", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-401392">
<div class="comment-container" id="li-comment-401392">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/06f2e5e0de675fdc19a095f4a1f0e1f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/06f2e5e0de675fdc19a095f4a1f0e1f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dionysis</span>
<span class="date">June 4, 2017 at 4:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-401392" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Is it simple to adapt this implementation in order to accommodate tuples of feature vectors?</p>
<p>Thanks,<br/>
D.</p>
<div class="reply">
<a aria-label="Reply to Dionysis" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=401392#respond" onclick='return addComment.moveForm( "comment-401392", "401392", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-407618">
<div class="comment-container" id="li-comment-407618">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.bayesniffer.com" rel="external nofollow">Jeffrey Grover</a></span>
<span class="date">July 28, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407618" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I was able to get the code to run and got the results as posted on this page. My question what next? How do you use these results to make classification on new data?</p>
<p>Thanks Jeff</p>
<div class="reply">
<a aria-label="Reply to Jeffrey Grover" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=407618#respond" onclick='return addComment.moveForm( "comment-407618", "407618", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-407633">
<div class="comment-container" id="li-comment-407633">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 28, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407633" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can fit a final model on all training data and start making predictions.</p>
<p>See this post about developing a final model:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=407633#respond" onclick='return addComment.moveForm( "comment-407633", "407633", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-373744">
<div class="comment-container" id="li-comment-373744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">December 4, 2016 at 10:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Figured it out! It was a problem with using Python 3.5.2. I switched to 2.7 and it worked!</p>
<p>thanks<br/>
marco</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=373744#respond" onclick='return addComment.moveForm( "comment-373744", "373744", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-373805">
<div class="comment-container" id="li-comment-373805">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 5, 2016 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373805" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Marco.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=373805#respond" onclick='return addComment.moveForm( "comment-373805", "373805", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-374379">
<div class="comment-container" id="li-comment-374379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/83d4fc6176762f49407effa7e5164e8b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/83d4fc6176762f49407effa7e5164e8b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">srikanth</span>
<span class="date">December 8, 2016 at 9:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-374379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Traceback (most recent call last):<br/>
  File “rf2.py”, line 203, in<br/>
    scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
  File “rf2.py”, line 68, in evaluate_algorithm<br/>
    predicted = algorithm(train_set, test_set, *args)<br/>
  File “rf2.py”, line 181, in random_forest<br/>
    tree = build_tree(sample, max_depth, min_size, n_features)<br/>
  File “rf2.py”, line 146, in build_tree<br/>
    split(root, max_depth, min_size, n_features, 1)<br/>
  File “rf2.py”, line 120, in split<br/>
    left, right = node[‘groups’]<br/>
TypeError: ‘NoneType’ object is not iterable</p>
<div class="reply">
<a aria-label="Reply to srikanth" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=374379#respond" onclick='return addComment.moveForm( "comment-374379", "374379", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376572">
<div class="comment-container" id="li-comment-376572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/074409150dd878a13833f9d727d237cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/074409150dd878a13833f9d727d237cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">beedotkiran</span>
<span class="date">December 21, 2016 at 7:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-376572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Works in python 3.x also. The division in line 45 :<br/>
fold_size = len(dataset) / n_folds<br/>
renders a float which remains valid when length of dataset_copy goes to zero. randrange(0) gives this error.</p>
<p>Replacing this line with<br/>
fold_size = len(dataset) // n_folds<br/>
gives an integer and the loop executes properly</p>
<div class="reply">
<a aria-label="Reply to beedotkiran" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=376572#respond" onclick='return addComment.moveForm( "comment-376572", "376572", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-376594">
<div class="comment-container" id="li-comment-376594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 21, 2016 at 8:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-376594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks beedotkiran.</p>
<p>I’d recommend casting the result, in case python beginners are not familiar with the double slash operator:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a658faaeac7a883935845" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
fold_size = int(len(dataset) / n_folds)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a658faaeac7a883935845-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a658faaeac7a883935845-1"><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=376594#respond" onclick='return addComment.moveForm( "comment-376594", "376594", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-379659">
<div class="comment-container" id="li-comment-379659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 9:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-379659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have updated the cross_validation_split() function in the above example to address issues with Python 3.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=379659#respond" onclick='return addComment.moveForm( "comment-379659", "379659", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-384702">
<div class="comment-container" id="li-comment-384702">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2dc60e46884298b2d45d667f6f8aac9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2dc60e46884298b2d45d667f6f8aac9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jake Rage</span>
<span class="date">January 28, 2017 at 1:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-384702" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This was a fantastic tutorial thanks you for taking the time to do this! I was wondering if you had any suggestions for serialization or the tree for use against other similar data sets, would pickling working for this structure? Thanks for you help!</p>
<div class="reply">
<a aria-label="Reply to Jake Rage" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=384702#respond" onclick='return addComment.moveForm( "comment-384702", "384702", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385379">
<div class="comment-container" id="li-comment-385379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-385379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jake, using pickle on the learned object would be a good starting point.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=385379#respond" onclick='return addComment.moveForm( "comment-385379", "385379", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-389937">
<div class="comment-container" id="li-comment-389937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">February 25, 2017 at 12:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial! Just a question about the function build_tree: when you evaluate the root of the tree, shouldn’t you use the train sample and not the whole dataset? </p>
<p>I mean:</p>
<p>root = get_split(train, n_features) rather than<br/>
root = get_split(dataset, n_features)</p>
<p>Can I ask also what are the main differences of this algorithm if you want adapt it to a regression problem rather than classification?</p>
<p>Thank you very much! Best regards</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=389937#respond" onclick='return addComment.moveForm( "comment-389937", "389937", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-389938">
<div class="comment-container" id="li-comment-389938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">February 25, 2017 at 12:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I didn’t see that you had already settled the change</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=389938#respond" onclick='return addComment.moveForm( "comment-389938", "389938", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-389974">
<div class="comment-container" id="li-comment-389974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 25, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem, nice catch!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=389974#respond" onclick='return addComment.moveForm( "comment-389974", "389974", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396010">
<div class="comment-container" id="li-comment-396010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f694b8d13164042cb82fc171da8b279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f694b8d13164042cb82fc171da8b279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike</span>
<span class="date">April 11, 2017 at 1:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-396010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason  great approach. I’m wondering if you have any tips about transforming the above code in order to support multi-label classification.<br/>
Thank you very much !!!</p>
<div class="reply">
<a aria-label="Reply to Mike" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=396010#respond" onclick='return addComment.moveForm( "comment-396010", "396010", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396044">
<div class="comment-container" id="li-comment-396044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2017 at 9:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-396044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not off hand, sorry Mike. I would have to do some homework.</p>
<p>Consider a search on google scholar or consider some multi-label methods in sklearn:<br/>
<a href="http://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification-format" rel="nofollow">http://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification-format</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=396044#respond" onclick='return addComment.moveForm( "comment-396044", "396044", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398416">
<div class="comment-container" id="li-comment-398416">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve</span>
<span class="date">May 3, 2017 at 4:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-398416" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, I like the approach that allows a person to ‘look under the hood’ of these machine learning methods.  I look forward to learning more of the machine learning methods this way.  </p>
<p>Random forest is completely new to me.  I have a dataset that could use random forest regression.  I would like to know what changes are needed to make random forest classification code (above) into random forest regression.  This was asked earlier by Alessandro but I didn’t understand the reply.  Random forest regression is not explained well as far as I can tell.  </p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Steve" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=398416#respond" onclick='return addComment.moveForm( "comment-398416", "398416", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398488">
<div class="comment-container" id="li-comment-398488">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-398488" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Steve.</p>
<p>As a start, consider using random forest regression in the sklearn library:<br/>
<a href="http://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="nofollow">http://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=398488#respond" onclick='return addComment.moveForm( "comment-398488", "398488", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-401962">
<div class="comment-container" id="li-comment-401962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve Hansen</span>
<span class="date">June 9, 2017 at 10:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-401962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, </p>
<p>    Thanks for the advice with random forest regression.  </p>
<p>    On the sonar dataset, I plotted a 60 x 60 correlation matrix from the data.  Many of the successive rows, and even not so close rows, are highly correlated. For instance, row 17 and column 18 have the following correlation: </p>
<p>Number of Observations:              131<br/>
Number of Degrees of Freedom:   2</p>
<p>R-squared:           0.870<br/>
Rmse:                  0.1046<br/>
F statistic             863.</p>
<p>and columns 14 and 15 have the correlation </p>
<p>Number of Observations:         131<br/>
Number of Degrees of Freedom:   2</p>
<p>R-squared:          0.8554<br/>
Rmse:                 0.0708<br/>
F statistic            763. </p>
<p>What impact does this correlation have on the use of random forest?  What can be done to remove or measure the effect of the correlation?  </p>
<p>Also, for this dataset I was able to get the following results:  </p>
<p>n_folds = 5<br/>
max_depth = 12<br/>
min_size = 1<br/>
sample_size = 0.75<br/>
for n_trees in [1, 5, 19]: </p>
<p> 71.875%,  73.438%,  82.031%</p>
<p>Thanks for the great work.  I am trying to absorb it all.</p>
<div class="reply">
<a aria-label="Reply to Steve Hansen" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=401962#respond" onclick='return addComment.moveForm( "comment-401962", "401962", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402065">
<div class="comment-container" id="li-comment-402065">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402065" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice results.</p>
<p>I don’t think RF is too affected by highly corrected features. Nevertheless, try removing some and see how it impacts model skill. I’d love to hear what you discover.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402065#respond" onclick='return addComment.moveForm( "comment-402065", "402065", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402787">
<div class="comment-container" id="li-comment-402787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">danniel</span>
<span class="date">June 17, 2017 at 12:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,thanks for awesome tutorial,can you please explain following things&gt;<br/>
1.what is function of this line : row_copy[-1] = None : because it works perfectly without this line<br/>
2.When i tried n_trees=[3,5,10] it  returned following result in which accuracy decreases with more trees&gt;<br/>
Trees: 3<br/>
Scores: [63.41463414634146, 51.21951219512195, 68.29268292682927, 68.29268292682927, 63.41463414634146]<br/>
Mean Accuracy: 62.927%<br/>
Trees: 5<br/>
Scores: [65.85365853658537, 60.97560975609756, 60.97560975609756, 60.97560975609756, 58.536585365853654]<br/>
Mean Accuracy: 61.463%<br/>
Trees: 10<br/>
Scores: [48.78048780487805, 60.97560975609756, 58.536585365853654, 70.73170731707317, 53.65853658536586]<br/>
Mean Accuracy: 58.537%</p>
<div class="reply">
<a aria-label="Reply to danniel" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402787#respond" onclick='return addComment.moveForm( "comment-402787", "402787", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402841">
<div class="comment-container" id="li-comment-402841">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 17, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402841" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1. To clear the output value so the algorithm/developer cannot accidentally cheat.<br/>
2. Yes, it is important to tune an algorithm to a problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402841#respond" onclick='return addComment.moveForm( "comment-402841", "402841", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-402900">
<div class="comment-container" id="li-comment-402900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danniel</span>
<span class="date">June 17, 2017 at 9:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would you like to help me?I am a student and I am using this for a problem that I found online &gt;<a href="https://github.com/barotdhrumil21/road_sign_prediction_using_random_forest_classifier/tree/master" rel="nofollow">https://github.com/barotdhrumil21/road_sign_prediction_using_random_forest_classifier/tree/master</a></p>
<div class="reply">
<a aria-label="Reply to Danniel" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402900#respond" onclick='return addComment.moveForm( "comment-402900", "402900", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-402939">
<div class="comment-container" id="li-comment-402939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend contacting the author of that code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402939#respond" onclick='return addComment.moveForm( "comment-402939", "402939", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402912">
<div class="comment-container" id="li-comment-402912">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">danniel</span>
<span class="date">June 18, 2017 at 12:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402912" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how do you suggest I should use this :<a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/random_forest_mnist.py" rel="nofollow">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/random_forest_mnist.py</a><br/>
or can I use it and is it same what you’ve done?</p>
<div class="reply">
<a aria-label="Reply to danniel" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402912#respond" onclick='return addComment.moveForm( "comment-402912", "402912", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402943">
<div class="comment-container" id="li-comment-402943">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402943" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use whatever code you like.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=402943#respond" onclick='return addComment.moveForm( "comment-402943", "402943", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-403063">
<div class="comment-container" id="li-comment-403063">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d08dfcd489b53fc2a5efec5ec42ec924?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d08dfcd489b53fc2a5efec5ec42ec924?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chris</span>
<span class="date">June 19, 2017 at 7:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403063" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>nice job! what kind of cost function should i use when doing regression problems?</p>
<div class="reply">
<a aria-label="Reply to chris" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=403063#respond" onclick='return addComment.moveForm( "comment-403063", "403063", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403122">
<div class="comment-container" id="li-comment-403122">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403122" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, consider mean squared error or mean absolute error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=403122#respond" onclick='return addComment.moveForm( "comment-403122", "403122", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-403076">
<div class="comment-container" id="li-comment-403076">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ea972a81d67c37285925d19836e9ad8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ea972a81d67c37285925d19836e9ad8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">joe</span>
<span class="date">June 20, 2017 at 12:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403076" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>test_split has return two values but here groups = test_split(index, row[index], dataset) just one variable, can anyone explain that, please, thanks a lot</p>
<div class="reply">
<a aria-label="Reply to joe" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=403076#respond" onclick='return addComment.moveForm( "comment-403076", "403076", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403126">
<div class="comment-container" id="li-comment-403126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The returned array is assigned a variable named groups.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=403126#respond" onclick='return addComment.moveForm( "comment-403126", "403126", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404930">
<div class="comment-container" id="li-comment-404930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiky</span>
<span class="date">July 6, 2017 at 5:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-404930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I am trying to learn RF through your sample example. But while running the code I am getting an error. I am using Ipython Notebook. </p>
<p> in split(node, max_depth, min_size, n_features, depth)<br/>
      6 # Create child splits for a node or make terminal<br/>
      7 def split(node, max_depth, min_size, n_features, depth):<br/>
—-&gt; 8         left, right = node[‘groups’]<br/>
      9         del(node[‘groups’])<br/>
     10         # check for a no split</p>
<p>TypeError: ‘NoneType’ object is not iterable</p>
<p>Please help.</p>
<div class="reply">
<a aria-label="Reply to Chiky" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=404930#respond" onclick='return addComment.moveForm( "comment-404930", "404930", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-404932">
<div class="comment-container" id="li-comment-404932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiky</span>
<span class="date">July 6, 2017 at 5:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-404932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The chain error list:</p>
<p>TypeError                                 Traceback (most recent call last)<br/>
 in ()<br/>
     16 n_features = int(sqrt(len(dataset[0])-1))<br/>
     17 for n_trees in [1, 5, 10]:<br/>
—&gt; 18         scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
     19         print(‘Trees: %d’ % n_trees)<br/>
     20         print(‘Scores: %s’ % scores)</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br/>
     12                         test_set.append(row_copy)<br/>
     13                         row_copy[-1] = None<br/>
—&gt; 14                 predicted = algorithm(train_set, test_set, *args)<br/>
     15                 actual = [row[-1] for row in fold]<br/>
     16                 accuracy = accuracy_metric(actual, predicted)</p>
<p> in random_forest(train, test, max_depth, min_size, sample_size, n_trees, n_features)<br/>
     18         for i in range(n_trees):<br/>
     19                 sample = subsample(train, sample_size)<br/>
—&gt; 20                 tree = build_tree(sample, max_depth, min_size, n_features)<br/>
     21                 trees.append(tree)<br/>
     22         predictions = [bagging_predict(trees, row) for row in test]</p>
<p> in build_tree(train, max_depth, min_size, n_features)<br/>
      2 def build_tree(train, max_depth, min_size, n_features):<br/>
      3         root = get_split(train, n_features)<br/>
—-&gt; 4         split(root, max_depth, min_size, n_features, 1)<br/>
      5         return root<br/>
      6 </p>
<p> in split(node, max_depth, min_size, n_features, depth)<br/>
      6 # Create child splits for a node or make terminal<br/>
      7 def split(node, max_depth, min_size, n_features, depth):<br/>
—-&gt; 8         left, right = node[‘groups’]<br/>
      9         del(node[‘groups’])<br/>
     10         # check for a no split</p>
<p>TypeError: ‘NoneType’ object is not iterable</p>
<div class="reply">
<a aria-label="Reply to Chiky" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=404932#respond" onclick='return addComment.moveForm( "comment-404932", "404932", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405223">
<div class="comment-container" id="li-comment-405223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t use notebooks. Confirm Python version 2.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=405223#respond" onclick='return addComment.moveForm( "comment-405223", "405223", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405790">
<div class="comment-container" id="li-comment-405790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danny Shterman</span>
<span class="date">July 13, 2017 at 11:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Shouldn’t dataset be sorted by a feature before calculating gini?</p>
<div class="reply">
<a aria-label="Reply to Danny Shterman" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=405790#respond" onclick='return addComment.moveForm( "comment-405790", "405790", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405865">
<div class="comment-container" id="li-comment-405865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf0e13dcede2713259247b35592c01d7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf0e13dcede2713259247b35592c01d7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tatiana</span>
<span class="date">July 14, 2017 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason<br/>
Thank you very much for your lessons. You code worked perfectly.<br/>
Now I am trying to use different dataset, which has also string values. And having difficulty with it. Is it even possible? I keep getting errors that cannot convert string to integer.</p>
<div class="reply">
<a aria-label="Reply to Tatiana" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=405865#respond" onclick='return addComment.moveForm( "comment-405865", "405865", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405989">
<div class="comment-container" id="li-comment-405989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>You must convert the strings to integers or real values. Perhaps you need to use a one hot encoding?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=405989#respond" onclick='return addComment.moveForm( "comment-405989", "405989", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-406216">
<div class="comment-container" id="li-comment-406216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danny</span>
<span class="date">July 17, 2017 at 5:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-406216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
is there a need to perform a sum of the the weighted gini indexes for each split?<br/>
Thanks<br/>
Danny</p>
<div class="reply">
<a aria-label="Reply to Danny" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=406216#respond" onclick='return addComment.moveForm( "comment-406216", "406216", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407727">
<div class="comment-container" id="li-comment-407727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.bayesniffer.com" rel="external nofollow">Jeffrey Grover</a></span>
<span class="date">July 29, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I have posted this protocol on YouTube as a reference @ <a href="https://youtu.be/Appc0Hpnado" rel="nofollow">https://youtu.be/Appc0Hpnado</a></p>
<p>Thanks for taking the time to teach us this method!</p>
<p>Jeff</p>
<div class="reply">
<a aria-label="Reply to Jeffrey Grover" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=407727#respond" onclick='return addComment.moveForm( "comment-407727", "407727", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407760">
<div class="comment-container" id="li-comment-407760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice one Jeffrey!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=407760#respond" onclick='return addComment.moveForm( "comment-407760", "407760", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-411892">
<div class="comment-container" id="li-comment-411892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wells</span>
<span class="date">August 31, 2017 at 2:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-411892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, your implementation helps me a lot! However, I have a question here: on each split, the algorithm randomly selects a subset of features from the total features and then pick the best feature with the best gini score. Then, is it possible for a tree that a single feature is used repeatedly during different splits? since in get_split(), the line index = randrange(len(dataset[0])-1) basically pick features from the whole pool. Could you explain this? Thanks!</p>
<div class="reply">
<a aria-label="Reply to Wells" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=411892#respond" onclick='return addComment.moveForm( "comment-411892", "411892", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411987">
<div class="comment-container" id="li-comment-411987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-411987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It does not choose the best split, but a random split from among the best.</p>
<p>You can split a single feature many times, if it makes sense from a gini-score perspective.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=411987#respond" onclick='return addComment.moveForm( "comment-411987", "411987", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-412036">
<div class="comment-container" id="li-comment-412036">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wells</span>
<span class="date">September 1, 2017 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-412036" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yeah I realized this point. Thanks!</p>
<div class="reply">
<a aria-label="Reply to Wells" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=412036#respond" onclick='return addComment.moveForm( "comment-412036", "412036", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414516">
<div class="comment-container" id="li-comment-414516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dcfe94c4077997262ebbce8ec419b44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dcfe94c4077997262ebbce8ec419b44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ria</span>
<span class="date">September 22, 2017 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-414516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>rf_model = training(training_data2,RandomForestClassifier())<br/>
    print rf_model<br/>
    test(rf_model,test_data2)</p>
<p>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=’gini’,<br/>
            max_depth=None, max_features=’auto’, max_leaf_nodes=None,<br/>
            min_impurity_split=1e-07, min_samples_leaf=1,<br/>
            min_samples_split=2, min_weight_fraction_leaf=0.0,<br/>
            n_estimators=10, n_jobs=1, oob_score=False, random_state=None,<br/>
            verbose=0, warm_start=False)<br/>
I tried using number of trees =1,5,10 as per your example but not working could you pls say  me where shld i need to make changes and moreover when i set randomstate = none each time i execute my accuracy keeps on changing but when i set a value for the random state giving me same accuracy.</p>
<div class="reply">
<a aria-label="Reply to Ria" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=414516#respond" onclick='return addComment.moveForm( "comment-414516", "414516", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416713">
<div class="comment-container" id="li-comment-416713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DATAEXPERT</span>
<span class="date">October 15, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I would like to change the code so it will work for 90% of data for train and 10% for test, with no folds. If I use n_folds = 1, I get an error. How can I change the code so it will work?</p>
<div class="reply">
<a aria-label="Reply to DATAEXPERT" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=416713#respond" onclick='return addComment.moveForm( "comment-416713", "416713", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416729">
<div class="comment-container" id="li-comment-416729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 15, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you would be better served by using scikit-learn to fit your model:<br/>
<a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="nofollow">https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=416729#respond" onclick='return addComment.moveForm( "comment-416729", "416729", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-416743">
<div class="comment-container" id="li-comment-416743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DATAEXPERT</span>
<span class="date">October 15, 2017 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot. I would like to use your code since I made another internal change of the algorithm that can’t be done using scikit-learn. I think the major (may be the only) change is in the evaluate_algorithm function.</p>
<div class="reply">
<a aria-label="Reply to DATAEXPERT" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=416743#respond" onclick='return addComment.moveForm( "comment-416743", "416743", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418151">
<div class="comment-container" id="li-comment-418151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">October 28, 2017 at 2:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-418151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can we implement random forest using fitctree in matlab?</p>
<p>There is a function call TreeBagger that can implement random forest. However, if we use this function, we have no control on each individual tree. Can we use the MATLAB function fitctree, which build a decision tree, to implement random forest? Thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=418151#respond" onclick='return addComment.moveForm( "comment-418151", "418151", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418174">
<div class="comment-container" id="li-comment-418174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-418174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have material on matlab.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=418174#respond" onclick='return addComment.moveForm( "comment-418174", "418174", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-420834">
<div class="comment-container" id="li-comment-420834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bc5ff4cf949f6b7718a5125cebd2ba64?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bc5ff4cf949f6b7718a5125cebd2ba64?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kuber Jain</span>
<span class="date">November 22, 2017 at 12:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-420834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am trying to solve classification problem using RF, and each time I run RandomForestClassifier on my training data, feature importance shows different features everytime I run it. How can I make sure it gives me same top 5 features everytime I run the model ? Please let me know.</p>
<p>model_rc = RandomForestClassifier(n_estimators=10,max_depth=None,min_samples_split=2,random_state=0)<br/>
rc_fit=model_rc.fit(X_train, y_train.values.ravel())</p>
<div class="reply">
<a aria-label="Reply to Kuber Jain" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=420834#respond" onclick='return addComment.moveForm( "comment-420834", "420834", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420937">
<div class="comment-container" id="li-comment-420937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-420937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is a feature of the algorithm.</p>
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=420937#respond" onclick='return addComment.moveForm( "comment-420937", "420937", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425465">
<div class="comment-container" id="li-comment-425465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a46be7cbc707eee613708ac44faa7b1b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a46be7cbc707eee613708ac44faa7b1b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Khin</span>
<span class="date">January 3, 2018 at 2:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to know the difference between sklearn randomforest and random forest algorithm implemented by oneself.  Is there any weakness or something in sklearn randomforest?</p>
<div class="reply">
<a aria-label="Reply to Khin" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425465#respond" onclick='return addComment.moveForm( "comment-425465", "425465", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425485">
<div class="comment-container" id="li-comment-425485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend only implementing the algorithm yourself for learning, I would expect the sklearn implementation will be more robust and efficient.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425485#respond" onclick='return addComment.moveForm( "comment-425485", "425485", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425521">
<div class="comment-container" id="li-comment-425521">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a730211e0f3422072853d5dd3b6740e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a730211e0f3422072853d5dd3b6740e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PSN</span>
<span class="date">January 3, 2018 at 5:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425521" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you implement rotation forest algorithm ?</p>
<div class="reply">
<a aria-label="Reply to PSN" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425521#respond" onclick='return addComment.moveForm( "comment-425521", "425521", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425571">
<div class="comment-container" id="li-comment-425571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425571#respond" onclick='return addComment.moveForm( "comment-425571", "425571", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425595">
<div class="comment-container" id="li-comment-425595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/240b0d2a70f82d50adeb46629e3b6e53?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/240b0d2a70f82d50adeb46629e3b6e53?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sterling</span>
<span class="date">January 4, 2018 at 11:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your blogs and tutorials have aided me throughout my PhD. Thank you for putting so much time and effort into sharing this information.</p>
<div class="reply">
<a aria-label="Reply to Sterling" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425595#respond" onclick='return addComment.moveForm( "comment-425595", "425595", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425602">
<div class="comment-container" id="li-comment-425602">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 3:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425602" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m really glad to hear that!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-random-forest-scratch-python/?replytocom=425602#respond" onclick='return addComment.moveForm( "comment-425602", "425602", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-random-forest-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3360"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="d59adce6c5"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="12"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center>
<h3>Code Algorithms From Scratch in Python</h3>
<p>Discover how to code top machine learning algorithms from first principles with Python.</p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Code Machine Learning Algorithms From Scratch Today!</a></p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>