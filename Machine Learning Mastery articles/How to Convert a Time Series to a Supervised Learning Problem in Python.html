<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Convert a Time Series to a Supervised Learning Problem in Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Convert a Time Series to a Supervised Learning Problem in Python - Machine Learning Mastery" property="og:title"/>
<meta content="Machine learning methods like deep learning can be used for time series forecasting. Before machine learning can be used, time series forecasting problems must be re-framed as supervised learning problems. From a sequence to pairs of input and output sequences. In this tutorial, you will discover how to transform univariate and multivariate time series forecasting …" property="og:description"/>
<meta content="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Time Series" property="article:section"/>
<meta content="2017-05-08T05:00:31+11:00" property="article:published_time"/>
<meta content="2017-03-30T14:28:10+11:00" property="article:modified_time"/>
<meta content="2017-03-30T14:28:10+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="361" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/convert-time-series-supervised-learning-problem-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Convert a Time Series to a Supervised Learning Problem in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3984" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3984 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3984 post type-post status-publish format-standard has-post-thumbnail hentry category-time-series">
<header>
<h1 class="title entry-title">How to Convert a Time Series to a Supervised Learning Problem in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-05-08T05:00:31+1100">May 8, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/time-series/" title="View all items in Time Series">Time Series</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/&amp;summary=Machine+learning+methods+like+deep+learning+can+be+used+for+time+series+forecasting.%0D%0A%0D%0ABefore+machi..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/&amp;summary=Machine+learning+methods+like+deep+learning+can+be+used+for+time+series+forecasting.%0D%0A%0D%0ABefore+machi...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Machine learning methods like deep learning can be used for time series forecasting.</p>
<p>Before machine learning can be used, time series forecasting problems must be re-framed as supervised learning problems. From a sequence to pairs of input and output sequences.</p>
<p>In this tutorial, you will discover how to transform univariate and multivariate time series forecasting problems into supervised learning problems for use with machine learning algorithms.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a function to transform a time series dataset into a supervised learning dataset.</li>
<li>How to transform univariate time series data for machine learning.</li>
<li>How to transform multivariate time series data for machine learning.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_3985" style="max-width: 650px"><img alt="How to Convert a Time Series to a Supervised Learning Problem in Python" class="size-full wp-image-3985" height="361" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python-300x169.jpg 300w" width="640"/><p class="wp-caption-text">How to Convert a Time Series to a Supervised Learning Problem in Python<br/>Photo by <a href="https://www.flickr.com/photos/quimgil/8490510169/">Quim Gil</a>, some rights reserved.</p></div>
<h2>Time Series vs Supervised Learning</h2>
<p>Before we get started, let’s take a moment to better understand the form of time series and supervised learning data.</p>
<p>A time series is a sequence of numbers that are ordered by a time index. This can be thought of as a list or column of ordered values.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c7d494835136" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0
1
2
3
4
5
6
7
8
9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c7d494835136-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c7d494835136-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c7d494835136-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c7d494835136-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c7d494835136-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c7d494835136-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c7d494835136-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c7d494835136-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c7d494835136-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c7d494835136-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c7d494835136-1">0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c7d494835136-2">1</div><div class="crayon-line" id="crayon-5a65922290c7d494835136-3">2</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c7d494835136-4">3</div><div class="crayon-line" id="crayon-5a65922290c7d494835136-5">4</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c7d494835136-6">5</div><div class="crayon-line" id="crayon-5a65922290c7d494835136-7">6</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c7d494835136-8">7</div><div class="crayon-line" id="crayon-5a65922290c7d494835136-9">8</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c7d494835136-10">9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A supervised learning problem is comprised of input patterns (<em>X</em>) and output patterns (<em>y</em>), such that an algorithm can learn how to predict the output patterns from the input patterns.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c8a417073380" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X,	y
1	2
2,	3
3,	4
4,	5
5,	6
6,	7
7,	8
8,	9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c8a417073380-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8a417073380-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c8a417073380-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8a417073380-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c8a417073380-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8a417073380-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c8a417073380-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8a417073380-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c8a417073380-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c8a417073380-1">X,	y</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8a417073380-2">1	2</div><div class="crayon-line" id="crayon-5a65922290c8a417073380-3">2,	3</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8a417073380-4">3,	4</div><div class="crayon-line" id="crayon-5a65922290c8a417073380-5">4,	5</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8a417073380-6">5,	6</div><div class="crayon-line" id="crayon-5a65922290c8a417073380-7">6,	7</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8a417073380-8">7,	8</div><div class="crayon-line" id="crayon-5a65922290c8a417073380-9">8,	9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>For more on this topic, see the post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/">Time Series Forecasting as Supervised Learning</a></li>
</ul>
<h2>Pandas shift() Function</h2>
<p>A key function to help transform time series data into a supervised learning problem is the Pandas <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.shift.html">shift()</a> function.</p>
<p>Given a DataFrame, the <em>shift()</em> function can be used to create copies of columns that are pushed forward (rows of NaN values added to the front) or pulled back (rows of NaN values added to the end).</p>
<p>This is the behavior required to create columns of lag observations as well as columns of forecast observations for a time series dataset in a supervised learning format.</p>
<p>Let’s look at some examples of the shift function in action.</p>
<p>We can define a mock time series dataset as a sequence of 10 numbers, in this case a single column in a DataFrame as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c8d346062239" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c8d346062239-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8d346062239-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c8d346062239-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c8d346062239-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c8d346062239-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8d346062239-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c8d346062239-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c8d346062239-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example prints the time series data with the row indices for each observation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c90106889462" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t
0  0
1  1
2  2
3  3
4  4
5  5
6  6
7  7
8  8
9  9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c90106889462-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c90106889462-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c90106889462-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c90106889462-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c90106889462-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c90106889462-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c90106889462-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c90106889462-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c90106889462-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c90106889462-10">10</div><div class="crayon-num" data-line="crayon-5a65922290c90106889462-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c90106889462-1">   t</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c90106889462-2">0  0</div><div class="crayon-line" id="crayon-5a65922290c90106889462-3">1  1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c90106889462-4">2  2</div><div class="crayon-line" id="crayon-5a65922290c90106889462-5">3  3</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c90106889462-6">4  4</div><div class="crayon-line" id="crayon-5a65922290c90106889462-7">5  5</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c90106889462-8">6  6</div><div class="crayon-line" id="crayon-5a65922290c90106889462-9">7  7</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c90106889462-10">8  8</div><div class="crayon-line" id="crayon-5a65922290c90106889462-11">9  9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can shift all the observations down by one time step by inserting one new row at the top. Because the new row has no data, we can use NaN to represent “no data”.</p>
<p>The shift function can do this for us and we can insert this shifted column next to our original series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c93216580572" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
df['t-1'] = df['t'].shift(1)
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c93216580572-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c93216580572-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c93216580572-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c93216580572-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c93216580572-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c93216580572-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c93216580572-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c93216580572-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c93216580572-4"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t-1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c93216580572-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running the example gives us two columns in the dataset. The first with the original observations and a new shifted column.</p>
<p>We can see that shifting the series forward one time step gives us a primitive supervised learning problem, although with <em>X</em> and <em>y</em> in the wrong order. Ignore the column of row labels. The first row would have to be discarded because of the NaN value. The second row shows the input value of 0.0 in the second column (input or <em>X</em>) and the value of 1 in the first column (output or <em>y</em>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c95606555179" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t  t-1
0  0  NaN
1  1  0.0
2  2  1.0
3  3  2.0
4  4  3.0
5  5  4.0
6  6  5.0
7  7  6.0
8  8  7.0
9  9  8.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c95606555179-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c95606555179-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c95606555179-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c95606555179-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c95606555179-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c95606555179-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c95606555179-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c95606555179-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c95606555179-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c95606555179-10">10</div><div class="crayon-num" data-line="crayon-5a65922290c95606555179-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c95606555179-1">   t  t-1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c95606555179-2">0  0  NaN</div><div class="crayon-line" id="crayon-5a65922290c95606555179-3">1  1  0.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c95606555179-4">2  2  1.0</div><div class="crayon-line" id="crayon-5a65922290c95606555179-5">3  3  2.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c95606555179-6">4  4  3.0</div><div class="crayon-line" id="crayon-5a65922290c95606555179-7">5  5  4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c95606555179-8">6  6  5.0</div><div class="crayon-line" id="crayon-5a65922290c95606555179-9">7  7  6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c95606555179-10">8  8  7.0</div><div class="crayon-line" id="crayon-5a65922290c95606555179-11">9  9  8.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that if we can repeat this process with shifts of 2, 3, and more, how we could create long input sequences (<em>X</em>) that can be used to forecast an output value (<em>y</em>).</p>
<p>The shift operator can also accept a negative integer value. This has the effect of pulling the observations up by inserting new rows at the end. Below is an example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c98841221665" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
df['t+1'] = df['t'].shift(-1)
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c98841221665-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c98841221665-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c98841221665-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c98841221665-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c98841221665-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c98841221665-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c98841221665-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c98841221665-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c98841221665-4"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t+1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c98841221665-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running the example shows a new column with a NaN value as the last value.</p>
<p>We can see that the forecast column can be taken as an input (<em>X</em>) and the second as an output value (<em>y</em>). That is the input value of 0 can be used to forecast the output value of 1.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c9b408464400" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t  t+1
0  0  1.0
1  1  2.0
2  2  3.0
3  3  4.0
4  4  5.0
5  5  6.0
6  6  7.0
7  7  8.0
8  8  9.0
9  9  NaN</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9b408464400-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9b408464400-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9b408464400-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9b408464400-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9b408464400-10">10</div><div class="crayon-num" data-line="crayon-5a65922290c9b408464400-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c9b408464400-1">   t  t+1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9b408464400-2">0  0  1.0</div><div class="crayon-line" id="crayon-5a65922290c9b408464400-3">1  1  2.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9b408464400-4">2  2  3.0</div><div class="crayon-line" id="crayon-5a65922290c9b408464400-5">3  3  4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9b408464400-6">4  4  5.0</div><div class="crayon-line" id="crayon-5a65922290c9b408464400-7">5  5  6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9b408464400-8">6  6  7.0</div><div class="crayon-line" id="crayon-5a65922290c9b408464400-9">7  7  8.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9b408464400-10">8  8  9.0</div><div class="crayon-line" id="crayon-5a65922290c9b408464400-11">9  9  NaN</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Technically, in time series forecasting terminology the current time (<em>t</em>) and future times (<em>t+1</em>, <em>t+n</em>) are forecast times and past observations (<em>t-1</em>, <em>t-n</em>) are used to make forecasts.</p>
<p>We can see how positive and negative shifts can be used to create a new DataFrame from a time series with sequences of input and output patterns for a supervised learning problem.</p>
<p>This permits not only classical <em>X -&gt; y</em> prediction, but also <em>X -&gt; Y</em> where both input and output can be sequences.</p>
<p>Further, the shift function also works on so-called multivariate time series problems. That is where instead of having one set of observations for a time series, we have multiple (e.g. temperature and pressure). All variates in the time series can be shifted forward or backward to create multivariate input and output sequences. We will explore this more later in the tutorial.</p>
<h2>The series_to_supervised() Function</h2>
<p>We can use the <em>shift()</em> function in Pandas to automatically create new framings of time series problems given the desired length of input and output sequences.</p>
<p>This would be a useful tool as it would allow us to explore different framings of a time series problem with machine learning algorithms to see which might result in better performing models.</p>
<p>In this section, we will define a new Python function named <em>series_to_supervised()</em> that takes a univariate or multivariate time series and frames it as a supervised learning dataset.</p>
<p>The function takes four arguments:</p>
<ul>
<li><strong>data</strong>: Sequence of observations as a list or 2D NumPy array. Required.</li>
<li><strong>n_in</strong>: Number of lag observations as input (<em>X</em>). Values may be between [1..len(data)] Optional. Defaults to 1.</li>
<li><strong>n_out</strong>: Number of observations as output (<em>y</em>). Values may be between [0..len(data)-1]. Optional. Defaults to 1.</li>
<li><strong>dropnan</strong>: Boolean whether or not to drop rows with NaN values. Optional. Defaults to True.</li>
</ul>
<p>The function returns a single value:</p>
<ul>
<li><strong>return</strong>: Pandas DataFrame of series framed for supervised learning.</li>
</ul>
<p>The new dataset is constructed as a DataFrame, with each column suitably named both by variable number and time step. This allows you to design a variety of different time step sequence type forecasting problems from a given univariate or multivariate time series.</p>
<p>Once the DataFrame is returned, you can decide how to split the rows of the returned DataFrame into <em>X</em> and <em>y</em> components for supervised learning any way you wish.</p>
<p>The function is defined with default parameters so that if you call it with just your data, it will construct a DataFrame with <em>t-1</em> as <em>X</em> and <em>t</em> as <em>y</em>.</p>
<p>The function is confirmed to be compatible with Python 2 and Python 3.</p>
<p>The complete function is listed below, including function comments.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290c9f178679224" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-2">2</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-4">4</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-6">6</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-8">8</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-10">10</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-12">12</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-14">14</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-16">16</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-18">18</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-20">20</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-22">22</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-24">24</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-26">26</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-28">28</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-30">30</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-32">32</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290c9f178679224-34">34</div><div class="crayon-num" data-line="crayon-5a65922290c9f178679224-35">35</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290c9f178679224-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290c9f178679224-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290c9f178679224-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">agg</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>Can you see obvious ways to make the function more robust or more readable?<br/>
Please let me know in the comments below.</p>
<p>Now that we have the whole function, we can explore how it may be used.</p>
<h2>One-Step Univariate Forecasting</h2>
<p>It is standard practice in time series forecasting to use lagged observations (e.g. t-1) as input variables to forecast the current time step (t).</p>
<p>This is called one-step forecasting.</p>
<p>The example below demonstrates a one lag time step (t-1) to predict the current time step (t).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290ca2871777638" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-2">2</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-4">4</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-6">6</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-8">8</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-10">10</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-12">12</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-14">14</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-16">16</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-18">18</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-20">20</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-22">22</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-24">24</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-26">26</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-28">28</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-30">30</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-32">32</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-34">34</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-36">36</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-38">38</div><div class="crayon-num" data-line="crayon-5a65922290ca2871777638-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca2871777638-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290ca2871777638-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-36"> </div><div class="crayon-line" id="crayon-5a65922290ca2871777638-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290ca2871777638-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca2871777638-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>Running the example prints the output of the reframed time series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290ca6279770204" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var1(t)
1        0.0        1
2        1.0        2
3        2.0        3
4        3.0        4
5        4.0        5
6        5.0        6
7        6.0        7
8        7.0        8
9        8.0        9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290ca6279770204-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca6279770204-2">2</div><div class="crayon-num" data-line="crayon-5a65922290ca6279770204-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca6279770204-4">4</div><div class="crayon-num" data-line="crayon-5a65922290ca6279770204-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca6279770204-6">6</div><div class="crayon-num" data-line="crayon-5a65922290ca6279770204-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca6279770204-8">8</div><div class="crayon-num" data-line="crayon-5a65922290ca6279770204-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290ca6279770204-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290ca6279770204-1">   var1(t-1)  var1(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca6279770204-2">1        0.0        1</div><div class="crayon-line" id="crayon-5a65922290ca6279770204-3">2        1.0        2</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca6279770204-4">3        2.0        3</div><div class="crayon-line" id="crayon-5a65922290ca6279770204-5">4        3.0        4</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca6279770204-6">5        4.0        5</div><div class="crayon-line" id="crayon-5a65922290ca6279770204-7">6        5.0        6</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca6279770204-8">7        6.0        7</div><div class="crayon-line" id="crayon-5a65922290ca6279770204-9">8        7.0        8</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290ca6279770204-10">9        8.0        9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the observations are named “<em>var1</em>” and that the input observation is suitably named (t-1) and the output time step is named (t).</p>
<p>We can also see that rows with NaN values have been automatically removed from the DataFrame.</p>
<p>We can repeat this example with an arbitrary number length input sequence, such as 3. This can be done by specifying the length of the input sequence as an argument; for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290ca8107132144" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = series_to_supervised(values, 3)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290ca8107132144-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290ca8107132144-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cab997762354" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values, 3)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cab997762354-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-10">10</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-12">12</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-14">14</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-16">16</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-18">18</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-20">20</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-22">22</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-24">24</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-26">26</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-28">28</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-30">30</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-32">32</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-34">34</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-36">36</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-38">38</div><div class="crayon-num" data-line="crayon-5a65922290cab997762354-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cab997762354-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cab997762354-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-36"> </div><div class="crayon-line" id="crayon-5a65922290cab997762354-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cab997762354-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cab997762354-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>Again, running the example prints the reframed series. We can see that the input sequence is in the correct left-to-right order with the output variable to be predicted on the far right.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cae408517562" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-3)  var1(t-2)  var1(t-1)  var1(t)
3        0.0        1.0        2.0        3
4        1.0        2.0        3.0        4
5        2.0        3.0        4.0        5
6        3.0        4.0        5.0        6
7        4.0        5.0        6.0        7
8        5.0        6.0        7.0        8
9        6.0        7.0        8.0        9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cae408517562-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cae408517562-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cae408517562-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cae408517562-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cae408517562-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cae408517562-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cae408517562-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cae408517562-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cae408517562-1">   var1(t-3)  var1(t-2)  var1(t-1)  var1(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cae408517562-2">3        0.0        1.0        2.0        3</div><div class="crayon-line" id="crayon-5a65922290cae408517562-3">4        1.0        2.0        3.0        4</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cae408517562-4">5        2.0        3.0        4.0        5</div><div class="crayon-line" id="crayon-5a65922290cae408517562-5">6        3.0        4.0        5.0        6</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cae408517562-6">7        4.0        5.0        6.0        7</div><div class="crayon-line" id="crayon-5a65922290cae408517562-7">8        5.0        6.0        7.0        8</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cae408517562-8">9        6.0        7.0        8.0        9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multi-Step or Sequence Forecasting</h2>
<p>A different type of forecasting problem is using past observations to forecast a sequence of future observations.</p>
<p>This may be called sequence forecasting or multi-step forecasting.</p>
<p>We can frame a time series for sequence forecasting by specifying another argument. For example, we could frame a forecast problem with an input sequence of 2 past observations to forecast 2 future observations as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cb1445675208" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = series_to_supervised(values, 2, 2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cb1445675208-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cb1445675208-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete example is listed below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cb3587925149" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values, 2, 2)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-10">10</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-12">12</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-14">14</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-16">16</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-18">18</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-20">20</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-22">22</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-24">24</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-26">26</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-28">28</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-30">30</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-32">32</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-34">34</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-36">36</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-38">38</div><div class="crayon-num" data-line="crayon-5a65922290cb3587925149-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb3587925149-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cb3587925149-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-36"> </div><div class="crayon-line" id="crayon-5a65922290cb3587925149-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb3587925149-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb3587925149-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>Running the example shows the differentiation of input (t-n) and output (t+n) variables with the current observation (t) considered an output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cb6867516099" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)
2        0.0        1.0        2        3.0
3        1.0        2.0        3        4.0
4        2.0        3.0        4        5.0
5        3.0        4.0        5        6.0
6        4.0        5.0        6        7.0
7        5.0        6.0        7        8.0
8        6.0        7.0        8        9.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cb6867516099-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb6867516099-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cb6867516099-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb6867516099-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cb6867516099-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb6867516099-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cb6867516099-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb6867516099-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cb6867516099-1">   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb6867516099-2">2        0.0        1.0        2        3.0</div><div class="crayon-line" id="crayon-5a65922290cb6867516099-3">3        1.0        2.0        3        4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb6867516099-4">4        2.0        3.0        4        5.0</div><div class="crayon-line" id="crayon-5a65922290cb6867516099-5">5        3.0        4.0        5        6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb6867516099-6">6        4.0        5.0        6        7.0</div><div class="crayon-line" id="crayon-5a65922290cb6867516099-7">7        5.0        6.0        7        8.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb6867516099-8">8        6.0        7.0        8        9.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multivariate Forecasting</h2>
<p>Another important type of time series is called multivariate time series.</p>
<p>This is where we may have observations of multiple different measures and an interest in forecasting one or more of them.</p>
<p>For example, we may have two sets of time series observations obs1 and obs2 and we wish to forecast one or both of these.</p>
<p>We can call <em>series_to_supervised()</em> in exactly the same way.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cb9061087966" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


raw = DataFrame()
raw['ob1'] = [x for x in range(10)]
raw['ob2'] = [x for x in range(50, 60)]
values = raw.values
data = series_to_supervised(values)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-10">10</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-12">12</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-14">14</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-16">16</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-18">18</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-20">20</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-22">22</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-24">24</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-26">26</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-28">28</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-30">30</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-32">32</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-34">34</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-36">36</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-38">38</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-40">40</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cb9061087966-42">42</div><div class="crayon-num" data-line="crayon-5a65922290cb9061087966-43">43</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cb9061087966-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-36"> </div><div class="crayon-line" id="crayon-5a65922290cb9061087966-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-38"><span class="crayon-v">raw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-39"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-40"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-41"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cb9061087966-42"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cb9061087966-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>Running the example prints the new framing of the data, showing an input pattern with one time step for both variables and an output pattern of one time step for both variables.</p>
<p>Again, depending on the specifics of the problem, the division of columns into <em>X</em> and <em>Y</em> components can be chosen arbitrarily, such as if the current observation of <em>var1</em> was also provided as input and only <em>var2</em> was to be predicted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cbd800994957" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var2(t-1)  var1(t)  var2(t)
1        0.0       50.0        1       51
2        1.0       51.0        2       52
3        2.0       52.0        3       53
4        3.0       53.0        4       54
5        4.0       54.0        5       55
6        5.0       55.0        6       56
7        6.0       56.0        7       57
8        7.0       57.0        8       58
9        8.0       58.0        9       59</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cbd800994957-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbd800994957-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cbd800994957-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbd800994957-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cbd800994957-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbd800994957-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cbd800994957-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbd800994957-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cbd800994957-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbd800994957-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cbd800994957-1">   var1(t-1)  var2(t-1)  var1(t)  var2(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbd800994957-2">1        0.0       50.0        1       51</div><div class="crayon-line" id="crayon-5a65922290cbd800994957-3">2        1.0       51.0        2       52</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbd800994957-4">3        2.0       52.0        3       53</div><div class="crayon-line" id="crayon-5a65922290cbd800994957-5">4        3.0       53.0        4       54</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbd800994957-6">5        4.0       54.0        5       55</div><div class="crayon-line" id="crayon-5a65922290cbd800994957-7">6        5.0       55.0        6       56</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbd800994957-8">7        6.0       56.0        7       57</div><div class="crayon-line" id="crayon-5a65922290cbd800994957-9">8        7.0       57.0        8       58</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbd800994957-10">9        8.0       58.0        9       59</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You can see how this may be easily used for sequence forecasting with multivariate time series by specifying the length of the input and output sequences as above.</p>
<p>For example, below is an example of a reframing with 1 time step as input and 2 time steps as forecast sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cbf044345910" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


raw = DataFrame()
raw['ob1'] = [x for x in range(10)]
raw['ob2'] = [x for x in range(50, 60)]
values = raw.values
data = series_to_supervised(values, 1, 2)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-10">10</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-12">12</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-14">14</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-16">16</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-18">18</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-20">20</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-22">22</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-24">24</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-26">26</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-28">28</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-30">30</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-32">32</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-34">34</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-36">36</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-38">38</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-40">40</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cbf044345910-42">42</div><div class="crayon-num" data-line="crayon-5a65922290cbf044345910-43">43</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cbf044345910-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-36"> </div><div class="crayon-line" id="crayon-5a65922290cbf044345910-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-38"><span class="crayon-v">raw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-39"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-40"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-41"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cbf044345910-42"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65922290cbf044345910-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>Running the example shows the large reframed DataFrame.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922290cc3387056350" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)
1        0.0       50.0        1       51        2.0       52.0
2        1.0       51.0        2       52        3.0       53.0
3        2.0       52.0        3       53        4.0       54.0
4        3.0       53.0        4       54        5.0       55.0
5        4.0       54.0        5       55        6.0       56.0
6        5.0       55.0        6       56        7.0       57.0
7        6.0       56.0        7       57        8.0       58.0
8        7.0       57.0        8       58        9.0       59.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922290cc3387056350-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cc3387056350-2">2</div><div class="crayon-num" data-line="crayon-5a65922290cc3387056350-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cc3387056350-4">4</div><div class="crayon-num" data-line="crayon-5a65922290cc3387056350-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cc3387056350-6">6</div><div class="crayon-num" data-line="crayon-5a65922290cc3387056350-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65922290cc3387056350-8">8</div><div class="crayon-num" data-line="crayon-5a65922290cc3387056350-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922290cc3387056350-1">   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cc3387056350-2">1        0.0       50.0        1       51        2.0       52.0</div><div class="crayon-line" id="crayon-5a65922290cc3387056350-3">2        1.0       51.0        2       52        3.0       53.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cc3387056350-4">3        2.0       52.0        3       53        4.0       54.0</div><div class="crayon-line" id="crayon-5a65922290cc3387056350-5">4        3.0       53.0        4       54        5.0       55.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cc3387056350-6">5        4.0       54.0        5       55        6.0       56.0</div><div class="crayon-line" id="crayon-5a65922290cc3387056350-7">6        5.0       55.0        6       56        7.0       57.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a65922290cc3387056350-8">7        6.0       56.0        7       57        8.0       58.0</div><div class="crayon-line" id="crayon-5a65922290cc3387056350-9">8        7.0       57.0        8       58        9.0       59.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Experiment with your own dataset and try multiple different framings to see what works best.</p>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to reframe time series datasets as supervised learning problems with Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About the Pandas <em>shift()</em> function and how it can be used to automatically define supervised learning datasets from time series data.</li>
<li>How to reframe a univariate time series into one-step and multi-step supervised learning problems.</li>
<li>How to reframe multivariate time series into one-step and multi-step supervised learning problems.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-26"> <div class="textwidget"><p></p><center>
<div class="woo-sc-hr"></div>
<h2>Want to Develop Time Series Forecasts with Python?</h2>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img align="left" alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasts in Minutes</h4>
<p>...with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/introduction-to-time-series-forecasting-with-python/">Introduction to Time Series Forecasting With Python</a></p>
<p>It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Loading data, visualization, modeling, algorithm tuning,</em> and much more...</p>
<h4>Finally Bring Time Series Forecasting to<br/>
Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
<p></p></center>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/&amp;summary=Machine+learning+methods+like+deep+learning+can+be+used+for+time+series+forecasting.%0D%0A%0D%0ABefore+machi..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Convert%20a%20Time%20Series%20to%20a%20Supervised%20Learning%20Problem%20in%20Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/&amp;summary=Machine+learning+methods+like+deep+learning+can+be+used+for+time+series+forecasting.%0D%0A%0D%0ABefore+machi...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/use-weight-regularization-lstm-networks-time-series-forecasting/" rel="prev"><i class="fa fa-angle-left"></i> How to Use Weight Regularization with LSTM Networks for Time Series Forecasting</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="next">Multi-step Time Series Forecasting with Long Short-Term Memory Networks in Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">66 Responses to <em>How to Convert a Time Series to a Supervised Learning Problem in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-399021">
<div class="comment-container" id="li-comment-399021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dcb623e6c03db17645676ec6f8b0870?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dcb623e6c03db17645676ec6f8b0870?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mikkel</span>
<span class="date">May 8, 2017 at 7:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your highly relevant article 🙂</p>
<p>I am having a hard time following the structure of the dataset. I understand the basics of t-n, t-1, t, t+1, t+n and so forth. Although, what exactly are we describing here in the t and t-1 column? Is it the change over time for a specific explanatory variable? In that case, wouldn’t it make more sense to transpose the data, so that the time were described in the rows rather than columns?</p>
<p>Also, how would you then characterise following data:</p>
<p>Customer_ID      Month       Balance<br/>
        1                    01            1,500<br/>
        1                    02            1,600<br/>
        1                    03            1,700<br/>
        1                    04            1,900<br/>
        2                    01            1,000<br/>
        2                    02              900<br/>
        2                    03              700<br/>
        2                    04              500<br/>
        3                    01            3,500<br/>
        3                    02            1,500<br/>
        3                    03            2,500<br/>
        3                    04            4,500    </p>
<p>Let’s say, that we wanna forcast their balance using supervised learning, or classify the customers as “savers” or “spenders”</p>
<div class="reply">
<a aria-label="Reply to Mikkel" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399021#respond" onclick='return addComment.moveForm( "comment-399021", "399021", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399088">
<div class="comment-container" id="li-comment-399088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2017 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is transposing each variable, but allowing control over the length of each row back into time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399088#respond" onclick='return addComment.moveForm( "comment-399088", "399088", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399137">
<div class="comment-container" id="li-comment-399137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/abaa99146ddd0419bebddeea30638819?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/abaa99146ddd0419bebddeea30638819?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Daniel</span>
<span class="date">May 9, 2017 at 4:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>this is an awesome article! I was looking for that the whole time.</p>
<p>The only thing is I am general programming in R, so I only found something similar like your code, but I am not sure if it is the same. I have got this from <a href="https://www.r-bloggers.com/generating-a-laglead-variables/" rel="nofollow">https://www.r-bloggers.com/generating-a-laglead-variables/</a> and it deals with lagged and leaded values. Also the output includes NA values.</p>
<p>shift1)<br/>
        return(sapply(shift_by,shift, x=x))</p>
<p>    out 0 )<br/>
        out&lt;-c(tail(x,-abs_shift_by),rep(NA,abs_shift_by))<br/>
    else if (shift_by &lt; 0 )<br/>
        out&lt;-c(rep(NA,abs_shift_by), head(x,-abs_shift_by))<br/>
    else<br/>
        out&lt;-x<br/>
    out<br/>
}</p>
<p>Output:<br/>
    x df_lead2 df_lag2<br/>
1   1        3      NA<br/>
2   2        4      NA<br/>
3   3        5       1<br/>
4   4        6       2<br/>
5   5        7       3<br/>
6   6        8       4<br/>
7   7        9       5<br/>
8   8       10       6<br/>
9   9       NA       7<br/>
10 10       NA       8</p>
<p>I also tried to recompile your code in R, but it failed.</p>
<div class="reply">
<a aria-label="Reply to Daniel" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399137#respond" onclick='return addComment.moveForm( "comment-399137", "399137", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399251">
<div class="comment-container" id="li-comment-399251">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399251" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend contacting the authors of the R code you reference.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399251#respond" onclick='return addComment.moveForm( "comment-399251", "399251", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-399421">
<div class="comment-container" id="li-comment-399421">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1f3df17a4e7d685d7dfa9ad741018e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1f3df17a4e7d685d7dfa9ad741018e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chris</span>
<span class="date">May 12, 2017 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399421" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you answer this in Go, Java, C# and COBOL as well????? Thanks, I really don’t want to do anything</p>
<div class="reply">
<a aria-label="Reply to chris" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399421#respond" onclick='return addComment.moveForm( "comment-399421", "399421", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-399446">
<div class="comment-container" id="li-comment-399446">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399446" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do my best to help, some need more help than others.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399446#respond" onclick='return addComment.moveForm( "comment-399446", "399446", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399192">
<div class="comment-container" id="li-comment-399192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/47fa92e81c98cb0418d3897f99d60ef6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/47fa92e81c98cb0418d3897f99d60ef6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lee</span>
<span class="date">May 9, 2017 at 11:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, good article, but could be much better if you illustrated everything with some actual time series data. Also, no need to repeat the function code 5 times 😉 Gripes aside, this was very timely as I’m just about to get into some time series forecasting, so thanks for this article!!!</p>
<div class="reply">
<a aria-label="Reply to Lee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399192#respond" onclick='return addComment.moveForm( "comment-399192", "399192", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399256">
<div class="comment-container" id="li-comment-399256">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399256" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion Lee.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399256#respond" onclick='return addComment.moveForm( "comment-399256", "399256", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399481">
<div class="comment-container" id="li-comment-399481">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/15204f195246425556b5cd78c6d93add?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/15204f195246425556b5cd78c6d93add?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christopher</span>
<span class="date">May 12, 2017 at 9:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399481" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
thank you for the good article! I really like the shifting approach for reframing the training data!<br/>
But my question about this topic is: What do you think is the next step for a one-step univariate forecasting? Which machine learning method is the most suitable for that?<br/>
Obviously a regressor is the best choice but how can I determine the size of the sliding window for the training? </p>
<p>Thanks a lot for your help and work<br/>
~ Christopher</p>
<div class="reply">
<a aria-label="Reply to Christopher" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399481#respond" onclick='return addComment.moveForm( "comment-399481", "399481", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399532">
<div class="comment-container" id="li-comment-399532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My advice is to trial a suite of different window sizes and see what works best. </p>
<p>You can use an ACF/PACF plots as a heuristic:<br/>
<a href="http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow">http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=399532#respond" onclick='return addComment.moveForm( "comment-399532", "399532", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401872">
<div class="comment-container" id="li-comment-401872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tom</span>
<span class="date">June 8, 2017 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason：<br/>
       In this post, you  create new framings of time series ,such as t-1, t, t+1.But, what’s the use of these time series .Do you mean these time series can make a good effect on model? Maybe<br/>
my question is too simple ,because I am a newer ,please understand! thank you !</p>
<div class="reply">
<a aria-label="Reply to tom" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=401872#respond" onclick='return addComment.moveForm( "comment-401872", "401872", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401936">
<div class="comment-container" id="li-comment-401936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am providing a technique to help you convert a series into a supervised learning problem.</p>
<p>This is valuable because you can then transform your time series problems into supervised learning problems and apply a suite of standard classification and regression techniques in order to make forecasts.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=401936#respond" onclick='return addComment.moveForm( "comment-401936", "401936", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401968">
<div class="comment-container" id="li-comment-401968">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tom</span>
<span class="date">June 9, 2017 at 11:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401968" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, your answer always makes me learn a lot。Thank you Jason!</p>
<div class="reply">
<a aria-label="Reply to tom" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=401968#respond" onclick='return addComment.moveForm( "comment-401968", "401968", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-402067">
<div class="comment-container" id="li-comment-402067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-402067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=402067#respond" onclick='return addComment.moveForm( "comment-402067", "402067", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403593">
<div class="comment-container" id="li-comment-403593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brad Suzon</span>
<span class="date">June 23, 2017 at 11:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If there are multiple variables varXi to train and only one variable varY to predict will the same technique be used in the below way:<br/>
varX1(t-1)   varX2(t-1)   varX1(t)   varX2(t)   …   varY(t-1)   varY(t)<br/>
   ..                 ..                ..                ..                  ..                ..<br/>
and then use linear regression and as Response= varY(t) ?</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Brad Suzon" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403593#respond" onclick='return addComment.moveForm( "comment-403593", "403593", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403640">
<div class="comment-container" id="li-comment-403640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 24, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow your question Brad, perhaps you can restate it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403640#respond" onclick='return addComment.moveForm( "comment-403640", "403640", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-403751">
<div class="comment-container" id="li-comment-403751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brad</span>
<span class="date">June 25, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In case there are multiple measures and then make the transformation in order to forecast only varXn:</p>
<p>var1(t-1)       var2(t-1)      var1(t)      var2(t) …      varN(t-1)        varN(t)</p>
<p>linear regression should use as the response variable the varN(t) ?</p>
<div class="reply">
<a aria-label="Reply to Brad" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403751#respond" onclick='return addComment.moveForm( "comment-403751", "403751", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-403807">
<div class="comment-container" id="li-comment-403807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 26, 2017 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403807#respond" onclick='return addComment.moveForm( "comment-403807", "403807", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403648">
<div class="comment-container" id="li-comment-403648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9f4d532e7bae2467c8839e102d02e3a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9f4d532e7bae2467c8839e102d02e3a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://GitHub.com/xbno" rel="external nofollow">Geoff</a></span>
<span class="date">June 24, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’ve found your articles very useful during my capstone at a bootcamp I’m attending. I have two questions that I hope you could advise where to find better info about.<br/>
First, I’ve run into an issue with running PCA on the newly supervised version only the data. Does PCA recognize that the lagged series are actually the same data? If one was to do PCA do they need to perform it before supervising the data?<br/>
Secondly, what do you propose as the best learning algorithms and proper ways to perform train test splits on the data?<br/>
Thanks again,</p>
<div class="reply">
<a aria-label="Reply to Geoff" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403648#respond" onclick='return addComment.moveForm( "comment-403648", "403648", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403719">
<div class="comment-container" id="li-comment-403719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 25, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not used PCA on time series data. I expect careful handling of the framing of the data is required.</p>
<p>I have tips for backtesting on time series data here:<br/>
<a href="http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=403719#respond" onclick='return addComment.moveForm( "comment-403719", "403719", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404440">
<div class="comment-container" id="li-comment-404440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kushal</span>
<span class="date">July 1, 2017 at 1:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-404440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Great post.</p>
<p>Just one question. If the some of the input variables are continuous and some are categorical with one binary, predicting two output variables.</p>
<p>How does the shift work then?</p>
<p>Thanks<br/>
Kushal</p>
<div class="reply">
<a aria-label="Reply to Kushal" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=404440#respond" onclick='return addComment.moveForm( "comment-404440", "404440", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404500">
<div class="comment-container" id="li-comment-404500">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 2, 2017 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-404500" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The same, but consider encoding your categorical variables first (e.g. number encoding or one hot encoding).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=404500#respond" onclick='return addComment.moveForm( "comment-404500", "404500", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-406027">
<div class="comment-container" id="li-comment-406027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kushal</span>
<span class="date">July 15, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-406027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks</p>
<p>Should I then use the lagged versions of the predictors?</p>
<p>Kushal</p>
<div class="reply">
<a aria-label="Reply to Kushal" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=406027#respond" onclick='return addComment.moveForm( "comment-406027", "406027", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-406081">
<div class="comment-container" id="li-comment-406081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 16, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-406081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, I do not follow your question, perhaps you can restate it with more information?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=406081#respond" onclick='return addComment.moveForm( "comment-406081", "406081", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405093">
<div class="comment-container" id="li-comment-405093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viorel Emilian Teodorescu</span>
<span class="date">July 8, 2017 at 9:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-405093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>great article, Jason!</p>
<div class="reply">
<a aria-label="Reply to Viorel Emilian Teodorescu" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=405093#respond" onclick='return addComment.moveForm( "comment-405093", "405093", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405259">
<div class="comment-container" id="li-comment-405259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-405259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I hope it helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=405259#respond" onclick='return addComment.moveForm( "comment-405259", "405259", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-409220">
<div class="comment-container" id="li-comment-409220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69314a0b57f1b141a7e85ff86d5bda98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69314a0b57f1b141a7e85ff86d5bda98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chinesh</span>
<span class="date">August 10, 2017 at 5:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-409220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>very helpful article !!</p>
<p>I am working on developing an algorithm which will predict the future traffic for the restaurant. The features I am using are: Day,whether there was festival,temperature,climatic condition , current rating,whether there was holiday,service rating,number of reviews etc.Can I solve this problem using time series analysis along with these features,If yes how.<br/>
Please guide me</p>
<div class="reply">
<a aria-label="Reply to Chinesh" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=409220#respond" onclick='return addComment.moveForm( "comment-409220", "409220", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409264">
<div class="comment-container" id="li-comment-409264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-409264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will guide you:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=409264#respond" onclick='return addComment.moveForm( "comment-409264", "409264", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410622">
<div class="comment-container" id="li-comment-410622">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7ae5658c180be12d20ffa314d27c213e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7ae5658c180be12d20ffa314d27c213e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hossein</span>
<span class="date">August 23, 2017 at 1:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-410622" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article Jason. Just a naive question: How does this method different from moving average smoothing? I’m a bit confused!<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Hossein" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=410622#respond" onclick='return addComment.moveForm( "comment-410622", "410622", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410664">
<div class="comment-container" id="li-comment-410664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-410664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post is just about the framing of the problem.</p>
<p>Moving average is something to do to the data once it is framed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=410664#respond" onclick='return addComment.moveForm( "comment-410664", "410664", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-411247">
<div class="comment-container" id="li-comment-411247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95e1d9d824529e06c22bbeaf727e3285?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95e1d9d824529e06c22bbeaf727e3285?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pkl520</span>
<span class="date">August 26, 2017 at 10:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , Jason! Good article as always~</p>
<p>I have a question. </p>
<p>“Running the example shows the differentiation of input (t-n) and output (t+n) variables with the current observation (t) considered an output.”</p>
<p>values = [x for x in range(10)]<br/>
data = series_to_supervised(values, 2, 2)<br/>
print(data)</p>
<p>   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)<br/>
2        0.0        1.0        2        3.0<br/>
3        1.0        2.0        3        4.0<br/>
4        2.0        3.0        4        5.0<br/>
5        3.0        4.0        5        6.0<br/>
6        4.0        5.0        6        7.0<br/>
7        5.0        6.0        7        8.0<br/>
8        6.0        7.0        8        9.0</p>
<p>So above example, var1(t-2)  var1(t-1) are input , var1(t)  var1(t+1) are output, am I right?</p>
<p>Then,below example.</p>
<p>raw = DataFrame()<br/>
raw[‘ob1’] = [x for x in range(10)]<br/>
raw[‘ob2’] = [x for x in range(50, 60)]<br/>
values = raw.values<br/>
data = series_to_supervised(values, 1, 2)<br/>
print(data)<br/>
Running the example shows the large reframed DataFrame.</p>
<p>   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)<br/>
1        0.0       50.0        1       51        2.0       52.0<br/>
2        1.0       51.0        2       52        3.0       53.0<br/>
3        2.0       52.0        3       53        4.0       54.0<br/>
4        3.0       53.0        4       54        5.0       55.0<br/>
5        4.0       54.0        5       55        6.0       56.0<br/>
6        5.0       55.0        6       56        7.0       57.0<br/>
7        6.0       56.0        7       57        8.0       58.0<br/>
8        7.0       57.0        8       58        9.0       59.0</p>
<p>var1(t-1)  var2(t-1) are input,  var1(t)  var2(t)  var1(t+1)  var2(t+1) are output.</p>
<p>can u answer my question? I will be very appreciate!</p>
<div class="reply">
<a aria-label="Reply to pkl520" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=411247#respond" onclick='return addComment.moveForm( "comment-411247", "411247", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411292">
<div class="comment-container" id="li-comment-411292">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 27, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411292" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, or you can interpret and use the columns any way you wish.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=411292#respond" onclick='return addComment.moveForm( "comment-411292", "411292", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-411711">
<div class="comment-container" id="li-comment-411711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">August 30, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason!!<br/>
You are the best teacher ever</p>
<div class="reply">
<a aria-label="Reply to Thabet" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=411711#respond" onclick='return addComment.moveForm( "comment-411711", "411711", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411758">
<div class="comment-container" id="li-comment-411758">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 30, 2017 at 4:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411758" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Thabet.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=411758#respond" onclick='return addComment.moveForm( "comment-411758", "411758", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415028">
<div class="comment-container" id="li-comment-415028">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f5f36c0e18f2ddd78b215c42c07f495?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f5f36c0e18f2ddd78b215c42c07f495?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">September 29, 2017 at 12:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415028" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>I love your articles! Keep it up! I have a generalization question. In this data set:</p>
<p>   var1(t-1)  var2(t-1)  var1(t)  var2(t)<br/>
1        0.0       50.0        1       51<br/>
2        1.0       51.0        2       52<br/>
3        2.0       52.0        3       53<br/>
4        3.0       53.0        4       54<br/>
5        4.0       54.0        5       55<br/>
6        5.0       55.0        6       56<br/>
7        6.0       56.0        7       57<br/>
8        7.0       57.0        8       58<br/>
9        8.0       58.0        9       59</p>
<p>If I was trying to predict var2(t) from the other 3 data,  would the input data X shape would be (9,1,3) and the target data Y would be (9,1)?  To generalize, what if this was just one instance of multiple time series that I wanted to use. Say I have 1000 instances of time series. Would my data X have the shape (1000,9,3)? And the input target set Y would have shape (1000,9)?</p>
<p>Is my reasoning off? Am I framing my problem the wrong way?</p>
<p>Thanks!<br/>
Charles</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415028#respond" onclick='return addComment.moveForm( "comment-415028", "415028", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415044">
<div class="comment-container" id="li-comment-415044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2017 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post provides help regarding how to reshape data for LSTMs:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415044#respond" onclick='return addComment.moveForm( "comment-415044", "415044", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415266">
<div class="comment-container" id="li-comment-415266">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean Maloney</span>
<span class="date">October 1, 2017 at 5:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415266" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>I’m really struggling to make a new prediction once the model has been build. Could you give an example? I’ve been trying to write a method that takes the past time data and returns the yhat for the next time.</p>
<p>Thanks you.</p>
<div class="reply">
<a aria-label="Reply to Sean Maloney" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415266#respond" onclick='return addComment.moveForm( "comment-415266", "415266", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415303">
<div class="comment-container" id="li-comment-415303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 2, 2017 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post:<br/>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415303#respond" onclick='return addComment.moveForm( "comment-415303", "415303", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415267">
<div class="comment-container" id="li-comment-415267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean Maloney</span>
<span class="date">October 1, 2017 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>P.S. I’m the most stuck at how to scale the new input values.</p>
<div class="reply">
<a aria-label="Reply to Sean Maloney" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415267#respond" onclick='return addComment.moveForm( "comment-415267", "415267", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415304">
<div class="comment-container" id="li-comment-415304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 2, 2017 at 9:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Any data transforms performed on training data must be performed on new data for which you want to make a prediction.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=415304#respond" onclick='return addComment.moveForm( "comment-415304", "415304", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417598">
<div class="comment-container" id="li-comment-417598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nish</span>
<span class="date">October 23, 2017 at 11:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-417598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
This is great, but what if I have around ten features (say 4 categorical and 6 continuous), a couple of thousand data points per day, around 200 days worth of data in my training set? The shift function could work in theory but you’d be adding hundreds of thousands of columns, which would be computationally horrendous.<br/>
In such situations, what is the recommended approach?</p>
<div class="reply">
<a aria-label="Reply to Nish" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=417598#respond" onclick='return addComment.moveForm( "comment-417598", "417598", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417616">
<div class="comment-container" id="li-comment-417616">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 4:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-417616" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you will get a lot of columns.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=417616#respond" onclick='return addComment.moveForm( "comment-417616", "417616", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418686">
<div class="comment-container" id="li-comment-418686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shud</span>
<span class="date">November 1, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-418686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I converted my time series problem into regression problem and i used GradientBoostingRegressor to model the data. I see my adjusted R-squared keep changing everytime i run the model. I believe this is because of the correlation that exists between the independent variable (lag variables). How to handle this scenario? Though the range of fluctuation is small, i am concerned that this might be a bad model</p>
<div class="reply">
<a aria-label="Reply to Shud" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=418686#respond" onclick='return addComment.moveForm( "comment-418686", "418686", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418730">
<div class="comment-container" id="li-comment-418730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-418730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may be because of the stochastic nature of the algorithm:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=418730#respond" onclick='return addComment.moveForm( "comment-418730", "418730", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419910">
<div class="comment-container" id="li-comment-419910">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0bcc669c35e96d89395674c516ea5dfe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0bcc669c35e96d89395674c516ea5dfe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nitin Gupta</span>
<span class="date">November 13, 2017 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-419910" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I applied the concept that you have explained to my data and used linear regression. Can I expand this concept to polynomial regression also, by squaring the t-1 terms?</p>
<div class="reply">
<a aria-label="Reply to Nitin Gupta" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=419910#respond" onclick='return addComment.moveForm( "comment-419910", "419910", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419948">
<div class="comment-container" id="li-comment-419948">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2017 at 10:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-419948" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=419948#respond" onclick='return addComment.moveForm( "comment-419948", "419948", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420101">
<div class="comment-container" id="li-comment-420101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Samuel</span>
<span class="date">November 15, 2017 at 9:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>thanks a lot for your article! I already read a lot of your articles. These articles are great, they really helped me a lot.</p>
<p>But I still have a rather general question, that I can’t seem to wrap my head around.</p>
<p>The question is basically:<br/>
In which case do I treat a supervised learning problem as a time series problem, or vice versa?</p>
<p>For further insight, this is my problem I am currently struggling with:<br/>
I have data out of a factory (hundreds of features), which I can use as my input.<br/>
Additionally I have the energy demand of the factory as my output.<br/>
So I already have a lot of input-output-pairs.<br/>
The energy demand of the factory is also the quantity I want to predict.<br/>
Each data point has its own timestamp.<br/>
I can transform the timestamp into several features to take trends and seasonality into account.<br/>
Subsequently I can use different regression models to predict the energy demand of the factory.<br/>
This would then be a classical supervised regression problem.</p>
<p>But as I unterstood it from your time series articles, I could as well treat the same problem as a time series problem.<br/>
I could use the timestamp to extract time values which I can use in multivariate time series forecasting.</p>
<p>In most examples you gave in your time series articles, you had the output over time.<br/>
<a href="https://machinelearningmastery.com/reframe-time-series-forecasting-problem/" rel="nofollow">https://machinelearningmastery.com/reframe-time-series-forecasting-problem/</a><br/>
And in this article you shifted the time series to get an input, in order to treat the problem as a supervised learning problem.</p>
<p>So let’s suppose you have the same number of features in both cases.<br/>
Is it a promising solution to change the supervised learning problem to a time series problem?<br/>
What would be the benefits and drawbacks of doing this?</p>
<p>As most regression outputs are over time.<br/>
Is there a general rule, when to use which framing(supervised or time series) of the problem?</p>
<p>I hope, that I could phrase my confusion in an ordered fashion.</p>
<p>Thanks a lot for your time and help, I really appreciate it!</p>
<p>Cheers Samuel</p>
<div class="reply">
<a aria-label="Reply to Samuel" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=420101#respond" onclick='return addComment.moveForm( "comment-420101", "420101", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420178">
<div class="comment-container" id="li-comment-420178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2017 at 10:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To use supervised learning algorithms you must represent your time series as a supervised learning problem.</p>
<p>Not sure I follow what you mean by tuning a supervised learning problem into a series?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=420178#respond" onclick='return addComment.moveForm( "comment-420178", "420178", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-421614">
<div class="comment-container" id="li-comment-421614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Samuel</span>
<span class="date">November 29, 2017 at 10:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>thank you for your fast answer.<br/>
I’m sorry that I couldn’t frame my question comprehensibly, I’m still new to ML.<br/>
I’ll try to explain what I mean with an example.</p>
<p>Let’s suppose you have the following data, I adapted it from your article:<br/>
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>
<p>input1(time), input2, output<br/>
1, 0.2, 88<br/>
2, 0.5, 89<br/>
3, 0.7, 87<br/>
4, 0.4, 88<br/>
5, 1.0, 90</p>
<p>This data is, what you would consider a time series. But as you already have 2 inputs and 1 output you could already use the data for supervised machine learning.<br/>
In order to predict future outputs of the data you would have to know input 1 and 2 at timestep 6. Let’s assume you know from your production plan in a factory that the input2 will have a value of 0.8 at timestep 6 (input1). With this data you could gain y_pred from your model. You would have treated the data purely as a supervised machine learning problem.</p>
<p>input1(time), input2, output<br/>
1, 0.2, 88<br/>
2, 0.5, 89<br/>
3, 0.7, 87<br/>
4, 0.4, 88<br/>
5, 1.0, 90<br/>
6, 0.8, y_pred</p>
<p>But you could do time-series forecasting with the same data as well, if I understood your articles correctly.</p>
<p>input1(time), input2, output<br/>
nan, nan, 88<br/>
1, 0.2, 89<br/>
2, 0.5, 87<br/>
3, 0.7, 88<br/>
4, 0.4, 90<br/>
5, 1.0, y_pred</p>
<p>This leads to my questions:</p>
<p>In which case do I treat the data as a supervised learning problem and in which case as a time series problem?<br/>
Is it a promising solution to change the supervised learning problem to a time series problem?<br/>
What would be the benefits and drawbacks of doing this?<br/>
As my regression outputs are over time.<br/>
Is there a general rule, when to use which framing (supervised or time series) of the problem?</p>
<p>I hope, that I stated my questions more clearly.</p>
<p>Thanks a lot in advance for your help!</p>
<p>Best regards Samuel</p>
<div class="reply">
<a aria-label="Reply to Samuel" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421614#respond" onclick='return addComment.moveForm( "comment-421614", "421614", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-421664">
<div class="comment-container" id="li-comment-421664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I follow your first case mostly, but time would not be an input, it would be removed and assumed. I do not follow your second case.</p>
<p>I believe it would be:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65922292fde539989848" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
output(t) = f(input2(t), output(t-1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65922292fde539989848-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65922292fde539989848-1"><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-e">input2</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>What is best for your specific data, I have no idea. Try a suite of different framings (including more or less lag obs) and see which models give the best skill on your problem. That is the only trade-off to consider.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421664#respond" onclick='return addComment.moveForm( "comment-421664", "421664", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420382">
<div class="comment-container" id="li-comment-420382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e24ec8362962de677290f1cdca0c4e72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e24ec8362962de677290f1cdca0c4e72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.insightsbot.com" rel="external nofollow">MJ</a></span>
<span class="date">November 18, 2017 at 12:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ver helpful, thanks!</p>
<div class="reply">
<a aria-label="Reply to MJ" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=420382#respond" onclick='return addComment.moveForm( "comment-420382", "420382", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420428">
<div class="comment-container" id="li-comment-420428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2017 at 10:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=420428#respond" onclick='return addComment.moveForm( "comment-420428", "420428", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421649">
<div class="comment-container" id="li-comment-421649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd88fbdf39d33e2f0d41c4aa8e70efad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd88fbdf39d33e2f0d41c4aa8e70efad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">November 30, 2017 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason:<br/>
Thank you for all the time and effort you have expended to share your knowledge of Deep Learning, Neural Networks, etc.  Nice work.</p>
<p>I have altered your series_to_supervised function in several ways which might be helpfut to other novices:<br/>
(1) the returned column names are based on the original data<br/>
(2) the current period data is always included so that leading and lagging period counts can be 0.<br/>
(3) the selLag and selFut arguments can limit the subset of columns that are shifted.</p>
<p>There is a simple set of test code at the bottom of this listing:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592229306c936971655" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat
import random

def time_series_to_supervised(data, n_lag=1, n_fut=1, selLag=None, selFut=None, dropnan=True):
    """
    Converts a time series to a supervised learning data set by adding time-shifted prior and future period
    data as input or output (i.e., target result) columns for each period
    :param data:  a series of periodic attributes as a list or NumPy array
    :param n_lag: number of PRIOR periods to lag as input (X); generates: Xa(t-1), Xa(t-2); min= 0 --&gt; nothing lagged
    :param n_fut: number of FUTURE periods to add as target output (y); generates Yout(t+1); min= 0 --&gt; no future periods
    :param selLag:  only copy these specific PRIOR period attributes; default= None; EX: ['Xa', 'Xb' ]
    :param selFut:  only copy these specific FUTURE period attributes; default= None; EX: ['rslt', 'xx']
    :param dropnan: True= drop rows with NaN values; default= True
    :return: a Pandas DataFrame of time series data organized for supervised learning
    NOTES:
    (1) The current period's data is always included in the output.
    (2) A suffix is added to the original column names to indicate a relative time reference: e.g., (t) is the current
        period; (t-2) is from two periods in the past; (t+1) is from the next period
    (3) This is an extension of Jason Brownlee's series_to_supervised() function, customized for MFI use
    """
    n_vars = 1 if type(data) is list else data.shape[1]
    df = DataFrame(data)
    origNames = df.columns
    cols, names = list(), list()
    # include all current period attributes
    cols.append(df.shift(0))
    names += [('%s' % origNames[j]) for j in range(n_vars)]

    # lag any past period attributes (t-n_lag,...,t-1)
    n_lag = max(0, n_lag)  # force valid number of lag periods
    for i in range(n_lag, 0, -1):
        suffix= '(t-%d)' % i
        if (None == selLag):   # copy all attributes from PRIOR periods?
            cols.append(df.shift(i))
            names += [('%s%s' % (origNames[j], suffix)) for j in range(n_vars)]
        else:
            for var in (selLag):
                cols.append(df[var].shift(i))
                names+= [('%s%s' % (var, suffix))]

    # include future period attributes (t+1,...,t+n_fut)
    n_fut = max(n_fut, 0)  # force valid number of future periods to shift back
    for i in range(1, n_fut + 1):
        suffix= '(t+%d)' % i
        if (None == selFut):  # copy all attributes from future periods?
            cols.append(df.shift(-i))
            names += [('%s%s' % (origNames[j], suffix)) for j in range(n_vars)]
        else:  # copy only selected future attributes
            for var in (selFut):
                cols.append(df[var].shift(-i))
                names += [('%s%s' % (var, suffix))]
    # combine everything
    agg = concat(cols, axis=1)
    agg.columns = names
    # drop rows with NaN values introduced by lagging
    if dropnan:
        agg.dropna(inplace=True)
    return agg


""" 
def main():    # simple test example
    df= DataFrame()
    df['xa']= [x for x in range(10)]
    df['xb']= [2*x for x in range(10)]
    df['rslt']= random.sample(range(100),10)
    print(df)
    dfx= time_series_to_supervised(df, n_lag= 1, n_fut= 2, dropnan= False, selLag= ['xa'], selFut=['rslt'])
    print (dfx)


if __name__ ==  '__main__':
    main()

"""</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592229306c936971655-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-2">2</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-4">4</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-6">6</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-8">8</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-10">10</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-12">12</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-14">14</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-16">16</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-18">18</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-20">20</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-22">22</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-24">24</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-26">26</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-28">28</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-30">30</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-32">32</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-34">34</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-36">36</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-38">38</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-40">40</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-42">42</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-44">44</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-46">46</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-48">48</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-50">50</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-52">52</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-54">54</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-56">56</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-58">58</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-60">60</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-62">62</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-64">64</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-66">66</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-68">68</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-70">70</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-72">72</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-74">74</div><div class="crayon-num" data-line="crayon-5a6592229306c936971655-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592229306c936971655-76">76</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592229306c936971655-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-3"><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-4"> </div><div class="crayon-line" id="crayon-5a6592229306c936971655-5"><span class="crayon-e">def </span><span class="crayon-e">time_series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_fut</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">selLag</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">selFut</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-6"><span class="crayon-h">    </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-7"><span class="crayon-s">    Converts a time series to a supervised learning data set by adding time-shifted prior and future period</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-8"><span class="crayon-s">    data as input or output (i.e., target result) columns for each period</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-9"><span class="crayon-s">    :param data:  a series of periodic attributes as a list or NumPy array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-10"><span class="crayon-s">    :param n_lag: number of PRIOR periods to lag as input (X); generates: Xa(t-1), Xa(t-2); min= 0 --&gt; nothing lagged</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-11"><span class="crayon-s">    :param n_fut: number of FUTURE periods to add as target output (y); generates Yout(t+1); min= 0 --&gt; no future periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-12"><span class="crayon-s">    :param selLag:  only copy these specific PRIOR period attributes; default= None; EX: ['Xa', 'Xb' ]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-13"><span class="crayon-s">    :param selFut:  only copy these specific FUTURE period attributes; default= None; EX: ['rslt', 'xx']</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-14"><span class="crayon-s">    :param dropnan: True= drop rows with NaN values; default= True</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-15"><span class="crayon-s">    :return: a Pandas DataFrame of time series data organized for supervised learning</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-16"><span class="crayon-s">    NOTES:</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-17"><span class="crayon-s">    (1) The current period's data is always included in the output.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-18"><span class="crayon-s">    (2) A suffix is added to the original column names to indicate a relative time reference: e.g., (t) is the current</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-19"><span class="crayon-s">        period; (t-2) is from two periods in the past; (t+1) is from the next period</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-20"><span class="crayon-s">    (3) This is an extension of Jason Brownlee's series_to_supervised() function, customized for MFI use</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-21"><span class="crayon-s">    "</span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-22"><span class="crayon-h">    </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-23"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-24"><span class="crayon-h">    </span><span class="crayon-v">origNames</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">columns</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-25"><span class="crayon-e">    </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-26"><span class="crayon-h">    </span><span class="crayon-p"># include all current period attributes</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-27"><span class="crayon-h">    </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-28"><span class="crayon-h">    </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-30"><span class="crayon-h">    </span><span class="crayon-p"># lag any past period attributes (t-n_lag,...,t-1)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-31"><span class="crayon-h">    </span><span class="crayon-v">n_lag</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_lag</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># force valid number of lag periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-32"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_lag</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-33"><span class="crayon-h">        </span><span class="crayon-v">suffix</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-34"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">selLag</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">   </span><span class="crayon-p"># copy all attributes from PRIOR periods?</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-35"><span class="crayon-h">            </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-36"><span class="crayon-h">            </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-37"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-38"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">selLag</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-39"><span class="crayon-h">                </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-40"><span class="crayon-h">                </span><span class="crayon-v">names</span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-42"><span class="crayon-h">    </span><span class="crayon-p"># include future period attributes (t+1,...,t+n_fut)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-43"><span class="crayon-h">    </span><span class="crayon-v">n_fut</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">n_fut</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># force valid number of future periods to shift back</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-44"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_fut</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-45"><span class="crayon-h">        </span><span class="crayon-v">suffix</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-46"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">selFut</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-p"># copy all attributes from future periods?</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-47"><span class="crayon-h">            </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-48"><span class="crayon-h">            </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-49"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-p"># copy only selected future attributes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-50"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">selFut</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-51"><span class="crayon-h">                </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-52"><span class="crayon-h">                </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-53"><span class="crayon-h">    </span><span class="crayon-p"># combine everything</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-54"><span class="crayon-h">    </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-55"><span class="crayon-h">    </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-56"><span class="crayon-h">    </span><span class="crayon-p"># drop rows with NaN values introduced by lagging</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-57"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-58"><span class="crayon-h">        </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-59"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-60"> </div><div class="crayon-line" id="crayon-5a6592229306c936971655-61"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-62"><span class="crayon-s">""</span><span class="crayon-s">" </span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-63"><span class="crayon-s">def main():    # simple test example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-64"><span class="crayon-s">    df= DataFrame()</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-65"><span class="crayon-s">    df['xa']= [x for x in range(10)]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-66"><span class="crayon-s">    df['xb']= [2*x for x in range(10)]</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-67"><span class="crayon-s">    df['rslt']= random.sample(range(100),10)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-68"><span class="crayon-s">    print(df)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-69"><span class="crayon-s">    dfx= time_series_to_supervised(df, n_lag= 1, n_fut= 2, dropnan= False, selLag= ['xa'], selFut=['rslt'])</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-70"><span class="crayon-s">    print (dfx)</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-71"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-72"> </div><div class="crayon-line" id="crayon-5a6592229306c936971655-73"><span class="crayon-s">if __name__ ==  '__main__':</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-74"><span class="crayon-s">    main()</span></div><div class="crayon-line" id="crayon-5a6592229306c936971655-75"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6592229306c936971655-76"><span class="crayon-s">"</span><span class="crayon-s">""</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0056 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421649#respond" onclick='return addComment.moveForm( "comment-421649", "421649", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421676">
<div class="comment-container" id="li-comment-421676">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421676" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very cool Michael, thanks for sharing!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421676#respond" onclick='return addComment.moveForm( "comment-421676", "421676", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421786">
<div class="comment-container" id="li-comment-421786">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 1, 2017 at 7:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421786" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I do forecasting, let’s say only one step ahead, as the first input value I should use any value that belongs i.e. to validation data (in order to set up initial state of forecasting). In second, third and so on prediction step I should use previous output of forecasting as input of NN. Do I understand correctly ?</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421786#respond" onclick='return addComment.moveForm( "comment-421786", "421786", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421823">
<div class="comment-container" id="li-comment-421823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think so.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421823#respond" onclick='return addComment.moveForm( "comment-421823", "421823", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-421892">
<div class="comment-container" id="li-comment-421892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 2, 2017 at 4:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, so another question. In the blog post here: <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a>, as an input for NN you use test values. The predictions are only saved to a list and they are not used to predict further values of timeseries.</p>
<p>My question is. Is it possible to predict a series of values knowing only the first value ?<br/>
For example. I train a network to predict values of sine wave. Is it possible to predict next N values of sine wave starting from value zero and feeding NN with result of prediction to predict t + 1, t + 2 etc ?</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421892#respond" onclick='return addComment.moveForm( "comment-421892", "421892", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-421893">
<div class="comment-container" id="li-comment-421893">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 2, 2017 at 4:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421893" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If my above understanding is incorrect then it means that if your test values are completely different than those which were used to train network, we will get even worse predictions.</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421893#respond" onclick='return addComment.moveForm( "comment-421893", "421893", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-421922">
<div class="comment-container" id="li-comment-421922">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421922" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. Bad predictions in a recursive model will give even worse subsequent predictions.</p>
<p>Ideally, you want to get ground truth values as inputs.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-421921">
<div class="comment-container" id="li-comment-421921">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421921" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is called multi-step forecasting. Here is an example:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=421921#respond" onclick='return addComment.moveForm( "comment-421921", "421921", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-421998">
<div class="comment-container" id="li-comment-421998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 3, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does it mean that using multi-step forecast (let’s say I will predict 4 values) I can predict a timeseries which contains 100 samples providing only initial step (for example providing only first two values of the timeseries) ?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-422090">
<div class="comment-container" id="li-comment-422090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 4, 2017 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-422090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but I would expect the skill to be poor – it’s a very hard problem to predict so many time steps from so little information.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426275">
<div class="comment-container" id="li-comment-426275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liz</span>
<span class="date">January 12, 2018 at 7:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Mr. Brownlee, </p>
<p>thank you for all of your nice tutorials. They really help!<br/>
I have two questions about the input data for an LSTM for multi-step predictions.<br/>
1. If I have multiple features that I use as input for the prediction and at a point (t) I have no new values for any of them. Do I have to predict all my input features in order to make make a multi-step forecast?<br/>
2. If some of my input data is binary data and not continuous can I still predict it with the same LSTM? Or do I need a separate Classification?</p>
<p>Sorry if its very basic, I am quite new to LSTM.<br/>
Best regards Liz</p>
<div class="reply">
<a aria-label="Reply to Liz" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=426275#respond" onclick='return addComment.moveForm( "comment-426275", "426275", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426298">
<div class="comment-container" id="li-comment-426298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 11:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, you can use whatever inputs you choose.</p>
<p>Sure you can have binary inputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=426298#respond" onclick='return addComment.moveForm( "comment-426298", "426298", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-426336">
<div class="comment-container" id="li-comment-426336">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liz</span>
<span class="date">January 13, 2018 at 1:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426336" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your quick answer.<br/>
Unfortunately I still have some trouble with the implementation.<br/>
If I use feature_1 and feature_2 as input for my my LSTM but only predict feature_1 at time (t+1) how do I make the next step to know feature_1 at time (t+2).<br/>
Somehow I seem to miss feature_2 at time (t+1) for this approach.<br/>
Could you tell me where I am off?<br/>
Best regards Liz</p>
<div class="reply">
<a aria-label="Reply to Liz" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=426336#respond" onclick='return addComment.moveForm( "comment-426336", "426336", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426372">
<div class="comment-container" id="li-comment-426372">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426372" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check your input data is complete?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/?replytocom=426372#respond" onclick='return addComment.moveForm( "comment-426372", "426372", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/convert-time-series-supervised-learning-problem-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3984"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="f16e953111"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="45"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-27"> <div class="textwidget"><p></p><center>
<h3>Get Good at Time Series Forecasting</h3>
<p>Need visualizations and forecast models?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Get Started with Time Series Forecasting in Python!</a></p>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>