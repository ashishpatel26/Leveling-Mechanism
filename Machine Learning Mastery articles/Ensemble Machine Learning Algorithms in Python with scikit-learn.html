<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Ensemble Machine Learning Algorithms in Python with scikit-learn - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Ensemble Machine Learning Algorithms in Python with scikit-learn - Machine Learning Mastery" property="og:title"/>
<meta content="Ensembles can give you a boost in accuracy on your dataset. In this post you will discover how you can create some of the most powerful types of ensembles in Python using scikit-learn. This case study will step you through Boosting, Bagging and Majority Voting and show you how you can continue to ratchet up …" property="og:description"/>
<meta content="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Python Machine Learning" property="article:section"/>
<meta content="2016-06-03T05:00:42+11:00" property="article:published_time"/>
<meta content="2017-04-04T09:18:54+11:00" property="article:modified_time"/>
<meta content="2017-04-04T09:18:54+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Ensemble-Machine-Learning-Algorithms-in-Python-with-scikit-learn.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Ensemble-Machine-Learning-Algorithms-in-Python-with-scikit-learn.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/ensemble-machine-learning-algorithms-python-scikit-learn\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/feed/" rel="alternate" title="Machine Learning Mastery » Ensemble Machine Learning Algorithms in Python with scikit-learn Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2475" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fensemble-machine-learning-algorithms-python-scikit-learn%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fensemble-machine-learning-algorithms-python-scikit-learn%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2475 single-format-standard ie8 ie alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-33"> <div class="textwidget"><p>Need help with Python Machine Learning? <a href="https://machinelearningmastery.lpages.co/python-machine-learning-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2475 post type-post status-publish format-standard has-post-thumbnail hentry category-python-machine-learning">
<header>
<h1 class="title entry-title">Ensemble Machine Learning Algorithms in Python with scikit-learn</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-03T05:00:42+1100">June 3, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/python-machine-learning/" title="View all items in Python Machine Learning">Python Machine Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fensemble-machine-learning-algorithms-python-scikit-learn%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/&amp;summary=Ensembles+can+give+you+a+boost+in+accuracy+on+your+dataset.%0D%0A%0D%0AIn+this+post+you+will+discover+how+yo..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/&amp;summary=Ensembles+can+give+you+a+boost+in+accuracy+on+your+dataset.%0D%0A%0D%0AIn+this+post+you+will+discover+how+yo...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Ensembles can give you a boost in accuracy on your dataset.</p>
<p>In this post you will discover how you can create some of the most powerful types of ensembles in Python using scikit-learn.</p>
<p>This case study will step you through Boosting, Bagging and Majority Voting and show you how you can continue to ratchet up the accuracy of the models on your own datasets.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Updated to reflect changes to the scikit-learn API in version 0.18.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2477" style="max-width: 650px"><img alt="Ensemble Machine Learning Algorithms in Python with scikit-learn" class="size-full wp-image-2477" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Ensemble-Machine-Learning-Algorithms-in-Python-with-scikit-learn.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Ensemble-Machine-Learning-Algorithms-in-Python-with-scikit-learn.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Ensemble-Machine-Learning-Algorithms-in-Python-with-scikit-learn-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Ensemble Machine Learning Algorithms in Python with scikit-learn<br/>Photo by <a href="https://www.flickr.com/photos/usarmyband/6830189060/">The United States Army Band</a>, some rights reserved.</p></div>
<h2>Combine Model Predictions Into Ensemble Predictions</h2>
<p>The three most popular methods for combining the predictions from different models are:</p>
<ul>
<li><strong>Bagging</strong>. Building multiple models (typically of the same type) from different subsamples of the training dataset.</li>
<li><strong>Boosting</strong>. Building multiple models (typically of the same type) each of which learns to fix the prediction errors of a prior model in the chain.</li>
<li><strong>Voting</strong>. Building multiple models (typically of differing types) and simple statistics (like calculating the mean) are used to combine predictions.</li>
</ul>
<p>This post will not explain each of these methods.</p>
<p>It assumes you are generally familiar with machine learning algorithms and ensemble methods and that you are looking for information on how to create ensembles in Python.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Machine Learning in Python?</h3>
<p>Take my free 2-week email course and discover data prep, algorithms and more (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/146d399f3f72a2%3A164f8be4f346dc/5655869022797824/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="146d399f3f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/146d399f3f72a2%3A164f8be4f346dc/5655869022797824/" src="https://machinelearningmastery.leadpages.co/leadbox-1001.js" type="text/javascript"></script></p></center>
<p style="text-align: center;"></p>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>About the Recipes</h2>
<p>Each recipe in this post was designed to be standalone. This is so that you can copy-and-paste it into your project and start using it immediately.</p>
<p>A standard classification problem from the UCI Machine Learning Repository is used to demonstrate each ensemble algorithm. This is the <a href="https://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians onset of Diabetes dataset</a>. It is a binary classification problem where all of the input variables are numeric and have differing scales.</p>
<p>Each ensemble algorithm is demonstrated using 10 fold cross validation, a standard technique used to estimate the performance of any machine learning algorithm on unseen data.</p>
<h2>Bagging Algorithms</h2>
<p>Bootstrap Aggregation or bagging involves taking multiple samples from your training dataset (with replacement) and training a model for each sample.</p>
<p>The final output prediction is averaged across the predictions of all of the sub-models.</p>
<p>The three bagging models covered in this section are as follows:</p>
<ol>
<li>Bagged Decision Trees</li>
<li>Random Forest</li>
<li>Extra Trees</li>
</ol>
<h3>1. Bagged Decision Trees</h3>
<p>Bagging performs best with algorithms that have high variance. A popular example are decision trees, often constructed without pruning.</p>
<p>In the example below see an example of using the BaggingClassifier with the Classification and Regression Trees algorithm (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html">DecisionTreeClassifier</a>). A total of 100 trees are created.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83d3605930323" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Bagged Decision Trees for Classification
import pandas
from sklearn import model_selection
from sklearn.ensemble import BaggingClassifier
from sklearn.tree import DecisionTreeClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
kfold = model_selection.KFold(n_splits=10, random_state=seed)
cart = DecisionTreeClassifier()
num_trees = 100
model = BaggingClassifier(base_estimator=cart, n_estimators=num_trees, random_state=seed)
results = model_selection.cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-16">16</div><div class="crayon-num" data-line="crayon-5a6592e8d83d3605930323-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83d3605930323-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-1"><span class="crayon-p"># Bagged Decision Trees for Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-6"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-7"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-8"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-9"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-11"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-12"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-13"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-14"><span class="crayon-v">cart</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-15"><span class="crayon-v">num_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-16"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">base_estimator</span><span class="crayon-o">=</span><span class="crayon-v">cart</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">num_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83d3605930323-17"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83d3605930323-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Running the example, we get a robust estimate of model accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83df484664885" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.770745044429</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83df484664885-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83df484664885-1">0.770745044429</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>2. Random Forest</h3>
<p>Random forest is an extension of bagged decision trees.</p>
<p>Samples of the training dataset are taken with replacement, but the trees are constructed in a way that reduces the correlation between individual classifiers. Specifically, rather than greedily choosing the best split point in the construction of the tree, only a random subset of features are considered for each split.</p>
<p>You can construct a Random Forest model for classification using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">RandomForestClassifier</a> class.</p>
<p>The example below provides an example of Random Forest for classification with 100 trees and split points chosen from a random selection of 3 features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83e2208207299" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Forest Classification
import pandas
from sklearn import model_selection
from sklearn.ensemble import RandomForestClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
num_trees = 100
max_features = 3
kfold = model_selection.KFold(n_splits=10, random_state=seed)
model = RandomForestClassifier(n_estimators=num_trees, max_features=max_features)
results = model_selection.cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e2208207299-16">16</div><div class="crayon-num" data-line="crayon-5a6592e8d83e2208207299-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-1"><span class="crayon-p"># Random Forest Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-5"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-6"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-7"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-8"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-10"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-11"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-12"><span class="crayon-v">num_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-13"><span class="crayon-v">max_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-14"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-15"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">num_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_features</span><span class="crayon-o">=</span><span class="crayon-v">max_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e2208207299-16"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83e2208207299-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Running the example provides a mean estimate of classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83e5020490149" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.770727956254</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83e5020490149-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83e5020490149-1">0.770727956254</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>3. Extra Trees</h3>
<p>Extra Trees are another modification of bagging where random trees are constructed from samples of the training dataset.</p>
<p>You can construct an Extra Trees model for classification using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html">ExtraTreesClassifier</a> class.</p>
<p>The example below provides a demonstration of extra trees with the number of trees set to 100 and splits chosen from 7 random features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83e8662021542" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Extra Trees Classification
import pandas
from sklearn import model_selection
from sklearn.ensemble import ExtraTreesClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
num_trees = 100
max_features = 7
kfold = model_selection.KFold(n_splits=10, random_state=seed)
model = ExtraTreesClassifier(n_estimators=num_trees, max_features=max_features)
results = model_selection.cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83e8662021542-16">16</div><div class="crayon-num" data-line="crayon-5a6592e8d83e8662021542-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-1"><span class="crayon-p"># Extra Trees Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesClassifier</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-5"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-6"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-7"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-8"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-10"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-11"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-12"><span class="crayon-v">num_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-13"><span class="crayon-v">max_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-14"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-15"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">num_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_features</span><span class="crayon-o">=</span><span class="crayon-v">max_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83e8662021542-16"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83e8662021542-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running the example provides a mean estimate of classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83eb604746359" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.760269993165</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83eb604746359-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83eb604746359-1">0.760269993165</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Boosting Algorithms</h2>
<p>Boosting ensemble algorithms creates a sequence of models that attempt to correct the mistakes of the models before them in the sequence.</p>
<p>Once created, the models make predictions which may be weighted by their demonstrated accuracy and the results are combined to create a final output prediction.</p>
<p>The two most common boosting ensemble machine learning algorithms are:</p>
<ol>
<li>AdaBoost</li>
<li>Stochastic Gradient Boosting</li>
</ol>
<h3>1. AdaBoost</h3>
<p>AdaBoost was perhaps the first successful boosting ensemble algorithm. It generally works by weighting instances in the dataset by how easy or difficult they are to classify, allowing the algorithm to pay or or less attention to them in the construction of subsequent models.</p>
<p>You can construct an AdaBoost model for classification using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html">AdaBoostClassifier</a> class.</p>
<p>The example below demonstrates the construction of 30 decision trees in sequence using the AdaBoost algorithm.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83f0718737933" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# AdaBoost Classification
import pandas
from sklearn import model_selection
from sklearn.ensemble import AdaBoostClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
num_trees = 30
kfold = model_selection.KFold(n_splits=10, random_state=seed)
model = AdaBoostClassifier(n_estimators=num_trees, random_state=seed)
results = model_selection.cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83f0718737933-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f0718737933-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-1"><span class="crayon-p"># AdaBoost Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostClassifier</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-5"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-6"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-7"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-8"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-10"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-11"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-12"><span class="crayon-v">num_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-13"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-14"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">num_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83f0718737933-15"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f0718737933-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Running the example provides a mean estimate of classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83f3642802412" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.76045796309</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83f3642802412-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83f3642802412-1">0.76045796309</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>2. Stochastic Gradient Boosting</h3>
<p>Stochastic Gradient Boosting (also called Gradient Boosting Machines) are one of the most sophisticated ensemble techniques. It is also a technique that is proving to be perhaps of the the best techniques available for improving performance via ensembles.</p>
<p>You can construct a Gradient Boosting model for classification using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html">GradientBoostingClassifier</a> class.</p>
<p>The example below demonstrates Stochastic Gradient Boosting for classification with 100 trees.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83f5673104027" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Stochastic Gradient Boosting Classification
import pandas
from sklearn import model_selection
from sklearn.ensemble import GradientBoostingClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
num_trees = 100
kfold = model_selection.KFold(n_splits=10, random_state=seed)
model = GradientBoostingClassifier(n_estimators=num_trees, random_state=seed)
results = model_selection.cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83f5673104027-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83f5673104027-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-1"><span class="crayon-p"># Stochastic Gradient Boosting Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-5"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-6"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-7"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-8"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-10"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-11"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-12"><span class="crayon-v">num_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-13"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-14"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">num_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83f5673104027-15"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83f5673104027-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running the example provides a mean estimate of classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83f8307793061" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.764285714286</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83f8307793061-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83f8307793061-1">0.764285714286</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Voting Ensemble</h2>
<p>Voting is one of the simplest ways of combining the predictions from multiple machine learning algorithms.</p>
<p>It works by first creating two or more standalone models from your training dataset. A Voting Classifier can then be used to wrap your models and average the predictions of the sub-models when asked to make predictions for new data.</p>
<p>The predictions of the sub-models can be weighted, but specifying the weights for classifiers manually or even heuristically is difficult. More advanced methods can learn how to best weight the predictions from submodels, but this is called stacking (stacked aggregation) and is currently not provided in scikit-learn.</p>
<p>You can create a voting ensemble model for classification using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html">VotingClassifier</a> class.</p>
<p>The code below provides an example of combining the predictions of logistic regression, classification and regression trees and support vector machines together for a classification problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83fb108887457" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Voting Ensemble for Classification
import pandas
from sklearn import model_selection
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.ensemble import VotingClassifier
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"
names = ['preg', 'plas', 'pres', 'skin', 'test', 'mass', 'pedi', 'age', 'class']
dataframe = pandas.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:8]
Y = array[:,8]
seed = 7
kfold = model_selection.KFold(n_splits=10, random_state=seed)
# create the sub models
estimators = []
model1 = LogisticRegression()
estimators.append(('logistic', model1))
model2 = DecisionTreeClassifier()
estimators.append(('cart', model2))
model3 = SVC()
estimators.append(('svm', model3))
# create the ensemble model
ensemble = VotingClassifier(estimators)
results = model_selection.cross_val_score(ensemble, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-2">2</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-4">4</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-6">6</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-8">8</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-10">10</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-12">12</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-14">14</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-16">16</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-18">18</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-20">20</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-22">22</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-24">24</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6592e8d83fb108887457-26">26</div><div class="crayon-num" data-line="crayon-5a6592e8d83fb108887457-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-1"><span class="crayon-p"># Voting Ensemble for Classification</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-3"><span class="crayon-e">from </span><span class="crayon-e">sklearn </span><span class="crayon-e">import </span><span class="crayon-e">model_selection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">VotingClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-8"><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-9"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'preg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'plas'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pres'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'skin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pedi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'class'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-10"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-11"><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-13"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-14"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-15"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-16"><span class="crayon-p"># create the sub models</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-17"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-18"><span class="crayon-v">model1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-19"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-20"><span class="crayon-v">model2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-21"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'cart'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-22"><span class="crayon-v">model3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-23"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'svm'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-24"><span class="crayon-p"># create the ensemble model</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-25"><span class="crayon-v">ensemble</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VotingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6592e8d83fb108887457-26"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_selection</span><span class="crayon-sy">.</span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">ensemble</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6592e8d83fb108887457-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example provides a mean estimate of classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6592e8d83fe603450759" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.712166780588</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6592e8d83fe603450759-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6592e8d83fe603450759-1">0.712166780588</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post you discovered ensemble machine learning algorithms for improving the performance of models on your problems.</p>
<p>You learned about:</p>
<ul>
<li>Bagging Ensembles including Bagged Decision Trees, Random Forest and Extra Trees.</li>
<li>Boosting Ensembles including AdaBoost and Stochastic Gradient Boosting.</li>
<li>Voting Ensembles for averaging the predictions for any arbitrary models.</li>
</ul>
<p>Do you have any questions about ensemble machine learning algorithms or ensembles in scikit-learn? Ask your questions in the comments and I will do my best to answer them.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-38"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2>Frustrated With Python Machine Learning?</h2>
<p><a href="/machine-learning-with-python/"><img align="left" alt="Master Machine Learning With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/07/MachineLearningMasteryWithPython-220px.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Models in Minutes</h4>
<p>…with just a few lines of scikit-learn code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/machine-learning-with-python/">Machine Learning Mastery With Python</a></p>
<p>Covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> like:<br/><em>Loading data</em>, <em>visualization</em>, <em>modeling</em>, <em>tuning</em>, and much more…</p>
<h4>Finally Bring Machine Learning To<br/>Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/machine-learning-with-python/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fensemble-machine-learning-algorithms-python-scikit-learn%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/&amp;summary=Ensembles+can+give+you+a+boost+in+accuracy+on+your+dataset.%0D%0A%0D%0AIn+this+post+you+will+discover+how+yo..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Ensemble%20Machine%20Learning%20Algorithms%20in%20Python%20with%20scikit-learn&amp;url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/&amp;summary=Ensembles+can+give+you+a+boost+in+accuracy+on+your+dataset.%0D%0A%0D%0AIn+this+post+you+will+discover+how+yo...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" rel="prev"><i class="fa fa-angle-left"></i> Multi-Class Classification Tutorial with the Keras Deep Learning Library</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/automate-machine-learning-workflows-pipelines-python-scikit-learn/" rel="next">Automate Machine Learning Workflows with Pipelines in Python and scikit-learn <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">63 Responses to <em>Ensemble Machine Learning Algorithms in Python with scikit-learn</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-353176">
<div class="comment-container" id="li-comment-353176">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0de2cd278a14067eba24f29c54608d54?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0de2cd278a14067eba24f29c54608d54?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishal</span>
<span class="date">June 9, 2016 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-353176" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Informative post. </p>
<p>Once you identify and finalize the best ensemble model, how would you score a future sample with such model? I am referring to the productionalization of the model in a data base. </p>
<p>Would you use something like the pickle package? Or is there a way to spell out the scoring algorithm (IF-ELSE rules for decision tree, or the actual formula for logistic regression) and use the formula for future scoring purposes?</p>
<div class="reply">
<a aria-label="Reply to Vishal" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=353176#respond" onclick='return addComment.moveForm( "comment-353176", "353176", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-353755">
<div class="comment-container" id="li-comment-353755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 14, 2016 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-353755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>After you finalize the model you can incorporate it into an application on service.</p>
<p>The model would be used directly.</p>
<p>It would be provided input patterns and make predictions that you could use in some operational way.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=353755#respond" onclick='return addComment.moveForm( "comment-353755", "353755", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-358114">
<div class="comment-container" id="li-comment-358114">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/71f305ebf9b56d48717e8e6ecb969fdc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/71f305ebf9b56d48717e8e6ecb969fdc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christos Chatzoglou</span>
<span class="date">July 26, 2016 at 10:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-358114" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very well written post! Is there any email we could send you some questions about the ensemble methods?</p>
<div class="reply">
<a aria-label="Reply to Christos Chatzoglou" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=358114#respond" onclick='return addComment.moveForm( "comment-358114", "358114", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-358136">
<div class="comment-container" id="li-comment-358136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2016 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-358136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Christos.</p>
<p>You can contact me directly here:<br/>
<a href="http://machinelearningmastery.com/contact/" rel="nofollow">http://machinelearningmastery.com/contact/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=358136#respond" onclick='return addComment.moveForm( "comment-358136", "358136", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364972">
<div class="comment-container" id="li-comment-364972">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/063eb389bbba68859964d6226d194aea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/063eb389bbba68859964d6226d194aea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kamagne</span>
<span class="date">September 19, 2016 at 11:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-364972" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
I,ve copy and paste your Random Forest and then result is:<br/>
0.766814764183.<br/>
We don’t have the same result, could you tell me why?<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Kamagne" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=364972#respond" onclick='return addComment.moveForm( "comment-364972", "364972", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365031">
<div class="comment-container" id="li-comment-365031">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2016 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-365031" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I try to fix the random number seed Kamagne, but sometimes things get through.</p>
<p>The performance of any machine learning algorithm is stochastic, we estimate performance in the range. It is best practice to run a give configuration many times and take the mean and standard deviation – reporting the range of expected performance on unseen data.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=365031#respond" onclick='return addComment.moveForm( "comment-365031", "365031", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-371065">
<div class="comment-container" id="li-comment-371065">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/debf9847378ff9b252d2937d4af86ff5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/debf9847378ff9b252d2937d4af86ff5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Natheer Alabsi</span>
<span class="date">November 18, 2016 at 1:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-371065" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The ensembeled model gave lower accuracy compared to the individual models. Isn’t strange?</p>
<div class="reply">
<a aria-label="Reply to Natheer Alabsi" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=371065#respond" onclick='return addComment.moveForm( "comment-371065", "371065", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-371185">
<div class="comment-container" id="li-comment-371185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2016 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-371185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This can happen. Ensembles are not a sure-thing to better performance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=371185#respond" onclick='return addComment.moveForm( "comment-371185", "371185", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-376490">
<div class="comment-container" id="li-comment-376490">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3738c2d49d0b2f1788f650e426ae9606?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3738c2d49d0b2f1788f650e426ae9606?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marido</span>
<span class="date">December 20, 2016 at 11:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-376490" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In your Bagging Classifier you used Decision Tree Classifier as your base estimator. I was wondering what other algorithms can be used as base estimators?</p>
<div class="reply">
<a aria-label="Reply to Marido" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=376490#respond" onclick='return addComment.moveForm( "comment-376490", "376490", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-376585">
<div class="comment-container" id="li-comment-376585">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 21, 2016 at 8:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-376585" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question Marido,</p>
<p>With bagging, the goal is to use a method that has high variance when trained on different data. </p>
<p>Un-pruned decision trees can do this (and can be made to do it even better – see random forest).<br/>
Another idea would be knn with a small k. </p>
<p>In fact, take your favorite algorithm and configure it to have a high variance, then bag it.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=376585#respond" onclick='return addComment.moveForm( "comment-376585", "376585", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-384325">
<div class="comment-container" id="li-comment-384325">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c992788c18eed1bd2f878b28f26ba08?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c992788c18eed1bd2f878b28f26ba08?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Natheer Alabsi</span>
<span class="date">January 26, 2017 at 9:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-384325" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks so much for your insightful replies.</p>
<p>What I understand is that ensembles improve the result if they make different mistakes.<br/>
In my below result of two models. The first model performs well in one class while the second model performs well on the other class. When I ensemble them, I get lower accuracy. Is that possible or I am doing something wrong.</p>
<p>GBC<br/>
[[922035    266]</p>
<p>[     2            5]]</p>
<p>cart<br/>
[[895914  26387]</p>
<p>[     0               7]]</p>
<p>This is how how I am doing it.<br/>
estimators = []<br/>
model1 = GradientBoostingClassifier()<br/>
estimators.append((‘GBC’, model1))<br/>
model2 = DecisionTreeClassifier()<br/>
estimators.append((‘cart’, model2))</p>
<p>ensemble = VotingClassifier(estimators)<br/>
ensemble.fit(X_train, Y_train)<br/>
predictions = ensemble.predict(X_test)<br/>
accuracy1 = accuracy_score(Y_test, predictions)</p>
<div class="reply">
<a aria-label="Reply to Natheer Alabsi" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=384325#respond" onclick='return addComment.moveForm( "comment-384325", "384325", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-384489">
<div class="comment-container" id="li-comment-384489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 27, 2017 at 12:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-384489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Natheer,</p>
<p>There is no guarantee for ensembles to lift performance.</p>
<p>Perhaps you can try a more sophisticated method to combine the predictions or perhaps try more or different submodels.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=384489#respond" onclick='return addComment.moveForm( "comment-384489", "384489", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-384451">
<div class="comment-container" id="li-comment-384451">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c411ecfb3092bd52c275aaf80ed365f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c411ecfb3092bd52c275aaf80ed365f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Djib</span>
<span class="date">January 27, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-384451" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Many thanks for your post. It is possible to have two different base estimators (i.e. decision tree, knn) in AdaBoost model? </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Djib" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=384451#respond" onclick='return addComment.moveForm( "comment-384451", "384451", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-384508">
<div class="comment-container" id="li-comment-384508">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 27, 2017 at 12:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-384508" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not that I am aware in Python Djib.</p>
<p>I don’t see why not in theory. You could develop your own implementation and see how it fairs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=384508#respond" onclick='return addComment.moveForm( "comment-384508", "384508", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-384630">
<div class="comment-container" id="li-comment-384630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c411ecfb3092bd52c275aaf80ed365f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c411ecfb3092bd52c275aaf80ed365f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Djib</span>
<span class="date">January 28, 2017 at 4:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-384630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason</p>
<div class="reply">
<a aria-label="Reply to Djib" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=384630#respond" onclick='return addComment.moveForm( "comment-384630", "384630", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392461">
<div class="comment-container" id="li-comment-392461">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c60482bd25033c075e86b2fd63ae6fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c60482bd25033c075e86b2fd63ae6fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adnan Ardhian</span>
<span class="date">March 13, 2017 at 2:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-392461" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, </p>
<p>Why max_features is 3? what is it exactly? Thank you 😀</p>
<div class="reply">
<a aria-label="Reply to Adnan Ardhian" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=392461#respond" onclick='return addComment.moveForm( "comment-392461", "392461", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-392573">
<div class="comment-container" id="li-comment-392573">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-392573" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just for demonstration purposes. It limits the number of selected features to 3.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=392573#respond" onclick='return addComment.moveForm( "comment-392573", "392573", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395316">
<div class="comment-container" id="li-comment-395316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fc8bfa7d4608ad2d04b404ff0ed7b76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fc8bfa7d4608ad2d04b404ff0ed7b76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paige</span>
<span class="date">April 4, 2017 at 8:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-395316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I found one slight mishap. In the voting ensemble code, I notice is that in the voting ensemble code, on lines 22 and 23 it has </p>
<p>model3 = SVC()<br/>
estimators.append((‘svm’, model2))</p>
<p>I believe it should instead say model3 instead of model2, as model 3 is the svm stuff.</p>
<div class="reply">
<a aria-label="Reply to Paige" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=395316#respond" onclick='return addComment.moveForm( "comment-395316", "395316", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395339">
<div class="comment-container" id="li-comment-395339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-395339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=395339#respond" onclick='return addComment.moveForm( "comment-395339", "395339", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-399734">
<div class="comment-container" id="li-comment-399734">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d86ce043c560977af492717734fa9eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d86ce043c560977af492717734fa9eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">May 15, 2017 at 11:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-399734" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey! Thanks for the great post.</p>
<p>I would like to use voting with SVM as you did, however scaling data SVM gives me better results and it’s simply much faster.  And from here comes the question: How can I scale just parto of the data for algorithms such as SVM, and leave non-slcaed data for XGB/Random forest and on top of it use ensembles. I have tried using Pipeline to first scale the data for SVM and then use Voting but it seams not working.  Any comment would be helpful</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=399734#respond" onclick='return addComment.moveForm( "comment-399734", "399734", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399777">
<div class="comment-container" id="li-comment-399777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-399777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>You could leave the pipeline behind and put the pieces together yourself with a scaled version of the data for SVM and non-scaled for the other methods.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=399777#respond" onclick='return addComment.moveForm( "comment-399777", "399777", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402634">
<div class="comment-container" id="li-comment-402634">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e041d9365863d211e7cded4b128fb2c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e041d9365863d211e7cded4b128fb2c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sayak Paul</span>
<span class="date">June 15, 2017 at 10:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-402634" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could we take it further and build a Neural Network model with Keras and use it in the Voting based Ensemble learning? (After wrapping the Neural Network model into a Scikit Learn classifier)</p>
<div class="reply">
<a aria-label="Reply to Sayak Paul" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=402634#respond" onclick='return addComment.moveForm( "comment-402634", "402634", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402694">
<div class="comment-container" id="li-comment-402694">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 16, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-402694" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, try it and let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=402694#respond" onclick='return addComment.moveForm( "comment-402694", "402694", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402678">
<div class="comment-container" id="li-comment-402678">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7bcd65d74bd18af43f1c15fd39b0ac20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7bcd65d74bd18af43f1c15fd39b0ac20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanga</span>
<span class="date">June 16, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-402678" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason…Thanks for the wonderful post. Is there a way to perform bagging on neural net regression? A sample code or example would be much appreciated. Thanks.</p>
<div class="reply">
<a aria-label="Reply to Sanga" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=402678#respond" onclick='return addComment.moveForm( "comment-402678", "402678", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402707">
<div class="comment-container" id="li-comment-402707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 16, 2017 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-402707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. It may perform quite well. Sorry I do not have an example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=402707#respond" onclick='return addComment.moveForm( "comment-402707", "402707", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410423">
<div class="comment-container" id="li-comment-410423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa2cf1250f1b3b14833e07d3cc7607ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa2cf1250f1b3b14833e07d3cc7607ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Peter</span>
<span class="date">August 21, 2017 at 4:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-410423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! </p>
<p>Thank you for the great post! </p>
<p>I would like to make soft voting for a convolutional neural network and a gru recurrent neural network, but i have 2 problems.</p>
<p>1: I have 2 different training datasets to train my networks on: vectors of prosodic data, and word embeddings of textual data. The 2 training sets are stored in two different np.arrays with different dimensionality. Is there any way to make VotingClassifier accept X1,and X2 except of a single X? (y is the same for both X1 and X2, and naturally they are of the same length)</p>
<p>2: where do i compile my networks?   </p>
<p>ensemble = VotingClassifier(estimators)<br/>
ensemble.compile()<br/>
?</p>
<p>I would be very grateful for any help.<br/>
Thank you!</p>
<div class="reply">
<a aria-label="Reply to Peter" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=410423#respond" onclick='return addComment.moveForm( "comment-410423", "410423", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410430">
<div class="comment-container" id="li-comment-410430">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2017 at 4:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-410430" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You have a few options.</p>
<p>You could get each model to generate the predictions, save them to a file, then have another model learn how to combine the predictions, perhaps with or without the original inputs. </p>
<p>If the original inputs are high-dimensional (images and sequences), you could try training a neural net to combine the predictions as part of training each sub-model. You can merge each network using a Merge layer in Keras (deep learning library), if your sub-models were also developed in Keras.</p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=410430#respond" onclick='return addComment.moveForm( "comment-410430", "410430", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-410547">
<div class="comment-container" id="li-comment-410547">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa2cf1250f1b3b14833e07d3cc7607ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa2cf1250f1b3b14833e07d3cc7607ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Peter</span>
<span class="date">August 22, 2017 at 1:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-410547" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the quick reply! I ve already tried the layer merging. It works, but not giving good results because one of my feature sets yields significantly better recognition accuracy than the other.</p>
<p>But the first solution looks good! I will try and implement it!</p>
<p>Thanks for the help!</p>
<div class="reply">
<a aria-label="Reply to Peter" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=410547#respond" onclick='return addComment.moveForm( "comment-410547", "410547", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-410642">
<div class="comment-container" id="li-comment-410642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-410642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work Peter!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=410642#respond" onclick='return addComment.moveForm( "comment-410642", "410642", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411109">
<div class="comment-container" id="li-comment-411109">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/25b265b74985b99adb72feb37d48d8c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/25b265b74985b99adb72feb37d48d8c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mehmood</span>
<span class="date">August 25, 2017 at 10:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-411109" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can I use more than one base estimator in Bagging and adaboost eg Bagging(Knn, Logistic Regression, etc)?</p>
<div class="reply">
<a aria-label="Reply to Mehmood" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=411109#respond" onclick='return addComment.moveForm( "comment-411109", "411109", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411167">
<div class="comment-container" id="li-comment-411167">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2017 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-411167" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can do anything, but really this is only practical with bagging.</p>
<p>You want to pick base estimators that have low bias/high variance, like k=1 kNN, decision trees without pruning or decision stumps, etc.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=411167#respond" onclick='return addComment.moveForm( "comment-411167", "411167", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-412267">
<div class="comment-container" id="li-comment-412267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f67d37e5ba45c690ee78975a1eaa54d4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f67d37e5ba45c690ee78975a1eaa54d4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">amar</span>
<span class="date">September 2, 2017 at 6:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-412267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>what is the meaning of seed here? can you explain the importance of seed and how can some changes in the seed will affect the model? Thanks</p>
<div class="reply">
<a aria-label="Reply to amar" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=412267#respond" onclick='return addComment.moveForm( "comment-412267", "412267", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412344">
<div class="comment-container" id="li-comment-412344">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-412344" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Seed makes the example reproducible so you get the same results as me.</p>
<p>Machine learning algorithms are stochastic, meaning they give different results each time they are run. This is a feature, not a bug. See this post for more details:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=412344#respond" onclick='return addComment.moveForm( "comment-412344", "412344", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414859">
<div class="comment-container" id="li-comment-414859">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://k%20l%20university" rel="external nofollow">sajana</a></span>
<span class="date">September 26, 2017 at 7:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-414859" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi sir</p>
<p>i am unable to run the gradient boosting code on my dataset.</p>
<p>please help me.</p>
<p>see my parameters.</p>
<p>AGE	Haemoglobin	RBC	Hct	Mcv	Mch	Mchc	Platelets	WBC	Granuls	Lymphocytes	Monocytes	disese<br/>
3	9.6	4.2	28.2	67	22.7	33.9	3.75	5800	44	50	6	Positive<br/>
11	12.1	4.3	33.7	78	28.2	36	2.22	6100	73	23	4	Positive<br/>
2	9.5	4.1	27.9	67	22.8	34	3.64	5100	64	32	4	Positive<br/>
4	9.9	3.9	27.8	71	25.3	35.6	2.06	4900	65	32	3	Positive<br/>
14	10.7	4.4	31.2	70	24.2	34.4	3	7600	50	44	6	Negative<br/>
7	9.8	4.2	28	66	23.2	35.1	1.95	3800	28	63	9	Negative<br/>
8	14.6	5	39.2	77	28.7	37.2	3.06	4400	58	36	6	Negative<br/>
4	12	4.5	33.3	74	26.5	35.9	5.28	9500	40	54	6	Negative<br/>
2	11.2	4.6	32.7	70	24.1	34.3	2.98	8800	38	58	4	Negative<br/>
1	9.1	4	27.2	67	22.4	33.3	3.6	5300	40	55	5	Negative<br/>
11	14.8	5.8	42.5	72	25.1	34.8	4.51	17200	75	20	5	Negative</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=414859#respond" onclick='return addComment.moveForm( "comment-414859", "414859", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414892">
<div class="comment-container" id="li-comment-414892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 5:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-414892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the problem?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=414892#respond" onclick='return addComment.moveForm( "comment-414892", "414892", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415068">
<div class="comment-container" id="li-comment-415068">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://k%20l%20university" rel="external nofollow">sajana</a></span>
<span class="date">September 29, 2017 at 10:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415068" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi sir ,</p>
<p>problem is first i want to balance the dataset with SMOTE algorithm  but it is not happening.</p>
<p>see my code and help me.</p>
<p>import pandas<br/>
import matplotlib.pyplot as plt<br/>
import seaborn as sns<br/>
from sklearn.datasets import make_classification<br/>
from sklearn.decomposition import PCA</p>
<p>from imblearn.over_sampling import SMOTE</p>
<p>print(__doc__)</p>
<p>sns.set()</p>
<p># Define some color for the plotting<br/>
almost_black = ‘#262626’<br/>
palette = sns.color_palette()<br/>
data = (‘mdata.csv’)<br/>
dataframe = pandas.read_csv(data)<br/>
array = dataframe.values<br/>
X = array[:,0:12]<br/>
y = array[:,12]</p>
<p>#print (X_train, Y_train)</p>
<p># Generate the dataset<br/>
#X, y = make_classification(n_classes=2, class_sep=2, weights=[0.1, 0.9],<br/>
 #                          n_informative=3, n_redundant=1, flip_y=0,<br/>
  #                         n_features=10, n_clusters_per_class=1,<br/>
   #                        n_samples=500, random_state=10)<br/>
print (X, y)<br/>
plt.show()</p>
<p># Instanciate a PCA object for the sake of easy visualisation<br/>
pca = PCA(n_components=2)<br/>
# Fit and transform x to visualise inside a 2D feature space<br/>
X_vis = pca.fit_transform(X)</p>
<p># Apply regular SMOTE<br/>
sm = SMOTE(kind=’regular’)<br/>
X_resampled, y_resampled = sm.fit_sample(X, y)<br/>
X_res_vis = pca.transform(X_resampled)</p>
<p># Two subplots, unpack the axes array immediately<br/>
f, (ax1, ax2) = plt.subplots(1, 2)</p>
<p>ax1.scatter(X_vis[y == 0, 0], X_vis[y == 0, 1], label=”Class #0″, alpha=0.5,<br/>
            edgecolor=almost_black, facecolor=palette[0], linewidth=0.15)<br/>
ax1.scatter(X_vis[y == 1, 0], X_vis[y == 1, 1], label=”Class #1″, alpha=0.5,<br/>
            edgecolor=almost_black, facecolor=palette[2], linewidth=0.15)<br/>
ax1.set_title(‘Original set’)</p>
<p>ax2.scatter(X_res_vis[y_resampled == 0, 0], X_res_vis[y_resampled == 0, 1],<br/>
            label=”Class #0″, alpha=.5, edgecolor=almost_black,<br/>
            facecolor=palette[0], linewidth=0.15)<br/>
ax2.scatter(X_res_vis[y_resampled == 1, 0], X_res_vis[y_resampled == 1, 1],<br/>
            label=”Class #1″, alpha=.5, edgecolor=almost_black,<br/>
            facecolor=palette[2], linewidth=0.15)<br/>
ax2.set_title(‘SMOTE ALGORITHM – Malaria regular’)<br/>
“””<br/>
daata after resample<br/>
“””<br/>
print (X_resampled, y_resampled)<br/>
plt.show()</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415068#respond" onclick='return addComment.moveForm( "comment-415068", "415068", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415149">
<div class="comment-container" id="li-comment-415149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot debug your code for you. Perhaps you can post your code to stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415149#respond" onclick='return addComment.moveForm( "comment-415149", "415149", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415069">
<div class="comment-container" id="li-comment-415069">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://k%20l%20university" rel="external nofollow">sajana</a></span>
<span class="date">September 29, 2017 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415069" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i am getting the error : </p>
<p>File “/usr/local/lib/python2.7/dist-packages/imblearn/over_sampling/smote.py”, line 360, in _sample_regular<br/>
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]<br/>
  File “/home/sajana/.local/lib/python2.7/site-packages/sklearn/neighbors/base.py”, line 347, in kneighbors<br/>
    (train_size, n_neighbors)<br/>
ValueError: Expected n_neighbors &lt;= n_samples,  but n_samples = 5, n_neighbors = 6</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415069#respond" onclick='return addComment.moveForm( "comment-415069", "415069", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415150">
<div class="comment-container" id="li-comment-415150">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2017 at 7:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415150" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It looks like your k is larger than the number of instances in one class. You need to reduce k or increase the number of instances for the least represented class.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415150#respond" onclick='return addComment.moveForm( "comment-415150", "415150", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415728">
<div class="comment-container" id="li-comment-415728">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sajana</span>
<span class="date">October 5, 2017 at 7:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415728" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i cleared the error sir </p>
<p>but when i work with Gradientboosting  it doesn’t work even though my dataset contains 2 classes as shown in the above discussion.</p>
<p>error : binomial deviance require 2 classes</p>
<p>and code :<br/>
import pandas<br/>
import matplotlib.pyplot as plt<br/>
from sklearn import model_selection<br/>
from sklearn.ensemble import GradientBoostingClassifier<br/>
from sklearn.metrics import accuracy_score<br/>
data = (‘dataset160.csv’)<br/>
dataframe = pandas.read_csv(data)<br/>
array = dataframe.values<br/>
X = array[:,0:12]<br/>
Y = array[:,12]<br/>
print (X, Y)<br/>
plt.show()<br/>
seed = 7<br/>
num_trees = 100<br/>
kfold = model_selection.KFold(n_splits=10, random_state=seed)<br/>
model = GradientBoostingClassifier(n_estimators=num_trees, random_state=seed)<br/>
results = model_selection.cross_val_score(model, X, Y, cv=kfold)<br/>
print(results.mean())<br/>
print(results)</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415728#respond" onclick='return addComment.moveForm( "comment-415728", "415728", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415769">
<div class="comment-container" id="li-comment-415769">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415769" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you need to transform your class variable from numeric to being a label.</p>
<p>sklearn has a label encoder you can use:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415769#respond" onclick='return addComment.moveForm( "comment-415769", "415769", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415815">
<div class="comment-container" id="li-comment-415815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sajana</span>
<span class="date">October 6, 2017 at 11:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sir, i have already labelled data set , </p>
<p>i am unable to run the gradient boosting code on my dataset.</p>
<p>please help me.</p>
<p>see my parameters.</p>
<p>AGE Haemoglobin RBC Hct Mcv Mch Mchc Platelets WBC Granuls Lymphocytes Monocytes disese<br/>
3 9.6 4.2 28.2 67 22.7 33.9 3.75 5800 44 50 6 Positive<br/>
11 12.1 4.3 33.7 78 28.2 36 2.22 6100 73 23 4 Positive<br/>
2 9.5 4.1 27.9 67 22.8 34 3.64 5100 64 32 4 Positive<br/>
4 9.9 3.9 27.8 71 25.3 35.6 2.06 4900 65 32 3 Positive<br/>
14 10.7 4.4 31.2 70 24.2 34.4 3 7600 50 44 6 Negative<br/>
7 9.8 4.2 28 66 23.2 35.1 1.95 3800 28 63 9 Negative<br/>
8 14.6 5 39.2 77 28.7 37.2 3.06 4400 58 36 6 Negative<br/>
4 12 4.5 33.3 74 26.5 35.9 5.28 9500 40 54 6 Negative<br/>
2 11.2 4.6 32.7 70 24.1 34.3 2.98 8800 38 58 4 Negative<br/>
1 9.1 4 27.2 67 22.4 33.3 3.6 5300 40 55 5 Negative<br/>
11 14.8 5.8 42.5 72 25.1 34.8 4.51 17200 75 20 5 Negative</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415815#respond" onclick='return addComment.moveForm( "comment-415815", "415815", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415878">
<div class="comment-container" id="li-comment-415878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-415878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this tutorial will help you get started:<br/>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" rel="nofollow">https://machinelearningmastery.com/machine-learning-in-python-step-by-step/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=415878#respond" onclick='return addComment.moveForm( "comment-415878", "415878", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416428">
<div class="comment-container" id="li-comment-416428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sajana</span>
<span class="date">October 12, 2017 at 7:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-416428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you sir.<br/>
sir i have a small doubt.</p>
<p>is that XGBoost algorithm is best or SMOTEBoost algorithm is best to handle skewed data.</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=416428#respond" onclick='return addComment.moveForm( "comment-416428", "416428", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416484">
<div class="comment-container" id="li-comment-416484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-416484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try both on your specific dataset and see what works best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=416484#respond" onclick='return addComment.moveForm( "comment-416484", "416484", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417180">
<div class="comment-container" id="li-comment-417180">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sajana</span>
<span class="date">October 19, 2017 at 7:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-417180" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you so much sir,</p>
<p>finally i have a doubt sir.<br/>
when i run the prediction code using adaboost i am getting 0.0%prediction accuracy .</p>
<p>for the code : </p>
<p>model = AdaBoostClassifier(n_estimators=num_trees, random_state=seed)<br/>
results = model_selection.cross_val_score(model, X, Y, cv=kfold)<br/>
model.fit(X, Y)<br/>
print(‘learning accuracy’)<br/>
print(results.mean())<br/>
predictions = model.predict(A)<br/>
print(predictions)<br/>
accuracy1 = accuracy_score(B, predictions)<br/>
print(“Accuracy % is “)<br/>
print(accuracy1*100)</p>
<p>anything wrong in the code . always i am getting 0.0.%accuracy and precision recall also 0% for any ensemble like boosting , bagging.<br/>
kindly rectify sir.</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=417180#respond" onclick='return addComment.moveForm( "comment-417180", "417180", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417213">
<div class="comment-container" id="li-comment-417213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-417213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It’s not clear. Perhaps try a suite of algorithms and see what works best on your problem. I recommend this process:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=417213#respond" onclick='return addComment.moveForm( "comment-417213", "417213", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419143">
<div class="comment-container" id="li-comment-419143">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ebf61dd7a7304f05808875f8c44e50d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ebf61dd7a7304f05808875f8c44e50d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://NA" rel="external nofollow">Amos Bunde</a></span>
<span class="date">November 6, 2017 at 8:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-419143" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dr. Jason you ARE doing a great job in machine learning.</p>
<div class="reply">
<a aria-label="Reply to Amos Bunde" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=419143#respond" onclick='return addComment.moveForm( "comment-419143", "419143", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419195">
<div class="comment-container" id="li-comment-419195">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-419195" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Amos, I really appreciate your support!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=419195#respond" onclick='return addComment.moveForm( "comment-419195", "419195", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-421109">
<div class="comment-container" id="li-comment-421109">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/49def84c6133bbfa3c9a537d87aaf5a7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/49def84c6133bbfa3c9a537d87aaf5a7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rohith R Nair</span>
<span class="date">November 25, 2017 at 1:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-421109" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks a lot for the great article. You are an inspiration.</p>
<p>Is there a way I could measure the performance impact of the different ensemble methods?</p>
<p>For me, the VotingClassifier took more time than the others. If there is a metric could you please help identify which is faster and has the least performance implications when working with larger datasets?</p>
<div class="reply">
<a aria-label="Reply to Rohith R Nair" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=421109#respond" onclick='return addComment.moveForm( "comment-421109", "421109", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421143">
<div class="comment-container" id="li-comment-421143">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-421143" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I would recommend a robust test harness such as repeated cross validation, see here:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=421143#respond" onclick='return addComment.moveForm( "comment-421143", "421143", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-422337">
<div class="comment-container" id="li-comment-422337">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sajana</span>
<span class="date">December 7, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-422337" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>will you please show how to use CostSensitiveRandomForestClassifier()<br/>
on a dataset. i can’t run the code sir.</p>
<div class="reply">
<a aria-label="Reply to sajana" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=422337#respond" onclick='return addComment.moveForm( "comment-422337", "422337", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422364">
<div class="comment-container" id="li-comment-422364">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-422364" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=422364#respond" onclick='return addComment.moveForm( "comment-422364", "422364", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422727">
<div class="comment-container" id="li-comment-422727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/852a5c2d2d9c2d892d4d177f5dc51acc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">T.SAJANA</span>
<span class="date">December 11, 2017 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-422727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>r u have any sample code ….. on costsensitive ensemble method</p>
<div class="reply">
<a aria-label="Reply to T.SAJANA" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=422727#respond" onclick='return addComment.moveForm( "comment-422727", "422727", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422764">
<div class="comment-container" id="li-comment-422764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 4:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-422764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not at this stage, thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=422764#respond" onclick='return addComment.moveForm( "comment-422764", "422764", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425518">
<div class="comment-container" id="li-comment-425518">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3f863a01d72248e79652023db3ee6e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3f863a01d72248e79652023db3ee6e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aniket Saxena</span>
<span class="date">January 3, 2018 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425518" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have following queries :-</p>
<p>1. As bagging method only works for high variance so don’t you think that while using bagging we actually reducing overfitting as it occurs when we have low bias and high variance in our model?</p>
<p>2. Since random forest is used to lower the correlation between individual classifiers as we have in bagging approach. So, is this also leads to reduce the overfitting in our model by reducing correlation?</p>
<p>3. Can you please refer me a way to study thoroughly about stack aggregation?</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Aniket Saxena" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425518#respond" onclick='return addComment.moveForm( "comment-425518", "425518", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425569">
<div class="comment-container" id="li-comment-425569">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425569" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Bagging can reduce overfitting.</p>
<p>RF often performs better than bagging.</p>
<p>Here’s a post on stacking:<br/>
<a href="https://machinelearningmastery.com/implementing-stacking-scratch-python/" rel="nofollow">https://machinelearningmastery.com/implementing-stacking-scratch-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425569#respond" onclick='return addComment.moveForm( "comment-425569", "425569", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425691">
<div class="comment-container" id="li-comment-425691">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6eb653b378dbf5bdb4de4eee056fcfbf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6eb653b378dbf5bdb4de4eee056fcfbf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Max</span>
<span class="date">January 5, 2018 at 10:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425691" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot Jason!  great content as always!</p>
<p>I have a couple of questions:</p>
<p>1) Does more advanced methods that learn how to best weight the predictions from submodels (i.e Stacking) always give better results than simpler ensembling techniques?</p>
<p>2) I read in your post on stacking that it works better  if the predictions of submodels are weakly correlated. Does it mean that it is better to train submodels from different families? (for example: a SVM model, a RF and a neural net)<br/>
Can I build an Aggregated model using stacking with Xgboost, LigthGBM, GBM? </p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Max" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425691#respond" onclick='return addComment.moveForm( "comment-425691", "425691", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425698">
<div class="comment-container" id="li-comment-425698">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 11:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425698" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, ensembles are not always better, but if used carefully often are.</p>
<p>Yes, different families of models, different input features, etc.</p>
<p>Sure, you can try anything, just ensure you have a robust test harness.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425698#respond" onclick='return addComment.moveForm( "comment-425698", "425698", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425816">
<div class="comment-container" id="li-comment-425816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6eb653b378dbf5bdb4de4eee056fcfbf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6eb653b378dbf5bdb4de4eee056fcfbf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Max</span>
<span class="date">January 7, 2018 at 7:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thanks for your answer. I have two more questions:</p>
<p>1) What kind of test can I use in order to ensure the robustness of my ensembled model?</p>
<p>2) How do you deal with imbalanced classes in this context?</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Max" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425816#respond" onclick='return addComment.moveForm( "comment-425816", "425816", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425845">
<div class="comment-container" id="li-comment-425845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-425845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Repeated cross validation is a good approach to evaluating model skill:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>I have some ideas on working with imbalanced data here:<br/>
<a href="https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=425845#respond" onclick='return addComment.moveForm( "comment-425845", "425845", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426282">
<div class="comment-container" id="li-comment-426282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/119436e38c5b2786a1515f9b6a29af48?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/119436e38c5b2786a1515f9b6a29af48?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Janio</span>
<span class="date">January 12, 2018 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-426282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I have a question with regards to a specific hyperparameter the “base_estimator” of AdaBoostClassifier. Is there a way for me to ensemble several models (For instance: DecisionTreeClassifier, KNeighborsClassifier, and SVC) into the base_estimator hyperparameter? Cause I have seen most people implementing only one model but the main concept of AdaBoostClassifiers is to train different classifiers into an ensemble giving  more weigh to incorrect classifications and correct prediction models through the use of bagging. Basically, I just want to know if this is possible to add several classifiers into the base_estimator hyperparameter. Thanks for the help and nice post!</p>
<div class="reply">
<a aria-label="Reply to Janio" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=426282#respond" onclick='return addComment.moveForm( "comment-426282", "426282", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426299">
<div class="comment-container" id="li-comment-426299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 11:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/#comment-426299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, but I don’t think so. I’d recommend stacking or voting instead.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/?replytocom=426299#respond" onclick='return addComment.moveForm( "comment-426299", "426299", "respond", "2475" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/ensemble-machine-learning-algorithms-python-scikit-learn/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2475"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="1c084501ad"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="206"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-10"> <div class="textwidget"><p></p><center>
<h3>Develop Predictive Models With Python</h3>
<p>Want to develop your own models in scikit-learn?<br/>
Want step-by-step tutorials?<br/>
Looking for sample code and templates?</p>
<p><a href="https://machinelearningmastery.com/machine-learning-with-python/">Get Started With Machine Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/machine-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/07/MachineLearningMasteryWithPython-220px.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>