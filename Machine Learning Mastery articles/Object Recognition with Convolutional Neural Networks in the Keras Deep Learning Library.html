<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Object Recognition with Convolutional Neural Networks in the Keras Deep Learning Library - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Object Recognition with Convolutional Neural Networks in the Keras Deep Learning Library - Machine Learning Mastery" property="og:title"/>
<meta content="Keras is a Python library for deep learning that wraps the powerful numerical libraries Theano and TensorFlow. A difficult problem where traditional neural networks fall down is called object recognition. It is where a model is able to identify the objects in images. In this post, you will discover how to develop and evaluate deep …" property="og:description"/>
<meta content="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-07-01T05:00:24+11:00" property="article:published_time"/>
<meta content="2017-03-31T10:30:24+11:00" property="article:modified_time"/>
<meta content="2017-03-31T10:30:24+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images.png" property="og:image:secure_url"/>
<meta content="800" property="og:image:width"/>
<meta content="600" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/object-recognition-convolutional-neural-networks-keras-deep-learning-library\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/feed/" rel="alternate" title="Machine Learning Mastery » Object Recognition with Convolutional Neural Networks in the Keras Deep Learning Library Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2596" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fobject-recognition-convolutional-neural-networks-keras-deep-learning-library%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fobject-recognition-convolutional-neural-networks-keras-deep-learning-library%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2596 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2596 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Object Recognition with Convolutional Neural Networks in the Keras Deep Learning Library</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-07-01T05:00:24+1100">July 1, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fobject-recognition-convolutional-neural-networks-keras-deep-learning-library%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/&amp;summary=Keras+is+a+Python+library+for+deep+learning+that+wraps+the+powerful+numerical+libraries+Theano+and+T..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/&amp;summary=Keras+is+a+Python+library+for+deep+learning+that+wraps+the+powerful+numerical+libraries+Theano+and+T...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Keras is a Python library for deep learning that wraps the powerful numerical libraries Theano and TensorFlow.</p>
<p>A difficult problem where traditional neural networks fall down is called object recognition. It is where a model is able to identify the objects in images.</p>
<p>In this post, you will discover how to develop and evaluate deep learning models for object recognition in Keras. After completing this tutorial you will know:</p>
<ul>
<li>About the CIFAR-10 object recognition dataset and how to load and use it in Keras.</li>
<li>How to create a simple Convolutional Neural Network for object recognition.</li>
<li>How to lift performance by creating deeper Convolutional Neural Networks.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 and TensorFlow 0.10.0.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<h2>The CIFAR-10 Problem Description</h2>
<p>The problem of automatically identifying objects in photographs is difficult because of the near infinite number of permutations of objects, positions, lighting and so on. It’s a really hard problem.</p>
<p>This is a well-studied problem in computer vision and more recently an important demonstration of the capability of deep learning. A standard computer vision and deep learning dataset for this problem was developed by the <a href="https://en.wikipedia.org/wiki/Canadian_Institute_for_Advanced_Research">Canadian Institute for Advanced Research (CIFAR)</a>.</p>
<p>The <a href="http://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10 dataset</a> consists of 60,000 photos divided into 10 classes (hence the name CIFAR-10). Classes include common objects such as airplanes, automobiles, birds, cats and so on. The dataset is split in a standard way, where 50,000 images are used for training a model and the remaining 10,000 for evaluating its performance.</p>
<p>The photos are in color with red, green and blue components, but are small measuring 32 by 32 pixel squares.</p>
<p>State of the art results are achieved using very large Convolutional Neural networks. You can learn about state of the are results on <a href="http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html#43494641522d3130">CIFAR-10 on Rodrigo Benenson’s webpage</a>. Model performance is reported in classification accuracy, with very good performance above 90% with human performance on the problem at 94% and state-of-the-art results at 96% at the time of writing.</p>
<p>There is a <a href="https://www.kaggle.com/c/cifar-10">Kaggle competition that makes use of the CIFAR-10 dataset</a>. It is a good place to join the discussion of developing new models for the problem and picking up models and scripts as a starting point.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>Loading The CIFAR-10 Dataset in Keras</h2>
<p>The CIFAR-10 dataset can easily be loaded in Keras.</p>
<p>Keras has the facility to automatically download standard datasets like CIFAR-10 and store them in the ~/.keras/datasets directory using the cifar10.load_data() function. This dataset is large at 163 megabytes, so it may take a few minutes to download.</p>
<p>Once downloaded, subsequent calls to the function will load the dataset ready for use.</p>
<p>The dataset is stored as pickled training and test sets, ready for use in Keras. Each image is represented as a three dimensional matrix, with dimensions for red, green, blue, width and height. We can plot images directly using <a href="http://matplotlib.org/">matplotlib</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7d6554720860" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Plot ad hoc CIFAR10 instances
from keras.datasets import cifar10
from matplotlib import pyplot
from scipy.misc import toimage
# load data
(X_train, y_train), (X_test, y_test) = cifar10.load_data()
# create a grid of 3x3 images
for i in range(0, 9):
	pyplot.subplot(330 + 1 + i)
	pyplot.imshow(toimage(X_train[i]))
# show the plot
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad7d6554720860-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7d6554720860-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7d6554720860-1"><span class="crayon-p"># Plot ad hoc CIFAR10 instances</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">cifar10</span></div><div class="crayon-line" id="crayon-5a659276ad7d6554720860-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-4"><span class="crayon-e">from </span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-e">misc </span><span class="crayon-e">import </span><span class="crayon-v">toimage</span></div><div class="crayon-line" id="crayon-5a659276ad7d6554720860-5"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-6"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cifar10</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7d6554720860-7"><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659276ad7d6554720860-9"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-10"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-e">toimage</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7d6554720860-11"><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7d6554720860-12"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Running the code create a 3×3 plot of photographs. The images have been scaled up from their small 32×32 size, but you can clearly see trucks horses and cars. You can also see some distortion in some images that have been forced to the square aspect ratio.</p>
<div class="wp-caption aligncenter" id="attachment_2597" style="max-width: 810px"><img alt="Small Sample of CIFAR-10 Images" class="size-full wp-image-2597" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/cifar10-sample-images-768x576.png 768w" width="800"/><p class="wp-caption-text">Small Sample of CIFAR-10 Images</p></div>
<h2>Simple Convolutional Neural Network for CIFAR-10</h2>
<p>The CIFAR-10 problem is best solved using a Convolutional Neural Network (CNN).</p>
<p>We can quickly start off by defining all of the classes and functions we will need in this example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7ed240537186" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Simple CNN model for CIFAR-10
import numpy
from keras.datasets import cifar10
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from keras.layers import Flatten
from keras.constraints import maxnorm
from keras.optimizers import SGD
from keras.layers.convolutional import Conv2D
from keras.layers.convolutional import MaxPooling2D
from keras.utils import np_utils
from keras import backend as K
K.set_image_dim_ordering('th')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad7ed240537186-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7ed240537186-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7ed240537186-1"><span class="crayon-p"># Simple CNN model for CIFAR-10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">cifar10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">constraints </span><span class="crayon-e">import </span><span class="crayon-e">maxnorm</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">SGD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">np_utils</span></div><div class="crayon-line" id="crayon-5a659276ad7ed240537186-13"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7ed240537186-14"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>As is good practice, we next initialize the random number seed with a constant to ensure the results are reproducible.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7f1490168359" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7f1490168359-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f1490168359-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7f1490168359-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7f1490168359-1"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f1490168359-2"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a659276ad7f1490168359-3"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Next we can load the CIFAR-10 dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7f4319273060" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load data
(X_train, y_train), (X_test, y_test) = cifar10.load_data()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7f4319273060-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f4319273060-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7f4319273060-1"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f4319273060-2"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cifar10</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The pixel values are in the range of 0 to 255 for each of the red, green and blue channels.</p>
<p>It is good practice to work with normalized data. Because the input values are well understood, we can easily normalize to the range 0 to 1 by dividing each value by the maximum observation which is 255.</p>
<p>Note, the data is loaded as integers, so we must cast it to floating point values in order to perform the division.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7f6154002954" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# normalize inputs from 0-255 to 0.0-1.0
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
X_train = X_train / 255.0
X_test = X_test / 255.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7f6154002954-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f6154002954-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7f6154002954-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f6154002954-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad7f6154002954-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7f6154002954-1"><span class="crayon-p"># normalize inputs from 0-255 to 0.0-1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f6154002954-2"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7f6154002954-3"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f6154002954-4"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="crayon-5a659276ad7f6154002954-5"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The output variables are defined as a vector of integers from 0 to 1 for each class.</p>
<p>We can use a one hot encoding to transform them into a binary matrix in order to best model the classification problem. We know there are 10 classes for this problem, so we can expect the binary matrix to have a width of 10.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7f9086944140" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# one hot encode outputs
y_train = np_utils.to_categorical(y_train)
y_test = np_utils.to_categorical(y_test)
num_classes = y_test.shape[1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7f9086944140-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f9086944140-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7f9086944140-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7f9086944140-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7f9086944140-1"><span class="crayon-p"># one hot encode outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f9086944140-2"><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np_utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7f9086944140-3"><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np_utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7f9086944140-4"><span class="crayon-v">num_classes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Let’s start off by defining a simple CNN structure as a baseline and evaluate how well it performs on the problem.</p>
<p>We will use a structure with two convolutional layers followed by max pooling and a flattening out of the network to fully connected layers to make predictions.</p>
<p>Our baseline network structure can be summarized as follows:</p>
<ol>
<li>Convolutional input layer, 32 feature maps with a size of 3×3, a rectifier activation function and a weight constraint of max norm set to 3.</li>
<li>Dropout set to 20%.</li>
<li>Convolutional layer, 32 feature maps with a size of 3×3, a rectifier activation function and a weight constraint of max norm set to 3.</li>
<li>Max Pool layer with size 2×2.</li>
<li>Flatten layer.</li>
<li>Fully connected layer with 512 units and a rectifier activation function.</li>
<li>Dropout set to 50%.</li>
<li>Fully connected output layer with 10 units and a softmax activation function.</li>
</ol>
<p>A logarithmic loss function is used with the stochastic gradient descent optimization algorithm configured with a large momentum and weight decay start with a learning rate of 0.01.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad7fc301220447" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create the model
model = Sequential()
model.add(Conv2D(32, (3, 3), input_shape=(3, 32, 32), padding='same', activation='relu', kernel_constraint=maxnorm(3)))
model.add(Dropout(0.2))
model.add(Conv2D(32, (3, 3), activation='relu', padding='same', kernel_constraint=maxnorm(3)))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Flatten())
model.add(Dense(512, activation='relu', kernel_constraint=maxnorm(3)))
model.add(Dropout(0.5))
model.add(Dense(num_classes, activation='softmax'))
# Compile model
epochs = 25
lrate = 0.01
decay = lrate/epochs
sgd = SGD(lr=lrate, momentum=0.9, decay=decay, nesterov=False)
model.compile(loss='categorical_crossentropy', optimizer=sgd, metrics=['accuracy'])
print(model.summary())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-14">14</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad7fc301220447-16">16</div><div class="crayon-num" data-line="crayon-5a659276ad7fc301220447-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad7fc301220447-1"><span class="crayon-p"># Create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">512</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-10"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">num_classes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-11"><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-12"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-13"><span class="crayon-v">lrate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-14"><span class="crayon-v">decay</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-o">/</span><span class="crayon-e">epochs</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-15"><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decay</span><span class="crayon-o">=</span><span class="crayon-v">decay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nesterov</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad7fc301220447-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad7fc301220447-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>We can fit this model with 25 epochs and a batch size of 32.</p>
<p>A small number of epochs was chosen to help keep this tutorial moving. Normally the number of epochs would be one or two orders of magnitude larger for this problem.</p>
<p>Once the model is fit, we evaluate it on the test dataset and print out the classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad800763295709" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Fit the model
model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=epochs, batch_size=32)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad800763295709-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad800763295709-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad800763295709-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad800763295709-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad800763295709-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad800763295709-1"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad800763295709-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad800763295709-3"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad800763295709-4"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad800763295709-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Running this example provides the results below. First the network structure is summarized which confirms our design was implemented correctly.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad803877206803" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 32, 32, 32)        896       
_________________________________________________________________
dropout_1 (Dropout)          (None, 32, 32, 32)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 32, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 16, 16)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 8192)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               4194816   
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 10)                5130      
=================================================================
Total params: 4,210,090.0
Trainable params: 4,210,090.0
Non-trainable params: 0.0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad803877206803-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-14">14</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-16">16</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-18">18</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-20">20</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad803877206803-22">22</div><div class="crayon-num" data-line="crayon-5a659276ad803877206803-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad803877206803-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-2">Layer (type)                 Output Shape              Param #   </div><div class="crayon-line" id="crayon-5a659276ad803877206803-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-4">conv2d_1 (Conv2D)            (None, 32, 32, 32)        896       </div><div class="crayon-line" id="crayon-5a659276ad803877206803-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-6">dropout_1 (Dropout)          (None, 32, 32, 32)        0         </div><div class="crayon-line" id="crayon-5a659276ad803877206803-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-8">conv2d_2 (Conv2D)            (None, 32, 32, 32)        9248      </div><div class="crayon-line" id="crayon-5a659276ad803877206803-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-10">max_pooling2d_1 (MaxPooling2 (None, 32, 16, 16)        0         </div><div class="crayon-line" id="crayon-5a659276ad803877206803-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-12">flatten_1 (Flatten)          (None, 8192)              0         </div><div class="crayon-line" id="crayon-5a659276ad803877206803-13">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-14">dense_1 (Dense)              (None, 512)               4194816   </div><div class="crayon-line" id="crayon-5a659276ad803877206803-15">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-16">dropout_2 (Dropout)          (None, 512)               0         </div><div class="crayon-line" id="crayon-5a659276ad803877206803-17">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-18">dense_2 (Dense)              (None, 10)                5130      </div><div class="crayon-line" id="crayon-5a659276ad803877206803-19">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-20">Total params: 4,210,090.0</div><div class="crayon-line" id="crayon-5a659276ad803877206803-21">Trainable params: 4,210,090.0</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad803877206803-22">Non-trainable params: 0.0</div><div class="crayon-line" id="crayon-5a659276ad803877206803-23">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The classification accuracy and loss is printed each epoch on both the training and test datasets. The model is evaluated on the test set and achieves an accuracy of 70.85%, which is not excellent.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad806218232804" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 20/25
50000/50000 [==============================] - 143s - loss: 0.2858 - acc: 0.9011 - val_loss: 1.0091 - val_acc: 0.7063
Epoch 21/25
50000/50000 [==============================] - 143s - loss: 0.2693 - acc: 0.9067 - val_loss: 1.0122 - val_acc: 0.7069
Epoch 22/25
50000/50000 [==============================] - 143s - loss: 0.2544 - acc: 0.9119 - val_loss: 1.0240 - val_acc: 0.7097
Epoch 23/25
50000/50000 [==============================] - 143s - loss: 0.2399 - acc: 0.9168 - val_loss: 1.0680 - val_acc: 0.7077
Epoch 24/25
50000/50000 [==============================] - 143s - loss: 0.2285 - acc: 0.9197 - val_loss: 1.0702 - val_acc: 0.7119
Epoch 25/25
50000/50000 [==============================] - 143s - loss: 0.2177 - acc: 0.9238 - val_loss: 1.0686 - val_acc: 0.7085
Accuracy: 70.85%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad806218232804-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad806218232804-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad806218232804-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad806218232804-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-2">Epoch 20/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-3">50000/50000 [==============================] - 143s - loss: 0.2858 - acc: 0.9011 - val_loss: 1.0091 - val_acc: 0.7063</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-4">Epoch 21/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-5">50000/50000 [==============================] - 143s - loss: 0.2693 - acc: 0.9067 - val_loss: 1.0122 - val_acc: 0.7069</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-6">Epoch 22/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-7">50000/50000 [==============================] - 143s - loss: 0.2544 - acc: 0.9119 - val_loss: 1.0240 - val_acc: 0.7097</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-8">Epoch 23/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-9">50000/50000 [==============================] - 143s - loss: 0.2399 - acc: 0.9168 - val_loss: 1.0680 - val_acc: 0.7077</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-10">Epoch 24/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-11">50000/50000 [==============================] - 143s - loss: 0.2285 - acc: 0.9197 - val_loss: 1.0702 - val_acc: 0.7119</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-12">Epoch 25/25</div><div class="crayon-line" id="crayon-5a659276ad806218232804-13">50000/50000 [==============================] - 143s - loss: 0.2177 - acc: 0.9238 - val_loss: 1.0686 - val_acc: 0.7085</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad806218232804-14">Accuracy: 70.85%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can improve the accuracy significantly by creating a much deeper network. This is what we will look at in the next section.</p>
<h2>Larger Convolutional Neural Network for CIFAR-10</h2>
<p>We have seen that a simple CNN performs poorly on this complex problem. In this section we look at scaling up the size and complexity of our model.</p>
<p>Let’s design a deep version of the simple CNN above. We can introduce an additional round of convolutions with many more feature maps. We will use the same pattern of Convolutional, Dropout, Convolutional and Max Pooling layers.</p>
<p>This pattern will be repeated 3 times with 32, 64, and 128 feature maps. The effect be an increasing number of feature maps with a smaller and smaller size given the max pooling layers. Finally an additional and larger Dense layer will be used at the output end of the network in an attempt to better translate the large number feature maps to class values.</p>
<p>We can summarize a new network architecture as follows:</p>
<ul>
<li>Convolutional input layer, 32 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Dropout layer at 20%.</li>
<li>Convolutional layer, 32 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Max Pool layer with size 2×2.</li>
<li>Convolutional layer, 64 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Dropout layer at 20%.</li>
<li>Convolutional layer, 64 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Max Pool layer with size 2×2.</li>
<li>Convolutional layer, 128 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Dropout layer at 20%.</li>
<li>Convolutional layer,128 feature maps with a size of 3×3 and a rectifier activation function.</li>
<li>Max Pool layer with size 2×2.</li>
<li>Flatten layer.</li>
<li>Dropout layer at 20%.</li>
<li>Fully connected layer with 1024 units and a rectifier activation function.</li>
<li>Dropout layer at 20%.</li>
<li>Fully connected layer with 512 units and a rectifier activation function.</li>
<li>Dropout layer at 20%.</li>
<li>Fully connected output layer with 10 units and a softmax activation function.</li>
</ul>
<p>We can very easily define this network topology in Keras, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad80a909507599" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create the model
model = Sequential()
model.add(Conv2D(32, (3, 3), input_shape=(3, 32, 32), activation='relu', padding='same'))
model.add(Dropout(0.2))
model.add(Conv2D(32, (3, 3), activation='relu', padding='same'))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Conv2D(64, (3, 3), activation='relu', padding='same'))
model.add(Dropout(0.2))
model.add(Conv2D(64, (3, 3), activation='relu', padding='same'))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Conv2D(128, (3, 3), activation='relu', padding='same'))
model.add(Dropout(0.2))
model.add(Conv2D(128, (3, 3), activation='relu', padding='same'))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Flatten())
model.add(Dropout(0.2))
model.add(Dense(1024, activation='relu', kernel_constraint=maxnorm(3)))
model.add(Dropout(0.2))
model.add(Dense(512, activation='relu', kernel_constraint=maxnorm(3)))
model.add(Dropout(0.2))
model.add(Dense(num_classes, activation='softmax'))
# Compile model
epochs = 25
lrate = 0.01
decay = lrate/epochs
sgd = SGD(lr=lrate, momentum=0.9, decay=decay, nesterov=False)
model.compile(loss='categorical_crossentropy', optimizer=sgd, metrics=['accuracy'])
print(model.summary())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-14">14</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-16">16</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-18">18</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-20">20</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-22">22</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-24">24</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-26">26</div><div class="crayon-num" data-line="crayon-5a659276ad80a909507599-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80a909507599-28">28</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad80a909507599-1"><span class="crayon-p"># Create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-10"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-11"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-12"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-13"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-14"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-15"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1024</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">512</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-20"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">num_classes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-22"><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-23"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-24"><span class="crayon-v">lrate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-25"><span class="crayon-v">decay</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-o">/</span><span class="crayon-e">epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-26"><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decay</span><span class="crayon-o">=</span><span class="crayon-v">decay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nesterov</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80a909507599-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80a909507599-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>We can fit and evaluate this model using the same a procedure above and the same number of epochs but a larger batch size of 64, found through some minor experimentation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad80d915495626" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
numpy.random.seed(seed)
model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=epochs, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad80d915495626-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80d915495626-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad80d915495626-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad80d915495626-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad80d915495626-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad80d915495626-1"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80d915495626-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80d915495626-3"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad80d915495626-4"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276ad80d915495626-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Running this example prints the classification accuracy and loss on the training and test datasets each epoch. The estimate of classification accuracy for the final model is 80.18% which is nearly 10 points better than our simpler model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276ad810686408969" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# 50000/50000 [==============================] - 34s - loss: 0.4993 - acc: 0.8230 - val_loss: 0.5994 - val_acc: 0.7932
# Epoch 20/25
# 50000/50000 [==============================] - 34s - loss: 0.4877 - acc: 0.8271 - val_loss: 0.5986 - val_acc: 0.7932
# Epoch 21/25
# 50000/50000 [==============================] - 34s - loss: 0.4714 - acc: 0.8327 - val_loss: 0.5916 - val_acc: 0.7959
# Epoch 22/25
# 50000/50000 [==============================] - 34s - loss: 0.4603 - acc: 0.8376 - val_loss: 0.5954 - val_acc: 0.8003
# Epoch 23/25
# 50000/50000 [==============================] - 34s - loss: 0.4454 - acc: 0.8410 - val_loss: 0.5742 - val_acc: 0.8024
# Epoch 24/25
# 50000/50000 [==============================] - 34s - loss: 0.4332 - acc: 0.8468 - val_loss: 0.5829 - val_acc: 0.8027
# Epoch 25/25
# 50000/50000 [==============================] - 34s - loss: 0.4217 - acc: 0.8498 - val_loss: 0.5785 - val_acc: 0.8018
# Accuracy: 80.18%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276ad810686408969-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-2">2</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-4">4</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-6">6</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-8">8</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-10">10</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-12">12</div><div class="crayon-num" data-line="crayon-5a659276ad810686408969-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276ad810686408969-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276ad810686408969-1"># 50000/50000 [==============================] - 34s - loss: 0.4993 - acc: 0.8230 - val_loss: 0.5994 - val_acc: 0.7932</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-2"># Epoch 20/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-3"># 50000/50000 [==============================] - 34s - loss: 0.4877 - acc: 0.8271 - val_loss: 0.5986 - val_acc: 0.7932</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-4"># Epoch 21/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-5"># 50000/50000 [==============================] - 34s - loss: 0.4714 - acc: 0.8327 - val_loss: 0.5916 - val_acc: 0.7959</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-6"># Epoch 22/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-7"># 50000/50000 [==============================] - 34s - loss: 0.4603 - acc: 0.8376 - val_loss: 0.5954 - val_acc: 0.8003</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-8"># Epoch 23/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-9"># 50000/50000 [==============================] - 34s - loss: 0.4454 - acc: 0.8410 - val_loss: 0.5742 - val_acc: 0.8024</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-10"># Epoch 24/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-11"># 50000/50000 [==============================] - 34s - loss: 0.4332 - acc: 0.8468 - val_loss: 0.5829 - val_acc: 0.8027</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-12"># Epoch 25/25</div><div class="crayon-line" id="crayon-5a659276ad810686408969-13"># 50000/50000 [==============================] - 34s - loss: 0.4217 - acc: 0.8498 - val_loss: 0.5785 - val_acc: 0.8018</div><div class="crayon-line crayon-striped-line" id="crayon-5a659276ad810686408969-14"># Accuracy: 80.18%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions To Improve Model Performance</h2>
<p>We have achieved good results on this very difficult problem, but we are still a good way from achieving world class results.</p>
<p>Below are some ideas that you can try to extend upon the models and improve model performance.</p>
<ul>
<li><strong>Train for More Epochs</strong>. Each model was trained for a very small number of epochs, 25. It is common to train large convolutional neural networks for hundreds or thousands of epochs. I would expect that performance gains can be achieved by significantly raising the number of training epochs.</li>
<li><strong>Image Data Augmentation</strong>. The objects in the image vary in their position. Another boost in model performance can likely be achieved by using some data augmentation. Methods such as standardization and random shifts and horizontal image flips may be beneficial.</li>
<li><strong>Deeper Network Topology</strong>. The larger network presented is deep, but larger networks could be designed for the problem. This may involve more feature maps closer to the input and perhaps less aggressive pooling. Additionally, standard convolutional network topologies that have been shown useful may be adopted and evaluated on the problem.</li>
</ul>
<h2>Summary</h2>
<p>In this post you discovered how to create deep learning models in Keras for object recognition in photographs.</p>
<p>After working through this tutorial you learned:</p>
<ul>
<li>About the CIFAR-10 dataset and how to load it in Keras and plot ad hoc examples from the dataset.</li>
<li>How to train and evaluate a simple Convolutional Neural Network on the problem.</li>
<li>How to expand a simple Convolutional Neural Network into a deep Convolutional Neural Network in order to boost performance on the difficult problem.</li>
<li>How to use data augmentation to get a further boost on the difficult object recognition problem.</li>
</ul>
<p>Do you have any questions about object recognition or about this post? Ask your question in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fobject-recognition-convolutional-neural-networks-keras-deep-learning-library%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/&amp;summary=Keras+is+a+Python+library+for+deep+learning+that+wraps+the+powerful+numerical+libraries+Theano+and+T..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Object%20Recognition%20with%20Convolutional%20Neural%20Networks%20in%20the%20Keras%20Deep%20Learning%20Library&amp;url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/&amp;summary=Keras+is+a+Python+library+for+deep+learning+that+wraps+the+powerful+numerical+libraries+Theano+and+T...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/better-understand-machine-learning-data-weka/" rel="prev"><i class="fa fa-angle-left"></i> How to Better Understand Your Machine Learning Data in Weka</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" rel="next">Predict Sentiment From Movie Reviews Using Deep Learning <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">124 Responses to <em>Object Recognition with Convolutional Neural Networks in the Keras Deep Learning Library</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-357898">
<div class="comment-container" id="li-comment-357898">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aakash Nain</span>
<span class="date">July 24, 2016 at 9:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-357898" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
What is the use of maxnorm in context of deep learning ?</p>
<div class="reply">
<a aria-label="Reply to Aakash Nain" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=357898#respond" onclick='return addComment.moveForm( "comment-357898", "357898", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-357944">
<div class="comment-container" id="li-comment-357944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2016 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-357944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Aakash,</p>
<p>maxnorm is a weight constraint and was found to be useful when using dropout. Learn more about maxnorm and dropout here:<br/>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<p>You can learn more about weight constraints in Keras here:<br/>
<a href="http://keras.io/constraints/" rel="nofollow">http://keras.io/constraints/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=357944#respond" onclick='return addComment.moveForm( "comment-357944", "357944", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-358429">
<div class="comment-container" id="li-comment-358429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c8dd0eb6ec832a282451bc785289a88b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c8dd0eb6ec832a282451bc785289a88b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aqsa</span>
<span class="date">July 31, 2016 at 4:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-358429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
I am doing detection of road signs in real time . The size of my images is 800*1360. The size of the road sign varies from 16*16 to 256*256. How can I use convolutional neural network for this puppose to get good detection accuracy in real time</p>
<div class="reply">
<a aria-label="Reply to Aqsa" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=358429#respond" onclick='return addComment.moveForm( "comment-358429", "358429", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-358470">
<div class="comment-container" id="li-comment-358470">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2016 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-358470" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider how you frame the problem Aqsa. Two options are:</p>
<p>1) You could rescale all images to the same size.<br/>
2) You could zero-pad all images.</p>
<p>As for the specifics of the network for this problem, you will have to design and test different structures. Perhaps you can leverage an existing well performing structure like VGG or inception.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=358470#respond" onclick='return addComment.moveForm( "comment-358470", "358470", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-363069">
<div class="comment-container" id="li-comment-363069">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4050cdcd3a659ae389eb362868ef676?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4050cdcd3a659ae389eb362868ef676?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">September 1, 2016 at 12:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363069" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What should be the input dimensions for 3D dataset of pcd format or off format.?<br/>
BdwI I find your tutorials very helpful.:-)</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363069#respond" onclick='return addComment.moveForm( "comment-363069", "363069", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-363220">
<div class="comment-container" id="li-comment-363220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2016 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t know what those formats are Jack.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363220#respond" onclick='return addComment.moveForm( "comment-363220", "363220", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-363252">
<div class="comment-container" id="li-comment-363252">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4050cdcd3a659ae389eb362868ef676?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4050cdcd3a659ae389eb362868ef676?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">September 2, 2016 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363252" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Point cloud data(PCD) contains the x,y and z coordinates of the object….. I want to build a neural network for 3D object classification… The problem I am facing is I don’t know what shd be the input to my network… For a neural network that classifies images you pass the pixel values (0-255), but a pcd file just has the coordinates…Is it wise to pass the coordinates as the inputs?..<br/>
I can extract some features of the object ( from pcd file)… Can I pass those features as input ??<br/>
I am new to this field, so I having difficulty understanding things…</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363252#respond" onclick='return addComment.moveForm( "comment-363252", "363252", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-363350">
<div class="comment-container" id="li-comment-363350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2016 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I wonder if you can rescale the coordinates to all have the range 0-to-1. Then provide them directly.</p>
<p>From there, you will have a baseline and can start to explore other transforms of your coords, such as perhaps projections into 2D.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363350#respond" onclick='return addComment.moveForm( "comment-363350", "363350", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-363265">
<div class="comment-container" id="li-comment-363265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shudhan</span>
<span class="date">September 2, 2016 at 4:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>May i know how to extract features from the images?</p>
<div class="reply">
<a aria-label="Reply to shudhan" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363265#respond" onclick='return addComment.moveForm( "comment-363265", "363265", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-363353">
<div class="comment-container" id="li-comment-363353">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2016 at 6:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-363353" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We no longer need to extract features when using deep learning methods as we are performing automatic feature learning. A great benefit of the approach.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=363353#respond" onclick='return addComment.moveForm( "comment-363353", "363353", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364104">
<div class="comment-container" id="li-comment-364104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">September 10, 2016 at 4:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-364104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot.</p>
<p>I have one question</p>
<p>In Keras, How can I extract the exact location of the detected object (or objects) within image that includes a background?<br/>
I assume it uses sliding window for object detection</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=364104#respond" onclick='return addComment.moveForm( "comment-364104", "364104", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364111">
<div class="comment-container" id="li-comment-364111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 10, 2016 at 7:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-364111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Walid.</p>
<p>This is called object identification in an image. I do not have an example at the moment, but I will prepare one in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=364111#respond" onclick='return addComment.moveForm( "comment-364111", "364111", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-364246">
<div class="comment-container" id="li-comment-364246">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinay</span>
<span class="date">September 12, 2016 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-364246" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi…could you please give same example for prima diabetes or airline passenger data set. My question is to apply CNN for direct numeric features. You could give any simple example</p>
<div class="reply">
<a aria-label="Reply to Vinay" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=364246#respond" onclick='return addComment.moveForm( "comment-364246", "364246", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364265">
<div class="comment-container" id="li-comment-364265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 12, 2016 at 8:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-364265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have such an example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=364265#respond" onclick='return addComment.moveForm( "comment-364265", "364265", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-401987">
<div class="comment-container" id="li-comment-401987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95577e4128ca28bd74d9078e828fbdf9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95577e4128ca28bd74d9078e828fbdf9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.punitsingh.ml" rel="external nofollow">Punit Singh</a></span>
<span class="date">June 9, 2017 at 3:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-401987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here you can learn about the Pima Diabetes example developed by Jason. <a href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<p>After studying from this example, I have implemented this example in iPython notebook, you can see here. <a href="https://github.com/thepunitsingh/keras_tutorials/blob/master/pima-indians-diabetes-categorization.ipynb" rel="nofollow">https://github.com/thepunitsingh/keras_tutorials/blob/master/pima-indians-diabetes-categorization.ipynb</a></p>
<div class="reply">
<a aria-label="Reply to Punit Singh" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=401987#respond" onclick='return addComment.moveForm( "comment-401987", "401987", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-364396">
<div class="comment-container" id="li-comment-364396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">September 14, 2016 at 3:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-364396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, I will look forward to your example.</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=364396#respond" onclick='return addComment.moveForm( "comment-364396", "364396", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365815">
<div class="comment-container" id="li-comment-365815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5123ca9217a405695f6cb56e4645d84f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5123ca9217a405695f6cb56e4645d84f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NotMikeJones</span>
<span class="date">September 29, 2016 at 11:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-365815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Where in Keras are you specifying the input dimension for your first convolution layer? I’d like to try a convolution NN with time series for event detection, and am having issues with keras 1d convolution working. Let’s say each of my samples are a timeseries represented by a 1 x 100 vector, and within the vector, I expect three types of events to occur somewhere in those time frames (unclear what the length of the event would be, but lets say roughly 10 time points across). Would I use three feature maps, and then use a ‘window’ of, say 10 time points, that map onto a single neuron in the convolution later? So I would have a convolution layer of 3 x 10?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to NotMikeJones" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=365815#respond" onclick='return addComment.moveForm( "comment-365815", "365815", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365860">
<div class="comment-container" id="li-comment-365860">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2016 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-365860" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>LSTM is the network for dealing with sequences rather than CNN.</p>
<p>CNN is good at spatial structure such as in images or text.</p>
<p>This tutorial on time series with LSTMs might be what you’re looking for:<br/>
<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=365860#respond" onclick='return addComment.moveForm( "comment-365860", "365860", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-365926">
<div class="comment-container" id="li-comment-365926">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5123ca9217a405695f6cb56e4645d84f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5123ca9217a405695f6cb56e4645d84f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NotMikeJones</span>
<span class="date">October 1, 2016 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-365926" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for that! I actually think I misspoke – I don’t want to forecast values at future time points, but instead identify if a current set of timepoints fit a pattern that indicate a certain event.</p>
<p>For example, let’s say we have fitness tracker data with various types of sensors (heart rate, pedometer, accelerometer), and we know a person does three types of activity: yoga, running, cooking. I want to train a model to identify these activities based on sensor data, and then be able to pull real-time data and classify what they are currently doing.</p>
<p>I was thinking a CNN with a windowed-approach would be the best bet, but I might be completely off-base.</p>
<div class="reply">
<a aria-label="Reply to NotMikeJones" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=365926#respond" onclick='return addComment.moveForm( "comment-365926", "365926", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-365956">
<div class="comment-container" id="li-comment-365956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 1, 2016 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-365956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It does sound like an anomaly detection or change detection problem, you may have benefit in framing the problem this way.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=365956#respond" onclick='return addComment.moveForm( "comment-365956", "365956", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-367410">
<div class="comment-container" id="li-comment-367410">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0f5e3fdba303da056614e1d8dfb4b7f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0f5e3fdba303da056614e1d8dfb4b7f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rafi</span>
<span class="date">October 18, 2016 at 6:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-367410" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’m running the exact same code in this page which produced a 71.82% accuracy on test data.</p>
<p>only difference is I’m using a validation data set split by 70-30%. I’m getting only less than 11% validation and test accuracy. What could be my mistake? Have you faced such<br/>
results? please help.</p>
<p>Thanks<br/>
Rafi</p>
<p>35000/35000 [==============================] – 94s – loss: 2.2974 – acc: 0.1158 – val_loss: 2.3033 – val_acc: 0.0991<br/>
Epoch 24/25<br/>
35000/35000 [==============================] – 94s – loss: 2.2961 – acc: 0.1170 – val_loss: 2.3035 – val_acc: 0.1022<br/>
Epoch 25/25<br/>
35000/35000 [==============================] – 93s – loss: 2.2954 – acc: 0.1213 – val_loss: 2.3036 – val_acc: 0.0987</p>
<div class="reply">
<a aria-label="Reply to Rafi" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=367410#respond" onclick='return addComment.moveForm( "comment-367410", "367410", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-369025">
<div class="comment-container" id="li-comment-369025">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">November 2, 2016 at 2:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-369025" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>I appreciate if you can illustrate In Keras : How can I extract the exact location of the detected object (or objects) within image that includes a background?</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=369025#respond" onclick='return addComment.moveForm( "comment-369025", "369025", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-369074">
<div class="comment-container" id="li-comment-369074">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2016 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-369074" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Walid, </p>
<p>Sorry, I don’t have an example of object localization with Keras yet. It is on the TODO list though.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=369074#respond" onclick='return addComment.moveForm( "comment-369074", "369074", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-369107">
<div class="comment-container" id="li-comment-369107">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/db863eeea0b8f256bf2429c745b2a8a7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/db863eeea0b8f256bf2429c745b2a8a7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Augusto Aguirre</span>
<span class="date">November 2, 2016 at 2:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-369107" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello! Very good explanation!<br/>
I am using your model to classify images containing either 0 or 1.<br/>
To resolve this, I am able to pleanteas using initially with a variant in the last hidden layer:</p>
<p>model.add (Dense (1, activation = ‘sigmoid’))</p>
<p>For me return a result between 0 or 1.</p>
<p>When I want to adjust the model gives me the following error:<br/>
‘Error when checking input model: convolution2d_input_20 expected to have 4 dimensions, but got array With shape (8000, 3072)’<br/>
My dataset are 32×32 RGB images. Therefore, contains 3072 columns, but one with a 0 or 1.<br/>
Regards!</p>
<div class="reply">
<a aria-label="Reply to Augusto Aguirre" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=369107#respond" onclick='return addComment.moveForm( "comment-369107", "369107", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-369220">
<div class="comment-container" id="li-comment-369220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2016 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-369220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Augusto, sorry to hear about the error on your own data.</p>
<p>It is not clear what the cause could be, sorry. Perhaps you are able to experiment and discover the root cause. Try simplifying your example to the minimum required and see if that helps to flush it out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=369220#respond" onclick='return addComment.moveForm( "comment-369220", "369220", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370235">
<div class="comment-container" id="li-comment-370235">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">November 11, 2016 at 12:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370235" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would I need to apply a dropout layer before a convolutional layer?</p>
<p>It just make sense for me when applied to input layer or any other layers in the fully connected layers.<br/>
Request.</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370235#respond" onclick='return addComment.moveForm( "comment-370235", "370235", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370269">
<div class="comment-container" id="li-comment-370269">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2016 at 10:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370269" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Walid,</p>
<p>It’s all about putting pressure on the network to force it to generalize. It may or may not be a good pressure point to force this type of learning. Try and see on your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370269#respond" onclick='return addComment.moveForm( "comment-370269", "370269", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-370245">
<div class="comment-container" id="li-comment-370245">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0be1daa9a8580fca2b4c4207ec8b88c9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0be1daa9a8580fca2b4c4207ec8b88c9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">William Amador</span>
<span class="date">November 11, 2016 at 3:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370245" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,Jason I have a question, how is the procedure for training if in my initial layer I do not handle a single image but a sequence of 30 images. For a specific case a sequence of movements of a person; Do you have any examples of training for a CNN for this case</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to William Amador" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370245#respond" onclick='return addComment.moveForm( "comment-370245", "370245", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370271">
<div class="comment-container" id="li-comment-370271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2016 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi William, great question. Sorry, I don’t have any worked examples of working with sequences of images at the moment.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370271#respond" onclick='return addComment.moveForm( "comment-370271", "370271", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370581">
<div class="comment-container" id="li-comment-370581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">November 15, 2016 at 2:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi  Jason</p>
<p>When I removed the  dropout layers  before any convolutional layer, my results improved.<br/>
especially when the size of dataset is large.</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370581#respond" onclick='return addComment.moveForm( "comment-370581", "370581", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370612">
<div class="comment-container" id="li-comment-370612">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2016 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370612" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the feedback Walid. Nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370612#respond" onclick='return addComment.moveForm( "comment-370612", "370612", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-370745">
<div class="comment-container" id="li-comment-370745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">November 16, 2016 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.<br/>
Another  question , I  know that keras comes with different optimizers, in your code you used sgd,others may use another optimizer like adam.<br/>
<a href="https://keras.io/optimizers/" rel="nofollow">https://keras.io/optimizers/</a><br/>
any advice or recommendation about yupt of  optimizer?</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370745#respond" onclick='return addComment.moveForm( "comment-370745", "370745", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370792">
<div class="comment-container" id="li-comment-370792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2016 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Walid,</p>
<p>I find optimizers generally make minor differences to the results – move the needle less than the network topology.</p>
<p>SGD is well understood and a great place to start. ADAM is fast and gives good results and I often use it in practice. I don’t really have much opinions beyond that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370792#respond" onclick='return addComment.moveForm( "comment-370792", "370792", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370842">
<div class="comment-container" id="li-comment-370842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1278ef17d1122971f05fae9c584cf053?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1278ef17d1122971f05fae9c584cf053?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bharath Paturi</span>
<span class="date">November 16, 2016 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have very large images to analyze. Probably each image size will be around 500 MB to 1 GB.<br/>
I wanted to apply segmentation to the images. Can we use convolution NN to do unsupervised learning.</p>
<div class="reply">
<a aria-label="Reply to Bharath Paturi" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370842#respond" onclick='return addComment.moveForm( "comment-370842", "370842", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370929">
<div class="comment-container" id="li-comment-370929">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2016 at 9:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370929" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch Bharath, they are massive images.</p>
<p>It is possible, but you’re going to run out of memory really fast!</p>
<p>I don’t have good advice, sorry. I have not researched this specific problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370929#respond" onclick='return addComment.moveForm( "comment-370929", "370929", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-370917">
<div class="comment-container" id="li-comment-370917">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/37fa50a21f7622e639b22b31ad7630e5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/37fa50a21f7622e639b22b31ad7630e5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">November 17, 2016 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370917" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I saw the line where you add a layer has a typo. It should read</p>
<p>    model.add(Convolution2D(32, 3, 3, input_shape=(32, 32, 3), border_mode=’same’, activation=’relu’,</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370917#respond" onclick='return addComment.moveForm( "comment-370917", "370917", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370938">
<div class="comment-container" id="li-comment-370938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2016 at 9:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-370938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you sure Michael? It all looks good to me and the example runs with Theano and TensorFlow backends.</p>
<p>Maybe I’m missing something?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=370938#respond" onclick='return addComment.moveForm( "comment-370938", "370938", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-404678">
<div class="comment-container" id="li-comment-404678">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean</span>
<span class="date">July 4, 2017 at 8:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404678" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think Michael is right. It throws me an error with input_shape=(3,32,32).  input_shape=(32,32,3) should be the correct one</p>
<div class="reply">
<a aria-label="Reply to Sean" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404678#respond" onclick='return addComment.moveForm( "comment-404678", "404678", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-375876">
<div class="comment-container" id="li-comment-375876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8113e5d16f846e94bcf0819c1d49895c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8113e5d16f846e94bcf0819c1d49895c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maxim</span>
<span class="date">December 19, 2016 at 1:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-375876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Michael, for solving your problem put the line: K.set_image_dim_ordering(‘th’) </p>
<p>ABOVE the </p>
<p>(X_train, y_train), (X_test, y_test)= cifar10.load_data()</p>
<div class="reply">
<a aria-label="Reply to Maxim" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=375876#respond" onclick='return addComment.moveForm( "comment-375876", "375876", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-371451">
<div class="comment-container" id="li-comment-371451">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4a4b346ea44c6cb3c40bc8b6a466759?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4a4b346ea44c6cb3c40bc8b6a466759?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shristi Baral</span>
<span class="date">November 21, 2016 at 10:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-371451" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How do I deal with the error? Got this while running script under “Loading The CIFAR-10 Dataset in Keras”. I tried altering the script of cifar10.py to figure out what the error is. But I couldnot.<br/>
—————————————————————————<br/>
UnicodeDecodeError                        Traceback (most recent call last)<br/>
 in ()<br/>
      4 from scipy.misc import toimage<br/>
      5 # load data<br/>
—-&gt; 6 (X_train, y_train), (X_test, y_test) = cifar10.load_data()<br/>
      7 # create a grid of 3×3 images<br/>
      8 for i in range(0, 9):</p>
<p>/home/kdc/anaconda3/lib/python3.5/site-packages/keras/datasets/cifar10.py in load_data()<br/>
     18     for i in range(1, 6):<br/>
     19         fpath = os.path.join(path, ‘data_batch_’ + str(i))<br/>
—&gt; 20         data, labels = load_batch(fpath)<br/>
     21         X_train[(i-1)*10000:i*10000, :, :, :] = data<br/>
     22         y_train[(i-1)*10000:i*10000] = labels</p>
<p>/home/kdc/anaconda3/lib/python3.5/site-packages/keras/datasets/cifar.py in load_batch(fpath, label_key)<br/>
     10         d = cPickle.load(f)<br/>
     11     else:<br/>
—&gt; 12         d = cPickle.load(f, encoding=”bytes”)<br/>
     13         # decode utf8<br/>
     14         for k, v in d.items():</p>
<p>UnicodeDecodeError: ‘ascii’ codec can’t decode byte 0x80 in position 3031: ordinal not in range(128)</p>
<div class="reply">
<a aria-label="Reply to Shristi Baral" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=371451#respond" onclick='return addComment.moveForm( "comment-371451", "371451", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371498">
<div class="comment-container" id="li-comment-371498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2016 at 7:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-371498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this error before, perhaps post to stack overflow or the Keras list?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=371498#respond" onclick='return addComment.moveForm( "comment-371498", "371498", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-371557">
<div class="comment-container" id="li-comment-371557">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/06f834301772d262fdeb19f936003c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/06f834301772d262fdeb19f936003c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aquib Javed Khan</span>
<span class="date">November 22, 2016 at 8:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-371557" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thanks for the awesome tutorial, you’r codes and explanations helps me lot in understanding the classification task.</p>
<p>I actually want to feed new images want to get the return the label matches to it, How can I do it like I am doing like this:</p>
<p>import keras<br/>
from keras.models import load_model<br/>
from keras.models import Sequential<br/>
import cv2<br/>
import numpy as np<br/>
from keras.preprocessing.image import ImageDataGenerator, array_to_img, img_to_array, load_img<br/>
model = Sequential()</p>
<p>model =load_model(‘firstmodel.h5′)<br/>
model.compile(loss=’binary_crossentropy’,<br/>
              optimizer=’rmsprop’,<br/>
              metrics=[‘accuracy’])</p>
<p>img = cv2.imread(‘cat.jpg’,0)<br/>
img = cv2.resize(img,(150,150))</p>
<p>classes = model.predict_classes(img, batch_size=32)<br/>
print classes</p>
<p>I’m getting error:<br/>
Exception: Error when checking : expected convolution2d_input_1 to have 4 dimensions, but got array with shape (150, 150)</p>
<p>How to fix it?</p>
<div class="reply">
<a aria-label="Reply to Aquib Javed Khan" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=371557#respond" onclick='return addComment.moveForm( "comment-371557", "371557", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371689">
<div class="comment-container" id="li-comment-371689">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 8:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-371689" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My suggestion would be to ensure that your loaded data matches the expected input dimensions exactly. You may have to resize or pad new data to make it match.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=371689#respond" onclick='return addComment.moveForm( "comment-371689", "371689", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-373198">
<div class="comment-container" id="li-comment-373198">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b7fac5dd38a236460ece9595d5f22d2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b7fac5dd38a236460ece9595d5f22d2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">s</span>
<span class="date">December 1, 2016 at 1:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-373198" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is NOT objection detection, it’s classification</p>
<div class="reply">
<a aria-label="Reply to s" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=373198#respond" onclick='return addComment.moveForm( "comment-373198", "373198", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-373339">
<div class="comment-container" id="li-comment-373339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2016 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-373339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the feedback.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=373339#respond" onclick='return addComment.moveForm( "comment-373339", "373339", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-373318">
<div class="comment-container" id="li-comment-373318">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid</span>
<span class="date">December 2, 2016 at 4:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-373318" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>I am so eager for an example of object localization with Keras yet, I hope you can come with one soon</p>
<div class="reply">
<a aria-label="Reply to Walid" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=373318#respond" onclick='return addComment.moveForm( "comment-373318", "373318", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-373347">
<div class="comment-container" id="li-comment-373347">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2016 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-373347" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to prepare one soon Walid, hopefully in the new year.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=373347#respond" onclick='return addComment.moveForm( "comment-373347", "373347", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374130">
<div class="comment-container" id="li-comment-374130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a56a0f0e49f6aa2b9edf0a1fd1b22ce?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a56a0f0e49f6aa2b9edf0a1fd1b22ce?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://avelabs.com" rel="external nofollow">Ahmed Desoky</a></span>
<span class="date">December 7, 2016 at 4:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-374130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Your tutorials are so helpful and awesome.</p>
<p>I am working on a classification problem using Keras on kitti dataset. I found that kitti is not supported yet in <a href="https://keras.io/datasets/" rel="nofollow">https://keras.io/datasets/</a> . </p>
<p>Is there any advice or an introductory point to work out with my problem ?</p>
<p>Thanks for help</p>
<div class="reply">
<a aria-label="Reply to Ahmed Desoky" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=374130#respond" onclick='return addComment.moveForm( "comment-374130", "374130", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-374157">
<div class="comment-container" id="li-comment-374157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2016 at 8:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-374157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not looked at that dataset yet.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=374157#respond" onclick='return addComment.moveForm( "comment-374157", "374157", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-374183">
<div class="comment-container" id="li-comment-374183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cb5e281070a9e856573ef4b49044608c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cb5e281070a9e856573ef4b49044608c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thanawin</span>
<span class="date">December 7, 2016 at 1:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-374183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason</p>
<p>I have seen many tutorials, but this is the best.<br/>
I am wondering if “scores = model.evaluate(X_test, y_test, verbose=0)” will take the last model from “model.fit()”. I would really appreciate if you can suggest me how can I evaluate my test data using the best model from “model.fit()”</p>
<div class="reply">
<a aria-label="Reply to Thanawin" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=374183#respond" onclick='return addComment.moveForm( "comment-374183", "374183", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-375194">
<div class="comment-container" id="li-comment-375194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c24aa36afef530dfaa6129916d1cbefc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c24aa36afef530dfaa6129916d1cbefc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TSchecker</span>
<span class="date">December 14, 2016 at 7:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-375194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>just in case facing the error</p>
<p>“AttributeError: ‘module’ object has no attribute ‘control_flow_ops'”</p>
<p>found here:<br/>
<a href="https://github.com/fchollet/keras/issues/3857" rel="nofollow">https://github.com/fchollet/keras/issues/3857</a></p>
<p>import tensorflow as tf<br/>
tf.python.control_flow_ops = tf</p>
<div class="reply">
<a aria-label="Reply to TSchecker" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=375194#respond" onclick='return addComment.moveForm( "comment-375194", "375194", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375250">
<div class="comment-container" id="li-comment-375250">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2016 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-375250" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing TSchecker.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=375250#respond" onclick='return addComment.moveForm( "comment-375250", "375250", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-375226">
<div class="comment-container" id="li-comment-375226">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce9b0d048b464e37e213cbb135eb1035?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce9b0d048b464e37e213cbb135eb1035?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">yask</span>
<span class="date">December 15, 2016 at 3:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-375226" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
I really like your article<br/>
I would like to extract objects such as ice, water etc. from photograph.<br/>
 is this library useful for that? How can I define training areas? Do I need to provide sample image of ice, water as a training area to the classifier? Which classifier servers best here? how about Artificial Neural Network ?</p>
<div class="reply">
<a aria-label="Reply to yask" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=375226#respond" onclick='return addComment.moveForm( "comment-375226", "375226", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376114">
<div class="comment-container" id="li-comment-376114">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/37d728ef4cdab7c88c8b338cfe123b01?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/37d728ef4cdab7c88c8b338cfe123b01?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.knightclan.in" rel="external nofollow">pranoy</a></span>
<span class="date">December 19, 2016 at 7:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-376114" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>which  function is used for predicting.. </p>
<p>if i give an image of a horse and i want to predict the output. which function i have to use</p>
<div class="reply">
<a aria-label="Reply to pranoy" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=376114#respond" onclick='return addComment.moveForm( "comment-376114", "376114", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-376282">
<div class="comment-container" id="li-comment-376282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2016 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-376282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use model.predict() to make a prediction on new data.</p>
<p>The new data must have the same shape as the data used to train the network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=376282#respond" onclick='return addComment.moveForm( "comment-376282", "376282", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-378508">
<div class="comment-container" id="li-comment-378508">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/60407fee1898fffef4871dfc5bf59112?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/60407fee1898fffef4871dfc5bf59112?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Milos</span>
<span class="date">December 29, 2016 at 10:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-378508" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>great article. I have a question. In Dense part you have specified 512 neurons. Can you tell me how did you determine number of neurons? </p>
<p>tnx</p>
<div class="reply">
<a aria-label="Reply to Milos" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=378508#respond" onclick='return addComment.moveForm( "comment-378508", "378508", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-378614">
<div class="comment-container" id="li-comment-378614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 30, 2016 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-378614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Milos, I used trial and error. Selecting the number and size of layer is an art – test a lot of configs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=378614#respond" onclick='return addComment.moveForm( "comment-378614", "378614", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-378769">
<div class="comment-container" id="li-comment-378769">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/60407fee1898fffef4871dfc5bf59112?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/60407fee1898fffef4871dfc5bf59112?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Milos</span>
<span class="date">December 30, 2016 at 7:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-378769" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for answer. I have assumed so , but I had to ask :).<br/>
Great and really useful articles I have found on your site :).</p>
<div class="reply">
<a aria-label="Reply to Milos" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=378769#respond" onclick='return addComment.moveForm( "comment-378769", "378769", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-378903">
<div class="comment-container" id="li-comment-378903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 31, 2016 at 7:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-378903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Milos.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=378903#respond" onclick='return addComment.moveForm( "comment-378903", "378903", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-385038">
<div class="comment-container" id="li-comment-385038">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f7dde7a53526a87294afe566f854b9a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f7dde7a53526a87294afe566f854b9a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deepak</span>
<span class="date">January 30, 2017 at 3:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-385038" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I use the model.predict, the following error is seen. Please help me</p>
<p>TypeError                                 Traceback (most recent call last)<br/>
 in ()<br/>
—-&gt; 1 model.predict(tmp)</p>
<p>/usr/local/lib/python2.7/dist-packages/keras/models.pyc in predict(self, x, batch_size, verbose)<br/>
    722         if self.model is None:<br/>
    723             self.build()<br/>
–&gt; 724         return self.model.predict(x, batch_size=batch_size, verbose=verbose)<br/>
    725<br/>
    726     def predict_on_batch(self, x):</p>
<p>/usr/local/lib/python2.7/dist-packages/keras/engine/training.pyc in predict(self, x, batch_size, verbose)<br/>
   1266         f = self.predict_function<br/>
   1267         return self._predict_loop(f, ins,<br/>
-&gt; 1268                                   batch_size=batch_size, verbose=verbose)<br/>
   1269<br/>
   1270     def train_on_batch(self, x, y,</p>
<p>/usr/local/lib/python2.7/dist-packages/keras/engine/training.pyc in _predict_loop(self, f, ins, batch_size, verbose)<br/>
    944                 ins_batch = slice_X(ins, batch_ids)<br/>
    945<br/>
–&gt; 946             batch_outs = f(ins_batch)<br/>
    947             if not isinstance(batch_outs, list):<br/>
    948                 batch_outs = [batch_outs]</p>
<p>/usr/local/lib/python2.7/dist-packages/keras/backend/theano_backend.pyc in __call__(self, inputs)<br/>
    957     def __call__(self, inputs):<br/>
    958         assert isinstance(inputs, (list, tuple))<br/>
–&gt; 959         return self.function(*inputs)<br/>
    960<br/>
    961 </p>
<p>/usr/local/lib/python2.7/dist-packages/Theano-0.9.0.dev5-py2.7.egg/theano/compile/function_module.pyc in __call__(self, *args, **kwargs)<br/>
    786                         s.storage[0] = s.type.filter(<br/>
    787                             arg, strict=s.strict,<br/>
–&gt; 788                             allow_downcast=s.allow_downcast)<br/>
    789<br/>
    790                     except Exception as e:</p>
<p>/usr/local/lib/python2.7/dist-packages/Theano-0.9.0.dev5-py2.7.egg/theano/tensor/type.pyc in filter(self, data, strict, allow_downcast)<br/>
    115             if allow_downcast:<br/>
    116                 # Convert to self.dtype, regardless of the type of data<br/>
–&gt; 117                 data = theano._asarray(data, dtype=self.dtype)<br/>
    118                 # TODO: consider to pad shape with ones to make it consistent<br/>
    119                 # with self.broadcastable… like vector-&gt;row type thing</p>
<p>/usr/local/lib/python2.7/dist-packages/Theano-0.9.0.dev5-py2.7.egg/theano/misc/safe_asarray.pyc in _asarray(a, dtype, order)<br/>
     32         dtype = theano.config.floatX<br/>
     33     dtype = numpy.dtype(dtype)  # Convert into dtype object.<br/>
—&gt; 34     rval = numpy.asarray(a, dtype=dtype, order=order)<br/>
     35     # Note that dtype comparison must be done by comparing their <code>num</code><br/>
     36     # attribute. One cannot assume that two identical data types are pointers</p>
<p>/home/yashwanth/.local/lib/python2.7/site-packages/numpy/core/numeric.pyc in asarray(a, dtype, order)<br/>
    529<br/>
    530     “””<br/>
–&gt; 531     return array(a, dtype, copy=False, order=order)<br/>
    532<br/>
    533 </p>
<p>TypeError: Bad input argument to theano function with name “/usr/local/lib/python2.7/dist-packages/keras/backend/theano_backend.py:955” at index 0 (0-based).<br/>
Backtrace when that variable is created:</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/IPython/core/interactiveshell.py”, line 2821, in run_ast_nodes<br/>
    if self.run_code(code, result):<br/>
  File “/usr/local/lib/python2.7/dist-packages/IPython/core/interactiveshell.py”, line 2881, in run_code<br/>
    exec(code_obj, self.user_global_ns, self.user_ns)<br/>
  File “”, line 2, in<br/>
    model.add(Convolution1D(64, 2, input_shape=[1,4], border_mode=’same’, activation=’relu’, W_constraint=maxnorm(3)))<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/models.py”, line 299, in add<br/>
    layer.create_input_layer(batch_input_shape, input_dtype)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py”, line 397, in create_input_layer<br/>
    dtype=input_dtype, name=name)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py”, line 1198, in Input<br/>
    input_tensor=tensor)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py”, line 1116, in __init__<br/>
    name=self.name)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/backend/theano_backend.py”, line 110, in placeholder<br/>
    x = T.TensorType(dtype, broadcast)(name)<br/>
float() argument must be a string or a number</p>
<div class="reply">
<a aria-label="Reply to Deepak" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=385038#respond" onclick='return addComment.moveForm( "comment-385038", "385038", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385397">
<div class="comment-container" id="li-comment-385397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-385397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that.</p>
<p>The cause is not obvious to me, the stack trace is hard to read.</p>
<p>Perhaps you could try posting to stackoverflow or the Keras google group?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=385397#respond" onclick='return addComment.moveForm( "comment-385397", "385397", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-386164">
<div class="comment-container" id="li-comment-386164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rajesh</span>
<span class="date">February 6, 2017 at 4:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Any idea about the following error? Everything looked good till the model.summary point. But when I tried to fit the model, I am seeing the following error.</p>
<p>ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
      1 # Fit the model<br/>
—-&gt; 2 model.fit(X_train, y_train, validation_data=(X_test, y_test), nb_epoch=epochs, batch_size=32)<br/>
      3 # Final evaluation of the model<br/>
      4 scores = model.evaluate(X_test, y_test, verbose=0)<br/>
      5 print(“Accuracy: %.2f%%” % (scores[1]*100))</p>
<p>/home/rajesh/anaconda2/lib/python2.7/site-packages/keras/models.pyc in fit(self, x, y, batch_size, nb_epoch, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, **kwargs)<br/>
    670                               class_weight=class_weight,<br/>
    671                               sample_weight=sample_weight,<br/>
–&gt; 672                               initial_epoch=initial_epoch)<br/>
    673<br/>
    674     def evaluate(self, x, y, batch_size=32, verbose=1,</p>
<p>/home/rajesh/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in fit(self, x, y, batch_size, nb_epoch, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch)<br/>
   1115             class_weight=class_weight,<br/>
   1116             check_batch_axis=False,<br/>
-&gt; 1117             batch_size=batch_size)<br/>
   1118         # prepare validation data<br/>
   1119         if validation_data:</p>
<p>/home/rajesh/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in _standardize_user_data(self, x, y, sample_weight, class_weight, check_batch_axis, batch_size)<br/>
   1028                                    self.internal_input_shapes,<br/>
   1029                                    check_batch_axis=False,<br/>
-&gt; 1030                                    exception_prefix=’model input’)<br/>
   1031         y = standardize_input_data(y, self.output_names,<br/>
   1032                                    output_shapes,</p>
<p>/home/rajesh/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)<br/>
    122                             ‘ to have shape ‘ + str(shapes[i]) +<br/>
    123                             ‘ but got array with shape ‘ +<br/>
–&gt; 124                             str(array.shape))<br/>
    125     return arrays<br/>
    126 </p>
<p>ValueError: Error when checking model input: expected convolution2d_input_6 to have shape (None, 3, 32, 32) but got array with shape (50000, 32, 32, 3)</p>
<div class="reply">
<a aria-label="Reply to Rajesh" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386164#respond" onclick='return addComment.moveForm( "comment-386164", "386164", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-386165">
<div class="comment-container" id="li-comment-386165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rajesh</span>
<span class="date">February 6, 2017 at 4:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I understood the issue. I was mistaking at the input_shape step.</p>
<p>It is a very nice tutorial. very well written. Thanks</p>
<div class="reply">
<a aria-label="Reply to Rajesh" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386165#respond" onclick='return addComment.moveForm( "comment-386165", "386165", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-386181">
<div class="comment-container" id="li-comment-386181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ba40f9df1aaa2cfc719a0f091458b99e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rajesh</span>
<span class="date">February 6, 2017 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to spam..but I am still seeing the error 🙁</p>
<div class="reply">
<a aria-label="Reply to Rajesh" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386181#respond" onclick='return addComment.moveForm( "comment-386181", "386181", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-386190">
<div class="comment-container" id="li-comment-386190">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2017 at 9:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386190" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Rajesh, you may want to confirm that you are not missing any lines of code.</p>
<p>Also, confirm your version of Keras, TensorFlow/Theano and Python.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386190#respond" onclick='return addComment.moveForm( "comment-386190", "386190", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386267">
<div class="comment-container" id="li-comment-386267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9355d3fcf3be12b13dafe974982d1000?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9355d3fcf3be12b13dafe974982d1000?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">February 6, 2017 at 9:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
Thank you for your example. I tried to run your code. But our network server is blocked and the code could not get data from the below url.</p>
<p> <a href="http://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz" rel="nofollow">http://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz</a></p>
<p>Can you let me know if there is another way to make training data set without using download wrapper method ?</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386267#respond" onclick='return addComment.moveForm( "comment-386267", "386267", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-386269">
<div class="comment-container" id="li-comment-386269">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9355d3fcf3be12b13dafe974982d1000?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9355d3fcf3be12b13dafe974982d1000?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">February 6, 2017 at 9:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386269" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Oh, I found a solution through googling. Thanks anyway.</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386269#respond" onclick='return addComment.moveForm( "comment-386269", "386269", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-386366">
<div class="comment-container" id="li-comment-386366">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 7, 2017 at 10:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386366" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Sam.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386366#respond" onclick='return addComment.moveForm( "comment-386366", "386366", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-386398">
<div class="comment-container" id="li-comment-386398">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da9a2d93ab1e2380d92d39055e6daf6c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da9a2d93ab1e2380d92d39055e6daf6c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">February 7, 2017 at 2:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386398" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>How I can recognize bike in video. It would be great if you can give example.</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386398#respond" onclick='return addComment.moveForm( "comment-386398", "386398", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-386527">
<div class="comment-container" id="li-comment-386527">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 8, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-386527" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question John, it is an area I’d like to cover in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=386527#respond" onclick='return addComment.moveForm( "comment-386527", "386527", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-393018">
<div class="comment-container" id="li-comment-393018">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/baf56fc9f92c580a20957df884fb7dd8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/baf56fc9f92c580a20957df884fb7dd8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ikhsan</span>
<span class="date">March 17, 2017 at 2:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-393018" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the tutorial. I have a question about the random.seed(seed). Why do we need to seed it first and where is the random number generator used in the rest of the code?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Ikhsan" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=393018#respond" onclick='return addComment.moveForm( "comment-393018", "393018", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393119">
<div class="comment-container" id="li-comment-393119">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 18, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-393119" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You do not need to seed the random number generator. I was attempting to make the code 100% reproducible.</p>
<p>Random numbers are used to seed neural networks and during training to shuffle training data.</p>
<p>You can learn more about random numbers for machine learning here:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=393119#respond" onclick='return addComment.moveForm( "comment-393119", "393119", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397134">
<div class="comment-container" id="li-comment-397134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6a3679fff054f2062adb31dd01f360df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6a3679fff054f2062adb31dd01f360df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">April 21, 2017 at 5:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-397134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason</p>
<p>Thanks for this great tutorial, I am trying to run the code but I got the following error any suggestion to fix </p>
<p>I am using keras with theona 2.7 back end</p>
<p>model = Sequential()<br/>
model.add(Conv2D(32, (3, 3), input_shape=(3, 32, 32), padding=’same’, activation=’relu’, kernel_constraint=maxnorm(3)))<br/>
model.add(Dropout(0.2))<br/>
model.add(Conv2D(32, (3, 3), activation=’relu’, padding=’same’, kernel_constraint=maxnorm(3)))<br/>
model.add(MaxPooling2D(pool_size=(2, 2)))<br/>
model.add(Flatten())<br/>
model.add(Dense(512, activation=’relu’, kernel_constraint=maxnorm(3)))<br/>
model.add(Dropout(0.5))<br/>
model.add(Dense(num_classes, activation=’softmax’))<br/>
# Compile model<br/>
epochs = 25<br/>
lrate = 0.01<br/>
decay = lrate/epochs<br/>
sgd = SGD(lr=lrate, momentum=0.9, decay=decay, nesterov=False)<br/>
model.compile(loss=’categorical_crossentropy’, optimizer=sgd, metrics=[‘accuracy’])<br/>
print(model.summary())</p>
<p>Traceback (most recent call last):</p>
<p>  File “”, line 2, in<br/>
    model.add(Conv2D(32, (3, 3), input_shape=(3, 32, 32), padding=’same’, activation=’relu’, kernel_constraint=maxnorm(3)))</p>
<p>TypeError: __init__() takes at least 4 arguments (4 given)</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=397134#respond" onclick='return addComment.moveForm( "comment-397134", "397134", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397189">
<div class="comment-container" id="li-comment-397189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2017 at 9:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-397189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure Ali, I have not seen this error before. </p>
<p>Perhaps confirm that you have copied the code exactly?</p>
<p>Consider removing arguments to help zoom in on the cause of the fault.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=397189#respond" onclick='return addComment.moveForm( "comment-397189", "397189", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398107">
<div class="comment-container" id="li-comment-398107">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3312881ddb4c250ed1bcfc4ef7725f29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3312881ddb4c250ed1bcfc4ef7725f29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AIZEN</span>
<span class="date">May 1, 2017 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-398107" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, i already manage to detect object in the still images. What am i supposed to do to detect objects in a video input? i intend to use the same Keras CNN.</p>
<div class="reply">
<a aria-label="Reply to AIZEN" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=398107#respond" onclick='return addComment.moveForm( "comment-398107", "398107", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398137">
<div class="comment-container" id="li-comment-398137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 1, 2017 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-398137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could process each frame of the video as an image with a CNN and use an LSTM to handle sequences of data from the CNN.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=398137#respond" onclick='return addComment.moveForm( "comment-398137", "398137", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398210">
<div class="comment-container" id="li-comment-398210">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fef0db851fe99a7bf83c89f2e1c12280?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fef0db851fe99a7bf83c89f2e1c12280?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Supriya</span>
<span class="date">May 2, 2017 at 2:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-398210" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, in this example we have created CNN model , but how to test it..</p>
<div class="reply">
<a aria-label="Reply to Supriya" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=398210#respond" onclick='return addComment.moveForm( "comment-398210", "398210", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398234">
<div class="comment-container" id="li-comment-398234">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2017 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-398234" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use a train/test split or k-fold cross validation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=398234#respond" onclick='return addComment.moveForm( "comment-398234", "398234", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399956">
<div class="comment-container" id="li-comment-399956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7236f0623b6a450794fb61f87cb305ee?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7236f0623b6a450794fb61f87cb305ee?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chao</span>
<span class="date">May 18, 2017 at 3:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-399956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What does “kernel_constraint=maxnorm(3)” mean?</p>
<p>Thanks a lot!</p>
<div class="reply">
<a aria-label="Reply to Chao" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=399956#respond" onclick='return addComment.moveForm( "comment-399956", "399956", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400007">
<div class="comment-container" id="li-comment-400007">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-400007" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question. It is a weight constraint. See this post on why we want to use them:<br/>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=400007#respond" onclick='return addComment.moveForm( "comment-400007", "400007", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401027">
<div class="comment-container" id="li-comment-401027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/40a99025b75e827c4f397138e712592c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/40a99025b75e827c4f397138e712592c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://mohamedmnete.com" rel="external nofollow">Mohamed Mnete</a></span>
<span class="date">June 1, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-401027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, say I had an image I would like the model you just made to predict what it has on it. I save it in the same directory as the python file. How can I load this to put into he prediction function and how can I write the prediction function. I would also like to try and use my own images on your model. I was also stuck on the technique of changing the images to numpy.arrays. I would also like the output to be either -1 or 1 . How  can I code this up. Please help….</p>
<div class="reply">
<a aria-label="Reply to Mohamed Mnete" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=401027#respond" onclick='return addComment.moveForm( "comment-401027", "401027", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401230">
<div class="comment-container" id="li-comment-401230">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-401230" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will help as a start:<br/>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=401230#respond" onclick='return addComment.moveForm( "comment-401230", "401230", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401861">
<div class="comment-container" id="li-comment-401861">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4efa43b7b35b1da1ad9e9c7bccb1abff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4efa43b7b35b1da1ad9e9c7bccb1abff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Natthaphon</span>
<span class="date">June 8, 2017 at 1:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-401861" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So can I insert annotation in each images</p>
<div class="reply">
<a aria-label="Reply to Natthaphon" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=401861#respond" onclick='return addComment.moveForm( "comment-401861", "401861", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401934">
<div class="comment-container" id="li-comment-401934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2017 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-401934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=401934#respond" onclick='return addComment.moveForm( "comment-401934", "401934", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402932">
<div class="comment-container" id="li-comment-402932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5333058ef0df38287a0160410db60745?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5333058ef0df38287a0160410db60745?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Daniel</span>
<span class="date">June 18, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-402932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I’m trying to do an image classifier that determines if something should be given a specific hashtag or not. My problem is that the accuracy of the classifier after each epoch remains constant, and is essentially assigning the same class to all images. This makes no sense as the image classes are fairly distinct (#gym and #foraging). I basically copied the smaller CNN you used: </p>
<p>model = Sequential()<br/>
model.add(Convolution2D(32, 3, 3, input_shape=(3, 100, 100), activation=’relu’))<br/>
model.add(Dropout(0.2))<br/>
model.add(Convolution2D(32, 3, 3, activation=’relu’))<br/>
model.add(MaxPooling2D(pool_size=(2, 2)))<br/>
model.add(Flatten())<br/>
model.add(Dense(512, activation=’relu’))<br/>
model.add(Dropout(0.5))<br/>
model.add(Dense(1, activation=’softmax’))</p>
<p>epochs = 10<br/>
lrate = 0.001<br/>
decay = lrate/epochs<br/>
sgd = SGD(lr=lrate, momentum=0.9, decay=decay, nesterov=False)<br/>
print(‘compiling model’)<br/>
model.compile(loss=’binary_crossentropy’, optimizer=sgd, metrics=[‘accuracy’])</p>
<p>print(“fitting model”)<br/>
model.fit(X_training, Y_training, nb_epoch=epochs, batch_size=100)</p>
<p>But every time, I get these results:</p>
<p>fitting model<br/>
Train on 908 samples, validate on 908 samples<br/>
Epoch 1/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 2/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 3/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 4/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 5/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 6/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 7/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 8/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 9/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000<br/>
Epoch 10/10<br/>
908/908 [==============================] – 104s – loss: 7.9712 – acc: 0.5000</p>
<p>What am I doing wrong?</p>
<div class="reply">
<a aria-label="Reply to Daniel" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=402932#respond" onclick='return addComment.moveForm( "comment-402932", "402932", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402946">
<div class="comment-container" id="li-comment-402946">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-402946" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a list of ideas you can try here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=402946#respond" onclick='return addComment.moveForm( "comment-402946", "402946", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404069">
<div class="comment-container" id="li-comment-404069">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c8b59cf9856cfca6210dd4d2140f47c9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c8b59cf9856cfca6210dd4d2140f47c9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Darlington Akogo</span>
<span class="date">June 28, 2017 at 10:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404069" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, thanks for your great tutorials! I need some help please, I’m working on an a medical image recognition(diagnostics) project based on your tutorials. Over here, you import the Cifar10 dataset provided via Keras with the load_data() function, but since am downloading the dataset from a diff source, that wouldn’t be possible. So from some research, I came across Keras’ flow_from_directory() function for Image data processing, which is amazing, I could just separate the images into folders and it’d consider them as classes. However, medical images are in the “DICOM” image format, and Keras image functions don’t seem to support it, so with further research, I came across pydicom module, for processing DICOM images in python, however, now, I can’t use flow_from_directory(), can you PLEASE offer some help as to how I can train my ConvNet model with DICOM images and be able to use it to classify(with  predict() function) any new DICOM image? </p>
<p>Thanks in advanced.</p>
<div class="reply">
<a aria-label="Reply to Darlington Akogo" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404069#respond" onclick='return addComment.moveForm( "comment-404069", "404069", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404163">
<div class="comment-container" id="li-comment-404163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know about that format.</p>
<p>Perhaps you can covert the images?<br/>
Perhaps you can put together your own DICOM-comapitable flow from dir function?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404163#respond" onclick='return addComment.moveForm( "comment-404163", "404163", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-422644">
<div class="comment-container" id="li-comment-422644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/347345cd57def228f1127995ed8dba7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/347345cd57def228f1127995ed8dba7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shila mosammami</span>
<span class="date">December 10, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-422644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Friend,<br/>
try this:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659276afc6d572136067" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def load_itk(filename):
    # Reads the image using SimpleITK
    itkimage = sitk.ReadImage(filename)

    # Convert the image to a  numpy array first and then shuffle the dimensions to get axis in the order z,y,x
    ct_scan = sitk.GetArrayFromImage(itkimage)

    # Read the origin of the ct_scan, will be used to convert the coordinates from world to voxel and vice versa.
    origin = np.array(list(reversed(itkimage.GetOrigin())))

    # Read the spacing along each dimension
    spacing = np.array(list(reversed(itkimage.GetSpacing())))


    return ct_scan, origin, spacing</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-2">2</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-4">4</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-6">6</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-8">8</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-10">10</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-12">12</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659276afc6d572136067-14">14</div><div class="crayon-num" data-line="crayon-5a659276afc6d572136067-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659276afc6d572136067-1"><span class="crayon-e">def </span><span class="crayon-e">load_itk</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-2"><span class="crayon-h">    </span><span class="crayon-p"># Reads the image using SimpleITK</span></div><div class="crayon-line" id="crayon-5a659276afc6d572136067-3"><span class="crayon-h">    </span><span class="crayon-v">itkimage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sitk</span><span class="crayon-sy">.</span><span class="crayon-e">ReadImage</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-4"> </div><div class="crayon-line" id="crayon-5a659276afc6d572136067-5"><span class="crayon-h">    </span><span class="crayon-p"># Convert the image to a  numpy array first and then shuffle the dimensions to get axis in the order z,y,x</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-6"><span class="crayon-h">    </span><span class="crayon-v">ct_scan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sitk</span><span class="crayon-sy">.</span><span class="crayon-e">GetArrayFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">itkimage</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276afc6d572136067-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-8"><span class="crayon-h">    </span><span class="crayon-p"># Read the origin of the ct_scan, will be used to convert the coordinates from world to voxel and vice versa.</span></div><div class="crayon-line" id="crayon-5a659276afc6d572136067-9"><span class="crayon-h">    </span><span class="crayon-v">origin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">itkimage</span><span class="crayon-sy">.</span><span class="crayon-e">GetOrigin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-10"> </div><div class="crayon-line" id="crayon-5a659276afc6d572136067-11"><span class="crayon-h">    </span><span class="crayon-p"># Read the spacing along each dimension</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-12"><span class="crayon-h">    </span><span class="crayon-v">spacing</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">itkimage</span><span class="crayon-sy">.</span><span class="crayon-e">GetSpacing</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659276afc6d572136067-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a659276afc6d572136067-14"> </div><div class="crayon-line" id="crayon-5a659276afc6d572136067-15"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">ct_scan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">origin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spacing</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to shila mosammami" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=422644#respond" onclick='return addComment.moveForm( "comment-422644", "422644", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404212">
<div class="comment-container" id="li-comment-404212">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5808a64c7fd34f161973d0b5685b72ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5808a64c7fd34f161973d0b5685b72ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bruce Wind</span>
<span class="date">June 29, 2017 at 11:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404212" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason, thanks for sharing. I test the code you provided, but my machine does not support CUDA, so it runs very slowly( half an hour per epoch). Since you have such a powerful computer, could you please show the results after hundreds or thousands epoches later? Thanks.</p>
<div class="reply">
<a aria-label="Reply to Bruce Wind" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404212#respond" onclick='return addComment.moveForm( "comment-404212", "404212", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404299">
<div class="comment-container" id="li-comment-404299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2017 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I ran the example on AWS. I recommend you try the same:<br/>
<a href="http://MachineLearningMastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow">http://MachineLearningMastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404299#respond" onclick='return addComment.moveForm( "comment-404299", "404299", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-404679">
<div class="comment-container" id="li-comment-404679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean</span>
<span class="date">July 4, 2017 at 9:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-404679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It really helps!</p>
<div class="reply">
<a aria-label="Reply to Sean" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=404679#respond" onclick='return addComment.moveForm( "comment-404679", "404679", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407039">
<div class="comment-container" id="li-comment-407039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 23, 2017 at 10:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
 Really it is a very nice tutorial :). If you will plot acc vs acc_val there is a gap between the graph of acc and the graph of acc_val  does this mean an overfitting ?! and also what I ( correct me if iam wrong) the accuracy graph should become after a certain number of epochs asymptotic( that is the acuracy will not increase anymore) !!<br/>
 Thanks in advance<br/>
Noura</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407039#respond" onclick='return addComment.moveForm( "comment-407039", "407039", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407082">
<div class="comment-container" id="li-comment-407082">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 24, 2017 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407082" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If acc is less than val_acc than it may mean that the model is underfitting and that perhaps a larger model or a model fit for longer would do better on the validation set.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407082#respond" onclick='return addComment.moveForm( "comment-407082", "407082", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-407149">
<div class="comment-container" id="li-comment-407149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 24, 2017 at 6:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>yes it is true but also if the acc_val is more than the acc then there is overfitting and I noticed this in your both results above ! what could be the reason of the overfitting ? and what we can do to get rid form it.</p>
<p>regards<br/>
Nunu</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407149#respond" onclick='return addComment.moveForm( "comment-407149", "407149", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-407224">
<div class="comment-container" id="li-comment-407224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps train less, perhaps train a smaller model, perhaps add some regularization like dropout.</p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407224#respond" onclick='return addComment.moveForm( "comment-407224", "407224", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-407267">
<div class="comment-container" id="li-comment-407267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 25, 2017 at 7:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I added dropouts and I added one more fully connected layer and i guess it worked.</p>
<p>Thanks a lot Jason 🙂<br/>
Best regards,<br/>
Nunu</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407267#respond" onclick='return addComment.moveForm( "comment-407267", "407267", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407318">
<div class="comment-container" id="li-comment-407318">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-407318" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=407318#respond" onclick='return addComment.moveForm( "comment-407318", "407318", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-411368">
<div class="comment-container" id="li-comment-411368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f4aa10f52d8323b2f88237a959d99bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f4aa10f52d8323b2f88237a959d99bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luna</span>
<span class="date">August 27, 2017 at 6:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-411368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Normally CNN for image classification will result in a vector contented probabilities of possible class. Is there a function in this library to extract the vector? Thank you!</p>
<div class="reply">
<a aria-label="Reply to Luna" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=411368#respond" onclick='return addComment.moveForm( "comment-411368", "411368", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411429">
<div class="comment-container" id="li-comment-411429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 28, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-411429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use a softmax activation function on the output layer to get probabilities for multiple classes or sigmoid activation for binary class probabilities.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=411429#respond" onclick='return addComment.moveForm( "comment-411429", "411429", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-412104">
<div class="comment-container" id="li-comment-412104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">September 2, 2017 at 4:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-412104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
is there is a way to apply the keras.predict function in a vectorized manner so that it can handle more than one input(image) simultaneously?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=412104#respond" onclick='return addComment.moveForm( "comment-412104", "412104", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412127">
<div class="comment-container" id="li-comment-412127">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2017 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-412127" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I believe predict() can take a list of samples (X) and return a list of predictions (yhat).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=412127#respond" onclick='return addComment.moveForm( "comment-412127", "412127", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-412601">
<div class="comment-container" id="li-comment-412601">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d98aee7c58e339d156bba981111a84b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d98aee7c58e339d156bba981111a84b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zoda</span>
<span class="date">September 5, 2017 at 3:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-412601" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello,</p>
<p>what can i do if i have one image which consistent of  6 objects in the image how can i detect and measure the size of the object in the image. it would be helpful if you gave me some tips<br/>
thank you .</p>
<div class="reply">
<a aria-label="Reply to zoda" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=412601#respond" onclick='return addComment.moveForm( "comment-412601", "412601", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412941">
<div class="comment-container" id="li-comment-412941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-412941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use object localization.</p>
<p>Sorry, I don’t have an example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=412941#respond" onclick='return addComment.moveForm( "comment-412941", "412941", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414715">
<div class="comment-container" id="li-comment-414715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c38ea6a5a23323f19896357aeb59897?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c38ea6a5a23323f19896357aeb59897?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sunil A Patel</span>
<span class="date">September 24, 2017 at 4:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-414715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir,</p>
<p>I want to detect hand in a image. my problem is the size of hand is tiny in a image and its vary image to image(my image size is 1920*1080),. An image contain hand, cup ,face, table, etc…..</p>
<p>My problem is<br/>
1. should we train CNN for various hand shape  and fixed size for example 50X50  or else<br/>
2. how to find localization of hand.</p>
<div class="reply">
<a aria-label="Reply to Sunil A Patel" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=414715#respond" onclick='return addComment.moveForm( "comment-414715", "414715", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414750">
<div class="comment-container" id="li-comment-414750">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-414750" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have examples of object localization. I hope to develop examples in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=414750#respond" onclick='return addComment.moveForm( "comment-414750", "414750", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416936">
<div class="comment-container" id="li-comment-416936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ad8975138312c6fe599d04d4cf4c745?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ad8975138312c6fe599d04d4cf4c745?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vinay</span>
<span class="date">October 17, 2017 at 12:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-416936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to run this code on GPU enabled machine?</p>
<div class="reply">
<a aria-label="Reply to vinay" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=416936#respond" onclick='return addComment.moveForm( "comment-416936", "416936", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416984">
<div class="comment-container" id="li-comment-416984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-416984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need to configure your TensorFlow or Theano library to use the GPU. I do not have instructions for this, sorry.</p>
<p>Generally, I would recommend using a pre-configured system, such as Amazon for about $1/hour:<br/>
<a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow">https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=416984#respond" onclick='return addComment.moveForm( "comment-416984", "416984", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417048">
<div class="comment-container" id="li-comment-417048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b4ae470268967c9d275b319d1aa0df5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b4ae470268967c9d275b319d1aa0df5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Miles</span>
<span class="date">October 18, 2017 at 1:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-417048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>In the first example network, you use a maxnorm kernel constraint in all hidden layers (conv and fully connected). I understand the advantages of this, particularly when used in combination with dropout. I’m wondering if there was a reason you removed the kernel constraint from the conv. layers in the second iteration of your model? If so, would you mind explaining the motivation for doing so? Thanks!</p>
<div class="reply">
<a aria-label="Reply to Miles" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=417048#respond" onclick='return addComment.moveForm( "comment-417048", "417048", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417063">
<div class="comment-container" id="li-comment-417063">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 18, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-417063" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It was few years ago now, I don’t remember. Perhaps the model achieved better results without the constraint?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=417063#respond" onclick='return addComment.moveForm( "comment-417063", "417063", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417106">
<div class="comment-container" id="li-comment-417106">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/070cff1ebdbab3d7f223fb58958e94d9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/070cff1ebdbab3d7f223fb58958e94d9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tin Tran</span>
<span class="date">October 18, 2017 at 6:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-417106" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>When we completed training the model, how do we use that model with a new picture?</p>
<div class="reply">
<a aria-label="Reply to Tin Tran" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=417106#respond" onclick='return addComment.moveForm( "comment-417106", "417106", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417137">
<div class="comment-container" id="li-comment-417137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 19, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-417137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, see this post on how to finalize a model:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>Once you have a final model, you can call it:<br/>
yhat = model.predict(newX)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=417137#respond" onclick='return addComment.moveForm( "comment-417137", "417137", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418243">
<div class="comment-container" id="li-comment-418243">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/599a1139c8b852d4b110f90a8cf80981?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/599a1139c8b852d4b110f90a8cf80981?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gabriele Minniti</span>
<span class="date">October 28, 2017 at 8:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-418243" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! My name is Gabriele, and I’m a young data scientis! I’m current working with the CNNs and i’ve few question for you. </p>
<p>1. I’ve seen that you are using images 32 x 32, my question is about which is the best shape for an high-resolution image of 1070 – 720? It’s necessary that the images are squared? </p>
<p>2. How significatly could be the improvement of the number of epoch in ‘accuracy metrics’? Maybe 100 epoch? 1000? Could them return an high perfomarce model? </p>
<p>Thanks a lot!<br/>
PS. Sorry for my “not perfect english” i hope that you understand my questions!<br/>
GM</p>
<div class="reply">
<a aria-label="Reply to Gabriele Minniti" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=418243#respond" onclick='return addComment.moveForm( "comment-418243", "418243", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418289">
<div class="comment-container" id="li-comment-418289">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-418289" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can try different shaped images or normalize to one shape. Smaller images require smaller models which in turn train faster.</p>
<p>This post will give you ideas on how to improve model performance for neural nets:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=418289#respond" onclick='return addComment.moveForm( "comment-418289", "418289", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419234">
<div class="comment-container" id="li-comment-419234">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fcafdd4efcc4562b35e53f250dc5e5c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fcafdd4efcc4562b35e53f250dc5e5c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kumar</span>
<span class="date">November 7, 2017 at 6:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-419234" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I am trying to identify multiple objects in an image and count the number of objects for each class in each image. Can you help me on this.</p>
<div class="reply">
<a aria-label="Reply to Kumar" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=419234#respond" onclick='return addComment.moveForm( "comment-419234", "419234", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419335">
<div class="comment-container" id="li-comment-419335">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-419335" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a great problem, but I don’t have material on this type of problem, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=419335#respond" onclick='return addComment.moveForm( "comment-419335", "419335", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420000">
<div class="comment-container" id="li-comment-420000">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee3134f22082cd35a9da62afd859dcd3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee3134f22082cd35a9da62afd859dcd3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arun</span>
<span class="date">November 15, 2017 at 12:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-420000" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hey</p>
<p>Traceback (most recent call last):</p>
<p>  File “”, line 1, in<br/>
    b=model.fit(X, Y,validation_split=0.33, epochs=150, batch_size=10,verbose=0)</p>
<p>  File “/Users/arun/anaconda/lib/python3.6/site-packages/keras/models.py”, line 893, in fit<br/>
    initial_epoch=initial_epoch)</p>
<p>  File “/Users/arun/anaconda/lib/python3.6/site-packages/keras/engine/training.py”, line 1555, in fit<br/>
    batch_size=batch_size)</p>
<p>  File “/Users/arun/anaconda/lib/python3.6/site-packages/keras/engine/training.py”, line 1409, in _standardize_user_data<br/>
    exception_prefix=’input’)</p>
<p>  File “/Users/arun/anaconda/lib/python3.6/site-packages/keras/engine/training.py”, line 126, in _standardize_input_data<br/>
    array = data[i]</p>
<p>UnboundLocalError: local variable ‘arrays’ referenced before assignment</p>
<p>I am getting this error when trying to fit the model. Looks like its an error in Keras.</p>
<div class="reply">
<a aria-label="Reply to Arun" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=420000#respond" onclick='return addComment.moveForm( "comment-420000", "420000", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420044">
<div class="comment-container" id="li-comment-420044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2017 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-420044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check you have the latest version of all libraries installed:<br/>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>
<p>Also confirm that you have copied all of the code in the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=420044#respond" onclick='return addComment.moveForm( "comment-420044", "420044", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420216">
<div class="comment-container" id="li-comment-420216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4b3430400b058dce2157e5833317a5a0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4b3430400b058dce2157e5833317a5a0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Himmat Ram Bairwa</span>
<span class="date">November 16, 2017 at 6:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-420216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi<br/>
i have give my own .jpg image then i want to predict the class but i am getting wrong result.</p>
<p>img = cv2.imread(‘C:/Users/8himmat/Desktop/ML/data/train/cats/dog2.jpg’)<br/>
img = cv2.resize(img,(32,32))<br/>
img = numpy.array(img)<br/>
img = numpy.reshape(img,[1,3,32,32])<br/>
preds = model.predict_classes(img)</p>
<div class="reply">
<a aria-label="Reply to Himmat Ram Bairwa" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=420216#respond" onclick='return addComment.moveForm( "comment-420216", "420216", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420284">
<div class="comment-container" id="li-comment-420284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-420284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the model is not good enough for your example?</p>
<p>Try more examples, try training the model with more examples like the example you tried, try augmenting during training, and so on.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=420284#respond" onclick='return addComment.moveForm( "comment-420284", "420284", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422646">
<div class="comment-container" id="li-comment-422646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/347345cd57def228f1127995ed8dba7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/347345cd57def228f1127995ed8dba7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sheila M</span>
<span class="date">December 10, 2017 at 9:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-422646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
First thanks a million for the tutorial you have provided.<br/>
I am trying to work on liver segmentation with ConvNN, and my data set is Sliver07 which includes meta images. there are two folders named scan which includes the oroginal meta images of CTscan, 20 on total and the second folder named segment which includes 20 meta images of segmented livers. Each instance has 2 formats .mhd and .raw, they can be easily viewed by the itksnap. I can load data and get the numpy array but the numpy array i get from the output for the original images and segmented images are as below:<br/>
[[[-1007  -997 -1007 …,  -973  -969 -1007]<br/>
  [-1002 -1000 -1007 …,  -979  -999 -1015]<br/>
  [-1000  -993 -1003 …,  -999 -1009 -1007]<br/>
  …,<br/>
  [ -894  -877  -883 …,  -893  -895  -906]<br/>
  [ -872  -878  -894 …,  -896  -892  -894]<br/>
  [ -873  -882  -893 …,  -898  -909  -896]]</p>
<p> [[-1005  -999 -1006 …,  -972  -964 -1008]<br/>
  [-1008  -995 -1004 …,  -966  -995 -1022]<br/>
  [-1004  -991 -1001 …,  -990 -1015 -1008]<br/>
  …,<br/>
  [ -905  -882  -897 …,  -889  -878  -895]<br/>
  [ -879  -884  -910 …,  -885  -880  -891]<br/>
  [ -874  -893  -907 …,  -882  -887  -897]]</p>
<p> [[-1001 -1010 -1009 …,  -991  -967 -1000]<br/>
  [-1000 -1004 -1006 …,  -977  -989 -1019]<br/>
  [ -993  -993 -1001 …,  -988 -1013 -1001]<br/>
  …,<br/>
  [ -902  -918  -911 …,  -899  -888  -892]<br/>
  [ -905  -909  -911 …,  -899  -887  -888]<br/>
  [ -909  -911  -908 …,  -900  -901  -896]]</p>
<p> …,<br/>
 [[-1001 -1002 -1002 …, -1007  -998 -1004]<br/>
  [-1004 -1004 -1005 …, -1003 -1009 -1000]<br/>
  [ -996 -1002 -1005 …,  -996 -1000  -988]<br/>
  …,<br/>
  [ -888  -896  -897 …,  -883  -888  -898]<br/>
  [ -879  -875  -866 …,  -886  -881  -894]<br/>
  [ -878  -866  -867 …,  -895  -891  -896]]</p>
<p> [[ -986  -990  -997 …, -1010 -1004 -1008]<br/>
  [ -999  -994  -995 …, -1003 -1007 -1002]<br/>
  [-1006 -1011 -1006 …, -1000  -996  -980]<br/>
  …,<br/>
  [ -887  -894  -900 …,  -888  -893  -903]<br/>
  [ -882  -885  -879 …,  -891  -883  -892]<br/>
  [ -880  -876  -876 …,  -896  -884  -882]]</p>
<p> [[-1000 -1004 -1003 …, -1002 -1003  -997]<br/>
  [-1007 -1002 -1004 …, -1002  -997  -998]<br/>
  [-1013 -1011  -997 …,  -998  -995  -993]<br/>
  …,<br/>
  [ -887  -894  -891 …,  -886  -891  -900]<br/>
  [ -892  -892  -885 …,  -892  -885  -893]<br/>
  [ -895  -893  -885 …,  -902  -893  -889]]]<br/>
segmented numpy:<br/>
[[[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]</p>
<p> [[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]</p>
<p> [[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]</p>
<p> …,<br/>
 [[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]</p>
<p> [[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]</p>
<p> [[0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  …,<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]<br/>
  [0 0 0 …, 0 0 0]]]<br/>
1) I have no idea how i can build a model for this.<br/>
2)The numbers seem to be so strange for me, why all negative in original and all zero in segmented ones?<br/>
3) I expected to have 20 array for each folder, which I cannot make sense with these results.<br/>
Best Regards</p>
<div class="reply">
<a aria-label="Reply to Sheila M" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=422646#respond" onclick='return addComment.moveForm( "comment-422646", "422646", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422705">
<div class="comment-container" id="li-comment-422705">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-422705" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps contact the owners of the dataset to ask for more information about it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=422705#respond" onclick='return addComment.moveForm( "comment-422705", "422705", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426844">
<div class="comment-container" id="li-comment-426844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4316a67621c80d2e666f52894af3029e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4316a67621c80d2e666f52894af3029e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fabrizio</span>
<span class="date">January 18, 2018 at 11:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-426844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
   I’m currently working on a real-time object detection. I have some constrains I need to keep in mind: this program should work under an ordinary PC desktop and the main idea is that it should be able to detect objects taking a video as input. So it shouldn’t be expensive when it comes to computational cost.<br/>
   Is a CNN a good approach to solve this problem? Googling, I’ve seen a pretrained DNN on OpenCV (I should use OpenCV as much as possible) but it runs under Caffe and I have no idea about Caffe.<br/>
   That’s why I am here and I think a CNN would be a nice approach. What do you think? Do you have some extra advices/tips?</p>
<div class="reply">
<a aria-label="Reply to Fabrizio" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=426844#respond" onclick='return addComment.moveForm( "comment-426844", "426844", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426878">
<div class="comment-container" id="li-comment-426878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#comment-426878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think running a CNN is straight forward, training is very slow.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/?replytocom=426878#respond" onclick='return addComment.moveForm( "comment-426878", "426878", "respond", "2596" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/object-recognition-convolutional-neural-networks-keras-deep-learning-library/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2596"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="0fd1315191"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="52"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>