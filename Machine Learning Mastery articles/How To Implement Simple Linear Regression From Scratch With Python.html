<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How To Implement Simple Linear Regression From Scratch With Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How To Implement Simple Linear Regression From Scratch With Python - Machine Learning Mastery" property="og:title"/>
<meta content="Linear regression is a prediction method that is more than 200 years old. Simple linear regression is a great first machine learning algorithm to implement as it requires you to estimate properties from your training dataset, but is simple enough for beginners to understand. In this tutorial, you will discover how to implement the simple …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Algorithms From Scratch" property="article:section"/>
<meta content="2016-10-26T05:00:42+11:00" property="article:published_time"/>
<meta content="2017-05-05T07:32:08+11:00" property="article:modified_time"/>
<meta content="2017-05-05T07:32:08+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/How-To-Implement-Simple-Linear-Regression-From-Scratch-With-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/How-To-Implement-Simple-Linear-Regression-From-Scratch-With-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/implement-simple-linear-regression-scratch-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How To Implement Simple Linear Regression From Scratch With Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3327" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-simple-linear-regression-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-simple-linear-regression-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3327 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Need help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3327 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How To Implement Simple Linear Regression From Scratch With Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-10-26T05:00:42+1100">October 26, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Algorithms From Scratch">Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-simple-linear-regression-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/&amp;summary=Linear+regression+is+a+prediction+method+that+is+more+than+200+years+old.%0D%0A%0D%0ASimple+linear+regressio..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/&amp;summary=Linear+regression+is+a+prediction+method+that+is+more+than+200+years+old.%0D%0A%0D%0ASimple+linear+regressio...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Linear regression is a prediction method that is more than 200 years old.</p>
<p><a href="http://machinelearningmastery.com/simple-linear-regression-tutorial-for-machine-learning/">Simple linear regression</a> is a great first machine learning algorithm to implement as it requires you to estimate properties from your training dataset, but is simple enough for beginners to understand.</p>
<p>In this tutorial, you will discover how to implement the simple linear regression algorithm from scratch in Python.</p>
<p>After completing this tutorial you will know:</p>
<ul>
<li>How to estimate statistical quantities from training data.</li>
<li>How to estimate linear regression coefficients from data.</li>
<li>How to make predictions using linear regression for new data.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_3331" style="max-width: 650px"><img alt="How To Implement Simple Linear Regression From Scratch With Python" class="size-full wp-image-3331" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/How-To-Implement-Simple-Linear-Regression-From-Scratch-With-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/How-To-Implement-Simple-Linear-Regression-From-Scratch-With-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/How-To-Implement-Simple-Linear-Regression-From-Scratch-With-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How To Implement Simple Linear Regression From Scratch With Python<br/>Photo by <a href="https://www.flickr.com/photos/kamshots/456696484/">Kamyar Adl</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section is divided into two parts, a description of the simple linear regression technique and a description of the dataset to which we will later apply it.</p>
<h3>Simple Linear Regression</h3>
<p>Linear regression assumes a linear or straight line relationship between the input variables (X) and the single output variable (y).</p>
<p>More specifically, that output (y) can be calculated from a linear combination of the input variables (X). When there is a single input variable, the method is referred to as a simple linear regression.</p>
<p>In simple linear regression we can use statistics on the training data to estimate the coefficients required by the model to make predictions on new data.</p>
<p>The line for a simple linear regression model can be written as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe2e401739154" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
y = b0 + b1 * x</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe2e401739154-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe2e401739154-1">y = b0 + b1 * x</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>where b0 and b1 are the coefficients we must estimate from the training data.</p>
<p>Once the coefficients are known, we can use this equation to estimate output values for y given new input examples of x.</p>
<p>It requires that you calculate statistical properties from the data such as mean, variance and covariance.</p>
<p>All the algebra has been taken care of and we are left with some arithmetic to implement to estimate the simple linear regression coefficients.</p>
<p>Briefly, we can estimate the coefficients as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe39771206704" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
B1 = sum((x(i) - mean(x)) * (y(i) - mean(y))) / sum( (x(i) - mean(x))^2 )
B0 = mean(y) - B1 * mean(x)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe39771206704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe39771206704-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe39771206704-1">B1 = sum((x(i) - mean(x)) * (y(i) - mean(y))) / sum( (x(i) - mean(x))^2 )</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe39771206704-2">B0 = mean(y) - B1 * mean(x)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>where the i refers to the value of the ith value of the input x or output y.</p>
<p>Don’t worry if this is not clear right now, these are the functions will implement in the tutorial.</p>
<h3>Swedish Insurance Dataset</h3>
<p>We will use a real dataset to demonstrate simple linear regression.</p>
<p>The dataset is called the “Auto Insurance in Sweden” dataset and involves predicting the total payment for all the claims in thousands of Swedish Kronor (y) given the total number of claims (x).</p>
<p>This means that for a new number of claims (x) we will be able to predict the total payment of claims (y).</p>
<p>Here is a small sample of the first 5 records of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe3c849992520" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
108,392.5
19,46.2
13,15.7
124,422.2
40,119.4</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe3c849992520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe3c849992520-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe3c849992520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe3c849992520-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe3c849992520-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe3c849992520-1">108,392.5</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe3c849992520-2">19,46.2</div><div class="crayon-line" id="crayon-5a6593027fe3c849992520-3">13,15.7</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe3c849992520-4">124,422.2</div><div class="crayon-line" id="crayon-5a6593027fe3c849992520-5">40,119.4</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Using the Zero Rule algorithm (that predicts the mean value) a Root Mean Squared Error or RMSE of about 72.251 (thousands of Kronor) is expected.</p>
<p>Below is a scatter plot of the entire dataset.</p>
<div class="wp-caption aligncenter" id="attachment_3328" style="max-width: 763px"><img alt="Swedish Insurance Dataset" class="size-full wp-image-3328" height="454" sizes="(max-width: 753px) 100vw, 753px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Swedish-Insurance-Dataset.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Swedish-Insurance-Dataset.png 753w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Swedish-Insurance-Dataset-300x181.png 300w" width="753"/><p class="wp-caption-text">Swedish Insurance Dataset</p></div>
<p>You can download the raw dataset from <a href="https://www.math.muni.cz/~kolacek/docs/frvs/M7222/data/AutoInsurSweden.txt">here</a> or <a href="http://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/slr/frames/slr06.html">here</a>.</p>
<p>Save it to a CSV file in your local working directory with the name “<strong>insurance.csv</strong>“.</p>
<p>Note, you may need to convert the European “,” to the decimal “.”. You will also need change the file from white-space-separated variables to CSV format.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into five parts:</p>
<ol>
<li>Calculate Mean and Variance.</li>
<li>Calculate Covariance.</li>
<li>Estimate Coefficients.</li>
<li>Make Predictions.</li>
<li>Predict Insurance.</li>
</ol>
<p>These steps will give you the foundation you need to implement and train simple linear regression models for your own prediction problems.</p>
<h3>1. Calculate Mean and Variance</h3>
<p>The first step is to estimate the mean and the variance of both the input and output variables from the training data.</p>
<p>The mean of a list of numbers can be calculated as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe40281956648" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
mean(x) = sum(x) / count(x)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe40281956648-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe40281956648-1">mean(x) = sum(x) / count(x)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is a function named <strong>mean()</strong> that implements this behavior for a list of numbers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe44934238761" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe44934238761-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe44934238761-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe44934238761-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe44934238761-1"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe44934238761-2"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe44934238761-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The variance is the sum squared difference for each value from the mean value.</p>
<p>Variance for a list of numbers can be calculated as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe47746700167" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
variance = sum( (x - mean(x))^2 )</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe47746700167-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe47746700167-1">variance = sum( (x - mean(x))^2 )</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is a function named <strong>variance()</strong> that calculates the variance of a list of numbers. It requires the mean of the list to be provided as an argument, just so we don’t have to calculate it more than once.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe4c707042939" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the variance of a list of numbers
def variance(values, mean):
	return sum([(x-mean)**2 for x in values])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe4c707042939-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe4c707042939-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe4c707042939-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe4c707042939-1"><span class="crayon-p"># Calculate the variance of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe4c707042939-2"><span class="crayon-e">def </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe4c707042939-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can put these two functions together and test them on a small contrived dataset.</p>
<p>Below is a small dataset of x and y values.</p>
<p><strong>NOTE</strong>: delete the column headers from this data if you save it to a .CSV file for use with the final code example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe50576876171" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
x, y
1, 1
2, 3
4, 3
3, 2
5, 5</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe50576876171-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe50576876171-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe50576876171-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe50576876171-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe50576876171-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe50576876171-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe50576876171-1">x, y</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe50576876171-2">1, 1</div><div class="crayon-line" id="crayon-5a6593027fe50576876171-3">2, 3</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe50576876171-4">4, 3</div><div class="crayon-line" id="crayon-5a6593027fe50576876171-5">3, 2</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe50576876171-6">5, 5</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can plot this dataset on a scatter plot graph as follows:</p>
<div class="wp-caption aligncenter" id="attachment_3329" style="max-width: 764px"><img alt="Small Contrived Dataset For Simple Linear Regression" class="size-full wp-image-3329" height="454" sizes="(max-width: 754px) 100vw, 754px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Small-Contrived-Dataset-For-Simple-Linear-Regression.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Small-Contrived-Dataset-For-Simple-Linear-Regression.png 754w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Small-Contrived-Dataset-For-Simple-Linear-Regression-300x181.png 300w" width="754"/><p class="wp-caption-text">Small Contrived Dataset For Simple Linear Regression</p></div>
<p>We can calculate the mean and variance for both the x and y values in the example below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe55300139426" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Estimate Mean and Variance

# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))

# Calculate the variance of a list of numbers
def variance(values, mean):
	return sum([(x-mean)**2 for x in values])

# calculate mean and variance
dataset = [[1, 1], [2, 3], [4, 3], [3, 2], [5, 5]]
x = [row[0] for row in dataset]
y = [row[1] for row in dataset]
mean_x, mean_y = mean(x), mean(y)
var_x, var_y = variance(x, mean_x), variance(y, mean_y)
print('x stats: mean=%.3f variance=%.3f' % (mean_x, var_x))
print('y stats: mean=%.3f variance=%.3f' % (mean_y, var_y))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-8">8</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-10">10</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-12">12</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-14">14</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-16">16</div><div class="crayon-num" data-line="crayon-5a6593027fe55300139426-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe55300139426-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe55300139426-1"><span class="crayon-p"># Estimate Mean and Variance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-2"> </div><div class="crayon-line" id="crayon-5a6593027fe55300139426-3"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-4"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe55300139426-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-6"> </div><div class="crayon-line" id="crayon-5a6593027fe55300139426-7"><span class="crayon-p"># Calculate the variance of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-8"><span class="crayon-e">def </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe55300139426-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-10"> </div><div class="crayon-line" id="crayon-5a6593027fe55300139426-11"><span class="crayon-p"># calculate mean and variance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-12"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe55300139426-13"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-14"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe55300139426-15"><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-16"><span class="crayon-v">var_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">var_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe55300139426-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'x stats: mean=%.3f variance=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">var_x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe55300139426-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'y stats: mean=%.3f variance=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">var_y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Running this example prints out the mean and variance for both columns.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe5a720200911" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
x stats: mean=3.000 variance=10.000
y stats: mean=2.800 variance=8.800</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe5a720200911-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe5a720200911-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe5a720200911-1">x stats: mean=3.000 variance=10.000</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe5a720200911-2">y stats: mean=2.800 variance=8.800</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This is our first step, next we need to put these values to use in calculating the covariance.</p>
<h3>2. Calculate Covariance</h3>
<p>The covariance of two groups of numbers describes how those numbers change together.</p>
<p>Covariance is a generalization of correlation. Correlation describes the relationship between two groups of numbers, whereas covariance can describe the relationship between two or more groups of numbers.</p>
<p>Additionally, covariance can be normalized to produce a correlation value.</p>
<p>Nevertheless, we can calculate the covariance between two variables as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe5f336224801" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
covariance = sum((x(i) - mean(x)) * (y(i) - mean(y)))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe5f336224801-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe5f336224801-1">covariance = sum((x(i) - mean(x)) * (y(i) - mean(y)))</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Below is a function named <strong>covariance()</strong> that implements this statistic. It builds upon the previous step and takes the lists of x and y values as well as the mean of these values as arguments.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe62483296262" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate covariance between x and y
def covariance(x, mean_x, y, mean_y):
	covar = 0.0
	for i in range(len(x)):
		covar += (x[i] - mean_x) * (y[i] - mean_y)
	return covar</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe62483296262-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe62483296262-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe62483296262-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe62483296262-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe62483296262-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe62483296262-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe62483296262-1"><span class="crayon-p"># Calculate covariance between x and y</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe62483296262-2"><span class="crayon-e">def </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe62483296262-3"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe62483296262-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe62483296262-5"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe62483296262-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">covar</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can test the calculation of the covariance on the same small contrived dataset as in the previous section.</p>
<p>Putting it all together we get the example below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe64467426874" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate Covariance

# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))

# Calculate covariance between x and y
def covariance(x, mean_x, y, mean_y):
	covar = 0.0
	for i in range(len(x)):
		covar += (x[i] - mean_x) * (y[i] - mean_y)
	return covar

# calculate covariance
dataset = [[1, 1], [2, 3], [4, 3], [3, 2], [5, 5]]
x = [row[0] for row in dataset]
y = [row[1] for row in dataset]
mean_x, mean_y = mean(x), mean(y)
covar = covariance(x, mean_x, y, mean_y)
print('Covariance: %.3f' % (covar))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-8">8</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-10">10</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-12">12</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-14">14</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-16">16</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-18">18</div><div class="crayon-num" data-line="crayon-5a6593027fe64467426874-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe64467426874-20">20</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe64467426874-1"><span class="crayon-p"># Calculate Covariance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-2"> </div><div class="crayon-line" id="crayon-5a6593027fe64467426874-3"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-4"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-6"> </div><div class="crayon-line" id="crayon-5a6593027fe64467426874-7"><span class="crayon-p"># Calculate covariance between x and y</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-8"><span class="crayon-e">def </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-9"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-11"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">covar</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-14"><span class="crayon-p"># calculate covariance</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-15"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-16"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-17"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-18"><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe64467426874-19"><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe64467426874-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Covariance: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">covar</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>Running this example prints the covariance for the x and y variables.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe67005834174" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Covariance: 8.000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe67005834174-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe67005834174-1">Covariance: 8.000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We now have all the pieces in place to calculate the coefficients for our model.</p>
<h3>3. Estimate Coefficients</h3>
<p>We must estimate the values for two coefficients in simple linear regression.</p>
<p>The first is B1 which can be estimated as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe6a098123496" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
B1 = sum((x(i) - mean(x)) * (y(i) - mean(y))) / sum( (x(i) - mean(x))^2 )</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe6a098123496-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe6a098123496-1">B1 = sum((x(i) - mean(x)) * (y(i) - mean(y))) / sum( (x(i) - mean(x))^2 )</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We have learned some things above and can simplify this arithmetic to:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe6c552936103" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
B1 = covariance(x, y) / variance(x)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe6c552936103-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe6c552936103-1">B1 = covariance(x, y) / variance(x)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We already have functions to calculate <strong>covariance()</strong> and <strong>variance()</strong>.</p>
<p>Next, we need to estimate a value for B0, also called the intercept as it controls the starting point of the line where it intersects the y-axis.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe6f667309044" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
B0 = mean(y) - B1 * mean(x)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe6f667309044-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe6f667309044-1">B0 = mean(y) - B1 * mean(x)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Again, we know how to estimate B1 and we have a function to estimate <strong>mean()</strong>.</p>
<p>We can put all of this together into a function named <strong>coefficients()</strong> that takes the dataset as an argument and returns the coefficients.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe71190895614" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate coefficients
def coefficients(dataset):
	x = [row[0] for row in dataset]
	y = [row[1] for row in dataset]
	x_mean, y_mean = mean(x), mean(y)
	b1 = covariance(x, x_mean, y, y_mean) / variance(x, x_mean)
	b0 = y_mean - b1 * x_mean
	return [b0, b1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe71190895614-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe71190895614-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe71190895614-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe71190895614-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe71190895614-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe71190895614-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe71190895614-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe71190895614-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe71190895614-1"><span class="crayon-p"># Calculate coefficients</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe71190895614-2"><span class="crayon-e">def </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe71190895614-3"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe71190895614-4"><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe71190895614-5"><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe71190895614-6"><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe71190895614-7"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-e">x_mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe71190895614-8"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>We can put this together with all of the functions from the previous two steps and test out the calculation of coefficients.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe74604958138" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate Coefficients

# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))

# Calculate covariance between x and y
def covariance(x, mean_x, y, mean_y):
	covar = 0.0
	for i in range(len(x)):
		covar += (x[i] - mean_x) * (y[i] - mean_y)
	return covar

# Calculate the variance of a list of numbers
def variance(values, mean):
	return sum([(x-mean)**2 for x in values])

# Calculate coefficients
def coefficients(dataset):
	x = [row[0] for row in dataset]
	y = [row[1] for row in dataset]
	x_mean, y_mean = mean(x), mean(y)
	b1 = covariance(x, x_mean, y, y_mean) / variance(x, x_mean)
	b0 = y_mean - b1 * x_mean
	return [b0, b1]

# calculate coefficients
dataset = [[1, 1], [2, 3], [4, 3], [3, 2], [5, 5]]
b0, b1 = coefficients(dataset)
print('Coefficients: B0=%.3f, B1=%.3f' % (b0, b1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-8">8</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-10">10</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-12">12</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-14">14</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-16">16</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-18">18</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-20">20</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-22">22</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-24">24</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-26">26</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-28">28</div><div class="crayon-num" data-line="crayon-5a6593027fe74604958138-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe74604958138-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe74604958138-1"><span class="crayon-p"># Calculate Coefficients</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-2"> </div><div class="crayon-line" id="crayon-5a6593027fe74604958138-3"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-4"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-5"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-6"> </div><div class="crayon-line" id="crayon-5a6593027fe74604958138-7"><span class="crayon-p"># Calculate covariance between x and y</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-8"><span class="crayon-e">def </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-9"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-11"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">covar</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-14"><span class="crayon-p"># Calculate the variance of a list of numbers</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-15"><span class="crayon-e">def </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-18"><span class="crayon-p"># Calculate coefficients</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-19"><span class="crayon-e">def </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-20"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-21"><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-22"><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-23"><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-24"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-e">x_mean</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-25"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-26"> </div><div class="crayon-line" id="crayon-5a6593027fe74604958138-27"><span class="crayon-p"># calculate coefficients</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-28"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe74604958138-29"><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe74604958138-30"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Coefficients: B0=%.3f, B1=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>Running this example calculates and prints the coefficients.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe77731258085" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Coefficients: B0=0.400, B1=0.800</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe77731258085-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe77731258085-1">Coefficients: B0=0.400, B1=0.800</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we know how to estimate the coefficients, the next step is to use them.</p>
<h3>4. Make Predictions</h3>
<p>The simple linear regression model is a line defined by coefficients estimated from training data.</p>
<p>Once the coefficients are estimated, we can use them to make predictions.</p>
<p>The equation to make predictions with a simple linear regression model is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe7a724983569" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
y = b0 + b1 * x</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe7a724983569-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe7a724983569-1">y = b0 + b1 * x</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is a function named <strong>simple_linear_regression()</strong> that implements the prediction equation to make predictions on a test dataset. It also ties together the estimation of the coefficients on training data from the steps above.</p>
<p>The coefficients prepared from the training data are used to make predictions on the test data, which are then returned.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe7c658395174" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def simple_linear_regression(train, test):
	predictions = list()
	b0, b1 = coefficients(train)
	for row in test:
		yhat = b0 + b1 * row[0]
		predictions.append(yhat)
	return predictions</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe7c658395174-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7c658395174-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe7c658395174-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7c658395174-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe7c658395174-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7c658395174-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe7c658395174-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe7c658395174-1"><span class="crayon-e">def </span><span class="crayon-e">simple_linear_regression</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7c658395174-2"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7c658395174-3"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7c658395174-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7c658395174-5"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7c658395174-6"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7c658395174-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Let’s pull together everything we have learned and make predictions for our simple contrived dataset.</p>
<p>As part of this example, we will also add in a function to manage the evaluation of the predictions called <strong>evaluate_algorithm()</strong> and another function to estimate the Root Mean Squared Error of the predictions called <strong>rmse_metric()</strong>.</p>
<p>The full example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe7f488876291" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Standalone simple linear regression example
from math import sqrt

# Calculate root mean squared error
def rmse_metric(actual, predicted):
	sum_error = 0.0
	for i in range(len(actual)):
		prediction_error = predicted[i] - actual[i]
		sum_error += (prediction_error ** 2)
	mean_error = sum_error / float(len(actual))
	return sqrt(mean_error)

# Evaluate regression algorithm on training dataset
def evaluate_algorithm(dataset, algorithm):
	test_set = list()
	for row in dataset:
		row_copy = list(row)
		row_copy[-1] = None
		test_set.append(row_copy)
	predicted = algorithm(dataset, test_set)
	print(predicted)
	actual = [row[-1] for row in dataset]
	rmse = rmse_metric(actual, predicted)
	return rmse

# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))

# Calculate covariance between x and y
def covariance(x, mean_x, y, mean_y):
	covar = 0.0
	for i in range(len(x)):
		covar += (x[i] - mean_x) * (y[i] - mean_y)
	return covar

# Calculate the variance of a list of numbers
def variance(values, mean):
	return sum([(x-mean)**2 for x in values])

# Calculate coefficients
def coefficients(dataset):
	x = [row[0] for row in dataset]
	y = [row[1] for row in dataset]
	x_mean, y_mean = mean(x), mean(y)
	b1 = covariance(x, x_mean, y, y_mean) / variance(x, x_mean)
	b0 = y_mean - b1 * x_mean
	return [b0, b1]

# Simple linear regression algorithm
def simple_linear_regression(train, test):
	predictions = list()
	b0, b1 = coefficients(train)
	for row in test:
		yhat = b0 + b1 * row[0]
		predictions.append(yhat)
	return predictions

# Test simple linear regression
dataset = [[1, 1], [2, 3], [4, 3], [3, 2], [5, 5]]
rmse = evaluate_algorithm(dataset, simple_linear_regression)
print('RMSE: %.3f' % (rmse))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-8">8</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-10">10</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-12">12</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-14">14</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-16">16</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-18">18</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-20">20</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-22">22</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-24">24</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-26">26</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-28">28</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-30">30</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-32">32</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-34">34</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-36">36</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-38">38</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-40">40</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-42">42</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-44">44</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-46">46</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-48">48</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-50">50</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-52">52</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-54">54</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-56">56</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-58">58</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-60">60</div><div class="crayon-num" data-line="crayon-5a6593027fe7f488876291-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe7f488876291-62">62</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe7f488876291-1"><span class="crayon-p"># Standalone simple linear regression example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-2"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-4"><span class="crayon-p"># Calculate root mean squared error</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-5"><span class="crayon-e">def </span><span class="crayon-e">rmse_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-6"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-8"><span class="crayon-h"> </span><span class="crayon-v">prediction_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-9"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">prediction_error *</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-10"><span class="crayon-h"> </span><span class="crayon-v">mean_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mean_error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-12"> </div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-13"><span class="crayon-p"># Evaluate regression algorithm on training dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-14"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-15"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-16"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-17"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-18"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-19"><span class="crayon-e"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-20"><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-21"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-22"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-23"><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">rmse_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-24"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-26"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-27"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-28"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-30"><span class="crayon-p"># Calculate covariance between x and y</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-31"><span class="crayon-e">def </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-32"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-33"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-34"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">covar</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-36"> </div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-37"><span class="crayon-p"># Calculate the variance of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-38"><span class="crayon-e">def </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-39"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-40"> </div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-41"><span class="crayon-p"># Calculate coefficients</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-42"><span class="crayon-e">def </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-43"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-44"><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-45"><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-46"><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-47"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-e">x_mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-48"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-49"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-50"><span class="crayon-p"># Simple linear regression algorithm</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-51"><span class="crayon-e">def </span><span class="crayon-e">simple_linear_regression</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-52"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-53"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-54"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-55"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-56"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-57"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-58"> </div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-59"><span class="crayon-p"># Test simple linear regression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-60"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe7f488876291-61"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">simple_linear_regression</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe7f488876291-62"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0050 seconds] -->
<p>Running this example displays the following output that first lists the predictions and the RMSE of these predictions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe82639280566" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[1.1999999999999995, 1.9999999999999996, 3.5999999999999996, 2.8, 4.3999999999999995]
RMSE: 0.693</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe82639280566-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe82639280566-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe82639280566-1">[1.1999999999999995, 1.9999999999999996, 3.5999999999999996, 2.8, 4.3999999999999995]</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe82639280566-2">RMSE: 0.693</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Finally, we can plot the predictions as a line and compare it to the original dataset.</p>
<div class="wp-caption aligncenter" id="attachment_3330" style="max-width: 764px"><img alt="Predictions For Small Contrived Dataset For Simple Linear Regression" class="size-full wp-image-3330" height="454" sizes="(max-width: 754px) 100vw, 754px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Predictions-For-Small-Contrived-Dataset-For-Simple-Linear-Regression.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Predictions-For-Small-Contrived-Dataset-For-Simple-Linear-Regression.png 754w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/10/Predictions-For-Small-Contrived-Dataset-For-Simple-Linear-Regression-300x181.png 300w" width="754"/><p class="wp-caption-text">Predictions For Small Contrived Dataset For Simple Linear Regression</p></div>
<h3>5. Predict Insurance</h3>
<p>We now know how to implement a simple linear regression model.</p>
<p>Let’s apply it to the Swedish insurance dataset.</p>
<p>This section assumes that you have downloaded the dataset to the file <strong>insurance.csv</strong> and it is available in the current working directory.</p>
<p>We will add some convenience functions to the simple linear regression from the previous steps.</p>
<p>Specifically a function to load the CSV file called <strong>load_csv()</strong>, a function to convert a loaded dataset to numbers called <strong>str_column_to_float()</strong>, a function to evaluate an algorithm using a train and test set called <strong>train_test_split()</strong> a function to calculate RMSE called <strong>rmse_metric()</strong> and a function to evaluate an algorithm called <strong>evaluate_algorithm()</strong>.</p>
<p>The complete example is listed below.</p>
<p>A training dataset of 60% of the data is used to prepare the model and predictions are made on the remaining 40%.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe86890760772" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Simple Linear Regression on the Swedish Insurance Dataset
from random import seed
from random import randrange
from csv import reader
from math import sqrt

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Split a dataset into a train and test set
def train_test_split(dataset, split):
	train = list()
	train_size = split * len(dataset)
	dataset_copy = list(dataset)
	while len(train) &lt; train_size:
		index = randrange(len(dataset_copy))
		train.append(dataset_copy.pop(index))
	return train, dataset_copy

# Calculate root mean squared error
def rmse_metric(actual, predicted):
	sum_error = 0.0
	for i in range(len(actual)):
		prediction_error = predicted[i] - actual[i]
		sum_error += (prediction_error ** 2)
	mean_error = sum_error / float(len(actual))
	return sqrt(mean_error)

# Evaluate an algorithm using a train/test split
def evaluate_algorithm(dataset, algorithm, split, *args):
	train, test = train_test_split(dataset, split)
	test_set = list()
	for row in test:
		row_copy = list(row)
		row_copy[-1] = None
		test_set.append(row_copy)
	predicted = algorithm(train, test_set, *args)
	actual = [row[-1] for row in test]
	rmse = rmse_metric(actual, predicted)
	return rmse

# Calculate the mean value of a list of numbers
def mean(values):
	return sum(values) / float(len(values))

# Calculate covariance between x and y
def covariance(x, mean_x, y, mean_y):
	covar = 0.0
	for i in range(len(x)):
		covar += (x[i] - mean_x) * (y[i] - mean_y)
	return covar

# Calculate the variance of a list of numbers
def variance(values, mean):
	return sum([(x-mean)**2 for x in values])

# Calculate coefficients
def coefficients(dataset):
	x = [row[0] for row in dataset]
	y = [row[1] for row in dataset]
	x_mean, y_mean = mean(x), mean(y)
	b1 = covariance(x, x_mean, y, y_mean) / variance(x, x_mean)
	b0 = y_mean - b1 * x_mean
	return [b0, b1]

# Simple linear regression algorithm
def simple_linear_regression(train, test):
	predictions = list()
	b0, b1 = coefficients(train)
	for row in test:
		yhat = b0 + b1 * row[0]
		predictions.append(yhat)
	return predictions

# Simple linear regression on insurance dataset
seed(1)
# load and prepare data
filename = 'insurance.csv'
dataset = load_csv(filename)
for i in range(len(dataset[0])):
	str_column_to_float(dataset, i)
# evaluate algorithm
split = 0.6
rmse = evaluate_algorithm(dataset, simple_linear_regression, split)
print('RMSE: %.3f' % (rmse))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-2">2</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-4">4</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-6">6</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-8">8</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-10">10</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-12">12</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-14">14</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-16">16</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-18">18</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-20">20</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-22">22</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-24">24</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-26">26</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-28">28</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-30">30</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-32">32</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-34">34</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-36">36</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-38">38</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-40">40</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-42">42</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-44">44</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-46">46</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-48">48</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-50">50</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-52">52</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-54">54</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-56">56</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-58">58</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-60">60</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-62">62</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-64">64</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-66">66</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-68">68</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-70">70</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-72">72</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-74">74</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-76">76</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-78">78</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-80">80</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-82">82</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-84">84</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-86">86</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-88">88</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-90">90</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-92">92</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-94">94</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-96">96</div><div class="crayon-num" data-line="crayon-5a6593027fe86890760772-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593027fe86890760772-98">98</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe86890760772-1"><span class="crayon-p"># Simple Linear Regression on the Swedish Insurance Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-5"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-6"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-7"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-8"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-9"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-10"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-11"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-13"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-14"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-15"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-18"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-19"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-21"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-22"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-23"><span class="crayon-p"># Split a dataset into a train and test set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-24"><span class="crayon-e">def </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">split</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-25"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-26"><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">split *</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-27"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-28"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-29"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-30"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-31"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-32"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-33"><span class="crayon-p"># Calculate root mean squared error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-34"><span class="crayon-e">def </span><span class="crayon-e">rmse_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-35"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-36"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-37"><span class="crayon-h"> </span><span class="crayon-v">prediction_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-38"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">prediction_error *</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-39"><span class="crayon-h"> </span><span class="crayon-v">mean_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-40"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">mean_error</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-42"><span class="crayon-p"># Evaluate an algorithm using a train/test split</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-43"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">split</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-44"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">split</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-45"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-46"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-47"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-48"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-49"><span class="crayon-e"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-50"><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-51"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-52"><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">rmse_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-53"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-54"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-55"><span class="crayon-p"># Calculate the mean value of a list of numbers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-56"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-57"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-58"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-59"><span class="crayon-p"># Calculate covariance between x and y</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-60"><span class="crayon-e">def </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-61"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-62"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-63"><span class="crayon-h"> </span><span class="crayon-v">covar</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-64"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">covar</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-65"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-66"><span class="crayon-p"># Calculate the variance of a list of numbers</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-67"><span class="crayon-e">def </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-68"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-69"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-70"><span class="crayon-p"># Calculate coefficients</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-71"><span class="crayon-e">def </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-72"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-73"><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-74"><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-75"><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">covariance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">variance</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-76"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-e">x_mean</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-77"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-78"> </div><div class="crayon-line" id="crayon-5a6593027fe86890760772-79"><span class="crayon-p"># Simple linear regression algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-80"><span class="crayon-e">def </span><span class="crayon-e">simple_linear_regression</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-81"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-82"><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coefficients</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-83"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-84"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">b1 *</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-85"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-86"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-87"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-88"><span class="crayon-p"># Simple linear regression on insurance dataset</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-89"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-90"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-91"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'insurance.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-92"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-93"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-94"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-95"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-96"><span class="crayon-v">split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span></div><div class="crayon-line" id="crayon-5a6593027fe86890760772-97"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">simple_linear_regression</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">split</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593027fe86890760772-98"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0067 seconds] -->
<p>Running the algorithm prints the RMSE for the trained model on the training dataset.</p>
<p>A score of about 38 (thousands of Kronor) was achieved, which is much better than the Zero Rule algorithm that achieves approximately 72 (thousands of Kronor) on the same problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593027fe8b546375927" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
RMSE: 38.339</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593027fe8b546375927-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593027fe8b546375927-1">RMSE: 38.339</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>The best extension to this tutorial is to try out the algorithm on more problems.</p>
<p>Small datasets with just an input (x) and output (y) columns are popular for demonstration in statistical books and courses. Many of these datasets are available online.</p>
<p>Seek out some more small datasets and make predictions using simple linear regression.</p>
<p style="text-align: center;"><strong>Did you apply simple linear regression to another dataset?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the simple linear regression algorithm from scratch in Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to estimate statistics from a training dataset like mean, variance and covariance.</li>
<li>How to estimate model coefficients and use them to make predictions.</li>
<li>How to use simple linear regression to make predictions on a real dataset.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your question in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-simple-linear-regression-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/&amp;summary=Linear+regression+is+a+prediction+method+that+is+more+than+200+years+old.%0D%0A%0D%0ASimple+linear+regressio..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20To%20Implement%20Simple%20Linear%20Regression%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/&amp;summary=Linear+regression+is+a+prediction+method+that+is+more+than+200+years+old.%0D%0A%0D%0ASimple+linear+regressio...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/create-algorithm-test-harness-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Create an Algorithm Test Harness From Scratch With Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-linear-regression-stochastic-gradient-descent-scratch-python/" rel="next">How to Implement Linear Regression With Stochastic Gradient Descent From Scratch With Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">75 Responses to <em>How To Implement Simple Linear Regression From Scratch With Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-368407">
<div class="comment-container" id="li-comment-368407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3aa72a1312b462eafc33a3decc9d9f27?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3aa72a1312b462eafc33a3decc9d9f27?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vineeth</span>
<span class="date">October 27, 2016 at 7:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>i have downloaded the csv file, but when i try to run the script against the file, i get the following error</p>
<p>” could not convert string to float: ‘X’ ”</p>
<p>this script stops at function def train_test_split(dataset, split)</p>
<p>can you confirm how your csv file is structured ? </p>
<p>Regards<br/>
Vineeth</p>
<div class="reply">
<a aria-label="Reply to Vineeth" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368407#respond" onclick='return addComment.moveForm( "comment-368407", "368407", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-368458">
<div class="comment-container" id="li-comment-368458">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2016 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368458" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that Vineeth.</p>
<p>Totally my error, do not include the column headers in the small contrived dataset. Delete the first row.</p>
<p>I will update the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368458#respond" onclick='return addComment.moveForm( "comment-368458", "368458", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-368669">
<div class="comment-container" id="li-comment-368669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/11718ff03b0a27ba5c5aacbadb8767c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/11718ff03b0a27ba5c5aacbadb8767c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">En-wai</span>
<span class="date">October 30, 2016 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason…..i have deleted the column headers X and Y along with all other descriptive info in the file but i kee getting this error: </p>
<p>                         ” ValueError: could not convert string to float: i”</p>
<p>here are the first 5 values in my csv file after removing the white space(replacing it with commas) and changing from european “,”  to decimal “.” </p>
<p>                   108,392.5<br/>
                   19,46.2<br/>
                   13,15.7<br/>
                   124,422.2<br/>
                   40,119.4</p>
<div class="reply">
<a aria-label="Reply to En-wai" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368669#respond" onclick='return addComment.moveForm( "comment-368669", "368669", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-368682">
<div class="comment-container" id="li-comment-368682">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 30, 2016 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368682" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your file looks perfect.</p>
<p>Confirm that you do not have any empty rows on the end of the file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368682#respond" onclick='return addComment.moveForm( "comment-368682", "368682", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-368413">
<div class="comment-container" id="li-comment-368413">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb1b98d9c7b683626457e933cce983b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb1b98d9c7b683626457e933cce983b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adrian Moldovan</span>
<span class="date">October 27, 2016 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368413" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is brilliant!<br/>
Thanks for talking the time to go through all the steps and explain literally… everything.</p>
<div class="reply">
<a aria-label="Reply to Adrian Moldovan" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368413#respond" onclick='return addComment.moveForm( "comment-368413", "368413", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-368459">
<div class="comment-container" id="li-comment-368459">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2016 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368459" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome Adrian, I’m glad you found it valuable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368459#respond" onclick='return addComment.moveForm( "comment-368459", "368459", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-368428">
<div class="comment-container" id="li-comment-368428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d0c238dfa08cdbbbfb7d475b3d5074f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d0c238dfa08cdbbbfb7d475b3d5074f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nelson Silva</span>
<span class="date">October 28, 2016 at 2:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
great tutorial!<br/>
It would be great if you also provided the code for the respective plots in python!<br/>
Especially the plot for the dataset 🙂</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Nelson Silva" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368428#respond" onclick='return addComment.moveForm( "comment-368428", "368428", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-368461">
<div class="comment-container" id="li-comment-368461">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2016 at 9:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368461" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great suggestion Nelson, thanks.</p>
<p>I was aiming to keep the use of libs to a minimum (e.g. no matplotlib or seaborn).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368461#respond" onclick='return addComment.moveForm( "comment-368461", "368461", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-402326">
<div class="comment-container" id="li-comment-402326">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.tcs.com" rel="external nofollow">Rahul Sharma</a></span>
<span class="date">June 13, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402326" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Nelson, You can use pyplotlib library to create this kinf of scatter plot:</p>
<p>Pls use this code to implement scatter plot:</p>
<p>import pyplotlib.pyplot as py<br/>
py.scatter(x_axis_value,y_axis_value,color=’black’)<br/>
py.show()</p>
<p>I hope this helps !</p>
<div class="reply">
<a aria-label="Reply to Rahul Sharma" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402326#respond" onclick='return addComment.moveForm( "comment-402326", "402326", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368438">
<div class="comment-container" id="li-comment-368438">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/84c98cbf8046e7dacc8914868f89e77f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/84c98cbf8046e7dacc8914868f89e77f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">venkat dabbara</span>
<span class="date">October 28, 2016 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368438" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>predicted = algorithm(dataset, test_set) </p>
<p>where is algorithm defined???</p>
<div class="reply">
<a aria-label="Reply to venkat dabbara" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368438#respond" onclick='return addComment.moveForm( "comment-368438", "368438", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368462">
<div class="comment-container" id="li-comment-368462">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2016 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368462" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Venkat.</p>
<p>The “algorithm” argument in the evaluate_algorithm() function is a name of a function. We pass in the name of the function as “simple_linear_regression”. This means that when we execute algorithm() to make predictions in evaluate_algorithm(), we are in fact calling the simple_linear_regression() function. </p>
<p>I did this to separate algorithm evaluation from algorithm implementation, so that the same test harness can be used for many different algorithms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368462#respond" onclick='return addComment.moveForm( "comment-368462", "368462", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-368499">
<div class="comment-container" id="li-comment-368499">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/11718ff03b0a27ba5c5aacbadb8767c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/11718ff03b0a27ba5c5aacbadb8767c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">En-wai</span>
<span class="date">October 28, 2016 at 9:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368499" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>under section 2. Calcuating covairiance i think the two meaning there is not quiet a clear. Pls check it.</p>
<p>“In fact, covariance is a generalization of correlation that is limited to two variables. Whereas covariance can be calculate between two or more variables.”???????</p>
<div class="reply">
<a aria-label="Reply to En-wai" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368499#respond" onclick='return addComment.moveForm( "comment-368499", "368499", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368555">
<div class="comment-container" id="li-comment-368555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2016 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks En-wai, I have updated the language.</p>
<p>I was trying to comment on how covariance is an abstraction of correlation to go from 2 groups of numbers to more than 2 groups of numbers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368555#respond" onclick='return addComment.moveForm( "comment-368555", "368555", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368518">
<div class="comment-container" id="li-comment-368518">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/517e3a0b3be8b59f723ae006822e8c02?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/517e3a0b3be8b59f723ae006822e8c02?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ram</span>
<span class="date">October 29, 2016 at 1:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368518" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I got clear idea on linear regression. Thank You.</p>
<p>We do calculate linear regression with SciPi library as below.</p>
<p>regr = linear_model.LinearRegression()</p>
<p>regr.fit(X_train, y_train).</p>
<p>Please clarify whether all this calculation will happen behind the scenes when we call the above code.</p>
<div class="reply">
<a aria-label="Reply to Ram" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368518#respond" onclick='return addComment.moveForm( "comment-368518", "368518", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368561">
<div class="comment-container" id="li-comment-368561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2016 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Ram, </p>
<p>There are more efficient approaches to implement these algorithms using linear algebra. I expect this these more efficient approaches are being used behind the scenes.</p>
<p>Implementing algorithms is great for learning how they work, but it is not a good idea to use these from scratch implementations in production.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368561#respond" onclick='return addComment.moveForm( "comment-368561", "368561", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-368603">
<div class="comment-container" id="li-comment-368603">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/40cb3cc08dde64cb98c5eb67b1c7ea6e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/40cb3cc08dde64cb98c5eb67b1c7ea6e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aliyu A. Aziz</span>
<span class="date">October 29, 2016 at 6:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368603" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Many thanks for this easy to follow LR from scratch. I have noticed Line 9</p>
<p>file = open(filename, “rb”)</p>
<p>is opening the file in text mode and causing the “Error: iterator should return strings, not bytes (did you open the file in text mode?)”</p>
<p>Changing ‘rb’ to ‘rt’ or ‘r’<br/>
file = open(filename, “rt”)</p>
<p>fixes the error.</p>
<p>Best regards</p>
<div class="reply">
<a aria-label="Reply to Aliyu A. Aziz" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368603#respond" onclick='return addComment.moveForm( "comment-368603", "368603", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368677">
<div class="comment-container" id="li-comment-368677">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 30, 2016 at 8:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-368677" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great, thanks Aliyu.</p>
<p>It does work on my platform, but I will make the example more portable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=368677#respond" onclick='return addComment.moveForm( "comment-368677", "368677", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-369306">
<div class="comment-container" id="li-comment-369306">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/afa64cf59a37038baf210059ee145f1b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/afa64cf59a37038baf210059ee145f1b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://dataaspirant.com" rel="external nofollow">saimadhu</a></span>
<span class="date">November 3, 2016 at 6:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-369306" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Jason Brownlee</p>
<p>Thanks a lot for such an amazing post on simple linear regression. This post is the best tutorial to get the clear picture about simple linear regression analysis and I felt this post  is the must read before learning the multi-regression analysis.</p>
<div class="reply">
<a aria-label="Reply to saimadhu" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=369306#respond" onclick='return addComment.moveForm( "comment-369306", "369306", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-369382">
<div class="comment-container" id="li-comment-369382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2016 at 9:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-369382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks saimadhu, I’m glad you found it useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=369382#respond" onclick='return addComment.moveForm( "comment-369382", "369382", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-374995">
<div class="comment-container" id="li-comment-374995">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/684e2a88af74c15a8333968c055a9278?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/684e2a88af74c15a8333968c055a9278?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Johnny</span>
<span class="date">December 13, 2016 at 4:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-374995" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Another great one and I love these foundation ones.  Also, you get right into the steps/meat of it and you do not leave out cosmetics – just wrap those up neatly at the end.  Thank you sir.</p>
<p>I would like to see/study this same type of process for datasets pertaining to the basic types of business.  Specifically, how to produce good dataset and properly frame up problem areas, for business.  Do you recommend any books?</p>
<div class="reply">
<a aria-label="Reply to Johnny" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=374995#respond" onclick='return addComment.moveForm( "comment-374995", "374995", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-375014">
<div class="comment-container" id="li-comment-375014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2016 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-375014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Johnny.</p>
<p>Sorry, I don’t know of good books like that. It is an empirical pursuit – more of a craft. The best education is practice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=375014#respond" onclick='return addComment.moveForm( "comment-375014", "375014", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392294">
<div class="comment-container" id="li-comment-392294">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6b734456454ffa83aaeedd5fec1c3f70?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6b734456454ffa83aaeedd5fec1c3f70?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aslam</span>
<span class="date">March 12, 2017 at 4:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-392294" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am a beginner and found this very useful.</p>
<p>Thank you sir !</p>
<div class="reply">
<a aria-label="Reply to Aslam" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=392294#respond" onclick='return addComment.moveForm( "comment-392294", "392294", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-392311">
<div class="comment-container" id="li-comment-392311">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 12, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-392311" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear it!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=392311#respond" onclick='return addComment.moveForm( "comment-392311", "392311", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394075">
<div class="comment-container" id="li-comment-394075">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a483d2aac7df518e78744d8d043f5f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a483d2aac7df518e78744d8d043f5f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Girish</span>
<span class="date">March 25, 2017 at 2:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-394075" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How go we plot the graph using code</p>
<div class="reply">
<a aria-label="Reply to Girish" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=394075#respond" onclick='return addComment.moveForm( "comment-394075", "394075", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394105">
<div class="comment-container" id="li-comment-394105">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 25, 2017 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-394105" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use matplotlib:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659302827b1395280470" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from matplotlib import pyplot
pyplot.plot(x, y)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659302827b1395280470-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302827b1395280470-2">2</div><div class="crayon-num" data-line="crayon-5a659302827b1395280470-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659302827b1395280470-1"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302827b1395280470-2"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659302827b1395280470-3"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=394105#respond" onclick='return addComment.moveForm( "comment-394105", "394105", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395065">
<div class="comment-container" id="li-comment-395065">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f4f24905f6ba84e50f6b0a724607cae6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f4f24905f6ba84e50f6b0a724607cae6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nemanja</span>
<span class="date">April 2, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-395065" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hy, how can we plot a line of regression on our graph? And what we can do to reduce a rmse?Thanks</p>
<div class="reply">
<a aria-label="Reply to Nemanja" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=395065#respond" onclick='return addComment.moveForm( "comment-395065", "395065", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395081">
<div class="comment-container" id="li-comment-395081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 2, 2017 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-395081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can evaluate the RMSE each epoch/iteration, save the RMSE values in an array and plot the array using matplotlib.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=395081#respond" onclick='return addComment.moveForm( "comment-395081", "395081", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395189">
<div class="comment-container" id="li-comment-395189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/644c200f88a840bda962a14bcc1c5ee8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/644c200f88a840bda962a14bcc1c5ee8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean</span>
<span class="date">April 3, 2017 at 4:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-395189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>what is the relationship between numpy.cov() , numpy.var() methods and your covariance() , variance() calculations ? I get very different results between the two.  </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Sean" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=395189#respond" onclick='return addComment.moveForm( "comment-395189", "395189", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397891">
<div class="comment-container" id="li-comment-397891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f010d205ba7aa1b44efb4eb4b79e0ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f010d205ba7aa1b44efb4eb4b79e0ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abhishek</span>
<span class="date">April 28, 2017 at 3:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-397891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Its a great article thankyou for helping us…</p>
<div class="reply">
<a aria-label="Reply to Abhishek" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=397891#respond" onclick='return addComment.moveForm( "comment-397891", "397891", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397960">
<div class="comment-container" id="li-comment-397960">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2017 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-397960" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Abhishek, I’m glad that you found it useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=397960#respond" onclick='return addComment.moveForm( "comment-397960", "397960", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398516">
<div class="comment-container" id="li-comment-398516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9937a25d3f87f8f57ed9fa80597ec6af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9937a25d3f87f8f57ed9fa80597ec6af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nuwan C</span>
<span class="date">May 4, 2017 at 1:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-398516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for another great tutorial.<br/>
What does the Zero Based algorithm do and why it use in her?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Nuwan C" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=398516#respond" onclick='return addComment.moveForm( "comment-398516", "398516", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398572">
<div class="comment-container" id="li-comment-398572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-398572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you mean the Zero Rule algorithm?</p>
<p>See this post for a description and worked example:<br/>
<a href="http://machinelearningmastery.com/implement-baseline-machine-learning-algorithms-scratch-python/" rel="nofollow">http://machinelearningmastery.com/implement-baseline-machine-learning-algorithms-scratch-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=398572#respond" onclick='return addComment.moveForm( "comment-398572", "398572", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398555">
<div class="comment-container" id="li-comment-398555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d0f05ab862b320f5f57bae63f7aa94b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d0f05ab862b320f5f57bae63f7aa94b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John David Kromkowski</span>
<span class="date">May 5, 2017 at 2:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-398555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work</p>
<p>Maybe tiny typo:</p>
<p>covariance = sum((x(i) – mean(x)) * (y – mean(y)))</p>
<p>should be</p>
<p>covariance = sum((x(i) – mean(x)) * (y(i) – mean(y)))</p>
<p>You have it correct in the actual code</p>
<div class="reply">
<a aria-label="Reply to John David Kromkowski" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=398555#respond" onclick='return addComment.moveForm( "comment-398555", "398555", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398576">
<div class="comment-container" id="li-comment-398576">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-398576" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks John. Fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=398576#respond" onclick='return addComment.moveForm( "comment-398576", "398576", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400128">
<div class="comment-container" id="li-comment-400128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5b40efa25521660265ffc1c1d61304f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5b40efa25521660265ffc1c1d61304f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Etienne</span>
<span class="date">May 20, 2017 at 6:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-400128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good day Jason</p>
<p>My model is y = b0 + (b1 * x) – (b2 / (b3+x)), which gives an asymptotic approach in a flocculation process. While I get a good data fit using the scipy curve_fit routine, I do not know how to get the leverage, the diagonal elements of the hat matrix H. Whereas in your model, the X system matrix would be formulated as:</p>
<p>^y = H.y</p>
<p>and H is X(XT.X)**-1.XT, where XT is the transpose of X</p>
<p>In your model X.^b would be:</p>
<p>[ 1  x0 ]    [b0]<br/>
[ 1  x1 ]    [b1]<br/>
[ 1  x2 ] .<br/>
[ 1  x3 ]<br/>
[ ..  ..   ]</p>
<p>But what would it be in my case? </p>
<p>Another problem is how to solve for H, so I can get the diagonal elements hii.</p>
<p>Any help would be greatly appreciated.</p>
<div class="reply">
<a aria-label="Reply to Etienne" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=400128#respond" onclick='return addComment.moveForm( "comment-400128", "400128", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400395">
<div class="comment-container" id="li-comment-400395">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4614372729801fc440de0b02831d4c72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4614372729801fc440de0b02831d4c72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">suguna</span>
<span class="date">May 24, 2017 at 4:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-400395" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I removed columns header from csv file(Insurance CSV)</p>
<p>then Iam getting this following error:</p>
<p>ValueError: could not convert string to float: female</p>
<div class="reply">
<a aria-label="Reply to suguna" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=400395#respond" onclick='return addComment.moveForm( "comment-400395", "400395", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-402327">
<div class="comment-container" id="li-comment-402327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.tcs.com" rel="external nofollow">Rahul Sharma</a></span>
<span class="date">June 13, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>suguna , you need to remove all the empty cells in your csv, if any are present. That is what is causing this error</p>
<div class="reply">
<a aria-label="Reply to Rahul Sharma" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402327#respond" onclick='return addComment.moveForm( "comment-402327", "402327", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402417">
<div class="comment-container" id="li-comment-402417">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahul Sharma</span>
<span class="date">June 14, 2017 at 2:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402417" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>As per the derivation : <a href="https://en.wikipedia.org/wiki/Standard_deviation" rel="nofollow">https://en.wikipedia.org/wiki/Standard_deviation</a></p>
<p>Variance = Avg (xi – xMean)^2</p>
<p>But here in algorithm you have used it as : sum([(x-mean)**2 for x in values]) </p>
<p>which is not average but only some of squared difference. Is this some kind of modification?</p>
<div class="reply">
<a aria-label="Reply to Rahul Sharma" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402417#respond" onclick='return addComment.moveForm( "comment-402417", "402417", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-402636">
<div class="comment-container" id="li-comment-402636">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1960341b8d6e1a6c2d0a4e6fb031110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.tcs.com" rel="external nofollow">Rahul Sharma</a></span>
<span class="date">June 15, 2017 at 10:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402636" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. Can you please clarify this doubt.</p>
<div class="reply">
<a aria-label="Reply to Rahul Sharma" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402636#respond" onclick='return addComment.moveForm( "comment-402636", "402636", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402550">
<div class="comment-container" id="li-comment-402550">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2da8a3feaac2d3cd250d3526dca4c07?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2da8a3feaac2d3cd250d3526dca4c07?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Digvijay Rana</span>
<span class="date">June 15, 2017 at 5:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402550" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thankyou very much Sir,<br/>
       I had been looking for someplace to start implenting algos myself. This is best tutorial i have read by far. Waiting fo other algorithm’s simple implementations.</p>
<div class="reply">
<a aria-label="Reply to Digvijay Rana" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402550#respond" onclick='return addComment.moveForm( "comment-402550", "402550", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402585">
<div class="comment-container" id="li-comment-402585">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 15, 2017 at 8:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402585" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<p>I have many right here:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow">https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402585#respond" onclick='return addComment.moveForm( "comment-402585", "402585", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-403679">
<div class="comment-container" id="li-comment-403679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0eac2c94354dab40e7def6fcf682793f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0eac2c94354dab40e7def6fcf682793f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">noname</span>
<span class="date">June 24, 2017 at 3:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-403679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>too late  to board the ML bus ..Digvijay..</p>
<div class="reply">
<a aria-label="Reply to noname" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=403679#respond" onclick='return addComment.moveForm( "comment-403679", "403679", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-403720">
<div class="comment-container" id="li-comment-403720">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 25, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-403720" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Never too late.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=403720#respond" onclick='return addComment.moveForm( "comment-403720", "403720", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402909">
<div class="comment-container" id="li-comment-402909">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6a8ccb34ba853e9c38644a0915298c54?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6a8ccb34ba853e9c38644a0915298c54?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vaibhav</span>
<span class="date">June 17, 2017 at 11:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402909" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot sir ! . Its a best description so far .</p>
<div class="reply">
<a aria-label="Reply to Vaibhav" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402909#respond" onclick='return addComment.moveForm( "comment-402909", "402909", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402942">
<div class="comment-container" id="li-comment-402942">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-402942" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=402942#respond" onclick='return addComment.moveForm( "comment-402942", "402942", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404954">
<div class="comment-container" id="li-comment-404954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b642bb8da7242bcc30d60d9257fda252?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b642bb8da7242bcc30d60d9257fda252?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kris</span>
<span class="date">July 6, 2017 at 11:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-404954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m confused about your definition of covariance. Generally it’s finally divided by (n – 1) where n is the number of samples, where as there is no such operation carried out through out the code. Can you please clarify ?</p>
<div class="reply">
<a aria-label="Reply to Kris" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=404954#respond" onclick='return addComment.moveForm( "comment-404954", "404954", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405688">
<div class="comment-container" id="li-comment-405688">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c0a1f9318c508360a11794dbcebcd94?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c0a1f9318c508360a11794dbcebcd94?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://soumikrakshitblog.wordpress.com" rel="external nofollow">Soumik Rakshit</a></span>
<span class="date">July 13, 2017 at 1:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-405688" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am unable to download the dataset as a csv file. Can someone please help me???</p>
<div class="reply">
<a aria-label="Reply to Soumik Rakshit" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=405688#respond" onclick='return addComment.moveForm( "comment-405688", "405688", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405726">
<div class="comment-container" id="li-comment-405726">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-405726" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is the raw file:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659302822d8347219316" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Auto Insurance in Sweden

In the following data
X = number of claims
Y = total payment for all the claims in thousands of Swedish Kronor
for geographical zones in Sweden
Reference: Swedish Committee on Analysis of Risk Premium in Motor Insurance
http://college.hmco.com/mathematics/brase/understandable_statistics/7e/students/datasets/
       slr/frames/frame.html

X	Y
108	392,5
19	46,2
13	15,7
124	422,2
40	119,4
57	170,9
23	56,9
14	77,5
45	214
10	65,3
5	20,9
48	248,1
11	23,5
23	39,6
7	48,8
2	6,6
24	134,9
6	50,9
3	4,4
23	113
6	14,8
9	48,7
9	52,1
3	13,2
29	103,9
7	77,5
4	11,8
20	98,1
7	27,9
4	38,1
0	0
25	69,2
6	14,6
5	40,3
22	161,5
11	57,2
61	217,6
12	58,1
4	12,6
16	59,6
13	89,9
60	202,4
41	181,3
37	152,8
55	162,8
41	73,4
11	21,3
27	92,6
8	76,1
3	39,9
17	142,1
13	93
13	31,9
15	32,1
8	55,6
29	133,3
30	194,5
24	137,9
9	87,4
31	209,8
14	95,5
53	244,6
26	187,5</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659302822d8347219316-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-2">2</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-4">4</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-6">6</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-8">8</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-10">10</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-12">12</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-14">14</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-16">16</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-18">18</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-20">20</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-22">22</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-24">24</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-26">26</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-28">28</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-30">30</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-32">32</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-34">34</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-36">36</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-38">38</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-40">40</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-42">42</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-44">44</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-46">46</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-48">48</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-50">50</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-52">52</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-54">54</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-56">56</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-58">58</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-60">60</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-62">62</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-64">64</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-66">66</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-68">68</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-70">70</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-72">72</div><div class="crayon-num" data-line="crayon-5a659302822d8347219316-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659302822d8347219316-74">74</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659302822d8347219316-1"><span class="crayon-e">Auto </span><span class="crayon-e">Insurance </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">Sweden</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-2"> </div><div class="crayon-line" id="crayon-5a659302822d8347219316-3"><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">following </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-4"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">number </span><span class="crayon-e">of </span><span class="crayon-i">claims</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-5"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">total </span><span class="crayon-e">payment </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">all </span><span class="crayon-e">the </span><span class="crayon-e">claims </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">thousands </span><span class="crayon-e">of </span><span class="crayon-e">Swedish </span><span class="crayon-e">Kronor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">geographical </span><span class="crayon-e">zones </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">Sweden</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-7"><span class="crayon-v">Reference</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Swedish </span><span class="crayon-e">Committee </span><span class="crayon-e">on </span><span class="crayon-e">Analysis </span><span class="crayon-e">of </span><span class="crayon-e">Risk </span><span class="crayon-e">Premium </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">Motor </span><span class="crayon-e">Insurance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-8"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//college.hmco.com/mathematics/brase/understandable_statistics/7e/students/datasets/</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-9"><span class="crayon-h">       </span><span class="crayon-v">slr</span><span class="crayon-o">/</span><span class="crayon-v">frames</span><span class="crayon-o">/</span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-i">html</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-10"> </div><div class="crayon-line" id="crayon-5a659302822d8347219316-11"><span class="crayon-i">X</span><span class="crayon-h"> </span><span class="crayon-i">Y</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-12"><span class="crayon-cn">108</span><span class="crayon-h"> </span><span class="crayon-cn">392</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-13"><span class="crayon-cn">19</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-14"><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-15"><span class="crayon-cn">124</span><span class="crayon-h"> </span><span class="crayon-cn">422</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-16"><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">119</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-17"><span class="crayon-cn">57</span><span class="crayon-h"> </span><span class="crayon-cn">170</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-18"><span class="crayon-cn">23</span><span class="crayon-h"> </span><span class="crayon-cn">56</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-19"><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-20"><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">214</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-21"><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-22"><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-23"><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-cn">248</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-24"><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">23</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-25"><span class="crayon-cn">23</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-26"><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-27"><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-28"><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-cn">134</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-29"><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-30"><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-31"><span class="crayon-cn">23</span><span class="crayon-h"> </span><span class="crayon-cn">113</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-32"><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-33"><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-34"><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-35"><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-36"><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-cn">103</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-37"><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-38"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-39"><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-40"><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-41"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-42"><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-43"><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-cn">69</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-44"><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-45"><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-46"><span class="crayon-cn">22</span><span class="crayon-h"> </span><span class="crayon-cn">161</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-47"><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-48"><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-cn">217</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-49"><span class="crayon-cn">12</span><span class="crayon-h"> </span><span class="crayon-cn">58</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-50"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-51"><span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-52"><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-53"><span class="crayon-cn">60</span><span class="crayon-h"> </span><span class="crayon-cn">202</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-54"><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-cn">181</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-55"><span class="crayon-cn">37</span><span class="crayon-h"> </span><span class="crayon-cn">152</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-56"><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-cn">162</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-57"><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-58"><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-59"><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-cn">92</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-60"><span class="crayon-cn">8</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-61"><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-62"><span class="crayon-cn">17</span><span class="crayon-h"> </span><span class="crayon-cn">142</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-63"><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">93</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-64"><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-65"><span class="crayon-cn">15</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-66"><span class="crayon-cn">8</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-67"><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-cn">133</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-68"><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-cn">194</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-69"><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-cn">137</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-70"><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-cn">87</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-71"><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-cn">209</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-72"><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5a659302822d8347219316-73"><span class="crayon-cn">53</span><span class="crayon-h"> </span><span class="crayon-cn">244</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659302822d8347219316-74"><span class="crayon-cn">26</span><span class="crayon-h"> </span><span class="crayon-cn">187</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0034 seconds] -->
<p></p>
<p>You will need to convert the “,” to “.” and replace the space between columns with “,”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=405726#respond" onclick='return addComment.moveForm( "comment-405726", "405726", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406136">
<div class="comment-container" id="li-comment-406136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e6207fc0910de5b9a6f63cfbee6c89f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e6207fc0910de5b9a6f63cfbee6c89f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">uma maheswari</span>
<span class="date">July 16, 2017 at 9:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-406136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason </p>
<p>can you tell how do we implement the linear regression on image dataset</p>
<div class="reply">
<a aria-label="Reply to uma maheswari" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=406136#respond" onclick='return addComment.moveForm( "comment-406136", "406136", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406170">
<div class="comment-container" id="li-comment-406170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 17, 2017 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-406170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps linear regression is a bad fit image data.</p>
<p>Convolutional neural networks are very popular for image data:<br/>
<a href="http://machinelearningmastery.com/crash-course-convolutional-neural-networks/" rel="nofollow">http://machinelearningmastery.com/crash-course-convolutional-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=406170#respond" onclick='return addComment.moveForm( "comment-406170", "406170", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-407931">
<div class="comment-container" id="li-comment-407931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7609ae2ad409b6b495c343f9f0e1a3ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7609ae2ad409b6b495c343f9f0e1a3ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.samadhiweb.com/" rel="external nofollow">Pierce Ng</a></span>
<span class="date">July 31, 2017 at 1:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-407931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great stuff! Thanks for the exposition.</p>
<p>I implemented a no-shuffling version of train_test_split which always takes the first 38 entries as training data and the last 25 entries as test data. The program gives RMSE of 45.23.</p>
<p>Your RMSE of 38.339 is from the randomization in train_test_split with seed(1). If I try with seed(2) then the RMSE is 37.734.</p>
<p>What’s the next step with different values of RMSE?</p>
<div class="reply">
<a aria-label="Reply to Pierce Ng" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=407931#respond" onclick='return addComment.moveForm( "comment-407931", "407931", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407959">
<div class="comment-container" id="li-comment-407959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-407959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is the variance of the method.</p>
<p>Ideally, we would evaluate the algorithm multiple times and report the mean and standard deviation of the model.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=407959#respond" onclick='return addComment.moveForm( "comment-407959", "407959", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-408737">
<div class="comment-container" id="li-comment-408737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7609ae2ad409b6b495c343f9f0e1a3ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7609ae2ad409b6b495c343f9f0e1a3ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.samadhiweb.com" rel="external nofollow">Pierce Ng</a></span>
<span class="date">August 6, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-408737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It does, thanks.</p>
<p>I ported your Python code to Pharo Smalltalk and wrote a blog post. See <a href="http://www.samadhiweb.com/blog/2017.08.06.dataframe.html" rel="nofollow">http://www.samadhiweb.com/blog/2017.08.06.dataframe.html</a>.</p>
<div class="reply">
<a aria-label="Reply to Pierce Ng" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=408737#respond" onclick='return addComment.moveForm( "comment-408737", "408737", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-408798">
<div class="comment-container" id="li-comment-408798">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 7, 2017 at 8:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-408798" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very cool Pierce. Nice work!</p>
<p>I used to work with a dev who was a massive small talk fan.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=408798#respond" onclick='return addComment.moveForm( "comment-408798", "408798", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-409254">
<div class="comment-container" id="li-comment-409254">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d3b94608e6718b564a1563a2a2576931?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d3b94608e6718b564a1563a2a2576931?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://na" rel="external nofollow">Eoin Kenny</a></span>
<span class="date">August 11, 2017 at 3:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-409254" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is NOT the formula for variance… you’re supposed to divide by n or n-1, what is going on?</p>
<div class="reply">
<a aria-label="Reply to Eoin Kenny" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=409254#respond" onclick='return addComment.moveForm( "comment-409254", "409254", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409275">
<div class="comment-container" id="li-comment-409275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2017 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-409275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Might be population vs sample variance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=409275#respond" onclick='return addComment.moveForm( "comment-409275", "409275", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-411957">
<div class="comment-container" id="li-comment-411957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c680494ddecb46f29ee96756b8a0520?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c680494ddecb46f29ee96756b8a0520?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://hsbc.co.in" rel="external nofollow">Tanmay</a></span>
<span class="date">September 1, 2017 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-411957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, why this *args parameter in the evaluate_algorithm function?</p>
<div class="reply">
<a aria-label="Reply to Tanmay" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=411957#respond" onclick='return addComment.moveForm( "comment-411957", "411957", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411999">
<div class="comment-container" id="li-comment-411999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-411999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So we can provide a variable number parameters for the algorithm to the evaluat_algorithm() function.</p>
<p>It is generic for different algorithms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=411999#respond" onclick='return addComment.moveForm( "comment-411999", "411999", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413824">
<div class="comment-container" id="li-comment-413824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/746432e4d84ddcca05de09737fe188fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/746432e4d84ddcca05de09737fe188fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vedang</span>
<span class="date">September 15, 2017 at 2:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-413824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How do we predict the value of y, given x. Also how obtain the accuracy?</p>
<div class="reply">
<a aria-label="Reply to vedang" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=413824#respond" onclick='return addComment.moveForm( "comment-413824", "413824", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413901">
<div class="comment-container" id="li-comment-413901">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 12:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-413901" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is all of applied machine learning.</p>
<p>Perhaps you might be best starting with Weka:<br/>
<a href="https://machinelearningmastery.com/start-here/#weka" rel="nofollow">https://machinelearningmastery.com/start-here/#weka</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=413901#respond" onclick='return addComment.moveForm( "comment-413901", "413901", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413913">
<div class="comment-container" id="li-comment-413913">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fae25f21ce9fc833ac4990e310d64444?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fae25f21ce9fc833ac4990e310d64444?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Barrys</span>
<span class="date">September 15, 2017 at 1:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-413913" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your great articles. They are very helpful to me.</p>
<p>Something is not clear to me. Why we calculated RMSE and what it means exactly? I was expecting you would calculate the accuracy of predictions from the test data as you did in your KNN post.</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Barrys" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=413913#respond" onclick='return addComment.moveForm( "comment-413913", "413913", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413985">
<div class="comment-container" id="li-comment-413985">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2017 at 8:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-413985" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>RMSE is root mean squared error and is the error of the predictions in the same units as the output variable.</p>
<p>You cannot calculate accuracy for a regression problem. Accuracy refers to the percentage of correct label predictions out of all label predictions made. We do not predict a label in regression, we predict a quantity.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=413985#respond" onclick='return addComment.moveForm( "comment-413985", "413985", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-414014">
<div class="comment-container" id="li-comment-414014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fae25f21ce9fc833ac4990e310d64444?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fae25f21ce9fc833ac4990e310d64444?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Barrys</span>
<span class="date">September 16, 2017 at 1:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-414014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So we need to run another algorithm to predict its label? How can I use y value for a given x without knowing its label (that’s linear regression as i understood)? What kind of problems does the linear regression solve? </p>
<p>It would be better to explain RMSE in the document and why we calculate it? it is mentioned but not explained.</p>
<div class="reply">
<a aria-label="Reply to Barrys" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=414014#respond" onclick='return addComment.moveForm( "comment-414014", "414014", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-414065">
<div class="comment-container" id="li-comment-414065">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 17, 2017 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-414065" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Linear regression is for problems where we want to predict a quantity, called regression problems.</p>
<p>If you have a dataset where you need to predict a label, you cannot use linear regression. You will need another algorithm like logistic regression.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=414065#respond" onclick='return addComment.moveForm( "comment-414065", "414065", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416336">
<div class="comment-container" id="li-comment-416336">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/995a0a4136966560d01d75b0143ea52c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/995a0a4136966560d01d75b0143ea52c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rizvi</span>
<span class="date">October 11, 2017 at 9:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-416336" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This is an awesome post for beginners. </p>
<p>Currently, we are fitting a polynomial with 2 coefficients to the data. If we extend this approach to higher order polynomial, will that come under the scope of non-linear regression? Also, will increasing the polynomial order improve the estimation accuracy?</p>
<div class="reply">
<a aria-label="Reply to Rizvi" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=416336#respond" onclick='return addComment.moveForm( "comment-416336", "416336", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416380">
<div class="comment-container" id="li-comment-416380">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 12, 2017 at 5:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-416380" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may improve accuracy, or it may over fit the data. Try it and see. </p>
<p>Use a robust test harness to ensure you do not trick yourself.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=416380#respond" onclick='return addComment.moveForm( "comment-416380", "416380", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416937">
<div class="comment-container" id="li-comment-416937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a51cf7b708d412ef37611d566589bbf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a51cf7b708d412ef37611d566589bbf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melina</span>
<span class="date">October 17, 2017 at 12:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-416937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial! Thank you 🙂</p>
<p>I am preparing a demo for simple linear regression and I plan to show the code using sklearn and compare it to “own” regression algorithm code, tweaked version of yours!</p>
<p>I am stuck at one thing in your code and that is the variance formula/equation.<br/>
* You are using: Variance = Sum( (x – mean(x))^2 )<br/>
* Should it not be: Variance = Sum( (x – mean(x))^2 ) / N</p>
<p>I am probably just confused so please correct me to the right thinking if I am.</p>
<div class="reply">
<a aria-label="Reply to Melina" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=416937#respond" onclick='return addComment.moveForm( "comment-416937", "416937", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416985">
<div class="comment-container" id="li-comment-416985">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-416985" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is not normalized. See here for more information:<br/>
<a href="https://en.wikipedia.org/wiki/Simple_linear_regression" rel="nofollow">https://en.wikipedia.org/wiki/Simple_linear_regression</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=416985#respond" onclick='return addComment.moveForm( "comment-416985", "416985", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422224">
<div class="comment-container" id="li-comment-422224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/036d25a7a8f1808f2a6b3665e222ed7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/036d25a7a8f1808f2a6b3665e222ed7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adilah</span>
<span class="date">December 6, 2017 at 12:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-422224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, can this method be used to predict the consumption of a type of product by customer? (sorry for my english )</p>
<div class="reply">
<a aria-label="Reply to Adilah" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=422224#respond" onclick='return addComment.moveForm( "comment-422224", "422224", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422250">
<div class="comment-container" id="li-comment-422250">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 6, 2017 at 9:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-422250" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend this process to work through your problem systematically:<br/>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=422250#respond" onclick='return addComment.moveForm( "comment-422250", "422250", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423492">
<div class="comment-container" id="li-comment-423492">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/13df6e7b45c8a74e8f18aca9e0cf1477?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/13df6e7b45c8a74e8f18aca9e0cf1477?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ronnie Mukherjee</span>
<span class="date">December 16, 2017 at 10:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-423492" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does anyone have the RMSE using the entire swedish insurance dataset for both training and testing (for verification)?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Ronnie Mukherjee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=423492#respond" onclick='return addComment.moveForm( "comment-423492", "423492", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426130">
<div class="comment-container" id="li-comment-426130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b8d4476ee2189b50307ef9fe3f145456?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b8d4476ee2189b50307ef9fe3f145456?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Himsikha hazarika</span>
<span class="date">January 10, 2018 at 8:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-426130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The dataset was already in float format.so,i commented out :</p>
<p># Convert string column to float<br/>
”’def str_column_to_float(dataset, column):<br/>
	for row in dataset:<br/>
		row[column] = float(row[column].strip())”’<br/>
_______________________<br/>
X	Y<br/>
108	392.5<br/>
19	46.2<br/>
13	15.7<br/>
124	422.2<br/>
40	119.4<br/>
;;;;;;_<br/>
______________________________</p>
<p>but the i got the below error:</p>
<p>Traceback (most recent call last):<br/>
  File “linear.py”, line 97, in<br/>
    rmse = evaluate_algorithm(dataset, simple_linear_regression, split)<br/>
  File “linear.py”, line 50, in evaluate_algorithm<br/>
    predicted = algorithm(train, test_set, *args)<br/>
  File “linear.py”, line 82, in simple_linear_regression<br/>
    b0, b1 = coefficients(train)<br/>
  File “linear.py”, line 74, in coefficients<br/>
    x_mean, y_mean = mean(x), mean(y)<br/>
  File “linear.py”, line 57, in mean<br/>
    return sum(values) / float(len(values))<br/>
TypeError: unsupported operand type(s) for +: ‘int’ and ‘str’</p>
<div class="reply">
<a aria-label="Reply to Himsikha hazarika" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=426130#respond" onclick='return addComment.moveForm( "comment-426130", "426130", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426170">
<div class="comment-container" id="li-comment-426170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 11, 2018 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-426170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t know the cause of your error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=426170#respond" onclick='return addComment.moveForm( "comment-426170", "426170", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-427081">
<div class="comment-container" id="li-comment-427081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc653a7610fb4db04c3ed1d24cf0359b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc653a7610fb4db04c3ed1d24cf0359b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Faraz</span>
<span class="date">January 22, 2018 at 2:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-427081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can anyone help me that how to convert the “,” to “.” and replace the space between columns with “,” ? It would be great if you upload the code!</p>
<div class="reply">
<a aria-label="Reply to Faraz" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=427081#respond" onclick='return addComment.moveForm( "comment-427081", "427081", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427093">
<div class="comment-container" id="li-comment-427093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 22, 2018 at 4:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/#comment-427093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, perhaps a course on basic programming would be a good place to start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-simple-linear-regression-scratch-python/?replytocom=427093#respond" onclick='return addComment.moveForm( "comment-427093", "427093", "respond", "3327" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-simple-linear-regression-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3327"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="0c09bb5921"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="75"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center>
<h3>Code Algorithms From Scratch in Python</h3>
<p>Discover how to code top machine learning algorithms from first principles with Python.</p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Code Machine Learning Algorithms From Scratch Today!</a></p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>