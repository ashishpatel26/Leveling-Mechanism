<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Evaluate the Performance Of Deep Learning Models in Keras - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Evaluate the Performance Of Deep Learning Models in Keras - Machine Learning Mastery" property="og:title"/>
<meta content="Keras is an easy to use and powerful Python library for deep learning. There are a lot of decisions to make when designing and configuring your deep learning models. Most of these decisions must be resolved empirically through trial and error and evaluating them on real data. As such, it is critically important to have …" property="og:description"/>
<meta content="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-05-26T05:00:42+11:00" property="article:published_time"/>
<meta content="2017-03-31T07:48:01+11:00" property="article:modified_time"/>
<meta content="2017-03-31T07:48:01+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Evaluate-the-Performance-Of-Deep-Learning-Models-in-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Evaluate-the-Performance-Of-Deep-Learning-Models-in-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="481" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/evaluate-performance-deep-learning-models-keras\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/feed/" rel="alternate" title="Machine Learning Mastery » Evaluate the Performance Of Deep Learning Models in Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2561" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fevaluate-performance-deep-learning-models-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fevaluate-performance-deep-learning-models-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2561 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2561 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Evaluate the Performance Of Deep Learning Models in Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-05-26T05:00:42+1100">May 26, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fevaluate-performance-deep-learning-models-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/&amp;summary=Keras+is+an+easy+to+use+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AThere+are+a+lot+of+decisio..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/&amp;summary=Keras+is+an+easy+to+use+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AThere+are+a+lot+of+decisio...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Keras is an easy to use and powerful Python library for deep learning.</p>
<p>There are a lot of decisions to make when designing and configuring your deep learning models. Most of these decisions must be resolved empirically through trial and error and evaluating them on real data.</p>
<p>As such, it is critically important to have a robust way to evaluate the performance of your neural networks and deep learning models.</p>
<p>In this post you will discover a few ways that you can use to evaluate model performance using Keras.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 and scikit-learn v0.18.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2563" style="max-width: 650px"><img alt="Evaluate the Performance Of Deep Learning Models in Keras" class="size-full wp-image-2563" height="481" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Evaluate-the-Performance-Of-Deep-Learning-Models-in-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Evaluate-the-Performance-Of-Deep-Learning-Models-in-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Evaluate-the-Performance-Of-Deep-Learning-Models-in-Keras-300x225.jpg 300w" width="640"/><p class="wp-caption-text">Evaluate the Performance Of Deep Learning Models in Keras<br/>Photo by <a href="https://www.flickr.com/photos/thomasleuthard/7273077758/">Thomas Leuthard</a>, some rights reserved.</p></div>
<h2>Empirically Evaluate Network Configurations</h2>
<p>There are a myriad of decisions you must make when designing and configuring your deep learning models.</p>
<p>Many of these decisions can be resolved by copying the structure of other people’s networks and using heuristics. Ultimately, the best technique is to actually design small experiments and empirically evaluate options using real data.</p>
<p>This includes high-level decisions like the number, size and type of layers in your network. It also includes the lower level decisions like the choice of loss function, activation functions,  optimization procedure and number of epochs.</p>
<p>Deep learning is often used on problems that have very large datasets. That is tens of thousands or hundreds of thousands of instances.</p>
<p>As such, you need to have a robust test harness that allows you to estimate the performance of a given configuration on unseen data, and reliably compare the performance to other configurations.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>Data Splitting</h2>
<p>The large amount of data and the complexity of the models require very long training times.</p>
<p>As such, it is typically to use a simple separation of data into training and test datasets or training and validation datasets.</p>
<p>Keras provides a two convenient ways of evaluating your deep learning algorithms this way:</p>
<ol>
<li>Use an automatic verification dataset.</li>
<li>Use a manual verification dataset.</li>
</ol>
<h3>Use a Automatic Verification Dataset</h3>
<p>Keras can separate a portion of your training data into a validation dataset and evaluate the performance of your model on that validation dataset each epoch.</p>
<p>You can do this by setting the <strong>validation_split</strong> argument on the <strong>fit</strong>() function to a percentage of the size of your training dataset.</p>
<p>For example, a reasonable value might be 0.2 or 0.33 for 20% or 33% of your training data held back for validation.</p>
<p>The example below demonstrates the use of using an automatic validation dataset on a small binary classification problem. All examples in this post use the <a href="http://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians onset of diabetes dataset</a>. You can <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">download it</a> from the UCI Machine Learning Repository and save the data file in your current working directory with the filename <strong>pima-indians-diabetes.csv</strong>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a023676142111" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP with automatic validation set
from keras.models import Sequential
from keras.layers import Dense
import numpy
# fix random seed for reproducibility
numpy.random.seed(7)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# Fit the model
model.fit(X, Y, validation_split=0.33, epochs=150, batch_size=10)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-12">12</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-14">14</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-16">16</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-18">18</div><div class="crayon-num" data-line="crayon-5a65949c3a023676142111-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a023676142111-20">20</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a023676142111-1"><span class="crayon-p"># MLP with automatic validation set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-4"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-5"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-6"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-7"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-8"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-9"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-11"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-12"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-13"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-14"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-15"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-17"><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a023676142111-19"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a023676142111-20"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_split</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running the example, you can see that the verbose output on each epoch shows the loss and accuracy on both the training dataset and the validation dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a02d497629431" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 145/150
514/514 [==============================] - 0s - loss: 0.5252 - acc: 0.7335 - val_loss: 0.5489 - val_acc: 0.7244
Epoch 146/150
514/514 [==============================] - 0s - loss: 0.5198 - acc: 0.7296 - val_loss: 0.5918 - val_acc: 0.7244
Epoch 147/150
514/514 [==============================] - 0s - loss: 0.5175 - acc: 0.7335 - val_loss: 0.5365 - val_acc: 0.7441
Epoch 148/150
514/514 [==============================] - 0s - loss: 0.5219 - acc: 0.7354 - val_loss: 0.5414 - val_acc: 0.7520
Epoch 149/150
514/514 [==============================] - 0s - loss: 0.5089 - acc: 0.7432 - val_loss: 0.5417 - val_acc: 0.7520
Epoch 150/150
514/514 [==============================] - 0s - loss: 0.5148 - acc: 0.7490 - val_loss: 0.5549 - val_acc: 0.7520</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a02d497629431-12">12</div><div class="crayon-num" data-line="crayon-5a65949c3a02d497629431-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a02d497629431-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-2">Epoch 145/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-3">514/514 [==============================] - 0s - loss: 0.5252 - acc: 0.7335 - val_loss: 0.5489 - val_acc: 0.7244</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-4">Epoch 146/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-5">514/514 [==============================] - 0s - loss: 0.5198 - acc: 0.7296 - val_loss: 0.5918 - val_acc: 0.7244</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-6">Epoch 147/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-7">514/514 [==============================] - 0s - loss: 0.5175 - acc: 0.7335 - val_loss: 0.5365 - val_acc: 0.7441</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-8">Epoch 148/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-9">514/514 [==============================] - 0s - loss: 0.5219 - acc: 0.7354 - val_loss: 0.5414 - val_acc: 0.7520</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-10">Epoch 149/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-11">514/514 [==============================] - 0s - loss: 0.5089 - acc: 0.7432 - val_loss: 0.5417 - val_acc: 0.7520</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a02d497629431-12">Epoch 150/150</div><div class="crayon-line" id="crayon-5a65949c3a02d497629431-13">514/514 [==============================] - 0s - loss: 0.5148 - acc: 0.7490 - val_loss: 0.5549 - val_acc: 0.7520</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Use a Manual Verification Dataset</h3>
<p>Keras also allows you to manually specify the dataset to use for validation during training.</p>
<p>In this example we use the handy <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.train_test_split.html">train_test_split</a>() function from the Python <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a> machine learning library to separate our data into a training and test dataset. We use 67% for training and the remaining 33% of the data for validation.</p>
<p>The validation dataset can be specified to the <strong>fit</strong>() function in Keras by the <strong>validation_data</strong> argument. It takes a tuple of the input and output datasets.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a031547546229" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP with manual validation set
from keras.models import Sequential
from keras.layers import Dense
from sklearn.model_selection import train_test_split
import numpy
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# split into 67% for train and 33% for test
X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.33, random_state=seed)
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# Fit the model
model.fit(X_train, y_train, validation_data=(X_test,y_test), epochs=150, batch_size=10)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-12">12</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-14">14</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-16">16</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-18">18</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-20">20</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-22">22</div><div class="crayon-num" data-line="crayon-5a65949c3a031547546229-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a031547546229-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a031547546229-1"><span class="crayon-p"># MLP with manual validation set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">train_test_split</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-5"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-6"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-7"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-8"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-9"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-11"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-13"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-14"><span class="crayon-p"># split into 67% for train and 33% for test</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-15"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-16"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-17"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-20"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-21"><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a031547546229-23"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a031547546229-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Like before, running the example provides verbose output of training that includes the loss and accuracy of the model on both the training and validation datasets for each epoch.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a034863794804" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 145/150
514/514 [==============================] - 0s - loss: 0.4847 - acc: 0.7704 - val_loss: 0.5668 - val_acc: 0.7323
Epoch 146/150
514/514 [==============================] - 0s - loss: 0.4853 - acc: 0.7549 - val_loss: 0.5768 - val_acc: 0.7087
Epoch 147/150
514/514 [==============================] - 0s - loss: 0.4864 - acc: 0.7743 - val_loss: 0.5604 - val_acc: 0.7244
Epoch 148/150
514/514 [==============================] - 0s - loss: 0.4831 - acc: 0.7665 - val_loss: 0.5589 - val_acc: 0.7126
Epoch 149/150
514/514 [==============================] - 0s - loss: 0.4961 - acc: 0.7782 - val_loss: 0.5663 - val_acc: 0.7126
Epoch 150/150
514/514 [==============================] - 0s - loss: 0.4967 - acc: 0.7588 - val_loss: 0.5810 - val_acc: 0.6929</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a034863794804-12">12</div><div class="crayon-num" data-line="crayon-5a65949c3a034863794804-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a034863794804-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-2">Epoch 145/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-3">514/514 [==============================] - 0s - loss: 0.4847 - acc: 0.7704 - val_loss: 0.5668 - val_acc: 0.7323</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-4">Epoch 146/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-5">514/514 [==============================] - 0s - loss: 0.4853 - acc: 0.7549 - val_loss: 0.5768 - val_acc: 0.7087</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-6">Epoch 147/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-7">514/514 [==============================] - 0s - loss: 0.4864 - acc: 0.7743 - val_loss: 0.5604 - val_acc: 0.7244</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-8">Epoch 148/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-9">514/514 [==============================] - 0s - loss: 0.4831 - acc: 0.7665 - val_loss: 0.5589 - val_acc: 0.7126</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-10">Epoch 149/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-11">514/514 [==============================] - 0s - loss: 0.4961 - acc: 0.7782 - val_loss: 0.5663 - val_acc: 0.7126</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a034863794804-12">Epoch 150/150</div><div class="crayon-line" id="crayon-5a65949c3a034863794804-13">514/514 [==============================] - 0s - loss: 0.4967 - acc: 0.7588 - val_loss: 0.5810 - val_acc: 0.6929</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Manual k-Fold Cross Validation</h2>
<p>The gold standard for machine learning model evaluation is <a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">k-fold cross validation</a>.</p>
<p>It provides a robust estimate of the performance of a model on unseen data. It does this by splitting the training dataset into k subsets and takes turns training models on all subsets except one which is held out, and evaluating model performance on the held out validation dataset. The process is repeated until all subsets are given an opportunity to be the held out validation set. The performance measure is then averaged across all models that are created.</p>
<p>Cross validation is often not used for evaluating deep learning models because of the greater computational expense. For example k-fold cross validation is often used with 5 or 10 folds. As such, 5 or 10 models must be constructed and evaluated, greatly adding to the evaluation time of a model.</p>
<p>Nevertheless, it when the problem is small enough or if you have sufficient compute resources, k-fold cross validation can give you a less biased estimate of the performance of your model.</p>
<p>In the example below we use the handy <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.StratifiedKFold.html">StratifiedKFold</a> class from the <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a> Python machine learning library to split up the training dataset into 10 folds. The folds are stratified, meaning that the algorithm attempts to balance the number of instances of each class in each fold.</p>
<p>The example creates and evaluates 10 models using the 10 splits of the data and collects all of the scores. The verbose output for each epoch is turned off by passing verbose=0 to the <strong>fit()</strong> and <strong>evaluate() </strong>functions on the model.</p>
<p>The performance is printed for each model and it is stored. The average and standard deviation of the model performance is then printed at the end of the run to provide a robust estimate of model accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a038892563607" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP for Pima Indians Dataset with 10-fold cross validation
from keras.models import Sequential
from keras.layers import Dense
from sklearn.model_selection import StratifiedKFold
import numpy
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# define 10-fold cross validation test harness
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)
cvscores = []
for train, test in kfold.split(X, Y):
  # create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	# Fit the model
	model.fit(X[train], Y[train], epochs=150, batch_size=10, verbose=0)
	# evaluate the model
	scores = model.evaluate(X[test], Y[test], verbose=0)
	print("%s: %.2f%%" % (model.metrics_names[1], scores[1]*100))
	cvscores.append(scores[1] * 100)
print("%.2f%% (+/- %.2f%%)" % (numpy.mean(cvscores), numpy.std(cvscores)))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-12">12</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-14">14</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-16">16</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-18">18</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-20">20</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-22">22</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-24">24</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-26">26</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-28">28</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a038892563607-30">30</div><div class="crayon-num" data-line="crayon-5a65949c3a038892563607-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a038892563607-1"><span class="crayon-p"># MLP for Pima Indians Dataset with 10-fold cross validation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">StratifiedKFold</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-5"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-6"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-7"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-8"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-9"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-11"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-13"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-14"><span class="crayon-p"># define 10-fold cross validation test harness</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-15"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StratifiedKFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-16"><span class="crayon-v">cvscores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-17"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-18"><span class="crayon-h">  </span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-19"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-20"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-21"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-22"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-23"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-24"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-25"><span class="crayon-h"> </span><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-26"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-27"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-28"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">test</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">[</span><span class="crayon-v">test</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-29"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a038892563607-30"><span class="crayon-h"> </span><span class="crayon-v">cvscores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65949c3a038892563607-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%.2f%% (+/- %.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">cvscores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">cvscores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>Running the example will take less than a minute and will produce the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3a03d617432752" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
acc: 77.92%
acc: 68.83%
acc: 72.73%
acc: 64.94%
acc: 77.92%
acc: 35.06%
acc: 74.03%
acc: 68.83%
acc: 34.21%
acc: 72.37%
64.68% (+/- 15.50%)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a03d617432752-2">2</div><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a03d617432752-4">4</div><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a03d617432752-6">6</div><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a03d617432752-8">8</div><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65949c3a03d617432752-10">10</div><div class="crayon-num" data-line="crayon-5a65949c3a03d617432752-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3a03d617432752-1">acc: 77.92%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a03d617432752-2">acc: 68.83%</div><div class="crayon-line" id="crayon-5a65949c3a03d617432752-3">acc: 72.73%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a03d617432752-4">acc: 64.94%</div><div class="crayon-line" id="crayon-5a65949c3a03d617432752-5">acc: 77.92%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a03d617432752-6">acc: 35.06%</div><div class="crayon-line" id="crayon-5a65949c3a03d617432752-7">acc: 74.03%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a03d617432752-8">acc: 68.83%</div><div class="crayon-line" id="crayon-5a65949c3a03d617432752-9">acc: 34.21%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65949c3a03d617432752-10">acc: 72.37%</div><div class="crayon-line" id="crayon-5a65949c3a03d617432752-11">64.68% (+/- 15.50%)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post you discovered the importance of having a robust way to estimate the performance of your deep learning models on unseen data.</p>
<p>You discovered three ways that you can estimate the performance of your deep learning models in Python using the Keras library:</p>
<ul>
<li>Use Automatic Verification Datasets.</li>
<li>Use Manual Verification Datasets.</li>
<li>Use Manual k-Fold Cross Validation.</li>
</ul>
<p>Do you have any questions about deep learning with Keras or this post? Ask your question in the comments and I will do my best to answer it.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fevaluate-performance-deep-learning-models-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/&amp;summary=Keras+is+an+easy+to+use+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AThere+are+a+lot+of+decisio..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Evaluate%20the%20Performance%20Of%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/&amp;summary=Keras+is+an+easy+to+use+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AThere+are+a+lot+of+decisio...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/metrics-evaluate-machine-learning-algorithms-python/" rel="prev"><i class="fa fa-angle-left"></i> Metrics To Evaluate Machine Learning Algorithms in Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/spot-check-classification-machine-learning-algorithms-python-scikit-learn/" rel="next">Spot-Check Classification Machine Learning Algorithms in Python with scikit-learn <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">91 Responses to <em>Evaluate the Performance Of Deep Learning Models in Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-357362">
<div class="comment-container" id="li-comment-357362">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/635487e0c29b164f9808bb387bba457f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/635487e0c29b164f9808bb387bba457f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DR Venugopala Rao Manneni</span>
<span class="date">July 19, 2016 at 2:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-357362" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how  to print network diagram</p>
<div class="reply">
<a aria-label="Reply to DR Venugopala Rao Manneni" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=357362#respond" onclick='return addComment.moveForm( "comment-357362", "357362", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-409718">
<div class="comment-container" id="li-comment-409718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5bfc444d648ad578b429c6412354620?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5bfc444d648ad578b429c6412354620?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">August 15, 2017 at 11:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use plot_model from keras.utils to plot a keras model. link: <a href="https://keras.io/visualization/" rel="nofollow">https://keras.io/visualization/</a></p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409718#respond" onclick='return addComment.moveForm( "comment-409718", "409718", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-362759">
<div class="comment-container" id="li-comment-362759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4aac06ac6fc821ea5c6dd300a33a5367?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4aac06ac6fc821ea5c6dd300a33a5367?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hendrik</span>
<span class="date">August 30, 2016 at 9:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-362759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you explain how can one use different evaluation metric (F1-score or even custom one) for evaluation?</p>
<div class="reply">
<a aria-label="Reply to Hendrik" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=362759#respond" onclick='return addComment.moveForm( "comment-362759", "362759", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-362852">
<div class="comment-container" id="li-comment-362852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2016 at 9:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-362852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Hendrik, you can use a suite of objectives with Keras models, here’s a lost:<br/>
<a href="https://keras.io/objectives/" rel="nofollow">https://keras.io/objectives/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=362852#respond" onclick='return addComment.moveForm( "comment-362852", "362852", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-363117">
<div class="comment-container" id="li-comment-363117">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4aac06ac6fc821ea5c6dd300a33a5367?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4aac06ac6fc821ea5c6dd300a33a5367?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hendrik</span>
<span class="date">September 1, 2016 at 5:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-363117" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the reply, but I don’t mean the “optimizer” parameter but the “metrics” at compilation, which is currently can be only “accuracy”. I’d like to change it to another evaluation metric (F1-score for instance or AUC).</p>
<div class="reply">
<a aria-label="Reply to Hendrik" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=363117#respond" onclick='return addComment.moveForm( "comment-363117", "363117", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-386027">
<div class="comment-container" id="li-comment-386027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/faa8404fd69b453af9befca5fc7d1f7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/faa8404fd69b453af9befca5fc7d1f7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rasika Karle</span>
<span class="date">February 5, 2017 at 1:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-386027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Hendrik, did you get the solution to how to use a different evaluation metric in Keras?</p>
<div class="reply">
<a aria-label="Reply to Rasika Karle" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=386027#respond" onclick='return addComment.moveForm( "comment-386027", "386027", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364957">
<div class="comment-container" id="li-comment-364957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fc78719feaf0854cac59dcedd6f09d2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fc78719feaf0854cac59dcedd6f09d2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shixudong</span>
<span class="date">September 19, 2016 at 6:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-364957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>could you give some instruction on how to train a deep model. if X, y is so large that can not be fit into memory?</p>
<p>model.fit(X_train, y_train, validation_data=(X_test,y_test), nb_epoch=150, batch_size=10)</p>
<div class="reply">
<a aria-label="Reply to shixudong" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=364957#respond" onclick='return addComment.moveForm( "comment-364957", "364957", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365029">
<div class="comment-container" id="li-comment-365029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2016 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-365029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question shixudong.</p>
<p>Keras has a data generator for image data that does not fit into memory:<br/>
<a href="https://keras.io/preprocessing/image/" rel="nofollow">https://keras.io/preprocessing/image/</a></p>
<p>The same approach could be used for tabular data:<br/>
<a href="https://github.com/fchollet/keras/issues/107" rel="nofollow">https://github.com/fchollet/keras/issues/107</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=365029#respond" onclick='return addComment.moveForm( "comment-365029", "365029", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-391388">
<div class="comment-container" id="li-comment-391388">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7df0b48f215340e821b8d7aa0e01c20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7df0b48f215340e821b8d7aa0e01c20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Toqi Tahamid</span>
<span class="date">March 5, 2017 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-391388" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My dataset are in a data folder like this structure–</p>
<p>-data</p>
<p>–Train<br/>
——Dog<br/>
——Cat</p>
<p>–Test<br/>
——Dog<br/>
——Cat</p>
<p>1. How do I know the y_true value of the dataset  from ImageDataGenerator, if I use the function flow_from_directory?</p>
<p>2. How do I use k-fold cross validation using the fit_generator function in Keras?</p>
<div class="reply">
<a aria-label="Reply to Toqi Tahamid" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=391388#respond" onclick='return addComment.moveForm( "comment-391388", "391388", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-391465">
<div class="comment-container" id="li-comment-391465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2017 at 10:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-391465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have examples of using the ImageDataGenerator other than for image augmentation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=391465#respond" onclick='return addComment.moveForm( "comment-391465", "391465", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365216">
<div class="comment-container" id="li-comment-365216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c47920b582cf9c5257619c58904141f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c47920b582cf9c5257619c58904141f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">andrew jeremy</span>
<span class="date">September 22, 2016 at 4:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-365216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how do can I use k-fold cross validation, the gold standard for evaluating machine learning with the fit function in keras ?</p>
<p>Also, how can I get an history of accuracy and loss with the cross_val_score module for plotting ?<br/>
thanks,<br/>
andrew</p>
<div class="reply">
<a aria-label="Reply to andrew jeremy" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=365216#respond" onclick='return addComment.moveForm( "comment-365216", "365216", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365240">
<div class="comment-container" id="li-comment-365240">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2016 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-365240" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great questions.</p>
<p>Here’s an example of using Keras with scikit-learn’s k-fold cross validation:<br/>
<a href="http://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" rel="nofollow">http://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/</a></p>
<p>It is way easier to collect and display history for a single train/test run. Here’s an example:<br/>
<a href="http://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow">http://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=365240#respond" onclick='return addComment.moveForm( "comment-365240", "365240", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-368323">
<div class="comment-container" id="li-comment-368323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f007b75bca98ad94309be3194f906ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f007b75bca98ad94309be3194f906ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Watterson</span>
<span class="date">October 27, 2016 at 12:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-368323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, thanks for the great tutorials!<br/>
I wanted to do a CV but read out the accuracy for each fold not only for the training but also for the test data. Would this ansatz be right: </p>
<p>kfold = StratifiedKFold(n_splits=folds, shuffle=True, random_state=seed)<br/>
for train, test in kfold.split(X, Y):<br/>
    model = Sequential()<br/>
    model.add(Dense(n, input_dim=dim, init=’uniform’, activation=’sigmoid’))<br/>
    model.add(Dense(1, init=’uniform’, activation=’sigmoid’))<br/>
    model.compile(loss=’mse’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
    asd = model.fit(X[train], Y[train], nb_epoch=epoch, validation_data=(X[test], Y[test]), batch_size=10, verbose=1)<br/>
    cv_acc_train = asd.history[‘acc’]<br/>
    cv_acc_test = asd.history[‘val_acc’]</p>
<div class="reply">
<a aria-label="Reply to Watterson" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=368323#respond" onclick='return addComment.moveForm( "comment-368323", "368323", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-368358">
<div class="comment-container" id="li-comment-368358">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2016 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-368358" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks good to me off the cuff Watterson.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=368358#respond" onclick='return addComment.moveForm( "comment-368358", "368358", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-382115">
<div class="comment-container" id="li-comment-382115">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Seun</span>
<span class="date">January 15, 2017 at 3:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-382115" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>asd = model.fit(X[train], Y[train], nb_epoch=epoch, validation_data=(X[test], Y[test])</p>
<p>Please, is the validation_data not suppose to be validation_data=(Y[test], Y[test]). Also, can I use categorical_crossentropy when my activation is softmax. Thanks so much.</p>
<div class="reply">
<a aria-label="Reply to Seun" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=382115#respond" onclick='return addComment.moveForm( "comment-382115", "382115", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-382148">
<div class="comment-container" id="li-comment-382148">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-382148" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Seun, the validation_data must include X and y components.</p>
<p>Yes, I think you can use logloss with softmax, try and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=382148#respond" onclick='return addComment.moveForm( "comment-382148", "382148", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-375617">
<div class="comment-container" id="li-comment-375617">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb8f7df3ed855bd776e926fabda99f59?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb8f7df3ed855bd776e926fabda99f59?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jonas</span>
<span class="date">December 18, 2016 at 2:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-375617" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>When you use the “automatic verfication dataset” the val_loss is lower than the loss.<br/>
“768/768 [==============================] – 0s – loss: 0.4593 – acc: 0.7839 – val_loss: 0.4177 – val_acc: 0.8386”</p>
<p>How can it be possible? </p>
<p>Thank very much for your help and your work !</p>
<div class="reply">
<a aria-label="Reply to Jonas" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=375617#respond" onclick='return addComment.moveForm( "comment-375617", "375617", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375644">
<div class="comment-container" id="li-comment-375644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 18, 2016 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-375644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t understand your question, perhaps could be more specific?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=375644#respond" onclick='return addComment.moveForm( "comment-375644", "375644", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-375660">
<div class="comment-container" id="li-comment-375660">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb8f7df3ed855bd776e926fabda99f59?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb8f7df3ed855bd776e926fabda99f59?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jonas</span>
<span class="date">December 18, 2016 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-375660" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I understood from my previous lectures that a model is fitting well when the validation error is low and slightly higher than the training error. </p>
<p>But in your first example (Automatic Verification Datasets), the validation error is lower than the training error. I can’t figure how the model can perform better on the validation set rather than on the training set.</p>
<p>Does it mean that the validation split isn’t randomly defined?</p>
<div class="reply">
<a aria-label="Reply to Jonas" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=375660#respond" onclick='return addComment.moveForm( "comment-375660", "375660", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-375940">
<div class="comment-container" id="li-comment-375940">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2016 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-375940" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Jonas,</p>
<p>It might be a statistical fluke and a sign of an unstable model.</p>
<p>It might also be a sign of a poor split of the data, and a sign that a strategy with repeated splits might be warranted.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=375940#respond" onclick='return addComment.moveForm( "comment-375940", "375940", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-381465">
<div class="comment-container" id="li-comment-381465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5626d9b13b9f2f85f9c979697f35eaa8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5626d9b13b9f2f85f9c979697f35eaa8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://digiphd.com" rel="external nofollow">Roger</a></span>
<span class="date">January 11, 2017 at 3:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-381465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I am no expert. But it looks like you are training on the binary labels:</p>
<p>Y = dataset[:,8] =&gt; Labels exist in column 8 correct?<br/>
X = dataset[:,0:8] =&gt; This includes column 8, i.e. labels</p>
<p>I could be wrong, haven’t looked at the data set.</p>
<div class="reply">
<a aria-label="Reply to Roger" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=381465#respond" onclick='return addComment.moveForm( "comment-381465", "381465", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381593">
<div class="comment-container" id="li-comment-381593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-381593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, I believe the code is correct (at least in Python 2.7).</p>
<p>I’m happy to hear if you get different results on your system.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=381593#respond" onclick='return addComment.moveForm( "comment-381593", "381593", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-390848">
<div class="comment-container" id="li-comment-390848">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/788b8655b8ad71cd6fda995e14f09959?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/788b8655b8ad71cd6fda995e14f09959?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wqp89324</span>
<span class="date">March 2, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-390848" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason, for a simple feedforward MLP, are there any intuitive criteria for choosing between Keras and Sklearn? </p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to wqp89324" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=390848#respond" onclick='return addComment.moveForm( "comment-390848", "390848", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390876">
<div class="comment-container" id="li-comment-390876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-390876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Speed, Keras will be faster give it is using optimized symbolic math libs as a backend on CPU or GPUs, whereas sklearn is limited to linear algebra libs on the CPU.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=390876#respond" onclick='return addComment.moveForm( "comment-390876", "390876", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-391288">
<div class="comment-container" id="li-comment-391288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pattijane</span>
<span class="date">March 5, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-391288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thanks a lot for your tutorials, they are great!</p>
<p>This might be a bit trivial but I’d like to ask the difference between when we used a validation split in “model.fit” and we  didn’t.  And, for instance instead of using separate train/validation/test sets, will using train/test sets with validation split be enough?</p>
<p>Thanks a lot!</p>
<div class="reply">
<a aria-label="Reply to pattijane" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=391288#respond" onclick='return addComment.moveForm( "comment-391288", "391288", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-391463">
<div class="comment-container" id="li-comment-391463">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2017 at 10:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-391463" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It depends on your problem.</p>
<p>If you can spare the data, it is a good idea to hold back a validation set for final checking. If you can afford the time, use k-fold cross-validation with multiple repeats to eval your model. We often don’t have the time, so we use train/test splits.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=391463#respond" onclick='return addComment.moveForm( "comment-391463", "391463", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-392972">
<div class="comment-container" id="li-comment-392972">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c1da2c27d87896442100078c1a05c86?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c1da2c27d87896442100078c1a05c86?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jason</span>
<span class="date">March 17, 2017 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-392972" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Very nice example, I enjoyed reading your blog.</p>
<p>I got one question, how to decide the number of epoch and the batch size?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Jason" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=392972#respond" onclick='return addComment.moveForm( "comment-392972", "392972", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392993">
<div class="comment-container" id="li-comment-392993">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 17, 2017 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-392993" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question! I recommend trial and error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=392993#respond" onclick='return addComment.moveForm( "comment-392993", "392993", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-393509">
<div class="comment-container" id="li-comment-393509">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/999db3b51c385d9af8e14bd130858968?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/999db3b51c385d9af8e14bd130858968?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carolyn</span>
<span class="date">March 21, 2017 at 8:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-393509" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This is a great post! </p>
<p>I’m having trouble combining categorical cross-entropy and StratifiedKFold. </p>
<p>StratifiedKFold assumes the response is a (number,) shape, according to:<br/>
<a href="http://stackoverflow.com/questions/35022463/stratifiedkfold-indexerror-too-many-indices-for-array" rel="nofollow">http://stackoverflow.com/questions/35022463/stratifiedkfold-indexerror-too-many-indices-for-array</a></p>
<p>But as you’ve explained before, Keras’s categorical cross-entropy expects the response to be a one-hot matrix. How can I resolve this?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Carolyn" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=393509#respond" onclick='return addComment.moveForm( "comment-393509", "393509", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393527">
<div class="comment-container" id="li-comment-393527">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-393527" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You might have to move away from cross validation and rely on repeated random train/test sets.</p>
<p>Alternatively, you could try pre-computing the folds manually or using a modified version of the dataset, the running the cross-validation manually.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=393527#respond" onclick='return addComment.moveForm( "comment-393527", "393527", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-414230">
<div class="comment-container" id="li-comment-414230">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/605bd45cad9f7ef81834d9b5c44d83df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/605bd45cad9f7ef81834d9b5c44d83df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Moji</span>
<span class="date">September 19, 2017 at 7:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414230" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I guess you can do the following:<br/>
change :<br/>
Y=numpy.argmax(Y,axis=1)<br/>
and then using : loss=’sparse_categorical_crossentropy’</p>
<p>it works but would that be correct way?</p>
<div class="reply">
<a aria-label="Reply to Moji" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414230#respond" onclick='return addComment.moveForm( "comment-414230", "414230", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-414254">
<div class="comment-container" id="li-comment-414254">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414254" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a way. I recommend evaluating many approaches and see what works best for your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414254#respond" onclick='return addComment.moveForm( "comment-414254", "414254", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395903">
<div class="comment-container" id="li-comment-395903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e19c32269d6c7a24a9ddfdeb518ac544?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e19c32269d6c7a24a9ddfdeb518ac544?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luis</span>
<span class="date">April 10, 2017 at 7:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-395903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason.</p>
<p>your blog is great! </p>
<p>I’m new on keras. In your last example you build and compile the keras model inside each for iteration (I show your code below).  I don’t know if it is possible, but it looks like it would be more efficient to build and complle the model one time (outside the for loop) and to fit it with the right data each time inside the loop. isn’t this possible in keras?</p>
<p>for train, test in kfold.split(X, Y):<br/>
  # create model<br/>
	model = Sequential()<br/>
	model.add(Dense(12, input_dim=8, activation=’relu’))<br/>
	model.add(Dense(8, activation=’relu’))<br/>
	model.add(Dense(1, activation=’sigmoid’))<br/>
	# Compile model<br/>
	model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<div class="reply">
<a aria-label="Reply to Luis" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=395903#respond" onclick='return addComment.moveForm( "comment-395903", "395903", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395915">
<div class="comment-container" id="li-comment-395915">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 10, 2017 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-395915" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but you may need to re-initialize the weights.</p>
<p>I am demonstrating complete independence of the model within each loop.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=395915#respond" onclick='return addComment.moveForm( "comment-395915", "395915", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396354">
<div class="comment-container" id="li-comment-396354">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2fde728839f462b018b26f3c16bafb29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2fde728839f462b018b26f3c16bafb29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manasi</span>
<span class="date">April 13, 2017 at 11:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396354" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am trying cross-vlisation code with lstm and getting the following error:<br/>
Found array with dim 3. Estimator expected &lt;= 2.</p>
<p>My code is as follows:</p>
<p>kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)<br/>
cvscores = []<br/>
for train, test in kfold.split(task_features_padded, task_label_padded):<br/>
    # create model<br/>
    model=Sequential()<br/>
    model.add(LSTM(50,input_shape=(max_seq,number_of_features),return_sequences = 1, activation = 'relu'))<br/>
    model.add(Dropout(0.2))<br/>
    model.add(Dense(1,activation='sigmoid'))</p>
<p>    print(model.summary())</p>
<p>    model.compile(loss='binary_crossentropy',<br/>
                  optimizer='adam',<br/>
                  metrics=['accuracy'])</p>
<p>    print('Train…')<br/>
    model.fit(task_features_padded[train], task_label_padded[train],batch_size=16,nb_epoch=1000,validation_data=(X_test,y_test),verbose=2)<br/>
    #model.fit(X_train, y_train,batch_size=16,nb_epoch=1000,validation_data=(X_test,y_test),verbose=2)<br/>
    #model.fit(X_train, y_train,batch_size=1,nb_epoch=1000,validation_data=(X_test,y_test),verbose=2)</p>
<p>    score, acc = model.evaluate(task_features_padded[test], task_label_padded[test], batch_size=16,verbose=0)<br/>
    #score, acc = model.evaluate(X_test, y_test, batch_size=16,verbose=0)<br/>
    #score, acc = model.evaluate(X_test, y_test, batch_size=1,verbose=0)<br/>
    print('Test score:', score)<br/>
    print('Test accuracy:', acc)</p>
<p>    scores = model.evaluate(X[test], Y[test], verbose=0)<br/>
    print("%s: %.2f%%" % (model.metrics_names[1], acc*100))<br/>
    cvscores.append(acc * 100)</p>
<p>the shape of task_features_padded is  (876, 6, 11)<br/>
and shape of task_label_padded is (876, 6, 1)</p>
<div class="reply">
<a aria-label="Reply to Manasi" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396354#respond" onclick='return addComment.moveForm( "comment-396354", "396354", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396391">
<div class="comment-container" id="li-comment-396391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 14, 2017 at 8:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure from a quick skim of your code.</p>
<p>I have some debugging suggestions in the FAQ under the question “Can you read, review or debug my code?”<br/>
<a href="http://machinelearningmastery.com/start-here/#faq" rel="nofollow">http://machinelearningmastery.com/start-here/#faq</a></p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396391#respond" onclick='return addComment.moveForm( "comment-396391", "396391", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396693">
<div class="comment-container" id="li-comment-396693">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bbec3c94b6518979291e7012c7c761f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bbec3c94b6518979291e7012c7c761f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arno</span>
<span class="date">April 17, 2017 at 3:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396693" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
In the last part of this article, you are training 10 different models instead of training one 10 times on each fold.<br/>
In other cases, how can I select the best model out of the 10 trained ? Is it a good practice in Machine Learning to do so ?<br/>
Thanks,<br/>
Arno</p>
<div class="reply">
<a aria-label="Reply to Arno" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396693#respond" onclick='return addComment.moveForm( "comment-396693", "396693", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396779">
<div class="comment-container" id="li-comment-396779">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2017 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396779" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent question, see the last part of this post:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396779#respond" onclick='return addComment.moveForm( "comment-396779", "396779", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-396793">
<div class="comment-container" id="li-comment-396793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bbec3c94b6518979291e7012c7c761f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bbec3c94b6518979291e7012c7c761f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arno</span>
<span class="date">April 18, 2017 at 10:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, I’m not the only one having these questions apparently 🙂<br/>
Thanks for the tips ! This website is indeed very helpful.</p>
<div class="reply">
<a aria-label="Reply to Arno" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396793#respond" onclick='return addComment.moveForm( "comment-396793", "396793", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-396871">
<div class="comment-container" id="li-comment-396871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2017 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-396871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=396871#respond" onclick='return addComment.moveForm( "comment-396871", "396871", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399711">
<div class="comment-container" id="li-comment-399711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb8d51f8d594108118e1fa3c04cd3eed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb8d51f8d594108118e1fa3c04cd3eed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nirmala</span>
<span class="date">May 15, 2017 at 4:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-399711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi sir,</p>
<p>When i try to run the code after building the layers i am facing this error</p>
<p>FileNotFoundError: [WinError 3] The system cannot find the path specified: ‘C:/deeplearning/openblas-0.2.14-int32/bin’</p>
<p>I have changed theano flag path using this</p>
<p>variable = THEANO_FLAGS value = floatX=float32,device=cpu,blas.ldflags=-LC:\openblas -lopenblas</p>
<p>but still i am facing the same problem…</p>
<p>Thank you!!</p>
<div class="reply">
<a aria-label="Reply to Nirmala" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=399711#respond" onclick='return addComment.moveForm( "comment-399711", "399711", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399767">
<div class="comment-container" id="li-comment-399767">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-399767" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not seen this error.</p>
<p>Consider posting it as a question to stackoverflow or the theano users group.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=399767#respond" onclick='return addComment.moveForm( "comment-399767", "399767", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399716">
<div class="comment-container" id="li-comment-399716">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/545d3e206bb2eee1adf4b3f2ba4380c2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/545d3e206bb2eee1adf4b3f2ba4380c2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Connie</span>
<span class="date">May 15, 2017 at 5:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-399716" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
How to give prediction score(not prediction label or prediction probability) of each test instance instead of evaluate result on whole test set?<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Connie" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=399716#respond" onclick='return addComment.moveForm( "comment-399716", "399716", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399769">
<div class="comment-container" id="li-comment-399769">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2017 at 8:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-399769" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can predict probabilities with:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65949c3c8a2335333178" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
prob = model.predict_proba(X)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65949c3c8a2335333178-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65949c3c8a2335333178-1"><span class="crayon-v">prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=399769#respond" onclick='return addComment.moveForm( "comment-399769", "399769", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403035">
<div class="comment-container" id="li-comment-403035">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a8614cb2991b8bd9319585f7c84a604?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a8614cb2991b8bd9319585f7c84a604?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">José</span>
<span class="date">June 19, 2017 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-403035" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for the post. Your blog is great to learn Machine Learning with Python, I am very very grateful for you are sharing this with us. Thanks and great job! Muito obrigado, você é muito generoso em compartilhar seu conhecimento.</p>
<div class="reply">
<a aria-label="Reply to José" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=403035#respond" onclick='return addComment.moveForm( "comment-403035", "403035", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403116">
<div class="comment-container" id="li-comment-403116">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-403116" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks José, I’m glad that it is helping.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=403116#respond" onclick='return addComment.moveForm( "comment-403116", "403116", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404275">
<div class="comment-container" id="li-comment-404275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2e607b3b6d55c8829209c88d4f9294ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2e607b3b6d55c8829209c88d4f9294ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aymane</span>
<span class="date">June 30, 2017 at 1:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-404275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, Thank you for your many posts and responses.<br/>
I have tried to follow this tutorial to train and evaluate a multioutput (3) regression deep network using the keras’ Model class API, and here is my code:</p>
<p>#Define cross validation scheme<br/>
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)<br/>
cvscores = []<br/>
for train, test in kfold.split(X_training, [Y_training10,Y_training20,Y_training30]):<br/>
    # Create model<br/>
    inputs=Input(shape=(72,),name=’input_layer’)<br/>
    x=Dense(200,activation=’relu’,name=’hidden_layer1′)(inputs)<br/>
    x=Dropout(.2)(x)<br/>
    y1=Dense(1,name=’GHI10′)(x)<br/>
    y2=Dense(1,name=’GHI20′)(x)<br/>
    y3=Dense(1,name=’GHI30′)(x)<br/>
    model=Model(inputs=inputs,outputs=[y1,y2,y3])<br/>
    # Compile model<br/>
    model.compile(loss=’mean_squared_error’, optimizer=’rmsprop’,metrics=’mean_absolute_error’)<br/>
    #Fit model<br/>
    model.fit(X_training[train],[Y_training10[train],Y_training20[train],Y_training30[train]] ,epochs=100, batch_size=10, verbose=1)<br/>
    # Evaluate model<br/>
    Scores=model.evaluate(X_training[test],[Y_training10[test],Y_training20[test],Y_training30[test]], verbose=1, sample_weight=None)<br/>
    print(“%s: %.2f%% (MSE)” % (model.metrics_names[1], scores[1]))<br/>
    print(“%s: %.2f%% (MSE)” % (model.metrics_names[2], scores[2]))<br/>
    print(“%s: %.2f%% (MSE)” % (model.metrics_names[3], scores[3]))<br/>
    cvscores.append([scores[1],scores[2],scores[3]])<br/>
print(“%.2f MSE of training” % (numpy.mean(cvscores,axis=0)))</p>
<p>But unfortunately I get this error :<br/>
Found input variables with inconsistent number of samples: [15000,3].</p>
<p>I have a [15000sample x 72predictor] as X_training and [15000samples x 3 outputs] as [Y_training10, Y_training20, Y_training30].</p>
<p>Any sort of help would be appreciated.</p>
<div class="reply">
<a aria-label="Reply to Aymane" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=404275#respond" onclick='return addComment.moveForm( "comment-404275", "404275", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404308">
<div class="comment-container" id="li-comment-404308">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-404308" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You have to make sure your input and output data match the same of your network and that train and test have the same number of features.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=404308#respond" onclick='return addComment.moveForm( "comment-404308", "404308", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-408884">
<div class="comment-container" id="li-comment-408884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashley</span>
<span class="date">August 8, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-408884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thank you for an awesome relevant post. I have a question about implementing training\test\validation 80\10\10. Which is sort of outlined in this question: <a href="https://stats.stackexchange.com/questions/19048/what-is-the-difference-between-test-set-and-validation-set" rel="nofollow">https://stats.stackexchange.com/questions/19048/what-is-the-difference-between-test-set-and-validation-set</a> – how would I further split my test set?</p>
<div class="reply">
<a aria-label="Reply to Ashley" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=408884#respond" onclick='return addComment.moveForm( "comment-408884", "408884", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408910">
<div class="comment-container" id="li-comment-408910">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-408910" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped Ashley.</p>
<p>Why would you further split your data?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=408910#respond" onclick='return addComment.moveForm( "comment-408910", "408910", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-408998">
<div class="comment-container" id="li-comment-408998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashley</span>
<span class="date">August 9, 2017 at 12:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-408998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It’s something from the ML course on Udacity. They use a validation set along side test set. It’s outlined in this lecture: <a href="https://classroom.udacity.com/courses/ud730/lessons/6370362152/concepts/63798118330923" rel="nofollow">https://classroom.udacity.com/courses/ud730/lessons/6370362152/concepts/63798118330923</a> Lesson 1 #22. They explain it as your test data bleeding into your training data over time, and this biases the training – so to further split your data, train on train data, validate on validation set and only at the very end test on test data.</p>
<div class="reply">
<a aria-label="Reply to Ashley" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=408998#respond" onclick='return addComment.moveForm( "comment-408998", "408998", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-408999">
<div class="comment-container" id="li-comment-408999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashley</span>
<span class="date">August 9, 2017 at 12:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-408999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This link gets you to #22 <a href="https://classroom.udacity.com/courses/ud730/lessons/6370362152/concepts/63798118300923" rel="nofollow">https://classroom.udacity.com/courses/ud730/lessons/6370362152/concepts/63798118300923</a></p>
<div class="reply">
<a aria-label="Reply to Ashley" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=408999#respond" onclick='return addComment.moveForm( "comment-408999", "408999", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-409002">
<div class="comment-container" id="li-comment-409002">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashley</span>
<span class="date">August 9, 2017 at 1:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409002" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As I say this – I realise that one way to do it is to train and validate and save the model, then load model and test on the test set.</p>
<div class="reply">
<a aria-label="Reply to Ashley" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409002#respond" onclick='return addComment.moveForm( "comment-409002", "409002", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-409041">
<div class="comment-container" id="li-comment-409041">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 9, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409041" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, what is your question exactly?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-409055">
<div class="comment-container" id="li-comment-409055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04e4a402eaa96ad743767cb09ba496bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashley</span>
<span class="date">August 9, 2017 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Initially, it was: how do I take in a validation set and a test set and have two different testing out puts after final run. i.e. How do I set up my model to have a split test/validation set (so have training, validation, test all in one session)<br/>
Now I am just assuming that I should train (fit) on my data, optimise my net according to my validation data (evaluate) and save the model. Then reload it and evaluate again but on test data that it has never seen before – which I am hoping will help me with the small data set I have.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-409137">
<div class="comment-container" id="li-comment-409137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can do that, sounds fine.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-409864">
<div class="comment-container" id="li-comment-409864">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">August 17, 2017 at 1:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409864" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey, Jason.  Great website!  I like how you’ve laid out your posts and how you explain the concepts.  I haven’t been able to figure out the final result from using k-fold.  Let’s assume I execute a k-fold just like you’ve done in your example.  Then, I use the code from another of your great posts to save the model (to JSON) and save the weights.  Which of the 10 models (created during the k-fold loop) will be saved?  The last of the 10?<br/>
I want to have a saved model that I can use on new datasets in the future.  How does creating 10 models with k-fold help me get a better model than using an automatic validation split (as described in this post)?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409864#respond" onclick='return addComment.moveForm( "comment-409864", "409864", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409903">
<div class="comment-container" id="li-comment-409903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2017 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>CV gives a less biased estimate of the models skill on unseen data than a train/test split, at least in general with smallish datasets (less than millions of obs).</p>
<p>Once you have tuned your model, throw all the trained models away and train a final model with all your data and start using it to make predictions.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>Some models are very expensive to train, in which case don’t use CV and keep the best models you train, use them in an ensemble as final models.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409903#respond" onclick='return addComment.moveForm( "comment-409903", "409903", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-409936">
<div class="comment-container" id="li-comment-409936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">August 17, 2017 at 2:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, that post was exactly what I needed.  Thank you!</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409936#respond" onclick='return addComment.moveForm( "comment-409936", "409936", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-409952">
<div class="comment-container" id="li-comment-409952">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2017 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-409952" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear that Michael.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=409952#respond" onclick='return addComment.moveForm( "comment-409952", "409952", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410433">
<div class="comment-container" id="li-comment-410433">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/adfbdfe2d295c5edb913539ab076b594?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/adfbdfe2d295c5edb913539ab076b594?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Minkyu Ha</span>
<span class="date">August 21, 2017 at 5:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-410433" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason<br/>
I’m one of your ebook readers 🙂</p>
<p>Let me ask a strange behavior my case.</p>
<p>When I train &amp; validate my model with dataset..like</p>
<p>model.fit( train_x, train_y, validation_split=0.1, epochs=15, batch_size=100)</p>
<p>it seems to be overfitting to see between acc and val_acc.</p>
<p>67473/67473 [==============================] – 27s – loss: 2.9052 – acc: 0.6370 – val_loss: 6.0345 – val_acc: 0.3758<br/>
Epoch 2/15<br/>
67473/67473 [==============================] – 26s – loss: 1.7335 – acc: 0.7947 – val_loss: 6.2073 – val_acc: 0.3788<br/>
Epoch 3/15<br/>
67473/67473 [==============================] – 26s – loss: 1.5050 – acc: 0.8207 – val_loss: 6.1922 – val_acc: 0.3952<br/>
Epoch 4/15<br/>
67473/67473 [==============================] – 26s – loss: 1.4130 – acc: 0.8380 – val_loss: 6.2896 – val_acc: 0.4092<br/>
Epoch 5/15<br/>
67473/67473 [==============================] – 26s – loss: 1.3750 – acc: 0.8457 – val_loss: 6.3136 – val_acc: 0.3953<br/>
Epoch 6/15<br/>
67473/67473 [==============================] – 26s – loss: 1.3350 – acc: 0.8573 – val_loss: 6.4355 – val_acc: 0.4098<br/>
Epoch 7/15<br/>
67473/67473 [==============================] – 26s – loss: 1.3045 – acc: 0.8644 – val_loss: 6.3992 – val_acc: 0.4018<br/>
Epoch 8/15<br/>
67473/67473 [==============================] – 26s – loss: 1.2687 – acc: 0.8710 – val_loss: 6.5578 – val_acc: 0.3897<br/>
Epoch 9/15<br/>
67473/67473 [==============================] – 26s – loss: 1.2552 – acc: 0.8745 – val_loss: 6.4178 – val_acc: 0.4104<br/>
Epoch 10/15<br/>
67473/67473 [==============================] – 26s – loss: 1.2195 – acc: 0.8796 – val_loss: 6.5593 – val_acc: 0.4044<br/>
Epoch 11/15<br/>
67473/67473 [==============================] – 26s – loss: 1.1977 – acc: 0.8833 – val_loss: 6.5514 – val_acc: 0.4041<br/>
Epoch 12/15<br/>
67473/67473 [==============================] – 26s – loss: 1.1828 – acc: 0.8874 – val_loss: 6.5972 – val_acc: 0.3973<br/>
Epoch 13/15<br/>
67473/67473 [==============================] – 26s – loss: 1.1665 – acc: 0.8890 – val_loss: 6.5879 – val_acc: 0.3882<br/>
Epoch 14/15<br/>
67473/67473 [==============================] – 26s – loss: 1.1466 – acc: 0.8931 – val_loss: 6.5610 – val_acc: 0.4104<br/>
Epoch 15/15<br/>
67473/67473 [==============================] – 27s – loss: 1.1394 – acc: 0.8925 – val_loss: 6.5062 – val_acc: 0.4100</p>
<p>but , when I split the data into train &amp; test with StratifiedKFold(n_splits=10, shuffle=True, random_state=7)<br/>
and evaluate it with test data,  it shows good result of accuracy.<br/>
score = model.evaluate(test_x, test_y)<br/>
[1.3547255955601791, 0.82816451482507525]</p>
<p>so.. I tried to validate with test dataset which was split with StratifiedKFold.<br/>
model.fit( train_x, train_y, validation_data=(test_x, test_y), epochs=15, batch_size=100)</p>
<p>and it shows good result of val_acc. </p>
<p>Epoch 1/14<br/>
67458/67458 [==============================] – 27s – loss: 2.9200 – acc: 0.6006 – val_loss: 1.9954 – val_acc: 0.7508<br/>
Epoch 2/14<br/>
67458/67458 [==============================] – 26s – loss: 1.8138 – acc: 0.7536 – val_loss: 1.6458 – val_acc: 0.7844<br/>
Epoch 3/14<br/>
67458/67458 [==============================] – 26s – loss: 1.5869 – acc: 0.7852 – val_loss: 1.5848 – val_acc: 0.7876<br/>
Epoch 4/14<br/>
67458/67458 [==============================] – 25s – loss: 1.4980 – acc: 0.8056 – val_loss: 1.5353 – val_acc: 0.8015<br/>
Epoch 5/14<br/>
67458/67458 [==============================] – 25s – loss: 1.4375 – acc: 0.8202 – val_loss: 1.4870 – val_acc: 0.8117<br/>
Epoch 6/14<br/>
67458/67458 [==============================] – 25s – loss: 1.3795 – acc: 0.8324 – val_loss: 1.4738 – val_acc: 0.8139<br/>
Epoch 7/14<br/>
67458/67458 [==============================] – 26s – loss: 1.3437 – acc: 0.8400 – val_loss: 1.4677 – val_acc: 0.8146<br/>
Epoch 8/14<br/>
67458/67458 [==============================] – 26s – loss: 1.3059 – acc: 0.8462 – val_loss: 1.4127 – val_acc: 0.8263<br/>
Epoch 9/14<br/>
67458/67458 [==============================] – 26s – loss: 1.2758 – acc: 0.8533 – val_loss: 1.4087 – val_acc: 0.8219<br/>
Epoch 10/14<br/>
67458/67458 [==============================] – 25s – loss: 1.2381 – acc: 0.8602 – val_loss: 1.4095 – val_acc: 0.8242<br/>
Epoch 11/14<br/>
67458/67458 [==============================] – 26s – loss: 1.2188 – acc: 0.8644 – val_loss: 1.3960 – val_acc: 0.8272<br/>
Epoch 12/14<br/>
67458/67458 [==============================] – 25s – loss: 1.1991 – acc: 0.8677 – val_loss: 1.3898 – val_acc: 0.8226<br/>
Epoch 13/14<br/>
67458/67458 [==============================] – 25s – loss: 1.1671 – acc: 0.8733 – val_loss: 1.3370 – val_acc: 0.8380<br/>
Epoch 14/14<br/>
67458/67458 [==============================] – 25s – loss: 1.1506 – acc: 0.8750 – val_loss: 1.3363 – val_acc: 0.8315</p>
<p>Do you have any idea the reason why  the result of auto validation_split and  validation with test dataset ?</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Minkyu Ha" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=410433#respond" onclick='return addComment.moveForm( "comment-410433", "410433", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410500">
<div class="comment-container" id="li-comment-410500">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 22, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-410500" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There is no need to validate when using cross validation. The model is doing twice the work.</p>
<p>Perhaps the stratification of the data sample is important to your model?</p>
<p>Perhaps the model performs better on the smaller sample (e.g. 1/10th of data if 10-folds).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=410500#respond" onclick='return addComment.moveForm( "comment-410500", "410500", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-412866">
<div class="comment-container" id="li-comment-412866">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cbb47189bffb8a693d33656f8f101013?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cbb47189bffb8a693d33656f8f101013?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Macarena</span>
<span class="date">September 6, 2017 at 8:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-412866" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
First of all congrats for these tutorials, they are great!<br/>
I’m trying to use StratifiedKFold validation in a multiple inputs network (3 inputs) for a regression problem, and I’m having several problems when using it. First of all, in the step:<br/>
“for train,test in kfold.split()” I’m introducing just one of the inputs and the labels structure, this way: “for train, test in kfold.split(X1, Y):”, and then inside the loop I define “X1_train = X1[train], X2_train = X2[train], X3_train=X3[train]” and so on. This way, when fitting my model I use “model.fit([X1_train, X2_train, X3_train], Y_train….)”. But I’m getting the error “n_splits=10 cannot be greater than the number of members in each class”, and I don’t know how to fix it.</p>
<p>I have also try the option you give in this tutorial: <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a><br/>
But in this case the error I get is “Found input variables with inconsistent numbers of samples”.</p>
<p>I don’t know how can I implement this, I would appreciate any help. Thanks.</p>
<div class="reply">
<a aria-label="Reply to Macarena" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=412866#respond" onclick='return addComment.moveForm( "comment-412866", "412866", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412968">
<div class="comment-container" id="li-comment-412968">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-412968" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>All rows must have the same number of columns, if that helps?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=412968#respond" onclick='return addComment.moveForm( "comment-412968", "412968", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-413022">
<div class="comment-container" id="li-comment-413022">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cbb47189bffb8a693d33656f8f101013?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cbb47189bffb8a693d33656f8f101013?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Macarena</span>
<span class="date">September 7, 2017 at 9:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-413022" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>X1, X2 and X3 have shape (nb_samples, 2, 8, 10), while Y has shape (nb_samples, 4). I don’t know if it is not able to recognize that the common axis is nb_samples (although I read in the documentation that it takes by default the first axis).<br/>
I have resolved it creating an structure of zeros with just one dimension: X_split = np.zeros((X1.shape[0])) and Y_split = np.zeros((Y.shape[0])), and I use those two arrays to create the for loop. But I don’t know why I cannot do it the other way.</p>
<div class="reply">
<a aria-label="Reply to Macarena" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=413022#respond" onclick='return addComment.moveForm( "comment-413022", "413022", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414871">
<div class="comment-container" id="li-comment-414871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a89f9c8e6b898832658878a916b2a1c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a89f9c8e6b898832658878a916b2a1c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Siyan</span>
<span class="date">September 27, 2017 at 12:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your blogs and I learned a lot from your posts.<br/>
I encountered a strange problem while using Keras, my problem is regression problem and I would like to show and record the loss and validation loss while training. But when I only assign “validation_split”, then I can only get the “loss” without any “validation loss”, after I manually assign the “validation_data” into model.fit the I can get either “loss” and “validation loss”.<br/>
From the document of Keras, “validation_split” will use last XX% of data without shuffle as the validation data, I assume it should have the “validation loss” as well, but I cannot find and get it. Do you have any ideas about it, thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Siyan" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414871#respond" onclick='return addComment.moveForm( "comment-414871", "414871", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414897">
<div class="comment-container" id="li-comment-414897">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414897" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you set validation data or a validation split, then the validation loss will be printed each epoch if verbose=1 and available in the history object at the end of the run.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414897#respond" onclick='return addComment.moveForm( "comment-414897", "414897", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414914">
<div class="comment-container" id="li-comment-414914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/66e51dbfc4ee64a4ee8f69c5923cce03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/66e51dbfc4ee64a4ee8f69c5923cce03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nafiz</span>
<span class="date">September 27, 2017 at 11:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, after doing the k-fold CV, how do you train the NN on your whole data set? Because usually, we train it as long as the validation set accuracy is increasing. Before applying the NN into the wild, we would like to train it on the whole data set, if our data set size is small. How do we train it then?</p>
<div class="reply">
<a aria-label="Reply to Nafiz" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414914#respond" onclick='return addComment.moveForm( "comment-414914", "414914", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414931">
<div class="comment-container" id="li-comment-414931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 3:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-414931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, see this post:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=414931#respond" onclick='return addComment.moveForm( "comment-414931", "414931", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417425">
<div class="comment-container" id="li-comment-417425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/829f7dbde49db960a6fe8517bf98c912?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/829f7dbde49db960a6fe8517bf98c912?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shahab</span>
<span class="date">October 21, 2017 at 8:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. i have trained a network using Keras for segmentation purpose of MRI images. My test data has no ground truth. I need to save the output of network for test set as Images and submit them for evaluation. I would like to ask you how can I do this procedure in testing part. As I know for evaluation in Keras, I need both test samples and the coressponding ground truth!!!!</p>
<div class="reply">
<a aria-label="Reply to Shahab" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417425#respond" onclick='return addComment.moveForm( "comment-417425", "417425", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417474">
<div class="comment-container" id="li-comment-417474">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417474" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct, you need ground truth in order to evaluate any model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417474#respond" onclick='return addComment.moveForm( "comment-417474", "417474", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417728">
<div class="comment-container" id="li-comment-417728">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">gana</span>
<span class="date">October 24, 2017 at 3:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417728" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your precious tutorials</p>
<p>I have a question about confusion between test set and validation set in tensorflow+keras.</p>
<p>In your tutorials validation dataset does not affect to training and totally independent from training procedure.<br/>
validation dataset is only for monitoring and early stopping. in addition, validation set is not used in training (updating weight, gradient decent, etc).</p>
<p>However i found that wikipedia says in different way as follows:<br/>
A validation dataset is a set of examples used to tune the hyperparameters (i.e. the architecture) of a classifier.<br/>
LINK: <a href="https://en.wikipedia.org/wiki/Training,_test,_and_validation_sets" rel="nofollow">https://en.wikipedia.org/wiki/Training,_test,_and_validation_sets</a></p>
<p>It sounds like validation dataset is for tuning parameters means that it is used in training procedure.<br/>
If it is true we will face overfitting. </p>
<p>if validation data set does not affect to training as your tutorial then does keras use some part of training dataset automatically for validating and tuning parameters?</p>
<div class="reply">
<a aria-label="Reply to gana" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417728#respond" onclick='return addComment.moveForm( "comment-417728", "417728", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417742">
<div class="comment-container" id="li-comment-417742">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 4:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417742" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, validation set is used for tuning the model and is a subset of the training dataset.</p>
<p>Perhaps this post will clear things up:<br/>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417742#respond" onclick='return addComment.moveForm( "comment-417742", "417742", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-417757">
<div class="comment-container" id="li-comment-417757">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">gana</span>
<span class="date">October 24, 2017 at 6:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417757" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Mr @Jason Brownlee for your quick answer</p>
<p>Let me clear my question again, i am asking this question not because i do not know the concept of three datasets.<br/>
it is because i do not know how background of Keras use the datasets.</p>
<p>For example. in this tutorilal <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/</a></p>
<p>You defined only two datasets as: </p>
<p>(X_train, y_train), (X_test, y_test) = imdb.load_data(nb_words=top_words)</p>
<p>You said that validation dataset may disappear if there is K-fold validation (in that case validation is picked from training set), however in the tutorial we did not use k-fold validation. So where is validation set? is it still in the training set?</p>
<p>in the code below, fit function uses validation_data for tuning parameters isn’t it? and also you assigned test data to validation data. in that case we need new test data for evaluation, is it right?</p>
<p>model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=3, batch_size=64)</p>
<p>in the code below, evaluate function results unbiased score isn’t it? then where is validation data? does keras background code automatically split X_train to train and validation parts?</p>
<p>model.fit(X_train, y_train, nb_epoch=3, batch_size=64)<br/>
# Final evaluation of the model<br/>
scores = model.evaluate(X_test, y_test, verbose=0)</p>
<div class="reply">
<a aria-label="Reply to gana" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417757#respond" onclick='return addComment.moveForm( "comment-417757", "417757", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-417822">
<div class="comment-container" id="li-comment-417822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We do not have to use a validation dataset and in many tutorials I exclude that part of the process for brevity.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=417822#respond" onclick='return addComment.moveForm( "comment-417822", "417822", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-417870">
<div class="comment-container" id="li-comment-417870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/740cace112999287d056d47e5ec406e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">gana</span>
<span class="date">October 25, 2017 at 1:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Means that keras picks part of training dataset automatically for validating and tuning parameters?<br/>
If we do not use validation dataset how to tune parameters?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-417886">
<div class="comment-container" id="li-comment-417886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 4:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-417886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It can, or we can specify it.</p>
<p>You can tune on the training dataset.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-418073">
<div class="comment-container" id="li-comment-418073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Estelle</span>
<span class="date">October 27, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-418073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you very much for your blog and examples, it is great!</p>
<p>Look I merged two of your examples: the one above and the Save and Load Your Keras Deep Learning Models (<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a>). You can see the code below:</p>
<p># MLP for Pima Indians Dataset with 10-fold cross validation<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from sklearn.model_selection import StratifiedKFold<br/>
from keras.models import model_from_json<br/>
import numpy<br/>
# fix random seed for reproducibility<br/>
seed = 7<br/>
numpy.random.seed(seed)<br/>
# load pima indians dataset<br/>
dataset = numpy.loadtxt(“pima-indians-diabetes.csv”, delimiter=”,”)<br/>
# split into input (X) and output (Y) variables<br/>
X = dataset[:,0:8]<br/>
Y = dataset[:,8]</p>
<p>#make model<br/>
def make_model():<br/>
    model = Sequential()<br/>
    model.add(Dense(12, input_dim=8, activation=’relu’))<br/>
    model.add(Dense(8, activation=’relu’))<br/>
    model.add(Dense(1, activation=’sigmoid’))<br/>
    # Compile model<br/>
    model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
    return(model)</p>
<p># define 10-fold cross validation test harness<br/>
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)<br/>
cvscores = []<br/>
for train, test in kfold.split(X, Y):<br/>
    # create model<br/>
    model = make_model()<br/>
    # Fit the model<br/>
    model.fit(X[train], Y[train], epochs=150, batch_size=10, verbose=0)<br/>
    # serialize model to JSON<br/>
    model_json = model.to_json()<br/>
    with open(“model.json”, “w”) as json_file:<br/>
        json_file.write(model_json)<br/>
    # serialize weights to HDF5<br/>
    model.save_weights(“model.h5”)<br/>
    print(“Saved model to disk”)</p>
<p>    # evaluate the model<br/>
    scores = model.evaluate(X[test], Y[test], verbose=0)<br/>
    print(“%s: %.2f%%” % (model.metrics_names[1], scores[1]*100))</p>
<p>    cvscores.append(scores[1] * 100)</p>
<p>    del model_json<br/>
    del model<br/>
print(“%.2f%% (+/- %.2f%%)” % (numpy.mean(cvscores), numpy.std(cvscores)))</p>
<p># load json and create model<br/>
json_file = open(‘model.json’, ‘r’)<br/>
loaded_model_json = json_file.read()<br/>
json_file.close()<br/>
loaded_model = model_from_json(loaded_model_json)<br/>
# load weights into new model<br/>
loaded_model.load_weights(“model.h5”)<br/>
print(“Loaded model from disk”)</p>
<p># evaluate loaded model on test data<br/>
loaded_model.compile(loss=’binary_crossentropy’, optimizer=’rmsprop’, metrics=[‘accuracy’])<br/>
score = loaded_model.evaluate(X, Y, verbose=0)<br/>
print(“%s: %.2f%%” % (loaded_model.metrics_names[1], score[1]*100))</p>
<p>And the output is as follow:</p>
<p>Saved model to disk<br/>
acc: 76.62%<br/>
Saved model to disk<br/>
acc: 74.03%<br/>
Saved model to disk<br/>
acc: 71.43%<br/>
Saved model to disk<br/>
acc: 72.73%<br/>
Saved model to disk<br/>
acc: 70.13%<br/>
Saved model to disk<br/>
acc: 64.94%<br/>
Saved model to disk<br/>
acc: 66.23%<br/>
Saved model to disk<br/>
acc: 64.94%<br/>
Saved model to disk<br/>
acc: 63.16%<br/>
Saved model to disk<br/>
acc: 72.37%<br/>
69.66% (+/- 4.32%)</p>
<p>Loaded model from disk<br/>
acc: 75.91%</p>
<p>Naively I was expecting to get the save accuracy as the last model I saved (which was 72.37%), but I got 75.91%. Could you please explain how the weights are saved inside a k-fold cross validation?</p>
<p>Thanks,</p>
<p>Estelle</p>
<div class="reply">
<a aria-label="Reply to Estelle" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=418073#respond" onclick='return addComment.moveForm( "comment-418073", "418073", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418106">
<div class="comment-container" id="li-comment-418106">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-418106" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Machine learning algorithms are stochastic, see this post for more details:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=418106#respond" onclick='return addComment.moveForm( "comment-418106", "418106", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-418184">
<div class="comment-container" id="li-comment-418184">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Estelle</span>
<span class="date">October 28, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-418184" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for your quick answer and reference.</p>
<p>Yes, I forgot that randomness happens at so many levels.</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Estelle" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=418184#respond" onclick='return addComment.moveForm( "comment-418184", "418184", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-418282">
<div class="comment-container" id="li-comment-418282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-418282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Indeed!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=418282#respond" onclick='return addComment.moveForm( "comment-418282", "418282", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422801">
<div class="comment-container" id="li-comment-422801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b03a4bed9cb4f0b736870545af95430b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b03a4bed9cb4f0b736870545af95430b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kongpon</span>
<span class="date">December 12, 2017 at 1:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-422801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I try to use your example in my Classification Model, but I got this Error</p>
<p>ValueError: Supported target types are: (‘binary’, ‘multiclass’). Got ‘multilabel-indicator’ instead.</p>
<div class="reply">
<a aria-label="Reply to Kongpon" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=422801#respond" onclick='return addComment.moveForm( "comment-422801", "422801", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422832">
<div class="comment-container" id="li-comment-422832">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-422832" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that. Ensure that all of your Python libraries are up to date and that you copied all of the code from the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=422832#respond" onclick='return addComment.moveForm( "comment-422832", "422832", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423982">
<div class="comment-container" id="li-comment-423982">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AJ</span>
<span class="date">December 19, 2017 at 9:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-423982" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir, can you sugest how to do startified kfol crossvalidation for this case.<br/>
<a href="https://gist.github.com/dirko/1d596ca757a541da96ac3caa6f291229" rel="nofollow">https://gist.github.com/dirko/1d596ca757a541da96ac3caa6f291229</a></p>
<div class="reply">
<a aria-label="Reply to AJ" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=423982#respond" onclick='return addComment.moveForm( "comment-423982", "423982", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424050">
<div class="comment-container" id="li-comment-424050">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-424050" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I do not have the capacity to review your code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=424050#respond" onclick='return addComment.moveForm( "comment-424050", "424050", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-424075">
<div class="comment-container" id="li-comment-424075">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AJ</span>
<span class="date">December 20, 2017 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-424075" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sorry it’s not my code – just found on the internet and I am learning- So I would like to know that if forward and backward training and testing data exist how to do pass two parameters in kfold.split(X, Y)<br/>
 as here in the link its given that X_enc_f X_enc_b and y_enc as the forward backward and label encoders</p>
<div class="reply">
<a aria-label="Reply to AJ" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=424075#respond" onclick='return addComment.moveForm( "comment-424075", "424075", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-424162">
<div class="comment-container" id="li-comment-424162">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 3:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-424162" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Maybe this doco will help:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=424162#respond" onclick='return addComment.moveForm( "comment-424162", "424162", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425637">
<div class="comment-container" id="li-comment-425637">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3b3b68e8b4a0709e579870eb78bfe165?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3b3b68e8b4a0709e579870eb78bfe165?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam Miller</span>
<span class="date">January 5, 2018 at 1:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-425637" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
How do you apply model.predict when using k-folds?<br/>
I want to be able to create a classification report for my model and possibly an AUC plot, heat map, precision-recall graph as well</p>
<div class="reply">
<a aria-label="Reply to Sam Miller" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=425637#respond" onclick='return addComment.moveForm( "comment-425637", "425637", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425667">
<div class="comment-container" id="li-comment-425667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-425667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, see this post on creating a final model:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=425667#respond" onclick='return addComment.moveForm( "comment-425667", "425667", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-425737">
<div class="comment-container" id="li-comment-425737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3b3b68e8b4a0709e579870eb78bfe165?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3b3b68e8b4a0709e579870eb78bfe165?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam Miller</span>
<span class="date">January 6, 2018 at 2:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-425737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry what I meant was, how do you code model.predict/predict_proba when you use the kfold.split method? </p>
<p>The examples I’ve seen that don’t use k-folds have code like model.predict(x_test) after applying model.fit.</p>
<p>I’d like to use precision_recall_curve and roc_curve with k-folds</p>
<div class="reply">
<a aria-label="Reply to Sam Miller" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=425737#respond" onclick='return addComment.moveForm( "comment-425737", "425737", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-425751">
<div class="comment-container" id="li-comment-425751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 6, 2018 at 5:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/#comment-425751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You do not. CV is for evaluating a model, then you can build a final model. Please see the post that I linked.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/evaluate-performance-deep-learning-models-keras/?replytocom=425751#respond" onclick='return addComment.moveForm( "comment-425751", "425751", "respond", "2561" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/evaluate-performance-deep-learning-models-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2561"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="2bc5f5ab63"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="154"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>