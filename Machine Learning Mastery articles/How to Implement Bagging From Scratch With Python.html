<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Implement Bagging From Scratch With Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/implement-bagging-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Implement Bagging From Scratch With Python - Machine Learning Mastery" property="og:title"/>
<meta content="Decision trees are a simple and powerful predictive modeling technique, but they suffer from high-variance. This means that trees can get very different results given different training data. A technique to make decision trees more robust and to achieve better performance is called bootstrap aggregation or bagging for short. In this tutorial, you will discover …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-bagging-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-11T05:00:40+11:00" property="article:published_time"/>
<meta content="2017-08-12T09:17:20+11:00" property="article:modified_time"/>
<meta content="2017-08-12T09:17:20+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Bagging-From-Scratch-With-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Bagging-From-Scratch-With-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/implement-bagging-scratch-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-bagging-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Implement Bagging From Scratch With Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3357" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-bagging-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-bagging-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3357 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Need help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3357 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How to Implement Bagging From Scratch With Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-11T05:00:40+1100">November 11, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Algorithms From Scratch">Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-bagging-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-bagging-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-bagging-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-bagging-scratch-python/&amp;summary=Decision+trees+are+a+simple+and+powerful+predictive+modeling+technique%2C+but+they+suffer+from+high-va..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-bagging-scratch-python/&amp;summary=Decision+trees+are+a+simple+and+powerful+predictive+modeling+technique%2C+but+they+suffer+from+high-va...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-bagging-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-bagging-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Decision trees are a simple and powerful predictive modeling technique, but they suffer from high-variance.</p>
<p>This means that trees can get very different results given different training data.</p>
<p>A technique to make decision trees more robust and to achieve better performance is called bootstrap aggregation or bagging for short.</p>
<p>In this tutorial, you will discover how to implement the bagging procedure with decision trees from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to create a bootstrap sample of your dataset.</li>
<li>How to make predictions with bootstrapped models.</li>
<li>How to apply bagging to your own predictive modeling problems.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Feb/2017</strong>: Fixed a bug in build_tree.</li>
<li><strong>Update Aug/2017</strong>: Fixed a bug in Gini calculation, added the missing weighting of group Gini scores by group size (thanks Michael!).</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3358" style="max-width: 650px"><img alt="How to Implement Bagging From Scratch With Python" class="size-full wp-image-3358" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Bagging-From-Scratch-With-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Bagging-From-Scratch-With-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Bagging-From-Scratch-With-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Implement Bagging From Scratch With Python<br/>Photo by <a href="https://www.flickr.com/photos/khouri/5457862281/">Michael Cory</a>, some rights reserved.</p></div>
<h2>Descriptions</h2>
<p>This section provides a brief description to Bootstrap Aggregation and the Sonar dataset that will be used in this tutorial.</p>
<h3>Bootstrap Aggregation Algorithm</h3>
<p>A bootstrap is a sample of a dataset with replacement.</p>
<p>This means that a new dataset is created from a random sample of an existing dataset where a given row may be selected and added more than once to the sample.</p>
<p>It is a useful approach to use when estimating values such as the mean for a broader dataset, when you only have a limited dataset available. By creating samples of your dataset and estimating the mean from those samples, you can take the average of those estimates and get a better idea of the true mean of the underlying problem.</p>
<p>This same approach can be used with machine learning algorithms that have a high variance, such as decision trees. A separate model is trained on each bootstrap sample of data and the average output of those models used to make predictions. This technique is called bootstrap aggregation or bagging for short.</p>
<p>Variance means that an algorithm’s performance is sensitive to the training data, with high variance suggesting that the more the training data is changed, the more the performance of the algorithm will vary.</p>
<p>The performance of high variance machine learning algorithms like unpruned decision trees can be improved by training many trees and taking the average of their predictions. Results are often better than a single decision tree.</p>
<p>Another benefit of bagging in addition to improved performance is that the bagged decision trees cannot overfit the problem. Trees can continue to be added until a maximum in performance is achieved.</p>
<h3>Sonar Dataset</h3>
<p>The dataset we will use in this tutorial is the Sonar dataset.</p>
<p>This is a dataset that describes sonar chirp returns bouncing off different surfaces. The 60 input variables are the strength of the returns at different angles. It is a binary classification problem that requires a model to differentiate rocks from metal cylinders. There are 208 observations.</p>
<p>It is a well-understood dataset. All of the variables are continuous and generally in the range of 0 to 1. The output variable is a string “M” for mine and “R” for rock, which will need to be converted to integers 1 and 0.</p>
<p>By predicting the class with the most observations in the dataset (M or mines) the Zero Rule Algorithm can achieve an accuracy of 53%.</p>
<p>You can learn more about this dataset at the <a href="https://archive.ics.uci.edu/ml/datasets/Connectionist+Bench+(Sonar,+Mines+vs.+Rocks)">UCI Machine Learning repository</a>.</p>
<p>Download the dataset for free and place it in your working directory with the filename <strong>sonar.all-data.csv</strong>.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 2 parts:</p>
<ol>
<li>Bootstrap Resample.</li>
<li>Sonar Dataset Case Study.</li>
</ol>
<p>These steps provide the foundation that you need to implement and apply bootstrap aggregation with decision trees to your own predictive modeling problems.</p>
<h3>1. Bootstrap Resample</h3>
<p>Let’s start off by getting a strong idea of how the bootstrap method works.</p>
<p>We can create a new sample of a dataset by randomly selecting rows from the dataset and adding them to a new list. We can repeat this for a fixed number of rows or until the size of the new dataset matches a ratio of the size of the original dataset.</p>
<p>We can allow sampling with replacement by not removing the row that was selected so that it is available for future selections.</p>
<p>Below is a function named <strong>subsample()</strong> that implements this procedure. The <strong>randrange()</strong> function from the random module is used to select a random row index to add to the sample each iteration of the loop. The default size of the sample is the size of the original dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6587a8ea07e277449205" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create a random subsample from the dataset with replacement
def subsample(dataset, ratio=1.0):
	sample = list()
	n_sample = round(len(dataset) * ratio)
	while len(sample) &lt; n_sample:
		index = randrange(len(dataset))
		sample.append(dataset[index])
	return sample</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6587a8ea07e277449205-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea07e277449205-2">2</div><div class="crayon-num" data-line="crayon-5a6587a8ea07e277449205-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea07e277449205-4">4</div><div class="crayon-num" data-line="crayon-5a6587a8ea07e277449205-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea07e277449205-6">6</div><div class="crayon-num" data-line="crayon-5a6587a8ea07e277449205-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea07e277449205-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6587a8ea07e277449205-1"><span class="crayon-p"># Create a random subsample from the dataset with replacement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea07e277449205-2"><span class="crayon-e">def </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea07e277449205-3"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea07e277449205-4"><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea07e277449205-5"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea07e277449205-6"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea07e277449205-7"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea07e277449205-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sample</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We can use this function to estimate the mean of a contrived dataset.</p>
<p>First, we can create a dataset with 20 rows and a single column of random numbers between 0 and 9 and calculate the mean value.</p>
<p>We can then make bootstrap samples of the original dataset, calculate the mean, and repeat this process until we have a list of means. Taking the average of these sample means should give us a robust estimate of the mean of the entire dataset.</p>
<p>The complete example is listed below.</p>
<p>Each bootstrap sample is created as a 10% sample of the original 20 observation dataset (or 2 observations). We then experiment by creating 1, 10, 100 bootstrap samples of the original dataset, calculate their mean value, then average all of those estimated mean values.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6587a8ea08a491862786" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from random import seed
from random import random
from random import randrange


# Create a random subsample from the dataset with replacement
def subsample(dataset, ratio=1.0):
	sample = list()
	n_sample = round(len(dataset) * ratio)
	while len(sample) &lt; n_sample:
		index = randrange(len(dataset))
		sample.append(dataset[index])
	return sample


# Calculate the mean of a list of numbers
def mean(numbers):
	return sum(numbers) / float(len(numbers))


seed(1)
# True mean
dataset = [[randrange(10)] for i in range(20)]
print('True Mean: %.3f' % mean([row[0] for row in dataset]))
# Estimated means
ratio = 0.10
for size in [1, 10, 100]:
	sample_means = list()
	for i in range(size):
		sample = subsample(dataset, ratio)
		sample_mean = mean([row[0] for row in sample])
		sample_means.append(sample_mean)
	print('Samples=%d, Estimated Mean: %.3f' % (size, mean(sample_means)))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-2">2</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-4">4</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-6">6</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-8">8</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-10">10</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-12">12</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-14">14</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-16">16</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-18">18</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-20">20</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-22">22</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-24">24</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-26">26</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-28">28</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-30">30</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08a491862786-32">32</div><div class="crayon-num" data-line="crayon-5a6587a8ea08a491862786-33">33</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-1"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-4"> </div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-6"><span class="crayon-p"># Create a random subsample from the dataset with replacement</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-7"><span class="crayon-e">def </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-8"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-9"><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-10"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-11"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-12"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-13"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-14"> </div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-16"><span class="crayon-p"># Calculate the mean of a list of numbers</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-17"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-20"> </div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-21"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-22"><span class="crayon-p"># True mean</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'True Mean: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-25"><span class="crayon-p"># Estimated means</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-26"><span class="crayon-v">ratio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.10</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">size </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-28"><span class="crayon-h"> </span><span class="crayon-v">sample_means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-30"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-31"><span class="crayon-h"> </span><span class="crayon-v">sample_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08a491862786-32"><span class="crayon-h"> </span><span class="crayon-v">sample_means</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">sample_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea08a491862786-33"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Samples=%d, Estimated Mean: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">sample_means</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example prints the original mean value we aim to estimate.</p>
<p>We can then see the estimated mean from the various different numbers of bootstrap samples. We can see that with 100 samples we achieve a good estimate of the mean.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6587a8ea08d806435584" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
True Mean: 4.450
Samples=1, Estimated Mean: 4.500
Samples=10, Estimated Mean: 3.300
Samples=100, Estimated Mean: 4.480</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6587a8ea08d806435584-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08d806435584-2">2</div><div class="crayon-num" data-line="crayon-5a6587a8ea08d806435584-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea08d806435584-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6587a8ea08d806435584-1">True Mean: 4.450</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08d806435584-2">Samples=1, Estimated Mean: 4.500</div><div class="crayon-line" id="crayon-5a6587a8ea08d806435584-3">Samples=10, Estimated Mean: 3.300</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea08d806435584-4">Samples=100, Estimated Mean: 4.480</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Instead of calculating the mean value, we can create a model from each subsample.</p>
<p>Next, let’s see how we can combine the predictions from multiple bootstrap models.</p>
<h3>2. Sonar Dataset Case Study</h3>
<p>In this section, we will apply the Random Forest algorithm to the Sonar dataset.</p>
<p>The example assumes that a CSV copy of the dataset is in the current working directory with the file name <strong>sonar.all-data.csv</strong>.</p>
<p>The dataset is first loaded, the string values converted to numeric and the output column is converted from strings to the integer values of 0 to 1. This is achieved with helper functions <strong>load_csv()</strong>, <strong>str_column_to_float()</strong> and <strong>str_column_to_int()</strong> to load and prepare the dataset.</p>
<p>We will use k-fold cross validation to estimate the performance of the learned model on unseen data. This means that we will construct and evaluate k models and estimate the performance as the mean model error. Classification accuracy will be used to evaluate each model. These behaviors are provided in the <strong>cross_validation_split()</strong>, <strong>accuracy_metric()</strong> and <strong>evaluate_algorithm()</strong> helper functions.</p>
<p>We will also use an implementation of the Classification and Regression Trees (CART) algorithm adapted for bagging including the helper functions <strong>test_split()</strong> to split a dataset into groups, <strong>gini_index()</strong> to evaluate a split point, <strong>get_split()</strong> to find an optimal split point, <strong>to_terminal()</strong>, <strong>split()</strong> and <strong>build_tree()</strong> used to create a single decision tree, <strong>predict()</strong> to make a prediction with a decision tree and the <strong>subsample()</strong> function described in the previous step to make a subsample of the training dataset</p>
<p>A new function named <strong>bagging_predict()</strong> is developed that is responsible for making a prediction with each decision tree and combining the predictions into a single return value. This is achieved by selecting the most common prediction from the list of predictions made by the bagged trees.</p>
<p>Finally, a new function named <strong>bagging()</strong> is developed that is responsible for creating the samples of the training dataset, training a decision tree on each, then making predictions on the test dataset using the list of bagged trees.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6587a8ea091527281482" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Bagging Algorithm on the Sonar dataset
from random import seed
from random import randrange
from csv import reader

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	for index in range(len(dataset[0])-1):
		for row in dataset:
		# for i in range(len(dataset)):
		# 	row = dataset[randrange(len(dataset))]
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)

# Create child splits for a node or make terminal
def split(node, max_depth, min_size, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left)
		split(node['left'], max_depth, min_size, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right)
		split(node['right'], max_depth, min_size, depth+1)

# Build a decision tree
def build_tree(train, max_depth, min_size):
	root = get_split(train)
	split(root, max_depth, min_size, 1)
	return root

# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']

# Create a random subsample from the dataset with replacement
def subsample(dataset, ratio):
	sample = list()
	n_sample = round(len(dataset) * ratio)
	while len(sample) &lt; n_sample:
		index = randrange(len(dataset))
		sample.append(dataset[index])
	return sample

# Make a prediction with a list of bagged trees
def bagging_predict(trees, row):
	predictions = [predict(tree, row) for tree in trees]
	return max(set(predictions), key=predictions.count)

# Bootstrap Aggregation Algorithm
def bagging(train, test, max_depth, min_size, sample_size, n_trees):
	trees = list()
	for i in range(n_trees):
		sample = subsample(train, sample_size)
		tree = build_tree(sample, max_depth, min_size)
		trees.append(tree)
	predictions = [bagging_predict(trees, row) for row in test]
	return(predictions)

# Test bagging on the sonar dataset
seed(1)
# load and prepare data
filename = 'sonar.all-data.csv'
dataset = load_csv(filename)
# convert string attributes to integers
for i in range(len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# evaluate algorithm
n_folds = 5
max_depth = 6
min_size = 2
sample_size = 0.50
for n_trees in [1, 5, 10, 50]:
	scores = evaluate_algorithm(dataset, bagging, n_folds, max_depth, min_size, sample_size, n_trees)
	print('Trees: %d' % n_trees)
	print('Scores: %s' % scores)
	print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-2">2</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-4">4</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-6">6</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-8">8</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-10">10</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-12">12</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-14">14</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-16">16</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-18">18</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-20">20</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-22">22</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-24">24</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-26">26</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-28">28</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-30">30</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-32">32</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-34">34</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-36">36</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-38">38</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-40">40</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-42">42</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-44">44</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-46">46</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-48">48</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-50">50</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-52">52</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-54">54</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-56">56</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-58">58</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-60">60</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-62">62</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-64">64</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-66">66</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-68">68</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-70">70</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-72">72</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-74">74</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-76">76</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-78">78</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-80">80</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-82">82</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-84">84</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-86">86</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-88">88</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-90">90</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-92">92</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-94">94</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-96">96</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-98">98</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-100">100</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-102">102</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-104">104</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-106">106</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-108">108</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-110">110</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-112">112</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-114">114</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-116">116</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-118">118</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-120">120</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-122">122</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-124">124</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-126">126</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-128">128</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-130">130</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-132">132</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-134">134</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-136">136</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-138">138</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-140">140</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-142">142</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-144">144</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-146">146</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-148">148</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-150">150</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-152">152</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-154">154</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-156">156</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-158">158</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-160">160</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-162">162</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-164">164</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-166">166</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-168">168</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-170">170</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-172">172</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-174">174</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-176">176</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-178">178</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-180">180</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-182">182</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-184">184</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-186">186</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-188">188</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-190">190</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-192">192</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-194">194</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-196">196</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-198">198</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-200">200</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-202">202</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-204">204</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-206">206</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea091527281482-208">208</div><div class="crayon-num" data-line="crayon-5a6587a8ea091527281482-209">209</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6587a8ea091527281482-1"><span class="crayon-p"># Bagging Algorithm on the Sonar dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-v">reader</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-6"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-7"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-8"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-9"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-10"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-12"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-13"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-14"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-15"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-16"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-17"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-18"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-20"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-22"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-23"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-24"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-25"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-26"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-27"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-28"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-30"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-31"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-32"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-33"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-34"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-35"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-36"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-37"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-38"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-39"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-40"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-41"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-42"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-43"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-44"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-45"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-46"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-47"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-48"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-49"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-50"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-51"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-52"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-53"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-54"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-55"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-56"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-57"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-58"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-59"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-60"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-61"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-62"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-63"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-64"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-65"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-66"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-67"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-68"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-69"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-70"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-71"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-72"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-73"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-74"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-75"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-76"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-77"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-78"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-79"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-80"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-81"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-82"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-83"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-84"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-85"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-86"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-87"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-88"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-89"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-90"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-91"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-92"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-93"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-94"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-95"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-96"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-97"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-98"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-99"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-100"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-101"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-102"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-103"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-104"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-105"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-106"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-107"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-108"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-109"><span class="crayon-h"> </span><span class="crayon-p"># for i in range(len(dataset)):</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-110"><span class="crayon-h"> </span><span class="crayon-p"># 	row = dataset[randrange(len(dataset))]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-111"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-112"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-113"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-114"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-115"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-116"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-117"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-118"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-119"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-120"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-121"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-122"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-123"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-124"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-125"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-126"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-127"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-128"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-129"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-130"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-131"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-132"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-133"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-134"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-135"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-136"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-137"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-138"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-139"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-140"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-141"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-142"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-143"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-144"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-145"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-146"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-147"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-148"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-149"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-150"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-151"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-152"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-153"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-154"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-155"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-156"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-157"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-158"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-159"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-160"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-161"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-162"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-163"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-164"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-165"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-166"><span class="crayon-p"># Create a random subsample from the dataset with replacement</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-167"><span class="crayon-e">def </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-168"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-169"><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-170"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-171"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-172"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-173"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-174"> </div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-175"><span class="crayon-p"># Make a prediction with a list of bagged trees</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-176"><span class="crayon-e">def </span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-177"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">tree </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-178"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-179"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-180"><span class="crayon-p"># Bootstrap Aggregation Algorithm</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-181"><span class="crayon-e">def </span><span class="crayon-e">bagging</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-182"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-183"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-184"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-185"><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-186"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-187"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-188"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-189"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-190"><span class="crayon-p"># Test bagging on the sonar dataset</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-191"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-192"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-193"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sonar.all-data.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-194"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-195"><span class="crayon-p"># convert string attributes to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-196"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-197"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-198"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-199"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-200"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-201"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-202"><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-203"><span class="crayon-v">min_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-204"><span class="crayon-v">sample_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.50</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-205"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">n_trees </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-206"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bagging</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-207"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Trees: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea091527281482-208"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6587a8ea091527281482-209"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0154 seconds] -->
<p>A k value of 5 was used for cross-validation, giving each fold 208/5 = 41.6 or just over 40 records to be evaluated upon each iteration.</p>
<p>Deep trees were constructed with a max depth of 6 and a minimum number of training rows at each node of 2. Samples of the training dataset were created with 50% the size of the original dataset. This was to force some variety in the dataset subsamples used to train each tree. The default for bagging is to have the size of sample datasets match the size of the original training dataset.</p>
<p>A series of 4 different numbers of trees were evaluated to show the behavior of the algorithm.</p>
<p>The accuracy from each fold and the mean accuracy for each configuration are printed. We can see a trend of some minor lift in performance as the number of trees is increased.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6587a8ea098692682263" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Trees: 1
Scores: [87.8048780487805, 65.85365853658537, 65.85365853658537, 65.85365853658537, 73.17073170731707]
Mean Accuracy: 71.707%

Trees: 5
Scores: [60.97560975609756, 80.48780487804879, 78.04878048780488, 82.92682926829268, 63.41463414634146]
Mean Accuracy: 73.171%

Trees: 10
Scores: [60.97560975609756, 73.17073170731707, 82.92682926829268, 80.48780487804879, 68.29268292682927]
Mean Accuracy: 73.171%

Trees: 50
Scores: [63.41463414634146, 75.60975609756098, 80.48780487804879, 75.60975609756098, 85.36585365853658]
Mean Accuracy: 76.098%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-2">2</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-4">4</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-6">6</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-8">8</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-10">10</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-12">12</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6587a8ea098692682263-14">14</div><div class="crayon-num" data-line="crayon-5a6587a8ea098692682263-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6587a8ea098692682263-1">Trees: 1</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-2">Scores: [87.8048780487805, 65.85365853658537, 65.85365853658537, 65.85365853658537, 73.17073170731707]</div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-3">Mean Accuracy: 71.707%</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-4"> </div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-5">Trees: 5</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-6">Scores: [60.97560975609756, 80.48780487804879, 78.04878048780488, 82.92682926829268, 63.41463414634146]</div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-7">Mean Accuracy: 73.171%</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-8"> </div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-9">Trees: 10</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-10">Scores: [60.97560975609756, 73.17073170731707, 82.92682926829268, 80.48780487804879, 68.29268292682927]</div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-11">Mean Accuracy: 73.171%</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-12"> </div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-13">Trees: 50</div><div class="crayon-line crayon-striped-line" id="crayon-5a6587a8ea098692682263-14">Scores: [63.41463414634146, 75.60975609756098, 80.48780487804879, 75.60975609756098, 85.36585365853658]</div><div class="crayon-line" id="crayon-5a6587a8ea098692682263-15">Mean Accuracy: 76.098%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A difficulty of this method is that even though deep trees are constructed, the bagged trees that are created are very similar. In turn, the predictions made by these trees are also similar, and the high variance we desire among the trees trained on different samples of the training dataset is diminished.</p>
<p>This is because of the greedy algorithm used in the construction of the trees selecting the same or similar split points.</p>
<p>The tutorial tried to re-inject this variance by constraining the sample size used to train each tree. A more robust technique is to constrain the features that may be evaluated when creating each split point. This is the method used in the Random Forest algorithm.</p>
<h2>Extensions</h2>
<ul>
<li><strong>Tune the Example</strong>. Explore different configurations for the number of trees and even individual tree configurations to see if you can further improve results.</li>
<li><strong>Bag Another Algorithm</strong>. Other algorithms can be used with bagging. For example, a k-nearest neighbor algorithm with a low value of k will have a high variance and is a good candidate for bagging.</li>
<li><strong>Regression Problems</strong>. Bagging can be used with regression trees. Instead of predicting the most common class value from the set of predictions, you can return the average of the predictions from the bagged trees. Experiment on regression problems.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement bootstrap aggregation from scratch with Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to create a subsample and estimate bootstrap quantities.</li>
<li>How to create an ensemble of decision trees and use them to make predictions.</li>
<li>How to apply bagging to a real world predictive modeling problem.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-bagging-scratch-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-bagging-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-bagging-scratch-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-bagging-scratch-python/&amp;summary=Decision+trees+are+a+simple+and+powerful+predictive+modeling+technique%2C+but+they+suffer+from+high-va..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Implement%20Bagging%20From%20Scratch%20With%20Python&amp;url=https://machinelearningmastery.com/implement-bagging-scratch-python/&amp;summary=Decision+trees+are+a+simple+and+powerful+predictive+modeling+technique%2C+but+they+suffer+from+high-va...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-bagging-scratch-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/implement-bagging-scratch-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Implement The Decision Tree Algorithm From Scratch In Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/" rel="next">How to Implement Random Forest From Scratch in Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">6 Responses to <em>How to Implement Bagging From Scratch With Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-382687">
<div class="comment-container" id="li-comment-382687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/473132c7403d8e50a42793940a5f7f24?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/473132c7403d8e50a42793940a5f7f24?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">skorzec</span>
<span class="date">January 18, 2017 at 4:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-382687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this example in python from scratch. I think the reason your score stays the same is because you are using the entire dataset to select your split attributes. This leads to similar trees and thus a small variance of the ensemble set. If you change your code, in such a way you get more variance in the trees, you will see an increase in performance of the ensemble. One solution is to alter this code snippet:</p>
<p># Build a decision tree<br/>
def build_tree(train, max_depth, min_size):<br/>
    root = get_split(train)<br/>
    split(root, max_depth, min_size, 1)<br/>
    return root</p>
<div class="reply">
<a aria-label="Reply to skorzec" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=382687#respond" onclick='return addComment.moveForm( "comment-382687", "382687", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-382744">
<div class="comment-container" id="li-comment-382744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-382744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tip!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=382744#respond" onclick='return addComment.moveForm( "comment-382744", "382744", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403732">
<div class="comment-container" id="li-comment-403732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a5abc1a65f6ca4de541247001b87ffc2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a5abc1a65f6ca4de541247001b87ffc2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://github.com/JovanSardinha" rel="external nofollow">Jovan Sardinha</a></span>
<span class="date">June 25, 2017 at 9:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-403732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for the great tutorial!</p>
<p>I have re-written this script using sklearn for easy implementation:<br/>
<a href="https://gist.github.com/JovanSardinha/2c58bd1e7e3aa4c02affedfe7abe8a29" rel="nofollow">https://gist.github.com/JovanSardinha/2c58bd1e7e3aa4c02affedfe7abe8a29</a></p>
<div class="reply">
<a aria-label="Reply to Jovan Sardinha" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=403732#respond" onclick='return addComment.moveForm( "comment-403732", "403732", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403804">
<div class="comment-container" id="li-comment-403804">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 26, 2017 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-403804" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=403804#respond" onclick='return addComment.moveForm( "comment-403804", "403804", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-411861">
<div class="comment-container" id="li-comment-411861">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ec427750e991b2a06f0f06b3648fcac2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ec427750e991b2a06f0f06b3648fcac2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex Godfrey</span>
<span class="date">August 31, 2017 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-411861" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Minor tip – In the string to integer conversion – I found that the unique set gets created in somewhat random order in repeat runs of this and others scripts that use this function.  To avoid this I have changed the line to read-</p>
<p>unique = sorted(set(class_values))</p>
<p>This results in creating the same lookup dictionary every time.  I ran across this when I was using the lookup dictionary to create nicely mapped printouts of the intermediate data.</p>
<div class="reply">
<a aria-label="Reply to Alex Godfrey" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=411861#respond" onclick='return addComment.moveForm( "comment-411861", "411861", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-411983">
<div class="comment-container" id="li-comment-411983">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/#comment-411983" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tip, thanks Alex!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/implement-bagging-scratch-python/?replytocom=411983#respond" onclick='return addComment.moveForm( "comment-411983", "411983", "respond", "3357" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-bagging-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3357"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="0f4b2ce8dc"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="155"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center>
<h3>Code Algorithms From Scratch in Python</h3>
<p>Discover how to code top machine learning algorithms from first principles with Python.</p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Code Machine Learning Algorithms From Scratch Today!</a></p>
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>