<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Convex Optimization in R - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/convex-optimization-in-r/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Convex Optimization in R - Machine Learning Mastery" property="og:title"/>
<meta content="Optimization is a big part of machine learning. It is the core of most popular methods, from least squares regression to artificial neural networks. In this post you will discover recipes for 5 optimization algorithms in R. These methods might be useful in the core of your own implementation of a machine learning algorithm. You …" property="og:description"/>
<meta content="https://machinelearningmastery.com/convex-optimization-in-r/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="R Machine Learning" property="article:section"/>
<meta content="2014-08-29T05:00:38+11:00" property="article:published_time"/>
<meta content="2016-09-22T10:25:17+11:00" property="article:modified_time"/>
<meta content="2016-09-22T10:25:17+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results.png" property="og:image:secure_url"/>
<meta content="877" property="og:image:width"/>
<meta content="899" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/convex-optimization-in-r\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/convex-optimization-in-r/feed/" rel="alternate" title="Machine Learning Mastery » Convex Optimization in R Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=1707" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvex-optimization-in-r%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvex-optimization-in-r%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-1707 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-15"> <div class="textwidget"><p>Want help with R machine learning? <a href="https://machinelearningmastery.leadpages.co/r-machine-learning-mini-course/">Take the FREE Mini-Course</a>.</p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-1707 post type-post status-publish format-standard has-post-thumbnail hentry category-r-machine-learning">
<header>
<h1 class="title entry-title">Convex Optimization in R</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2014-08-29T05:00:38+1100">August 29, 2014</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/r-machine-learning/" title="View all items in R Machine Learning">R Machine Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Convex%20Optimization%20in%20R&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvex-optimization-in-r%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convex-optimization-in-r/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convex-optimization-in-r/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Convex%20Optimization%20in%20R&amp;url=https://machinelearningmastery.com/convex-optimization-in-r/&amp;summary=Optimization+is+a+big+part+of+machine+learning.+It+is+the+core+of+most+popular+methods%2C+from+least+s..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Convex%20Optimization%20in%20R&amp;url=https://machinelearningmastery.com/convex-optimization-in-r/&amp;summary=Optimization+is+a+big+part+of+machine+learning.+It+is+the+core+of+most+popular+methods%2C+from+least+s...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/convex-optimization-in-r/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/convex-optimization-in-r/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Optimization is a big part of machine learning. It is the core of most popular methods, from least squares regression to artificial neural networks.</p>
<p>In this post you will discover recipes for 5 optimization algorithms in R.</p>
<p>These methods might be useful in the core of your own implementation of a machine learning algorithm. You may want to implement your own algorithm tuning scheme to optimize the parameters of a model for some cost function.</p>
<p>A good example may be the case where you want to optimize the hyper-parameters of a blend of predictions from an ensemble of multiple child models.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need more elp with R for Machine Learning?</h3>
<p>Take my free 14-day email course and discover how to use R on your project (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/141caac73f72a2%3A164f8be4f346dc/5734055144325120/" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="141caac73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/141caac73f72a2%3A164f8be4f346dc/5734055144325120/" src="https://machinelearningmastery.lpages.co/leadbox-1500583721.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>Golden Section Search</h2>
<p>Golden Section Search is a Line Search method for Global Optimization in one-dimension. It is a Direct Search (Pattern Search) method as it samples the function to approximate a derivative rather than computing it directly.</p>
<p>The Golden Section Search is related to pattern searches of discrete ordered lists such as the Binary Search and the Fibonacci Search. It is related to other Line Search algorithms such as Brent’s Method and more generally to other direct search optimization methods such as the Nelder-Mead Method.</p>
<p>The information processing objective of the method is to locate the extremum of a function. It does this by directly sampling the function using a pattern of three points. The points form the brackets on the search: the first and the last points are the current bounds of the search, and the third point partitions the intervening space. The partitioning point is selected so that the ratio between the larger partition and the whole interval is the same as the ratio of the larger partition to the small partition, known as the golden ratio (<em>phi</em>). The partitions are compared based on their function evaluation and the better performing section is selected as the new bounds on the search. The process recurses until the desired level of precision (bracketing of the optimum) is obtained or the search stalls.</p>
<p>The following example provides a code listing Golden Section Search method in R solving a one-dimensional nonlinear unconstrained optimization function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6589b675316433822471" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Golden Section Search in R</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define a 1D basin function, optima at f(0)=0
basin &lt;- function(x) {
x[1]^2
}

# locate the minimum of the function using a Golden Section Line Search
result &lt;- optimize( 
basin, # the function to be minimized
c(-5, 5), # the bounds on the function parameter
maximum=FALSE, # we are concerned with the function minima
tol=1e-8) # the size of the final bracketing

# display the results
print(result$minimum)
print(result$objective)

# plot the function 
x &lt;- seq(-5, 5, length.out=100)
y &lt;- basin(expand.grid(x))
plot(x, y, xlab="x",ylab="f(x)", type="l")
# plot the solution as a point
points(result$minimum, result$objective, col="red", pch=19)
# draw a square around the optima to highlight it
rect(result$minimum-0.3, result$objective-0.7, result$minimum+0.3, result$objective+0.7, lwd=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6589b675316433822471-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-2">2</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-4">4</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-6">6</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-8">8</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-10">10</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-12">12</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-14">14</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-16">16</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-18">18</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-20">20</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-22">22</div><div class="crayon-num" data-line="crayon-5a6589b675316433822471-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675316433822471-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6589b675316433822471-1"><span class="crayon-c"># define a 1D basin function, optima at f(0)=0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-2"><span class="crayon-v">basin</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-3"><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-6"><span class="crayon-c"># locate the minimum of the function using a Golden Section Line Search</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-7"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">optimize</span><span class="crayon-sy">(</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-8"><span class="crayon-v">basin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the function to be minimized</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-9"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the bounds on the function parameter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-10"><span class="crayon-v">maximum</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># we are concerned with the function minima</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-11"><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the size of the final bracketing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-12"> </div><div class="crayon-line" id="crayon-5a6589b675316433822471-13"><span class="crayon-c"># display the results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-14"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">minimum</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">objective</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-16"> </div><div class="crayon-line" id="crayon-5a6589b675316433822471-17"><span class="crayon-c"># plot the function </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-18"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-19"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">basin</span><span class="crayon-sy">(</span><span class="crayon-v">expand</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-20"><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"x"</span><span class="crayon-sy">,</span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"f(x)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"l"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-21"><span class="crayon-c"># plot the solution as a point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-22"><span class="crayon-e">points</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">minimum</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">objective</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-s">"red"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pch</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675316433822471-23"><span class="crayon-c"># draw a square around the optima to highlight it</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675316433822471-24"><span class="crayon-e">rect</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">minimum</span><span class="crayon-o">-</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">objective</span><span class="crayon-o">-</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">minimum</span><span class="crayon-o">+</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">objective</span><span class="crayon-o">+</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lwd</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_1716" style="max-width: 302px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Golden-Section-Search-Results.png"><img alt="Golden Section Search Results" class="size-medium wp-image-1716" height="300" sizes="(max-width: 292px) 100vw, 292px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Golden-Section-Search-Results-292x300.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Golden-Section-Search-Results-292x300.png 292w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Golden-Section-Search-Results.png 877w" width="292"/></a><p class="wp-caption-text">Golden Section Search Results</p></div>
<h3>Usage Heuristics</h3>
<ul>
<li>Assumes that the function is convex and unimodal specifically, that the function has a single optimum and that it lies between the bracketing points.</li>
<li>Intended to find the extrema one-dimensional continuous functions.</li>
<li>It was shown to be more efficient than an equal-sized partition line search.</li>
<li>The termination criteria is a specification on the minimum distance between the brackets on the optimum.</li>
<li>It can quickly locate the bracketed area of the optimum but is less efficient at locating the specific optimum.</li>
<li>Once a solution of desired precision is located, it can be provided as the basis to a second search algorithm that has a faster rate of convergence.</li>
</ul>
<h2>Nelder Mead</h2>
<p>The Nelder-Mead Method is an optimization algorithm for multidimensional nonlinear unconstrained functions.<br/>
It is a Direct Search Method in that it does not use a function gradient during the procedure. It is a Pattern Search in that it uses a geometric pattern to explore the problem space.</p>
<p>It is related to other Direct Search optimization methods such as Hooke and Jeeves’ Pattern Search that also uses a geometric pattern to optimize an objective function.</p>
<p>The information processing objective of the Nelder-Mead Method is to locate the extremum of a function. This is achieved by overlaying a simplex (geometrical pattern) in the domain and iteratively increasing and/or reducing its size until an optimal value is found. The simplex is defined always with <em>n</em>+1 vertices, where <em>n</em> is the number of dimensions of the search space (i.e. a triangle for a 2D problem).</p>
<p>The process involves identifying the worst performing point of the complex and replacing it with a point reflected through the centroid (center point) of the remaining points. The simplex can be deformed (adapt itself to the topology of the search space) by expanding away from the worst point, contract along one dimension away from the worst point, or contract on all dimensions towards the best point.</p>
<p>The following example provides a code listing of the Nelder-Mead method in R solving a two-dimensional nonlinear optimization function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6589b675323704403353" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Nelder-Mead Method in R</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# definition of the 2D Rosenbrock function, optima is at (1,1)
rosenbrock &lt;- function(v) { 
(1 - v[1])^2 + 100 * (v[2] - v[1]*v[1])^2
}

# locate the minimum of the function using the Nelder-Mead method
result &lt;- optim(
c(runif(1,-3,3), runif(1,-3,3)), # start at a random position
rosenbrock, # the function to minimize
NULL, # no function gradient 
method="Nelder-Mead", # use the Nelder-Mead method
control=c( # configure Nelder-Mead
maxit=100, # maximum iterations of 100
reltol=1e-8, # response tolerance over-one step
alpha=1.0, # reflection factor
beta=0.5, # contraction factor
gamma=2.0)) # expansion factor

# summarize results
# the coordinate of the minimum
print(result$par) 
# the function response of the minimum
print(result$value) 
# the number of function calls performed
print(result$counts)

# display the function as a contour plot
x &lt;- seq(-3, 3, length.out=100)
y &lt;- seq(-3, 3, length.out=100)
z &lt;- rosenbrock(expand.grid(x, y))
contour(x, y, matrix(log10(z), length(x)), xlab="x",ylab="y")
# draw the optima as a point
points(result$par[1], result$par[2], col="red", pch=19)
# draw a square around the optima to highlight it
rect(result$par[1]-0.2, result$par[2]-0.2, result$par[1]+0.2, result$par[2]+0.2, lwd=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6589b675323704403353-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-2">2</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-4">4</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-6">6</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-8">8</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-10">10</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-12">12</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-14">14</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-16">16</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-18">18</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-20">20</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-22">22</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-24">24</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-26">26</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-28">28</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-30">30</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-32">32</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675323704403353-34">34</div><div class="crayon-num" data-line="crayon-5a6589b675323704403353-35">35</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6589b675323704403353-1"><span class="crayon-c"># definition of the 2D Rosenbrock function, optima is at (1,1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-2"><span class="crayon-v">rosenbrock</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-3"><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-6"><span class="crayon-c"># locate the minimum of the function using the Nelder-Mead method</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-7"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">optim</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-8"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># start at a random position</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-9"><span class="crayon-v">rosenbrock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the function to minimize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-10"><span class="crayon-t">NULL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># no function gradient </span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-11"><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"Nelder-Mead"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># use the Nelder-Mead method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-12"><span class="crayon-v">control</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-c"># configure Nelder-Mead</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-13"><span class="crayon-v">maxit</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># maximum iterations of 100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-14"><span class="crayon-v">reltol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># response tolerance over-one step</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-15"><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># reflection factor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-16"><span class="crayon-v">beta</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># contraction factor</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-17"><span class="crayon-v">gamma</span><span class="crayon-o">=</span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># expansion factor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-18"> </div><div class="crayon-line" id="crayon-5a6589b675323704403353-19"><span class="crayon-c"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-20"><span class="crayon-c"># the coordinate of the minimum</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-22"><span class="crayon-c"># the function response of the minimum</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-24"><span class="crayon-c"># the number of function calls performed</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">counts</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-26"> </div><div class="crayon-line" id="crayon-5a6589b675323704403353-27"><span class="crayon-c"># display the function as a contour plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-28"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-29"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-30"><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">rosenbrock</span><span class="crayon-sy">(</span><span class="crayon-v">expand</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-31"><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">matrix</span><span class="crayon-sy">(</span><span class="crayon-e">log10</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">length</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"x"</span><span class="crayon-sy">,</span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"y"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-32"><span class="crayon-c"># draw the optima as a point</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-33"><span class="crayon-e">points</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-s">"red"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pch</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675323704403353-34"><span class="crayon-c"># draw a square around the optima to highlight it</span></div><div class="crayon-line" id="crayon-5a6589b675323704403353-35"><span class="crayon-e">rect</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lwd</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0029 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_1715" style="max-width: 302px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Nelder-Mead-Results.png"><img alt="Nelder Mead Results" class="size-medium wp-image-1715" height="300" sizes="(max-width: 292px) 100vw, 292px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Nelder-Mead-Results-292x300.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Nelder-Mead-Results-292x300.png 292w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Nelder-Mead-Results.png 877w" width="292"/></a><p class="wp-caption-text">Nelder Mead Results</p></div>
<h3>Usage Heuristics</h3>
<ul>
<li>It can be used with multi-dimensional functions (one or more parameters) and with non-linear response surfaces.</li>
<li>It does not use a function derivative meaning that it can be used on non-differentiable functions, discontinuous functions, non-smooth functions, and noisy functions.</li>
<li>As a direct search method it is consider inefficient and slow relative to modern derivative-based methods.</li>
<li>It is dependent on the starting position and can be caught by local optimum in multimodal functions.</li>
<li>The stopping criteria can be a minimum change in the best position.</li>
<li>The nature of the simplex structure can mean it can get stuck in non-optimal areas of the search space, this is more likely if the size of the initial simplex is too large.</li>
<li>When the method does work (is appropriate for the function being optimized) it has been shown to be fast and robust.</li>
</ul>
<h2>Gradient Descent</h2>
<p>Gradient Descent is a first-order derivative optimization method for unconstrained nonlinear function optimization. It is called Gradient Descent because it was envisioned for function minimization. When applied to function maximization it may be referred to as Gradient Ascent.</p>
<p>Steepest Descent Search is an extension that performs a Line Search on the line of the gradient to the locate the optimum neighboring point (optimum step or steepest step). Batch Gradient Descent is an extension where the cost function and its derivative are computed as the summed error on a collection of training examples. Stochastic Gradient Descent (or Online Gradient Descent) is like Batch Gradient Descent except that the cost function and derivative are computed for each training example.</p>
<p>The information processing objective of the method is to locate the extremum of a function. This is achieved by first selecting a starting point in the search space. For a given point in the search space, the derivative of the cost function is calculated and a new point is selected down the gradient of the functions derivative at a distance of <em>alpha</em> (the step size parameter) from the current point.</p>
<p>The example provides a code listing Gradient Descent algorithm in R solving a two-dimensional nonlinear optimization function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6589b67532a671130234" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Gradient Descent in R</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define a 2D basin function, optima is at (0,0)
basin &lt;- function(x) {
x[1]^2 + x[2]^2
}

# define the derivative for a 2D basin function
derivative &lt;- function(x) {
c(2*x[1], 2*x[2])
}

# definition of the gradient descent method in 2D
gradient_descent &lt;- function(func, derv, start, step=0.05, tol=1e-8) {
pt1 &lt;- start
grdnt &lt;- derv(pt1)
pt2 &lt;- c(pt1[1] - step*grdnt[1], pt1[2] - step*grdnt[2])
while (abs(func(pt1)-func(pt2)) &gt; tol) {
pt1 &lt;- pt2
grdnt &lt;- derv(pt1)
pt2 &lt;- c(pt1[1] - step*grdnt[1], pt1[2] - step*grdnt[2])
print(func(pt2)) # print progress
}
pt2 # return the last point
}

# locate the minimum of the function using the Gradient Descent method
result &lt;- gradient_descent(
basin, # the function to optimize
derivative, # the gradient of the function
c(runif(1,-3,3), runif(1,-3,3)), # start point of the search 
0.05, # step size (alpha)
1e-8) # relative tolerance for one step

# display a summary of the results
print(result) # coordinate of fucntion minimum
print(basin(result)) # response of fucntion minimum

# display the function as a contour plot
x &lt;- seq(-3, 3, length.out=100)
y &lt;- seq(-3, 3, length.out=100)
z &lt;- basin(expand.grid(x, y))
contour(x, y, matrix(z, length(x)), xlab="x",ylab="y")
# draw the optima as a point
points(result[1], result[2], col="red", pch=19)
# draw a square around the optima to highlight it
rect(result[1]-0.2, result[2]-0.2, result[1]+0.2, result[2]+0.2, lwd=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-2">2</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-4">4</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-6">6</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-8">8</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-10">10</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-12">12</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-14">14</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-16">16</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-18">18</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-20">20</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-22">22</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-24">24</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-26">26</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-28">28</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-30">30</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-32">32</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-34">34</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-36">36</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-38">38</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-40">40</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-42">42</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b67532a671130234-44">44</div><div class="crayon-num" data-line="crayon-5a6589b67532a671130234-45">45</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6589b67532a671130234-1"><span class="crayon-c"># define a 2D basin function, optima is at (0,0)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-2"><span class="crayon-v">basin</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-3"><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-6"><span class="crayon-c"># define the derivative for a 2D basin function</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-7"><span class="crayon-v">derivative</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-8"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-10"> </div><div class="crayon-line" id="crayon-5a6589b67532a671130234-11"><span class="crayon-c"># definition of the gradient descent method in 2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-12"><span class="crayon-v">gradient_descent</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">func</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">derv</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">step</span><span class="crayon-o">=</span><span class="crayon-cn">0.05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-13"><span class="crayon-v">pt1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">start</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-14"><span class="crayon-v">grdnt</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">derv</span><span class="crayon-sy">(</span><span class="crayon-v">pt1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-15"><span class="crayon-v">pt2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-v">pt1</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">step</span><span class="crayon-o">*</span><span class="crayon-v">grdnt</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pt1</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">step</span><span class="crayon-o">*</span><span class="crayon-v">grdnt</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-16"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-v">pt1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-v">pt2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-17"><span class="crayon-v">pt1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">pt2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-18"><span class="crayon-v">grdnt</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">derv</span><span class="crayon-sy">(</span><span class="crayon-v">pt1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-19"><span class="crayon-v">pt2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-v">pt1</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">step</span><span class="crayon-o">*</span><span class="crayon-v">grdnt</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pt1</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">step</span><span class="crayon-o">*</span><span class="crayon-v">grdnt</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-v">pt2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># print progress</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-21"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-22"><span class="crayon-v">pt2</span><span class="crayon-h"> </span><span class="crayon-c"># return the last point</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-23"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-24"> </div><div class="crayon-line" id="crayon-5a6589b67532a671130234-25"><span class="crayon-c"># locate the minimum of the function using the Gradient Descent method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-26"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">gradient_descent</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-27"><span class="crayon-v">basin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the function to optimize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-28"><span class="crayon-v">derivative</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the gradient of the function</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-29"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># start point of the search </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-30"><span class="crayon-cn">0.05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># step size (alpha)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-31"><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># relative tolerance for one step</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-32"> </div><div class="crayon-line" id="crayon-5a6589b67532a671130234-33"><span class="crayon-c"># display a summary of the results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># coordinate of fucntion minimum</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-35"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">basin</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># response of fucntion minimum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-36"> </div><div class="crayon-line" id="crayon-5a6589b67532a671130234-37"><span class="crayon-c"># display the function as a contour plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-38"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-39"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-40"><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">basin</span><span class="crayon-sy">(</span><span class="crayon-v">expand</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-41"><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">matrix</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">length</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"x"</span><span class="crayon-sy">,</span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"y"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-42"><span class="crayon-c"># draw the optima as a point</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-43"><span class="crayon-e">points</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-s">"red"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pch</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b67532a671130234-44"><span class="crayon-c"># draw a square around the optima to highlight it</span></div><div class="crayon-line" id="crayon-5a6589b67532a671130234-45"><span class="crayon-e">rect</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lwd</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0038 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_1718" style="max-width: 302px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Gradient-Descent-Results.png"><img alt="Gradient Descent Results" class="size-medium wp-image-1718" height="300" sizes="(max-width: 292px) 100vw, 292px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Gradient-Descent-Results-292x300.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Gradient-Descent-Results-292x300.png 292w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Gradient-Descent-Results.png 877w" width="292"/></a><p class="wp-caption-text">Gradient Descent Results</p></div>
<h3>Usage Heuristics</h3>
<ul>
<li>The method is limited to finding the local optimum, which if the function is convex, is also the global optimum.</li>
<li>It is considered inefficient and slow (linear) to converge relative to modern methods. Convergence can be slow if the gradient at the optimum flattens out (gradient goes to 0 slowly). Convergence can also be slow if the Hessian is poorly conditioned (gradient changes rapidly in some directions and slower in others).</li>
<li>The step size (<em>alpha</em>) may be constant, may adapt with the search, and may be maintained holistically or for each dimension.</li>
<li>The method is sensitive to initial conditions, and as such, it can be common to repeat the search process a number of times with randomly selected initial positions.</li>
<li>If the step size parameter (<em>alpha</em>) is too small, the search will generally take a large number of iterations to converge, if the parameter is too large can overshoot the function’s optimum.</li>
<li>Compared to non-iterative function optimization methods, gradient descent has some relative efficiencies when it comes to scaling with the number of features (dimensions).</li>
</ul>
<h2>Conjugate Gradient</h2>
<p>Conjugate Gradient Method is a first-order derivative optimization method for multidimensional nonlinear unconstrained functions. It is related to other first-order derivative optimization algorithms such as Gradient Descent and Steepest Descent.</p>
<p>The information processing objective of the technique is to locate the extremum of a function. From a starting position, the method first computes the gradient to locate the direction of steepest descent, then performs a line search to locate the optimum step size (<em>alpha</em>). The method then repeats the process of computing the steepest direction, computes direction of the search, and performing a line search to locate the optimum step size. A parameter <em>beta</em> defines the direction update rule based on the gradient and can be computed using one of a number of methods.</p>
<p>The difference between Conjugate Gradient and Steepest Descent is that it uses conjugate directions rather than local gradients to move downhill towards the function minimum, which can be very efficient.</p>
<p>The example provides a code listing of the Conjugate Gradient method in R solving a two-dimensional nonlinear optimization function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6589b675330309036974" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Conjugate Gradient in R</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# definition of the 2D Rosenbrock function, optima is at (1,1)
rosenbrock &lt;- function(v) { 
(1 - v[1])^2 + 100 * (v[2] - v[1]*v[1])^2
}

# definition of the gradient of the 2D Rosenbrock function
derivative &lt;- function(v) {
c(-400 * v[1] * (v[2] - v[1]*v[1]) - 2 * (1 - v[1]), 
200 * (v[2] - v[1]*v[1]))
}

# locate the minimum of the function using the Conjugate Gradient method
result &lt;- optim(
c(runif(1,-3,3), runif(1,-3,3)), # start at a random position
rosenbrock, # the function to minimize
derivative, # no function gradient 
method="CG", # use the Conjugate Gradient method
control=c( # configure Conjugate Gradient
maxit=100, # maximum iterations of 100
reltol=1e-8, # response tolerance over-one step
type=2)) # use the Polak-Ribiere update method

# summarize results
print(result$par) # the coordinate of the minimum
print(result$value) # the function response of the minimum
print(result$counts) # the number of function calls performed

# display the function as a contour plot
x &lt;- seq(-3, 3, length.out=100)
y &lt;- seq(-3, 3, length.out=100)
z &lt;- rosenbrock(expand.grid(x, y))
contour(x, y, matrix(log10(z), length(x)), xlab="x", ylab="y")
# draw the optima as a point
points(result$par[1], result$par[2], col="red", pch=19)
# draw a square around the optima to highlight it
rect(result$par[1]-0.2, result$par[2]-0.2, result$par[1]+0.2, result$par[2]+0.2, lwd=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6589b675330309036974-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-2">2</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-4">4</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-6">6</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-8">8</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-10">10</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-12">12</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-14">14</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-16">16</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-18">18</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-20">20</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-22">22</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-24">24</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-26">26</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-28">28</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-30">30</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-32">32</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-34">34</div><div class="crayon-num" data-line="crayon-5a6589b675330309036974-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675330309036974-36">36</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6589b675330309036974-1"><span class="crayon-c"># definition of the 2D Rosenbrock function, optima is at (1,1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-2"><span class="crayon-v">rosenbrock</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-3"><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-6"><span class="crayon-c"># definition of the gradient of the 2D Rosenbrock function</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-7"><span class="crayon-v">derivative</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-8"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">400</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-9"><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-10"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-12"><span class="crayon-c"># locate the minimum of the function using the Conjugate Gradient method</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-13"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">optim</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-14"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># start at a random position</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-15"><span class="crayon-v">rosenbrock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the function to minimize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-16"><span class="crayon-v">derivative</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># no function gradient </span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-17"><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"CG"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># use the Conjugate Gradient method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-18"><span class="crayon-v">control</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-c"># configure Conjugate Gradient</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-19"><span class="crayon-v">maxit</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># maximum iterations of 100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-20"><span class="crayon-v">reltol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># response tolerance over-one step</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-21"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># use the Polak-Ribiere update method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-22"> </div><div class="crayon-line" id="crayon-5a6589b675330309036974-23"><span class="crayon-c"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the coordinate of the minimum</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the function response of the minimum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-26"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">counts</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the number of function calls performed</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-28"><span class="crayon-c"># display the function as a contour plot</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-29"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-30"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-31"><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">rosenbrock</span><span class="crayon-sy">(</span><span class="crayon-v">expand</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-32"><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">matrix</span><span class="crayon-sy">(</span><span class="crayon-e">log10</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">length</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"x"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"y"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-33"><span class="crayon-c"># draw the optima as a point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-34"><span class="crayon-e">points</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-s">"red"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pch</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675330309036974-35"><span class="crayon-c"># draw a square around the optima to highlight it</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675330309036974-36"><span class="crayon-e">rect</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lwd</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0037 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_1714" style="max-width: 302px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Conjugate-Gradient-Results.png"><img alt="Conjugate Gradient Results" class="size-medium wp-image-1714" height="300" sizes="(max-width: 292px) 100vw, 292px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Conjugate-Gradient-Results-292x300.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Conjugate-Gradient-Results-292x300.png 292w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/Conjugate-Gradient-Results.png 877w" width="292"/></a><p class="wp-caption-text">Conjugate Gradient Results</p></div>
<h3>Usage Heuristics</h3>
<ul>
<li>It is more efficient than Steepest Descent, for example it may take a straight line path down narrow valley’s, whereas Steepest Descent would have to zig-zag (pinball) down the valley.</li>
<li>Devolves into Steepest Descent if the conjugate direction is reset each iteration.</li>
<li>It is almost as fast as second-order gradient methods, requiring just <em>n</em> iterations to locate an optimum for suitable functions (where <em>n</em> is the number of parameters).</li>
<li>It does not maintain a Hessian matrix (like BFGS) and therefore may be suitable for larger problems with many variables.</li>
<li>The method is most efficient (works the best) with quadratic or quadratic-like functions, or where the function is approximately quadratic near the optimum.</li>
<li>The method is sensitive to its starting position on non-convex problems.</li>
<li>The learning rate (step size <em>alpha</em>) does not have to be specified as a line search is used to locate the optimum value as needed.</li>
<li>Common methods for computing the direction update rule (<em>beta</em>) are the Hestenes-Stiefel, Fletcher-Reeves, Polak-Ribiere, and Beale-Sorenson methods. The Polak-Ribiere method generally works better in practice for non-quadratic functions.</li>
<li>It is dependent on the accuracy of the line search, errors introduced both from this and the less-than quadratic nature of the response surface will result in more frequent updates to the direction and a less efficient search.</li>
<li>To avoid the search degenerating, consider restarting the search process after <em>n</em> iterations, where <em>n</em> is the number of function parameters.</li>
</ul>
<h2>BFGS</h2>
<p>BFGS is an optimization method for multidimensional nonlinear unconstrained functions.</p>
<p>BFGS belongs to the family of quasi-Newton (Variable Metric) optimization methods that make use of both first-derivative (gradient) and second-derivative (Hessian matrix) based information of the function being optimized. More specifically, it is a quasi-Newton method which means that it approximates the second-order derivative rather than compute it directly. It is related to other quasi-Newton methods such as the DFP Method, Broyden’s method and the SR1 Method.</p>
<p>Two popular extension of BFGS is L-BFGS (Limited Memory BFGS) which has lower memory resource requirements and L-BFGS-B (Limited Memory Boxed BFGS) which extends L-BFGS and imposes box constraints on the method.</p>
<p>The information processing objective of the BFGS Method is to locate the extremum of a function.</p>
<p>This is achieved by iteratively building up a good approximation of the inverse Hessian matrix. Given an initial starting position, it prepares an approximation of the Hessian matrix (square matrix of second-order partial derivatives). It then repeats the process of computing the search direction using the approximated Hessian, computes an optimum step size using a Line Search then, updates the position, and updates the approximation of the Hessian. The method for updating the Hessian each iteration is called the BFGS rule which insures the updated matrix is positive definite.</p>
<p>The example provides a code listing of the BFGS method in R solving a two-dimensional nonlinear optimization function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6589b675336509195579" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">BFGS in R</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# definition of the 2D Rosenbrock function, optima is at (1,1)
rosenbrock &lt;- function(v) { 
(1 - v[1])^2 + 100 * (v[2] - v[1]*v[1])^2
}

# definition of the gradient of the 2D Rosenbrock function
derivative &lt;- function(v) {
c(-400 * v[1] * (v[2] - v[1]*v[1]) - 2 * (1 - v[1]), 200 * (v[2] - v[1]*v[1]))
}

# locate the minimum of the function using the BFGS method
result &lt;- optim(
c(runif(1,-3,3), runif(1,-3,3)), # start at a random position
rosenbrock, # the function to minimize
derivative, # no function gradient 
method="BFGS", # use the BFGS method
control=c( # configure BFGS
maxit=100, # maximum iterations of 100
reltol=1e-8)) # response tolerance over-one step

# summarize results
print(result$par) # the coordinate of the minimum
print(result$value) # the function response of the minimum
print(result$counts) # the number of function calls performed

# display the function as a contour plot
x &lt;- seq(-3, 3, length.out=100)
y &lt;- seq(-3, 3, length.out=100)
z &lt;- rosenbrock(expand.grid(x, y))
contour(x, y, matrix(log10(z), length(x)), xlab="x", ylab="y")
# draw the optima as a point
points(result$par[1], result$par[2], col="red", pch=19)
# draw a square around the optima to highlight it
rect(result$par[1]-0.2, result$par[2]-0.2, result$par[1]+0.2, result$par[2]+0.2, lwd=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6589b675336509195579-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-2">2</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-4">4</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-6">6</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-8">8</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-10">10</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-12">12</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-14">14</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-16">16</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-18">18</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-20">20</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-22">22</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-24">24</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-26">26</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-28">28</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-30">30</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-32">32</div><div class="crayon-num" data-line="crayon-5a6589b675336509195579-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6589b675336509195579-34">34</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6589b675336509195579-1"><span class="crayon-c"># definition of the 2D Rosenbrock function, optima is at (1,1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-2"><span class="crayon-v">rosenbrock</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-3"><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-6"><span class="crayon-c"># definition of the gradient of the 2D Rosenbrock function</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-7"><span class="crayon-v">derivative</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-8"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">400</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">v</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-10"> </div><div class="crayon-line" id="crayon-5a6589b675336509195579-11"><span class="crayon-c"># locate the minimum of the function using the BFGS method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-12"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">optim</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-13"><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">runif</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># start at a random position</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-14"><span class="crayon-v">rosenbrock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># the function to minimize</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-15"><span class="crayon-v">derivative</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># no function gradient </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-16"><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"BFGS"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># use the BFGS method</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-17"><span class="crayon-v">control</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-c"># configure BFGS</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-18"><span class="crayon-v">maxit</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># maximum iterations of 100</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-19"><span class="crayon-v">reltol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># response tolerance over-one step</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-20"> </div><div class="crayon-line" id="crayon-5a6589b675336509195579-21"><span class="crayon-c"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the coordinate of the minimum</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the function response of the minimum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">counts</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># the number of function calls performed</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-26"><span class="crayon-c"># display the function as a contour plot</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-27"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-28"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">length</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-29"><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">rosenbrock</span><span class="crayon-sy">(</span><span class="crayon-v">expand</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-30"><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">matrix</span><span class="crayon-sy">(</span><span class="crayon-e">log10</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">length</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"x"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"y"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-31"><span class="crayon-c"># draw the optima as a point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-32"><span class="crayon-e">points</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-s">"red"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pch</span><span class="crayon-o">=</span><span class="crayon-cn">19</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6589b675336509195579-33"><span class="crayon-c"># draw a square around the optima to highlight it</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6589b675336509195579-34"><span class="crayon-e">rect</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">$</span><span class="crayon-v">par</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lwd</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0035 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_1717" style="max-width: 302px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results.png"><img alt="BFGS Results" class="size-medium wp-image-1717" height="300" sizes="(max-width: 292px) 100vw, 292px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results-292x300.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results-292x300.png 292w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/08/BFGS-Results.png 877w" width="292"/></a><p class="wp-caption-text">BFGS Results</p></div>
<h3>Usage Heuristics</h3>
<ul>
<li>It requires a function where the the functions gradient (first partial derivative) can be computed at arbitrary points.</li>
<li>It does not require second-order derivatives as it approximates the Hessian matrix, making it less computationally expensive compared to Newton’s method.</li>
<li>It requires a relatively large memory footprint, as it maintains an <em>n*n</em> Hessian matrix, where <em>n</em> is the number of variables. This is a limitation on the methods scalability.</li>
<li>The rate of convergence is super-linear and the computational cost of each iteration is O(n^2).</li>
<li>The L-BFGS extension to BFGS is intended for functions with very large numbers of parameters (&gt;1000).</li>
<li>The stopping condition is typically a minimum change is response or a minimum gradient.</li>
<li>BFGS is somewhat robust and self correcting in terms of the search direction and as such it does not require the use of exact line searches when determining the step size.</li>
</ul>
<h2>Summary</h2>
<p>Optimization is an important concept to understand and apply carefully in applied machine learning.</p>
<p>In this post you discovered 5 convex optimization algorithms with recipes in R that are ready to copy and paste into your own problem.</p>
<p>You also learned some background for each method and general heuristics for operating each algorithm.</p>
<p>Did I miss your favorite convex optimization algorithm? Leave a comment and let me know.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-39"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2>Frustrated With Your Progress In R Machine Learning?</h2>
<p><a href="/machine-learning-with-r/"><img align="left" alt="Master Machine Learning With R" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/MachineLearningMasteryWithR-small.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Models in Minutes</h4>
<p>…with just a few lines of R code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/machine-learning-with-r/">Machine Learning Mastery With R</a></p>
<p>Covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> like:<br/>Loading data, visualization, build models, tuning, and much more…</p>
<h4>Finally Bring Machine Learning To<br/>Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/machine-learning-with-r/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Convex%20Optimization%20in%20R&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvex-optimization-in-r%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convex-optimization-in-r/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convex-optimization-in-r/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Convex%20Optimization%20in%20R&amp;url=https://machinelearningmastery.com/convex-optimization-in-r/&amp;summary=Optimization+is+a+big+part+of+machine+learning.+It+is+the+core+of+most+popular+methods%2C+from+least+s..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Convex%20Optimization%20in%20R&amp;url=https://machinelearningmastery.com/convex-optimization-in-r/&amp;summary=Optimization+is+a+big+part+of+machine+learning.+It+is+the+core+of+most+popular+methods%2C+from+least+s...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/convex-optimization-in-r/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/convex-optimization-in-r/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/non-linear-classification-in-r-with-decision-trees/" rel="prev"><i class="fa fa-angle-left"></i> Non-Linear Classification in R with Decision Trees</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/machine-learning-newsletters/" rel="next">Machine Learning Newsletters <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">5 Responses to <em>Convex Optimization in R</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-182913">
<div class="comment-container" id="li-comment-182913">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1c65f2c92649962b5d28d98c6b9af86?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1c65f2c92649962b5d28d98c6b9af86?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joyce</span>
<span class="date">December 18, 2014 at 10:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convex-optimization-in-r/#comment-182913" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I currently carry on this LASSO related project in R. However, out of specific need of research , I have to change the penalty function to another smooth function. The problem is I was totally spoiled by all the well-established packages in R to solve all kinds of PLS problems. I have used “glmnet” to solve LASSO, ridge and elastic-net, used “ncvreg” to solve SCAD. But I don’t know which general optimization package I should use to make a refinement on the restriction function for my own purpose. Could you please shed some light on my dilemma? I will greatly appreciate your help and suggestions.</p>
<div class="reply">
<a aria-label="Reply to Joyce" class="comment-reply-link" href="https://machinelearningmastery.com/convex-optimization-in-r/?replytocom=182913#respond" onclick='return addComment.moveForm( "comment-182913", "182913", "respond", "1707" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-304891">
<div class="comment-container" id="li-comment-304891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f3f4421d20765e95e829b9e56dbb835f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f3f4421d20765e95e829b9e56dbb835f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://none" rel="external nofollow">Dr. R. K. Verma</a></span>
<span class="date">June 22, 2015 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convex-optimization-in-r/#comment-304891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I am a retired scientist, a Ph.D in Mathematics, specialized in optimization techniques and an IT fellow. </p>
<p>Your article ‘Convex Optimization in R’ has aroused my interest in learning Machine Learning. Could you help me by sending your literature and collection of literature on Machine Learning.  This associate may last longer and it may give many a tools and techniques to data analytics and optimization communities !!!!</p>
<p>Wishing a great success in your all ventures, I am<br/>
Dr. R. K. VERMA</p>
<div class="reply">
<a aria-label="Reply to Dr. R. K. Verma" class="comment-reply-link" href="https://machinelearningmastery.com/convex-optimization-in-r/?replytocom=304891#respond" onclick='return addComment.moveForm( "comment-304891", "304891", "respond", "1707" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-309829">
<div class="comment-container" id="li-comment-309829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d4ff27d05ad610bfb05f48a743314df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d4ff27d05ad610bfb05f48a743314df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dr. R. K. VERMA</span>
<span class="date">August 1, 2015 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convex-optimization-in-r/#comment-309829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I appreciate your examples on Convex Optimization in R. </p>
<p>My suggestion: You release a series on ‘Optimization Methods in R’ ranging from linear programming thru to non-linear programming. OR/MS community in academia and industry will highly appreciate such a series, believe me. </p>
<p>Wishing a great success once more, I am</p>
<p>Dr. R. K. Verma</p>
<div class="reply">
<a aria-label="Reply to Dr. R. K. VERMA" class="comment-reply-link" href="https://machinelearningmastery.com/convex-optimization-in-r/?replytocom=309829#respond" onclick='return addComment.moveForm( "comment-309829", "309829", "respond", "1707" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420265">
<div class="comment-container" id="li-comment-420265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b723ff7fc9bf0cca3cd8061919f07dcc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b723ff7fc9bf0cca3cd8061919f07dcc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Connor</span>
<span class="date">November 17, 2017 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convex-optimization-in-r/#comment-420265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you have any code for Gradient Descent Method for constrained inequality functions? If so, please share.That would be a great help.</p>
<div class="reply">
<a aria-label="Reply to Connor" class="comment-reply-link" href="https://machinelearningmastery.com/convex-optimization-in-r/?replytocom=420265#respond" onclick='return addComment.moveForm( "comment-420265", "420265", "respond", "1707" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420295">
<div class="comment-container" id="li-comment-420295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convex-optimization-in-r/#comment-420295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t believe so.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/convex-optimization-in-r/?replytocom=420295#respond" onclick='return addComment.moveForm( "comment-420295", "420295", "respond", "1707" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/convex-optimization-in-r/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="1707"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="58b7931b60"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="48"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-8"><h3>Create Predictive Models With R</h3> <div class="textwidget"><center>
Want to develop your own predictive models in R?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects with templates?<br/>
<br/>
<a href="/machine-learning-with-r/">Get Started With R Machine Learning Today! </a>
<a href="/machine-learning-with-r/"><img alt="Machine Learning Mastery With R" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/MachineLearningMasteryWithR-small.png"/></a>
<br/>
</center></div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>