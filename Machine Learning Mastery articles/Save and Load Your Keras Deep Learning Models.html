<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Save and Load Your Keras Deep Learning Models - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Save and Load Your Keras Deep Learning Models - Machine Learning Mastery" property="og:title"/>
<meta content="Keras is a simple and powerful Python library for deep learning. Given that deep learning models can take hours, days and even weeks to train, it is important to know how to save and load them from disk. In this post, you will discover how you can save your Keras models to file and load them …" property="og:description"/>
<meta content="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-06-13T05:00:06+11:00" property="article:published_time"/>
<meta content="2017-03-31T08:18:09+11:00" property="article:modified_time"/>
<meta content="2017-03-31T08:18:09+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Save-and-Load-Your-Keras-Deep-Learning-Models.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Save-and-Load-Your-Keras-Deep-Learning-Models.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="428" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/save-load-keras-deep-learning-models\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/feed/" rel="alternate" title="Machine Learning Mastery » Save and Load Your Keras Deep Learning Models Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2573" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fsave-load-keras-deep-learning-models%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fsave-load-keras-deep-learning-models%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2573 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2573 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Save and Load Your Keras Deep Learning Models</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-13T05:00:06+1100">June 13, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fsave-load-keras-deep-learning-models%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/save-load-keras-deep-learning-models/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/save-load-keras-deep-learning-models/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/&amp;summary=Keras+is+a+simple+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AGiven+that+deep+learning+models+..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/&amp;summary=Keras+is+a+simple+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AGiven+that+deep+learning+models+...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Keras is a simple and powerful Python library for deep learning.</p>
<p>Given that deep learning models can take hours, days and even weeks to train, it is important to know how to save and load them from disk.</p>
<p>In this post, you will discover how you can save your Keras models to file and load them up again to make predictions.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Mar 2017</strong>: Added instructions to install h5py first. Added missing brackets on final print statement in each example.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2574" style="max-width: 650px"><img alt="Save and Load Your Keras Deep Learning Models" class="size-full wp-image-2574" height="428" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Save-and-Load-Your-Keras-Deep-Learning-Models.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Save-and-Load-Your-Keras-Deep-Learning-Models.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Save-and-Load-Your-Keras-Deep-Learning-Models-300x201.jpg 300w" width="640"/><p class="wp-caption-text">Save and Load Your Keras Deep Learning Models<br/>Photo by <a href="https://www.flickr.com/photos/art_inthecity/6346545268/">art_inthecity</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>Keras separates the concerns of saving your model architecture and saving your model weights.</p>
<p>Model weights are saved to <a href="http://www.h5py.org/">HDF5 format</a>. This is a grid format that is ideal for storing multi-dimensional arrays of numbers.</p>
<p>The model structure can be described and saved using two different formats: JSON and YAML.</p>
<p>In this post we are going to look at two examples of saving and loading your model to file:</p>
<ul>
<li>Save Model to JSON.</li>
<li>Save Model to YAML.</li>
</ul>
<p>Each example will also demonstrate saving and loading your model weights to HDF5 formatted files.</p>
<p>The examples will use the same simple network trained on the Pima Indians onset of diabetes binary classification dataset. This is a small dataset that contains all numerical data and is easy to work with. You can <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">download this dataset</a> and place it in your working directory with the filename “<em>pima-indians-diabetes.csv</em>“.</p>
<p>Confirm that you have the latest version of Keras installed (v1.2.2 as of March 2017).</p>
<p>Note: You may need to install <em>h5py</em> first:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba07a451798518" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
sudo pip install h5py</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba07a451798518-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba07a451798518-1">sudo pip install h5py</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><!-- Start shortcoder --></p><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>Save Your Neural Network Model to JSON</h2>
<p>JSON is a simple file format for describing data hierarchically.</p>
<p>Keras provides the ability to describe any model using JSON format with a <em>to_json()</em> function. This can be saved to file and later loaded via the <em>model_from_json()</em> function that will create a new model from the JSON specification.</p>
<p>The weights are saved directly from the model using the <em>save_weights()</em> function and later loaded using the symmetrical <em>load_weights()</em> function.</p>
<p>The example below trains and evaluates a simple model on the Pima Indians dataset. The model is then converted to JSON format and written to model.json in the local directory. The network weights are written to <em>model.h5</em> in the local directory.</p>
<p>The model and weight data is loaded from the saved files and a new model is created. It is important to compile the loaded model before it is used. This is so that predictions made using the model can use the appropriate efficient computation from the Keras backend.</p>
<p>The model is evaluated in the same way printing the same evaluation score.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba083291012267" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP for Pima Indians Dataset Serialize to JSON and HDF5
from keras.models import Sequential
from keras.layers import Dense
from keras.models import model_from_json
import numpy
import os
# fix random seed for reproducibility
numpy.random.seed(7)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# Fit the model
model.fit(X, Y, epochs=150, batch_size=10, verbose=0)
# evaluate the model
scores = model.evaluate(X, Y, verbose=0)
print("%s: %.2f%%" % (model.metrics_names[1], scores[1]*100))

# serialize model to JSON
model_json = model.to_json()
with open("model.json", "w") as json_file:
    json_file.write(model_json)
# serialize weights to HDF5
model.save_weights("model.h5")
print("Saved model to disk")

# later...

# load json and create model
json_file = open('model.json', 'r')
loaded_model_json = json_file.read()
json_file.close()
loaded_model = model_from_json(loaded_model_json)
# load weights into new model
loaded_model.load_weights("model.h5")
print("Loaded model from disk")

# evaluate loaded model on test data
loaded_model.compile(loss='binary_crossentropy', optimizer='rmsprop', metrics=['accuracy'])
score = loaded_model.evaluate(X, Y, verbose=0)
print("%s: %.2f%%" % (loaded_model.metrics_names[1], score[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba083291012267-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-4">4</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-6">6</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-8">8</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-10">10</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-12">12</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-14">14</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-16">16</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-18">18</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-20">20</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-22">22</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-24">24</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-26">26</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-28">28</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-30">30</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-32">32</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-34">34</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-36">36</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-38">38</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-40">40</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-42">42</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-44">44</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-46">46</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba083291012267-48">48</div><div class="crayon-num" data-line="crayon-5a65948cba083291012267-49">49</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba083291012267-1"><span class="crayon-p"># MLP for Pima Indians Dataset Serialize to JSON and HDF5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">model_from_json</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-5"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-6"><span class="crayon-e">import </span><span class="crayon-v">os</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-7"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-8"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-9"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-11"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-13"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-14"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-15"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-19"><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-20"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-21"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-23"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-24"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-26"> </div><div class="crayon-line" id="crayon-5a65948cba083291012267-27"><span class="crayon-p"># serialize model to JSON</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-28"><span class="crayon-v">model_json</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">to_json</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-29"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"model.json"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"w"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">json_file</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-30"><span class="crayon-h">    </span><span class="crayon-v">json_file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">model_json</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-31"><span class="crayon-p"># serialize weights to HDF5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-32"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save_weights</span><span class="crayon-sy">(</span><span class="crayon-s">"model.h5"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Saved model to disk"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-34"> </div><div class="crayon-line" id="crayon-5a65948cba083291012267-35"><span class="crayon-p"># later...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-36"> </div><div class="crayon-line" id="crayon-5a65948cba083291012267-37"><span class="crayon-p"># load json and create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-38"><span class="crayon-v">json_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'model.json'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-39"><span class="crayon-v">loaded_model_json</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json_file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-40"><span class="crayon-v">json_file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-41"><span class="crayon-v">loaded_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">model_from_json</span><span class="crayon-sy">(</span><span class="crayon-v">loaded_model_json</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-42"><span class="crayon-p"># load weights into new model</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-43"><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">load_weights</span><span class="crayon-sy">(</span><span class="crayon-s">"model.h5"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-44"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Loaded model from disk"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-45"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-46"><span class="crayon-p"># evaluate loaded model on test data</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-47"><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'rmsprop'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba083291012267-48"><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba083291012267-49"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>Running this example provides the output below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba087376030048" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
acc: 78.78%
Saved model to disk
Loaded model from disk
acc: 78.78%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba087376030048-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba087376030048-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba087376030048-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba087376030048-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba087376030048-1">acc: 78.78%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba087376030048-2">Saved model to disk</div><div class="crayon-line" id="crayon-5a65948cba087376030048-3">Loaded model from disk</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba087376030048-4">acc: 78.78%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The JSON format of the model looks like the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba08b654417060" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
{  
   "keras_version":"2.0.2",
   "backend":"theano",
   "config":[  
      {  
         "config":{  
            "dtype":"float32",
            "bias_regularizer":null,
            "activation":"relu",
            "bias_constraint":null,
            "use_bias":true,
            "bias_initializer":{  
               "config":{  

               },
               "class_name":"Zeros"
            },
            "kernel_regularizer":null,
            "activity_regularizer":null,
            "kernel_constraint":null,
            "trainable":true,
            "name":"dense_1",
            "kernel_initializer":{  
               "config":{  
                  "maxval":0.05,
                  "minval":-0.05,
                  "seed":null
               },
               "class_name":"RandomUniform"
            },
            "batch_input_shape":[  
               null,
               8
            ],
            "units":12
         },
         "class_name":"Dense"
      },
      {  
         "config":{  
            "kernel_regularizer":null,
            "bias_regularizer":null,
            "activation":"relu",
            "bias_constraint":null,
            "use_bias":true,
            "bias_initializer":{  
               "config":{  

               },
               "class_name":"Zeros"
            },
            "activity_regularizer":null,
            "kernel_constraint":null,
            "trainable":true,
            "name":"dense_2",
            "kernel_initializer":{  
               "config":{  
                  "maxval":0.05,
                  "minval":-0.05,
                  "seed":null
               },
               "class_name":"RandomUniform"
            },
            "units":8
         },
         "class_name":"Dense"
      },
      {  
         "config":{  
            "kernel_regularizer":null,
            "bias_regularizer":null,
            "activation":"sigmoid",
            "bias_constraint":null,
            "use_bias":true,
            "bias_initializer":{  
               "config":{  

               },
               "class_name":"Zeros"
            },
            "activity_regularizer":null,
            "kernel_constraint":null,
            "trainable":true,
            "name":"dense_3",
            "kernel_initializer":{  
               "config":{  
                  "maxval":0.05,
                  "minval":-0.05,
                  "seed":null
               },
               "class_name":"RandomUniform"
            },
            "units":1
         },
         "class_name":"Dense"
      }
   ],
   "class_name":"Sequential"
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-4">4</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-6">6</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-8">8</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-10">10</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-12">12</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-14">14</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-16">16</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-18">18</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-20">20</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-22">22</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-24">24</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-26">26</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-28">28</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-30">30</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-32">32</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-34">34</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-36">36</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-38">38</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-40">40</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-42">42</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-44">44</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-46">46</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-48">48</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-50">50</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-52">52</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-54">54</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-56">56</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-58">58</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-60">60</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-62">62</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-64">64</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-66">66</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-68">68</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-70">70</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-72">72</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-74">74</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-76">76</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-78">78</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-80">80</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-82">82</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-84">84</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-86">86</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-88">88</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-90">90</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-92">92</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-94">94</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-96">96</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08b654417060-98">98</div><div class="crayon-num" data-line="crayon-5a65948cba08b654417060-99">99</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba08b654417060-1">{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-2">   "keras_version":"2.0.2",</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-3">   "backend":"theano",</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-4">   "config":[  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-5">      {  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-6">         "config":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-7">            "dtype":"float32",</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-8">            "bias_regularizer":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-9">            "activation":"relu",</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-10">            "bias_constraint":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-11">            "use_bias":true,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-12">            "bias_initializer":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-13">               "config":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-14"> </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-15">               },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-16">               "class_name":"Zeros"</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-17">            },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-18">            "kernel_regularizer":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-19">            "activity_regularizer":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-20">            "kernel_constraint":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-21">            "trainable":true,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-22">            "name":"dense_1",</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-23">            "kernel_initializer":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-24">               "config":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-25">                  "maxval":0.05,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-26">                  "minval":-0.05,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-27">                  "seed":null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-28">               },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-29">               "class_name":"RandomUniform"</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-30">            },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-31">            "batch_input_shape":[  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-32">               null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-33">               8</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-34">            ],</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-35">            "units":12</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-36">         },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-37">         "class_name":"Dense"</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-38">      },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-39">      {  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-40">         "config":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-41">            "kernel_regularizer":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-42">            "bias_regularizer":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-43">            "activation":"relu",</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-44">            "bias_constraint":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-45">            "use_bias":true,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-46">            "bias_initializer":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-47">               "config":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-48"> </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-49">               },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-50">               "class_name":"Zeros"</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-51">            },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-52">            "activity_regularizer":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-53">            "kernel_constraint":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-54">            "trainable":true,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-55">            "name":"dense_2",</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-56">            "kernel_initializer":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-57">               "config":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-58">                  "maxval":0.05,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-59">                  "minval":-0.05,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-60">                  "seed":null</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-61">               },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-62">               "class_name":"RandomUniform"</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-63">            },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-64">            "units":8</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-65">         },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-66">         "class_name":"Dense"</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-67">      },</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-68">      {  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-69">         "config":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-70">            "kernel_regularizer":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-71">            "bias_regularizer":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-72">            "activation":"sigmoid",</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-73">            "bias_constraint":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-74">            "use_bias":true,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-75">            "bias_initializer":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-76">               "config":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-77"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-78">               },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-79">               "class_name":"Zeros"</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-80">            },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-81">            "activity_regularizer":null,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-82">            "kernel_constraint":null,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-83">            "trainable":true,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-84">            "name":"dense_3",</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-85">            "kernel_initializer":{  </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-86">               "config":{  </div><div class="crayon-line" id="crayon-5a65948cba08b654417060-87">                  "maxval":0.05,</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-88">                  "minval":-0.05,</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-89">                  "seed":null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-90">               },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-91">               "class_name":"RandomUniform"</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-92">            },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-93">            "units":1</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-94">         },</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-95">         "class_name":"Dense"</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-96">      }</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-97">   ],</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08b654417060-98">   "class_name":"Sequential"</div><div class="crayon-line" id="crayon-5a65948cba08b654417060-99">}</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2>Save Your Neural Network Model to YAML</h2>
<p>This example is much the same as the above JSON example, except the <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> format is used for the model specification.</p>
<p>The model is described using YAML, saved to file model.yaml and later loaded into a new model via the <em>model_from_yaml()</em> function. Weights are handled in the same way as above in HDF5 format as model.h5.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba08f021927505" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP for Pima Indians Dataset serialize to YAML and HDF5
from keras.models import Sequential
from keras.layers import Dense
from keras.models import model_from_yaml
import numpy
import os
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# Fit the model
model.fit(X, Y, epochs=150, batch_size=10, verbose=0)
# evaluate the model
scores = model.evaluate(X, Y, verbose=0)
print("%s: %.2f%%" % (model.metrics_names[1], scores[1]*100))

# serialize model to YAML
model_yaml = model.to_yaml()
with open("model.yaml", "w") as yaml_file:
    yaml_file.write(model_yaml)
# serialize weights to HDF5
model.save_weights("model.h5")
print("Saved model to disk")

# later...

# load YAML and create model
yaml_file = open('model.yaml', 'r')
loaded_model_yaml = yaml_file.read()
yaml_file.close()
loaded_model = model_from_yaml(loaded_model_yaml)
# load weights into new model
loaded_model.load_weights("model.h5")
print("Loaded model from disk")

# evaluate loaded model on test data
loaded_model.compile(loss='binary_crossentropy', optimizer='rmsprop', metrics=['accuracy'])
score = loaded_model.evaluate(X, Y, verbose=0)
print("%s: %.2f%%" % (loaded_model.metrics_names[1], score[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-4">4</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-6">6</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-8">8</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-10">10</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-12">12</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-14">14</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-16">16</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-18">18</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-20">20</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-22">22</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-24">24</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-26">26</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-28">28</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-30">30</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-32">32</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-34">34</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-36">36</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-38">38</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-40">40</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-42">42</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-44">44</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-46">46</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-48">48</div><div class="crayon-num" data-line="crayon-5a65948cba08f021927505-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba08f021927505-50">50</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba08f021927505-1"><span class="crayon-p"># MLP for Pima Indians Dataset serialize to YAML and HDF5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">model_from_yaml</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-5"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-6"><span class="crayon-e">import </span><span class="crayon-v">os</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-7"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-8"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-10"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-11"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-12"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-14"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-15"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-16"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-20"><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-22"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-24"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-25"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-26"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-28"><span class="crayon-p"># serialize model to YAML</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-29"><span class="crayon-v">model_yaml</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">to_yaml</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-30"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"model.yaml"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"w"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">yaml_file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-31"><span class="crayon-h">    </span><span class="crayon-v">yaml_file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">model_yaml</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-32"><span class="crayon-p"># serialize weights to HDF5</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save_weights</span><span class="crayon-sy">(</span><span class="crayon-s">"model.h5"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Saved model to disk"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-35"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-36"><span class="crayon-p"># later...</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-38"><span class="crayon-p"># load YAML and create model</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-39"><span class="crayon-v">yaml_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'model.yaml'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-40"><span class="crayon-v">loaded_model_yaml</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yaml_file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-41"><span class="crayon-v">yaml_file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-42"><span class="crayon-v">loaded_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">model_from_yaml</span><span class="crayon-sy">(</span><span class="crayon-v">loaded_model_yaml</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-43"><span class="crayon-p"># load weights into new model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-44"><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">load_weights</span><span class="crayon-sy">(</span><span class="crayon-s">"model.h5"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-45"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Loaded model from disk"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-46"> </div><div class="crayon-line" id="crayon-5a65948cba08f021927505-47"><span class="crayon-p"># evaluate loaded model on test data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-48"><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'rmsprop'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a65948cba08f021927505-49"><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba08f021927505-50"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">loaded_model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example displays the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba093095954320" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
acc: 78.78%
Saved model to disk
Loaded model from disk
acc: 78.78%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba093095954320-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba093095954320-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba093095954320-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba093095954320-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba093095954320-1">acc: 78.78%</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba093095954320-2">Saved model to disk</div><div class="crayon-line" id="crayon-5a65948cba093095954320-3">Loaded model from disk</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba093095954320-4">acc: 78.78%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The model described in YAML format looks like the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65948cba096215507192" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
backend: theano
class_name: Sequential
config:
- class_name: Dense
  config:
    activation: relu
    activity_regularizer: null
    batch_input_shape: !!python/tuple [null, 8]
    bias_constraint: null
    bias_initializer:
      class_name: Zeros
      config: {}
    bias_regularizer: null
    dtype: float32
    kernel_constraint: null
    kernel_initializer:
      class_name: RandomUniform
      config: {maxval: 0.05, minval: -0.05, seed: null}
    kernel_regularizer: null
    name: dense_1
    trainable: true
    units: 12
    use_bias: true
- class_name: Dense
  config:
    activation: relu
    activity_regularizer: null
    bias_constraint: null
    bias_initializer:
      class_name: Zeros
      config: {}
    bias_regularizer: null
    kernel_constraint: null
    kernel_initializer:
      class_name: RandomUniform
      config: {maxval: 0.05, minval: -0.05, seed: null}
    kernel_regularizer: null
    name: dense_2
    trainable: true
    units: 8
    use_bias: true
- class_name: Dense
  config:
    activation: sigmoid
    activity_regularizer: null
    bias_constraint: null
    bias_initializer:
      class_name: Zeros
      config: {}
    bias_regularizer: null
    kernel_constraint: null
    kernel_initializer:
      class_name: RandomUniform
      config: {maxval: 0.05, minval: -0.05, seed: null}
    kernel_regularizer: null
    name: dense_3
    trainable: true
    units: 1
    use_bias: true
keras_version: 2.0.2</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65948cba096215507192-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-2">2</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-4">4</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-6">6</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-8">8</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-10">10</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-12">12</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-14">14</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-16">16</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-18">18</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-20">20</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-22">22</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-24">24</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-26">26</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-28">28</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-30">30</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-32">32</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-34">34</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-36">36</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-38">38</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-40">40</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-42">42</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-44">44</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-46">46</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-48">48</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-50">50</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-52">52</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-54">54</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-56">56</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-58">58</div><div class="crayon-num" data-line="crayon-5a65948cba096215507192-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a65948cba096215507192-60">60</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65948cba096215507192-1">backend: theano</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-2">class_name: Sequential</div><div class="crayon-line" id="crayon-5a65948cba096215507192-3">config:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-4">- class_name: Dense</div><div class="crayon-line" id="crayon-5a65948cba096215507192-5">  config:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-6">    activation: relu</div><div class="crayon-line" id="crayon-5a65948cba096215507192-7">    activity_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-8">    batch_input_shape: !!python/tuple [null, 8]</div><div class="crayon-line" id="crayon-5a65948cba096215507192-9">    bias_constraint: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-10">    bias_initializer:</div><div class="crayon-line" id="crayon-5a65948cba096215507192-11">      class_name: Zeros</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-12">      config: {}</div><div class="crayon-line" id="crayon-5a65948cba096215507192-13">    bias_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-14">    dtype: float32</div><div class="crayon-line" id="crayon-5a65948cba096215507192-15">    kernel_constraint: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-16">    kernel_initializer:</div><div class="crayon-line" id="crayon-5a65948cba096215507192-17">      class_name: RandomUniform</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-18">      config: {maxval: 0.05, minval: -0.05, seed: null}</div><div class="crayon-line" id="crayon-5a65948cba096215507192-19">    kernel_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-20">    name: dense_1</div><div class="crayon-line" id="crayon-5a65948cba096215507192-21">    trainable: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-22">    units: 12</div><div class="crayon-line" id="crayon-5a65948cba096215507192-23">    use_bias: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-24">- class_name: Dense</div><div class="crayon-line" id="crayon-5a65948cba096215507192-25">  config:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-26">    activation: relu</div><div class="crayon-line" id="crayon-5a65948cba096215507192-27">    activity_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-28">    bias_constraint: null</div><div class="crayon-line" id="crayon-5a65948cba096215507192-29">    bias_initializer:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-30">      class_name: Zeros</div><div class="crayon-line" id="crayon-5a65948cba096215507192-31">      config: {}</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-32">    bias_regularizer: null</div><div class="crayon-line" id="crayon-5a65948cba096215507192-33">    kernel_constraint: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-34">    kernel_initializer:</div><div class="crayon-line" id="crayon-5a65948cba096215507192-35">      class_name: RandomUniform</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-36">      config: {maxval: 0.05, minval: -0.05, seed: null}</div><div class="crayon-line" id="crayon-5a65948cba096215507192-37">    kernel_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-38">    name: dense_2</div><div class="crayon-line" id="crayon-5a65948cba096215507192-39">    trainable: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-40">    units: 8</div><div class="crayon-line" id="crayon-5a65948cba096215507192-41">    use_bias: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-42">- class_name: Dense</div><div class="crayon-line" id="crayon-5a65948cba096215507192-43">  config:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-44">    activation: sigmoid</div><div class="crayon-line" id="crayon-5a65948cba096215507192-45">    activity_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-46">    bias_constraint: null</div><div class="crayon-line" id="crayon-5a65948cba096215507192-47">    bias_initializer:</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-48">      class_name: Zeros</div><div class="crayon-line" id="crayon-5a65948cba096215507192-49">      config: {}</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-50">    bias_regularizer: null</div><div class="crayon-line" id="crayon-5a65948cba096215507192-51">    kernel_constraint: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-52">    kernel_initializer:</div><div class="crayon-line" id="crayon-5a65948cba096215507192-53">      class_name: RandomUniform</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-54">      config: {maxval: 0.05, minval: -0.05, seed: null}</div><div class="crayon-line" id="crayon-5a65948cba096215507192-55">    kernel_regularizer: null</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-56">    name: dense_3</div><div class="crayon-line" id="crayon-5a65948cba096215507192-57">    trainable: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-58">    units: 1</div><div class="crayon-line" id="crayon-5a65948cba096215507192-59">    use_bias: true</div><div class="crayon-line crayon-striped-line" id="crayon-5a65948cba096215507192-60">keras_version: 2.0.2</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Further Reading</h2>
<ul>
<li><a href="https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model">How can I save a Keras model?</a> in the Keras documentation.</li>
<li><a href="https://keras.io/models/about-keras-models/">About Keras models</a> in the Keras documentation.</li>
</ul>
<h2>Summary</h2>
<p>In this post, you discovered how to serialize your Keras deep learning models.</p>
<p>You learned how you can save your trained models to files and later load them up and use them to make predictions.</p>
<p>You also learned that model weights are easily stored using  HDF5 format and that the network structure can be saved in either JSON or YAML format.</p>
<p>Do you have any questions about saving your deep learning models or about this post? Ask your questions in the comments and I will do my best to answer them.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fsave-load-keras-deep-learning-models%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/save-load-keras-deep-learning-models/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/save-load-keras-deep-learning-models/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/&amp;summary=Keras+is+a+simple+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AGiven+that+deep+learning+models+..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Save%20and%20Load%20Your%20Keras%20Deep%20Learning%20Models&amp;url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/&amp;summary=Keras+is+a+simple+and+powerful+Python+library+for+deep+learning.%0D%0A%0D%0AGiven+that+deep+learning+models+...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/save-load-keras-deep-learning-models/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" rel="prev"><i class="fa fa-angle-left"></i> Your First Machine Learning Project in Python Step-By-Step</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/applied-machine-learning-with-weka/" rel="next">Rapidly Accelerate Your Progress in Applied Machine Learning With Weka <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">103 Responses to <em>Save and Load Your Keras Deep Learning Models</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-362905">
<div class="comment-container" id="li-comment-362905">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/453f1684bbed1b13aee45606986a119a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/453f1684bbed1b13aee45606986a119a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Onkar</span>
<span class="date">August 31, 2016 at 4:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-362905" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am grateful you for sharing knowledge through this blog. It has been very helpful for me.<br/>
Thank you for the effort.</p>
<p>I have one question. When I am executing keras code to load YAML / JSON data i am seeing following error.</p>
<p>Traceback (most recent call last):<br/>
  File “simple_rnn.py”, line 158, in<br/>
    loaded_model = model_from_yaml(loaded_model_yaml)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/models.py”, line 26, in model_from_yaml<br/>
    return layer_from_config(config, custom_objects=custom_objects)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/utils/layer_utils.py”, line 35, in layer_from_config<br/>
    return layer_class.from_config(config[‘config’])<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/models.py”, line 781, in from_config<br/>
    layer = get_or_create_layer(first_layer)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/models.py”, line 765, in get_or_create_layer<br/>
    layer = layer_from_config(layer_data)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/utils/layer_utils.py”, line 35, in layer_from_config<br/>
    return layer_class.from_config(config[‘config’])<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/engine/topology.py”, line 896, in from_config<br/>
    return cls(**config)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/layers/recurrent.py”, line 290, in __init__<br/>
    self.init = initializations.get(init)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/initializations.py”, line 109, in get<br/>
    ‘initialization’, kwargs=kwargs)<br/>
  File “/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/utils/generic_utils.py”, line 14, in get_from_module<br/>
    str(identifier))<br/>
Exception: Invalid initialization: </p>
<p>What could be the reason ?  File is getting saved properly but at the time of loading model I am facing this issue.<br/>
Can you please give me any pointers ?</p>
<p>Thanks,<br/>
Onkar</p>
<div class="reply">
<a aria-label="Reply to Onkar" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=362905#respond" onclick='return addComment.moveForm( "comment-362905", "362905", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-363019">
<div class="comment-container" id="li-comment-363019">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2016 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-363019" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Onkar, the fault is not clear.</p>
<p>Are you able to execute the example in the tutorial OK?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=363019#respond" onclick='return addComment.moveForm( "comment-363019", "363019", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-426213">
<div class="comment-container" id="li-comment-426213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/86ed8838cc49c7f05437374e5301bbe1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/86ed8838cc49c7f05437374e5301bbe1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ridhesh</span>
<span class="date">January 11, 2018 at 4:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-426213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Nice post with helpful steps to save and evaluate model. How do I run the saved model on NEW data without having to re-train it on new data? lets say I have linear regression y=mx+c trained on set of x, once I obtain m and c for given y and x, only thing I need to do is input NEW x and get predicted y with same m and c. I am unable to use LSTM model on these lines.</p>
<p>Thanks you in advance for your help and comments.</p>
<div class="reply">
<a aria-label="Reply to Ridhesh" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=426213#respond" onclick='return addComment.moveForm( "comment-426213", "426213", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426255">
<div class="comment-container" id="li-comment-426255">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-426255" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Load the model and make predictions:</p>
<p>model.predict(X)</p>
<p>Perhaps I don’t understand the problem?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=426255#respond" onclick='return addComment.moveForm( "comment-426255", "426255", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365609">
<div class="comment-container" id="li-comment-365609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">September 27, 2016 at 1:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>your code worked fine,<br/>
I tried to add saving model to my  code but the files were not actually created alyhough I got no error messages</p>
<p>please advice</p>
<p>walid</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365609#respond" onclick='return addComment.moveForm( "comment-365609", "365609", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365650">
<div class="comment-container" id="li-comment-365650">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2016 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365650" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I expect the files were created. Check your current working directory / the dir where the source code files are located.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365650#respond" onclick='return addComment.moveForm( "comment-365650", "365650", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-365667">
<div class="comment-container" id="li-comment-365667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1a2312a6d09292ebb1c7f25390931ce?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1a2312a6d09292ebb1c7f25390931ce?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Peter</span>
<span class="date">September 27, 2016 at 1:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for creating this valuable content.</p>
<p>On my Mac (OSX10.11), the script ran fine until the last line, in which it gave a syntax error below: </p>
<p>&gt;&gt;&gt; print “%s: %.2f%%” % (loaded_model.metrics_names[1], score[1]*100)<br/>
  File “”, line 1<br/>
    print “%s: %.2f%%” % (loaded_model.metrics_names[1], score[1]*100)<br/>
                     ^<br/>
SyntaxError: invalid syntax</p>
<p>What could be the issue here?</p>
<p>Thanks,<br/>
Peter</p>
<div class="reply">
<a aria-label="Reply to Peter" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365667#respond" onclick='return addComment.moveForm( "comment-365667", "365667", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365711">
<div class="comment-container" id="li-comment-365711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2016 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Peter, you may be on Python3, try adding brackets around the argument to the print functions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365711#respond" onclick='return addComment.moveForm( "comment-365711", "365711", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365785">
<div class="comment-container" id="li-comment-365785">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/39a988ccb04c94e86543aa179c4f2cb5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/39a988ccb04c94e86543aa179c4f2cb5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deployment</span>
<span class="date">September 29, 2016 at 1:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365785" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Your blog and books were great, and thanks much to you I finally got my project working in Keras.</p>
<p>I can’t seem to find how to translate a Keras model in to a standalone code that can run without Keras installed.</p>
<p>The best I could find was to learn TensorFlow, build an equivalent model in TF, then use TF to create standalone code.</p>
<p>Does Keras not have such functionality?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Deployment" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365785#respond" onclick='return addComment.moveForm( "comment-365785", "365785", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365808">
<div class="comment-container" id="li-comment-365808">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2016 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-365808" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, my understanding is that Keras is required to use the model in prediction.</p>
<p>You could try to save the network weights and use them in your own code, but you are creating a lot of work for yourself.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=365808#respond" onclick='return addComment.moveForm( "comment-365808", "365808", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-404606">
<div class="comment-container" id="li-comment-404606">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ede9f66ea80a6d2484012c9c5892d472?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ede9f66ea80a6d2484012c9c5892d472?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu prasad</span>
<span class="date">July 3, 2017 at 11:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-404606" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for this incredible blog.<br/>
Is saving this model and reload only possible with keras or even in other skilearn models like kmeans Etc?<br/>
When I have a few classifies used which are also onehotencoded like salary grade or country etc, Lets say u saved model but how can I apply same encoding and featurescaling on input data for which am expected to give output?<br/>
E. G. I may have trained a cancer outcome based model based on country, gender, smoking and drinking status like often, occasional, rare etc. Now when I get new record how to ensure my encoding and featurescaling is aligned with my training set and convert this to get Prediction?<br/>
Thanks in advance for your help.</p>
<div class="reply">
<a aria-label="Reply to vishnu prasad" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=404606#respond" onclick='return addComment.moveForm( "comment-404606", "404606", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-404860">
<div class="comment-container" id="li-comment-404860">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 9:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-404860" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can save sklearn models:<br/>
<a href="http://machinelearningmastery.com/save-load-machine-learning-models-python-scikit-learn/" rel="nofollow">http://machinelearningmastery.com/save-load-machine-learning-models-python-scikit-learn/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=404860#respond" onclick='return addComment.moveForm( "comment-404860", "404860", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-407762">
<div class="comment-container" id="li-comment-407762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/896cd41d8c78ae73f4557b53aa99e09c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/896cd41d8c78ae73f4557b53aa99e09c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">N3da</span>
<span class="date">July 29, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-407762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you know if it’s possible to load a saved sklearn model with keras? How would that work?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-407859">
<div class="comment-container" id="li-comment-407859">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-407859" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, sorry.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-371514">
<div class="comment-container" id="li-comment-371514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Davood</span>
<span class="date">November 22, 2016 at 10:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-371514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thanks for your great and very helpful website. </p>
<p>Since in here you talked about how to save a model, I wanted to know how we can save an embedding layer in the way that can be seen in a regular word embeddings file (i.e. text file or txt format). Let’s assume we either learn these word embeddings in the model from scratch or we update those pre-trained ones which are fed in the first layer of the model.</p>
<p>I truly appreciate your response in advance.</p>
<p>Regards,<br/>
Davood</p>
<div class="reply">
<a aria-label="Reply to Davood" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=371514#respond" onclick='return addComment.moveForm( "comment-371514", "371514", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-371679">
<div class="comment-container" id="li-comment-371679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 8:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-371679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure we need to save embedding layers Davood.</p>
<p>I believe they are deterministic and can just be re-created.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=371679#respond" onclick='return addComment.moveForm( "comment-371679", "371679", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-371721">
<div class="comment-container" id="li-comment-371721">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Davood</span>
<span class="date">November 23, 2016 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-371721" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I guess we should be able to save word embeddings at one point (not needed always though!). To visualize/map them in a (2D) space or to test algebraic word analogies on them can be some examples of this need.</p>
<p>I found the answer for this and I’m sharing this here:</p>
<p>If we train an embedding layer emb (e.g. emb = Embedding(some_parameters_here) ), we can get the resulting word-by-dimension matrix by my_embeddings = emb.get_weights(). Then, we can do normal numpy things like np.save(“my_embeddings.npy”, my_matrix) to save this matrix; or use other built-in write_to_a_file functions in Python to store each line of this matrix along with its associated word. These words and their indices are typically stored in a word_index dictionary somewhere in the code.</p>
<div class="reply">
<a aria-label="Reply to Davood" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=371721#respond" onclick='return addComment.moveForm( "comment-371721", "371721", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371932">
<div class="comment-container" id="li-comment-371932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 24, 2016 at 10:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-371932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice, thanks for sharing the specifics Davood.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=371932#respond" onclick='return addComment.moveForm( "comment-371932", "371932", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-372865">
<div class="comment-container" id="li-comment-372865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e72da043bab062d544bc3ac86d38fdad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Davood</span>
<span class="date">November 29, 2016 at 7:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-372865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are very welcome Jason.<br/>
However I have another question here!<br/>
Let’s assume we two columns of networks in keras and these two columns are exactly the same. These two are going to merge on the top and then feed into a dense layer which is the output layer in our model. My question is, while the first layer of each column here is an embedding layer, how can we share the the weights of the similar layers in the columns? No need to say that we set our embedding layers (first layers) in a way that we only have one embedding matrix. What I mean is shared embeddings, something like this:<br/>
emb1 = Embedding(some_parameters_here)<br/>
emb2 = emb1      # instead of emb2 = Embedding(some_other_parameters_here)).<br/>
How about the other layers on top of these two embedding layers?! How to share their weights?<br/>
Thanks for your answer in advance.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-372993">
<div class="comment-container" id="li-comment-372993">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2016 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-372993" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hmm, interesting Davood.</p>
<p>I think, and could be wrong, that embedding layers are deterministic. They do not have state, only the weights in or out have state. Create two and use them side by side. Try it and see.</p>
<p>I’d love to know how you go?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-373939">
<div class="comment-container" id="li-comment-373939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6d4cc54a531d164af55952b7f689a295?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6d4cc54a531d164af55952b7f689a295?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chao</span>
<span class="date">December 6, 2016 at 1:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-373939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your share, it helps me a lot. I’d like to ask a question, why the optimizer while compiling the model is adam, but uses rmsprop instead while compiling the loaded_model?</p>
<div class="reply">
<a aria-label="Reply to Chao" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=373939#respond" onclick='return addComment.moveForm( "comment-373939", "373939", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-374004">
<div class="comment-container" id="li-comment-374004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 6, 2016 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-374004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would suggest trying many different optimizers and see what you like best / works best for your problem.</p>
<p>I find ADAM is fast and gives good results.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=374004#respond" onclick='return addComment.moveForm( "comment-374004", "374004", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-375089">
<div class="comment-container" id="li-comment-375089">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/82e3268e178fa44503fcd654c4141012?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/82e3268e178fa44503fcd654c4141012?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kl</span>
<span class="date">December 13, 2016 at 11:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-375089" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have difficulties finding an answer to this question: </p>
<p>when are weights initialized in keras?</p>
<p>at compile time ? (probably not)</p>
<p>on first epoch ?</p>
<p>This is important when resuming learning</p>
<div class="reply">
<a aria-label="Reply to kl" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=375089#respond" onclick='return addComment.moveForm( "comment-375089", "375089", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375140">
<div class="comment-container" id="li-comment-375140">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 14, 2016 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-375140" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting question.</p>
<p>I don’t know.</p>
<p>If I had to guess, I would say at the model.compile() time when the data structures are created.</p>
<p>It might be worth asking on the keras email list – I’d love to know the answer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=375140#respond" onclick='return addComment.moveForm( "comment-375140", "375140", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-376844">
<div class="comment-container" id="li-comment-376844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/156d6b6e4cb1d35138539428807116d4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/156d6b6e4cb1d35138539428807116d4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Soheil</span>
<span class="date">December 22, 2016 at 8:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-376844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for creating such great blog.<br/>
I saved a model with mentioned code. But when I wanted to load it again, I faced following error. It seems the network architecture was not save correctly?  </p>
<p>—————————————————————————<br/>
Exception                                 Traceback (most recent call last)<br/>
 in ()<br/>
      1 # load weights into new model<br/>
—-&gt; 2 modelN.load_weights(“model41.h5”)<br/>
      3 print(“Loaded model from disk”)</p>
<p>C:\Anaconda2\envs\py35\lib\site-packages\keras\engine\topology.py in load_weights(self, filepath, by_name)<br/>
   2518             self.load_weights_from_hdf5_group_by_name(f)<br/>
   2519         else:<br/>
-&gt; 2520             self.load_weights_from_hdf5_group(f)<br/>
   2521<br/>
   2522         if hasattr(f, ‘close’):</p>
<p>C:\Anaconda2\envs\py35\lib\site-packages\keras\engine\topology.py in load_weights_from_hdf5_group(self, f)<br/>
   2570                                 ‘containing ‘ + str(len(layer_names)) +<br/>
   2571                                 ‘ layers into a model with ‘ +<br/>
-&gt; 2572                                 str(len(flattened_layers)) + ‘ layers.’)<br/>
   2573<br/>
   2574             # We batch weight value assignments in a single backend call</p>
<p>Exception: You are trying to load a weight file containing 4 layers into a model with 5 layers.</p>
<div class="reply">
<a aria-label="Reply to Soheil" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=376844#respond" onclick='return addComment.moveForm( "comment-376844", "376844", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-376945">
<div class="comment-container" id="li-comment-376945">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 23, 2016 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-376945" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Soheil,</p>
<p>It looks like the network structure that you are loading the weights into does not match the structure of the weights.</p>
<p>Double check that the network structure matches exactly the structure that you used when you saved the weights. You can even save this structure as a json or yaml file as well.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=376945#respond" onclick='return addComment.moveForm( "comment-376945", "376945", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-383853">
<div class="comment-container" id="li-comment-383853">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/afe2e9006e1255d7f68b9c8742aadaf7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/afe2e9006e1255d7f68b9c8742aadaf7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">prajnya</span>
<span class="date">January 24, 2017 at 6:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-383853" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a question. Now that I have saved the model and the weights, is it possible for me to come back after a few days and train the model again with initial weights equal to the one I saved?</p>
<div class="reply">
<a aria-label="Reply to prajnya" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=383853#respond" onclick='return addComment.moveForm( "comment-383853", "383853", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-384008">
<div class="comment-container" id="li-comment-384008">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 9:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-384008" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question prajnya.</p>
<p>You can load the saved weights and continue training/update with new data or start making predictions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=384008#respond" onclick='return addComment.moveForm( "comment-384008", "384008", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-405173">
<div class="comment-container" id="li-comment-405173">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8daa18dea5c56b06c3349dfbb48af020?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8daa18dea5c56b06c3349dfbb48af020?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tharun</span>
<span class="date">July 9, 2017 at 2:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-405173" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I tried to save and load a model trained for 5000 epochs and checked the performance of the model in the same session in comparison with the model performance just before saving after 5000 epochs. I any case using the above code I ended up with random results. But then I only saved the weights and instantiated the model again and loaded the weights with the argument “by_name”  model.load_weights(‘model.h5’, by_name=True) then the accuracy as same as the model starting performance at 1st epoch/iteration. But in any case I am not able to replicate/reproduce!!! Request you if you could clarify this with a post, There is a post on github too but it is not yet resolved to satisfaction!!!</p>
<div class="reply">
<a aria-label="Reply to Tharun" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=405173#respond" onclick='return addComment.moveForm( "comment-405173", "405173", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-405270">
<div class="comment-container" id="li-comment-405270">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-405270" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, I don’t have any good ideas. Perhaps post to stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=405270#respond" onclick='return addComment.moveForm( "comment-405270", "405270", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-405174">
<div class="comment-container" id="li-comment-405174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8daa18dea5c56b06c3349dfbb48af020?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8daa18dea5c56b06c3349dfbb48af020?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tharun</span>
<span class="date">July 9, 2017 at 2:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-405174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>the github post is at <a href="https://github.com/fchollet/keras/issues/4875" rel="nofollow">https://github.com/fchollet/keras/issues/4875</a></p>
<div class="reply">
<a aria-label="Reply to Tharun" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=405174#respond" onclick='return addComment.moveForm( "comment-405174", "405174", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386621">
<div class="comment-container" id="li-comment-386621">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AKSHAY</span>
<span class="date">February 8, 2017 at 6:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-386621" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>It is an amazing blog you have here. Thanks for the well documented works.<br/>
I have a question regarding loading the model weights. Is there a way to save the weights into a variable rather than loading and assigning the weights to a different model?<br/>
I wanted to do some operations on the weights associated with the intermediate hidden layer.</p>
<p>I was anticipating on using ModelCheckpoint but I am a bit lost on reading weights from the hdf5 format and saving it to a variable. Could you please help me figure it out.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to AKSHAY" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=386621#respond" onclick='return addComment.moveForm( "comment-386621", "386621", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-386713">
<div class="comment-container" id="li-comment-386713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 9, 2017 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-386713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, sorry I have not done this.</p>
<p>I expect you will be able to extract them using the Keras API, it might be worth looking at the source code on github.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=386713#respond" onclick='return addComment.moveForm( "comment-386713", "386713", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-390656">
<div class="comment-container" id="li-comment-390656">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07a49b7e5a35a9d1040f8966fb75e959?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07a49b7e5a35a9d1040f8966fb75e959?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Patrick</span>
<span class="date">March 1, 2017 at 3:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-390656" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>thanks a lot for your excellent tutorials! Very much appreciated… </p>
<p>Regarding the saving and loading: It seems that Keras as of now saves model and weights in HD5 rather than only the weights. </p>
<p><a href="https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model" rel="nofollow">https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model</a></p>
<p>This results in a much simpler snippet for import / export:</p>
<p>——————————————————-</p>
<p>from keras.models import load_model</p>
<p>model.save(‘my_model.h5’)  # creates a HDF5 file ‘my_model.h5’<br/>
del model  # deletes the existing model</p>
<p># returns a compiled model<br/>
# identical to the previous one<br/>
model = load_model(‘my_model.h5’)</p>
<p>——————————————————-</p>
<div class="reply">
<a aria-label="Reply to Patrick" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=390656#respond" onclick='return addComment.moveForm( "comment-390656", "390656", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390714">
<div class="comment-container" id="li-comment-390714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-390714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Patrick, I’ll investigate and look at updating the post soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=390714#respond" onclick='return addComment.moveForm( "comment-390714", "390714", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391603">
<div class="comment-container" id="li-comment-391603">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/175d0cf6a1a3090a868097c77ac49d6f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/175d0cf6a1a3090a868097c77ac49d6f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Avik Moulik</span>
<span class="date">March 7, 2017 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-391603" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Getting this error:</p>
<p>NameError: name ‘model_from_json’ is not defined</p>
<p>Thanks in advance for any help on this.</p>
<div class="reply">
<a aria-label="Reply to Avik Moulik" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=391603#respond" onclick='return addComment.moveForm( "comment-391603", "391603", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-391619">
<div class="comment-container" id="li-comment-391619">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 7, 2017 at 9:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-391619" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Confirm that you have Keras 1.2.2 or higher installed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=391619#respond" onclick='return addComment.moveForm( "comment-391619", "391619", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396262">
<div class="comment-container" id="li-comment-396262">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aedbc1635f77f6e042bf0ffb46aa8b5d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aedbc1635f77f6e042bf0ffb46aa8b5d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chan</span>
<span class="date">April 13, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-396262" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have saved my weights already in a txt file. Can I use it and load weights?</p>
<div class="reply">
<a aria-label="Reply to Chan" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=396262#respond" onclick='return addComment.moveForm( "comment-396262", "396262", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396298">
<div class="comment-container" id="li-comment-396298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 10:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-396298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may be able, I don’t have an example off-hand, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=396298#respond" onclick='return addComment.moveForm( "comment-396298", "396298", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396954">
<div class="comment-container" id="li-comment-396954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ddccc06cee68413e2b91d0324c7be181?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ddccc06cee68413e2b91d0324c7be181?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">M Amer</span>
<span class="date">April 20, 2017 at 2:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-396954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thankyou for this great tutorial.<br/>
I want to convert this keras model(model.h5) to tensorflow model(filename.pb) because I want to use it in android. I have used the github code that is:<br/>
=========================================</p>
<p>import keras<br/>
import tensorflow<br/>
from keras import backend as K<br/>
from tensorflow.contrib.session_bundle import exporter<br/>
from keras.models import model_from_config, Sequential</p>
<p>print(“Loading model for exporting to Protocol Buffer format…”)<br/>
model_path = “C:/Users/User/buildingrecog/model.h5”<br/>
model = keras.models.load_model(model_path)</p>
<p>K.set_learning_phase(0)  # all new operations will be in test mode from now on<br/>
sess = K.get_session()</p>
<p> # serialize the model and get its weights, for quick re-building<br/>
config = model.get_config()<br/>
weights = model.get_weights()</p>
<p> # re-build a model where the learning phase is now hard-coded to 0<br/>
new_model = Sequential.model_from_config(config)<br/>
new_model.set_weights(weights)</p>
<p>export_path = “C:/Users/User/buildingrecog/khi_buildings.pb”  # where to save the exported graph<br/>
export_version = 1  # version number (integer)</p>
<p>saver = tensorflow.train.Saver(sharded=True)<br/>
model_exporter = exporter.Exporter(saver)<br/>
signature = exporter.classification_signature(input_tensor=model.input, scores_tensor=model.output)<br/>
model_exporter.init(sess.graph.as_graph_def(), default_graph_signature=signature)<br/>
model_exporter.export(export_path, tensorflow.constant(export_version), sess)<br/>
———————————————————————————–</p>
<p>but has the following error…<br/>
=====================</p>
<p>Loading model for exporting to Protocol Buffer format…<br/>
—————————————————————————<br/>
ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
      7 print(“Loading model for exporting to Protocol Buffer format…”)<br/>
      8 model_path = “C:/Users/User/buildingrecog/model.h5”<br/>
—-&gt; 9 model = keras.models.load_model(model_path)<br/>
     10<br/>
     11 K.set_learning_phase(0)  # all new operations will be in test mode from now on</p>
<p>C:\Users\User\Anaconda3\lib\site-packages\keras\models.py in load_model(filepath, custom_objects)<br/>
    228     model_config = f.attrs.get(‘model_config’)<br/>
    229     if model_config is None:<br/>
–&gt; 230         raise ValueError(‘No model found in config file.’)<br/>
    231     model_config = json.loads(model_config.decode(‘utf-8’))<br/>
    232     model = model_from_config(model_config, custom_objects=custom_objects)</p>
<p>ValueError: No model found in config file.<br/>
—————————————————————-</p>
<p>Please help me to solve this…!!</p>
<div class="reply">
<a aria-label="Reply to M Amer" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=396954#respond" onclick='return addComment.moveForm( "comment-396954", "396954", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396998">
<div class="comment-container" id="li-comment-396998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-396998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t know how to load keras models in tensorflow off-hand.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=396998#respond" onclick='return addComment.moveForm( "comment-396998", "396998", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-397801">
<div class="comment-container" id="li-comment-397801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6727af664ef0e3ea4cc6b09bad429c57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6727af664ef0e3ea4cc6b09bad429c57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ravid</span>
<span class="date">April 28, 2017 at 12:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>M Amer,</p>
<p>I ma trying to do exactly the same thing. Please let us know if you figure it out.</p>
<div class="reply">
<a aria-label="Reply to Ravid" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397801#respond" onclick='return addComment.moveForm( "comment-397801", "397801", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397059">
<div class="comment-container" id="li-comment-397059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ddccc06cee68413e2b91d0324c7be181?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ddccc06cee68413e2b91d0324c7be181?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">M Amer</span>
<span class="date">April 21, 2017 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have created the keras model file (.h5) unfortunately it can’t be loaded. But I want to load it and convert it into tensor flow (.pb) model.Any Solution? Waiting for your response….</p>
<div class="reply">
<a aria-label="Reply to M Amer" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397059#respond" onclick='return addComment.moveForm( "comment-397059", "397059", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397098">
<div class="comment-container" id="li-comment-397098">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 21, 2017 at 8:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397098" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have an example of how to load a Keras model in TensorFlow.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397098#respond" onclick='return addComment.moveForm( "comment-397098", "397098", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397370">
<div class="comment-container" id="li-comment-397370">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/678b7892df5f7c4ceda548b20a4b15b0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/678b7892df5f7c4ceda548b20a4b15b0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanjay</span>
<span class="date">April 24, 2017 at 2:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397370" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am having issues with loading the model which has been saved with normalising (StandardScaler) the columns.  Do you have to apply normalising (StandarScaler) when you load the models too?</p>
<p>Here is the snippet of code:  1) Save and 2)Load</p>
<p>Save:<br/>
import numpy as np<br/>
import matplotlib.pyplot as plt<br/>
import pandas as pd</p>
<p># Importing the dataset<br/>
dataset = pd.read_csv(‘Churn_Modelling.csv’)<br/>
X = dataset.iloc[:, 3:13].values<br/>
y = dataset.iloc[:, 13].values</p>
<p># Encoding categorical data<br/>
from sklearn.preprocessing import LabelEncoder, OneHotEncoder<br/>
labelencoder_X_1 = LabelEncoder()<br/>
X[:, 1] = labelencoder_X_1.fit_transform(X[:, 1])<br/>
labelencoder_X_2 = LabelEncoder()<br/>
X[:, 2] = labelencoder_X_2.fit_transform(X[:, 2])<br/>
onehotencoder = OneHotEncoder(categorical_features = [1])<br/>
X = onehotencoder.fit_transform(X).toarray()<br/>
X = X[:, 1:]</p>
<p># Splitting the dataset into the Training set and Test set<br/>
from sklearn.model_selection import train_test_split<br/>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)</p>
<p># Feature Scaling<br/>
from sklearn.preprocessing import StandardScaler<br/>
sc = StandardScaler()<br/>
X_train = sc.fit_transform(X_train)<br/>
X_test = sc.transform(X_test)</p>
<p># Importing the Keras libraries and packages<br/>
import keras<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense</p>
<p># Initialising the ANN<br/>
classifier = Sequential()</p>
<p>classifier.add(Dense(units = 6, kernel_initializer = ‘uniform’, activation = ‘relu’, input_dim = 11))<br/>
classifier.add(Dense(units = 6, kernel_initializer = ‘uniform’, activation = ‘relu’))<br/>
classifier.add(Dense(units = 1, kernel_initializer = ‘uniform’, activation = ‘sigmoid’))<br/>
classifier.compile(optimizer = ‘adam’, loss = ‘binary_crossentropy’, metrics = [‘accuracy’])</p>
<p># Fitting the ANN to the Training set<br/>
classifier.fit(X_train, y_train, batch_size = 10, epochs = 1)</p>
<p># Predicting the Test set results<br/>
y_pred = classifier.predict(X_test)<br/>
y_pred = (y_pred &gt; 0.5)</p>
<p># Saving your model<br/>
classifier.save(“ann_churn_model_v1.h5”) </p>
<p>Load:<br/>
import numpy as np<br/>
import matplotlib.pyplot as plt<br/>
import pandas as pd</p>
<p># Reuse churn_model_v1.h5<br/>
import keras<br/>
from keras.models import load_model<br/>
classifier = load_model(“ann_churn_model_v1.h5”) </p>
<p># Feature Scaling – Here I have a question whether to apply StandarScaler after loading the model?</p>
<p>from sklearn.preprocessing import StandardScaler<br/>
#sc = StandardScaler()</p>
<p>new_prediction = classifier.predict(sc.transform(np.array([[0.0, 0.0, 600, 1, 40, 3, 60000, 2, 1, 1, 50000]])))<br/>
new_prediction = (new_prediction &gt; 0.5)</p>
<p>Thanks,<br/>
Sanj</p>
<div class="reply">
<a aria-label="Reply to Sanjay" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397370#respond" onclick='return addComment.moveForm( "comment-397370", "397370", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397387">
<div class="comment-container" id="li-comment-397387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 24, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will also need to save your scaler. </p>
<p>Perhaps you can pickle it or just the coefficients (min/max for each feature) needed to scale data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397387#respond" onclick='return addComment.moveForm( "comment-397387", "397387", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397922">
<div class="comment-container" id="li-comment-397922">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/049050a854ad6709550e088fe67e9541?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/049050a854ad6709550e088fe67e9541?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rohit</span>
<span class="date">April 28, 2017 at 9:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397922" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the useful information. </p>
<p>Is it possible to load this model and weights to any other platform, for example Android or iOS. I believe that model and weights are language independent.</p>
<p>Are there any free / open source solutions for this purpose?</p>
<div class="reply">
<a aria-label="Reply to Rohit" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397922#respond" onclick='return addComment.moveForm( "comment-397922", "397922", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397965">
<div class="comment-container" id="li-comment-397965">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2017 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-397965" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t see why not. Sorry, I not across the android or ios platforms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=397965#respond" onclick='return addComment.moveForm( "comment-397965", "397965", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399506">
<div class="comment-container" id="li-comment-399506">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a2100c6f1ce0f929da456ac6d91d7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a2100c6f1ce0f929da456ac6d91d7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kshitij Deshmukh</span>
<span class="date">May 12, 2017 at 11:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-399506" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How can I create a model out of face recognition encodings to save using Saver.save() method?</p>
<div class="reply">
<a aria-label="Reply to Kshitij Deshmukh" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=399506#respond" onclick='return addComment.moveForm( "comment-399506", "399506", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399535">
<div class="comment-container" id="li-comment-399535">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-399535" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is Saver.save()?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=399535#respond" onclick='return addComment.moveForm( "comment-399535", "399535", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399718">
<div class="comment-container" id="li-comment-399718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2d9b02c88562fbc51e2aafd94159a114?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2d9b02c88562fbc51e2aafd94159a114?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lotem</span>
<span class="date">May 15, 2017 at 6:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-399718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, have you tried saving a model, closing the python session, then opening a new python session and then loading a model?</p>
<p>Using python 3.5, if I save a trained model in one session and load it in another, my accuracy drops dramatically and the predictions become random (as if the model wasn’t trained).</p>
<p>This is what I’m trying to do:<br/>
”’<br/>
embedding_size = 64<br/>
hidden_size = 64<br/>
input_length = 100<br/>
learning_rate = 0.1<br/>
patience = 3<br/>
num_labels = 6<br/>
batch_size= 50<br/>
epochs = 100<br/>
seq_len = 100′</p>
<p>model = Sequential()<br/>
model.add(Embedding(vocab_size, embedding_size, input_length=input_length))<br/>
model.add(Bidirectional(GRU(hidden_size, return_sequences=True, activation=”tanh”)))<br/>
model.add(TimeDistributed(Dense(num_labels, activation=’softmax’)))<br/>
optimizer = Adagrad(lr=learning_rate)<br/>
model.compile(loss=’categorical_crossentropy’, optimizer=optimizer, metrics=[‘categorical_accuracy’])<br/>
callbacks = [EarlyStopping(monitor=’val_loss’, patience=patience, verbose=0)]<br/>
model.fit(x_train, y_train, batch_size=batch_size, epochs = epochs, callbacks=callbacks, validation_data=[x_dev, y_dev])</p>
<p>model.save(“model.h5″)<br/>
”’</p>
<p>Evaluating the model in this point gives me accuracy of ~70.</p>
<p>Then I exit python, open a new python session, and try:</p>
<p>”’<br/>
model2 = load_mode(‘model_full.h5′)<br/>
”’</p>
<p>Evaluating the model in this point gives me accuracy of ~20.</p>
<p>Any ideas?</p>
<div class="reply">
<a aria-label="Reply to Lotem" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=399718#respond" onclick='return addComment.moveForm( "comment-399718", "399718", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399771">
<div class="comment-container" id="li-comment-399771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-399771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have. I don’t believe it is related to the Python session.</p>
<p>Off the cuff, my gut tells me something is different in the saved model.</p>
<p>If you save and load in the same session is the result the same as prior to the save? What if you repeat the load+test process a few times?</p>
<p>Confirm that you are saving the Embedding as well (I think it may need to be saved). </p>
<p>Confirm that you are evaluating it on exactly the same data in the same order and in the same way.</p>
<p>Neural nets are stochastic and a deviation could affect the internal state of your RNN and result in different results, perhaps not as dramatic as you are reporting through.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=399771#respond" onclick='return addComment.moveForm( "comment-399771", "399771", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400592">
<div class="comment-container" id="li-comment-400592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carl</span>
<span class="date">May 26, 2017 at 8:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-400592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I seem to get an error message </p>
<p>RuntimeError: Unable to create attribute (Object header message is too large)</p>
<p>Github issues states that the error could be due to too large network, which is the case here.. but</p>
<p>How should i then save the weights… Keras doesn’t seem to have any alternative methods..</p>
<div class="reply">
<a aria-label="Reply to Carl" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=400592#respond" onclick='return addComment.moveForm( "comment-400592", "400592", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401144">
<div class="comment-container" id="li-comment-401144">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-401144" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not seen this error.</p>
<p>See if you can save the weights with a smaller network on your system to try and narrow down the cause of the fault.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=401144#respond" onclick='return addComment.moveForm( "comment-401144", "401144", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401263">
<div class="comment-container" id="li-comment-401263">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c623a67658d0e9d297b095246b519cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c623a67658d0e9d297b095246b519cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nguyennguyen</span>
<span class="date">June 2, 2017 at 4:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-401263" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey guys,<br/>
I want to know how can i update value of model, like i have better model, version 2 and not need to stop service, with use of version 1 before in Keras. I want to say a module manager model, can update new version model, and not need to break service, or something like this. Thank you.</p>
<div class="reply">
<a aria-label="Reply to nguyennguyen" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=401263#respond" onclick='return addComment.moveForm( "comment-401263", "401263", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401312">
<div class="comment-container" id="li-comment-401312">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2017 at 7:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-401312" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You have a few options.</p>
<p>You can replace the weights and continue to use the topology. You can replace the topology and weights. </p>
<p>You can also continue learning from the existing set of weights, see this post:<br/>
<a href="http://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=401312#respond" onclick='return addComment.moveForm( "comment-401312", "401312", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-404078">
<div class="comment-container" id="li-comment-404078">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c623a67658d0e9d297b095246b519cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c623a67658d0e9d297b095246b519cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nguyennguyen</span>
<span class="date">June 28, 2017 at 1:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-404078" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks you so much jason.</p>
<div class="reply">
<a aria-label="Reply to nguyennguyen" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=404078#respond" onclick='return addComment.moveForm( "comment-404078", "404078", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-404165">
<div class="comment-container" id="li-comment-404165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-404165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=404165#respond" onclick='return addComment.moveForm( "comment-404165", "404165", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401673">
<div class="comment-container" id="li-comment-401673">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4d4453dce34f09979e9591046abb972?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4d4453dce34f09979e9591046abb972?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">George</span>
<span class="date">June 6, 2017 at 6:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-401673" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
do you know if it’s possible saving the model only and every time it’s accuracy over the validation set has improved (after each epoch)? </p>
<p>and is it possible checking the validation in a higher frequency than every epoch? </p>
<p>thanks!</p>
<div class="reply">
<a aria-label="Reply to George" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=401673#respond" onclick='return addComment.moveForm( "comment-401673", "401673", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401729">
<div class="comment-container" id="li-comment-401729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 7, 2017 at 7:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-401729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would expect so George, the callback is quite configurable:<br/>
<a href="https://keras.io/callbacks/#modelcheckpoint" rel="nofollow">https://keras.io/callbacks/#modelcheckpoint</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=401729#respond" onclick='return addComment.moveForm( "comment-401729", "401729", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402325">
<div class="comment-container" id="li-comment-402325">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af06a67e881c1d0257b97af2a2945193?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af06a67e881c1d0257b97af2a2945193?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prathap</span>
<span class="date">June 13, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-402325" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dr. Jason,<br/>
I am using keras with Tensorflow back-end. I have saved my model as you mentioned here. But the problem was it takes some longer time than expected to load the weights. I am only using a CPU (not a GPU) since my model is kind of a small model. Can you please let me know how to improve the loading time of the model? Compared to sci-kit learn pickled model’s loading time, this is very high (nearly about 1 minute).</p>
<div class="reply">
<a aria-label="Reply to Prathap" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=402325#respond" onclick='return addComment.moveForm( "comment-402325", "402325", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402355">
<div class="comment-container" id="li-comment-402355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2017 at 8:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-402355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is a long time. </p>
<p>Confirm that it is Keras causing the problem. </p>
<p>Perhaps it is something else in your code? </p>
<p>Perhaps you have a very slow HDD?</p>
<p>Perhaps you are running out of RAM for some reason?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=402355#respond" onclick='return addComment.moveForm( "comment-402355", "402355", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402949">
<div class="comment-container" id="li-comment-402949">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://soulis.tech" rel="external nofollow">Anastasios Selalmazidis</a></span>
<span class="date">June 18, 2017 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-402949" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>how can I save a model after gridsearch ? I keep getting errors: “AttributeError: ‘KerasClassifier’ object has no attribute ‘save'”</p>
<div class="reply">
<a aria-label="Reply to Anastasios Selalmazidis" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=402949#respond" onclick='return addComment.moveForm( "comment-402949", "402949", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405115">
<div class="comment-container" id="li-comment-405115">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/711aaa87088b04d3ce7d76e8a4f2b49b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/711aaa87088b04d3ce7d76e8a4f2b49b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AndreasM</span>
<span class="date">July 8, 2017 at 2:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-405115" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have two questions,<br/>
1) why you compile() the model a second time after load_weights() to reload the model from file?<br/>
2) in both examples, you use one optimizer to compile() before the fit(), but pass a different optimizer to compile() after load_weights() , isn’t that problematic? if not, then why should we use different optimizer?</p>
<div class="reply">
<a aria-label="Reply to AndreasM" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=405115#respond" onclick='return addComment.moveForm( "comment-405115", "405115", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405262">
<div class="comment-container" id="li-comment-405262">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-405262" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It used ti be required to compile a loaded model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=405262#respond" onclick='return addComment.moveForm( "comment-405262", "405262", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406334">
<div class="comment-container" id="li-comment-406334">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Devakar</span>
<span class="date">July 18, 2017 at 3:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-406334" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I saved the model and weights. Then I uploaded the model from other python script, its not working.Why?</p>
<p>Its working if saving and loading the model is within same python script.</p>
<p>I am puzzled with the behaviour. Any help, please.</p>
<div class="reply">
<a aria-label="Reply to Devakar" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=406334#respond" onclick='return addComment.moveForm( "comment-406334", "406334", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406346">
<div class="comment-container" id="li-comment-406346">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 18, 2017 at 5:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-406346" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the problem exactly? Is there an error?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=406346#respond" onclick='return addComment.moveForm( "comment-406346", "406346", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410353">
<div class="comment-container" id="li-comment-410353">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb2156858479683318bf5b7538858898?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb2156858479683318bf5b7538858898?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PandaN</span>
<span class="date">August 20, 2017 at 8:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-410353" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the article! Helped a lot..<br/>
I had the following doubt though – </p>
<p>The following from the Keras docs itself: </p>
<p>“””<br/>
You can use model.save(filepath) to save a Keras model into a single HDF5 file which will contain:</p>
<p>– the architecture of the model, allowing to re-create the model<br/>
– the weights of the model<br/>
– the training configuration (loss, optimizer)<br/>
– the state of the optimizer, allowing to resume training exactly where you left off.<br/>
“””</p>
<p>As it says, it also saves the training configuration (loss, optimizer) why are we again compiling after loading the model and weights? Why don’t we just directly evaluate on test data?</p>
<div class="reply">
<a aria-label="Reply to PandaN" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=410353#respond" onclick='return addComment.moveForm( "comment-410353", "410353", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410386">
<div class="comment-container" id="li-comment-410386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2017 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-410386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The API has changed since I wrote this tutorial. You can now save the model in one file and you no longer need to compile after loading.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=410386#respond" onclick='return addComment.moveForm( "comment-410386", "410386", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411756">
<div class="comment-container" id="li-comment-411756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d9dfadd5c4688814a033acb75d4a999e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d9dfadd5c4688814a033acb75d4a999e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jan balewski</span>
<span class="date">August 30, 2017 at 4:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-411756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’m keras novice and I really enjoyed your short tutorials  – I have learned a lot.<br/>
Perhaps you can advice me how to push the concept of saving/loading net config for a  more complex case, when 2 Sequential nets are merged  to the new sequential net, sth like this:</p>
<p>model1 = Sequential()<br/>
…<br/>
model2 = Sequential()<br/>
…<br/>
model3 = Sequential()<br/>
model3.add(Merge([model1, model2], mode=’concat’))<br/>
…</p>
<p>I can save/load each model[1-3] separately.  But after I load the 3 pieces back I do not know how to glue them together? Can you help how to execute equivalence of<br/>
model3.add(Merge([model1, model2], mode=’concat’))  after 3 sub-nets were read in from Yaml?<br/>
Below is a simple toy code which is missing just this last step.<br/>
Thanks in advance<br/>
Jan</p>
<p>– – –<br/>
cat toy-2LSTM-save-model.py<br/>
#!/usr/bin/env python<br/>
“””<br/>
definse multi branch Sequential net with Merge()<br/>
save net to yaml,<br/>
reads it back (and looses some pieces)<br/>
“””</p>
<p>import os, time<br/>
import warnings<br/>
os.environ[‘TF_CPP_MIN_LOG_LEVEL’] = ‘3’ #Hide messy TensorFlow warnings<br/>
warnings.filterwarnings(“ignore”) #Hide messy Numpy warnings</p>
<p>from keras.datasets import mnist<br/>
from keras import utils as np_utils<br/>
from keras.models import Sequential, load_model,  model_from_yaml<br/>
from keras.callbacks import EarlyStopping, ModelCheckpoint<br/>
from keras.layers import Dense, Dropout, Merge,  LSTM<br/>
import yaml</p>
<p>print(‘build_model:’)</p>
<p>inp_sh1=(10, 20)<br/>
inp_sh2=(11, 22)<br/>
print(‘build_model inp1:’,inp_sh1,’ inp2:’,inp_sh2)<br/>
lstm_na=30<br/>
lstm_nb=40</p>
<p>dens_nc=30</p>
<p>model1 = Sequential()<br/>
model1.add(LSTM(lstm_na, input_shape=inp_sh1))</p>
<p>model2 = Sequential()<br/>
model2.add(LSTM(lstm_nb, input_shape=inp_sh2 ))</p>
<p>model3 = Sequential()<br/>
model3.add(Merge([model1, model2], mode=’concat’))<br/>
model3.add(Dense(1, activation=’sigmoid’)) # predicts only 0/1 </p>
<p># Compile model<br/>
model3.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>print(‘input1:’,inp_sh1, ‘input2:’,inp_sh2)<br/>
print(‘1st LSTM branch:’)<br/>
model1.summary() # will print<br/>
print(‘2nd LSTM branch:’)<br/>
model2.summary()<br/>
print(‘final Dense branch:’)<br/>
model3.summary()</p>
<p>print(“———–  Save model as YAML ———–“)<br/>
yamlRec1 = model1.to_yaml()<br/>
yamlRec2 = model2.to_yaml()<br/>
yamlRec3 = model3.to_yaml()</p>
<p>with open(‘jan.model1.yaml’, ‘w’) as outfile:<br/>
    yaml.dump(yamlRec1, outfile)<br/>
with open(‘jan.model2.yaml’, ‘w’) as outfile:<br/>
    yaml.dump(yamlRec2, outfile)<br/>
with open(‘jan.model3.yaml’, ‘w’) as outfile:<br/>
    yaml.dump(yamlRec3, outfile)</p>
<p>print(“———–  Read model from YAML ———–“)<br/>
with open(‘jan.model1.yaml’, ‘r’) as inpfile:<br/>
    yamlRec1b=yaml.load(inpfile)<br/>
model1b = model_from_yaml(yamlRec1b)<br/>
model1b.summary() # will print</p>
<p>with open(‘jan.model2.yaml’, ‘r’) as inpfile:<br/>
    yamlRec2b=yaml.load(inpfile)<br/>
model2b = model_from_yaml(yamlRec2b)<br/>
model2b.summary() # will print</p>
<p>with open(‘jan.model3.yaml’, ‘r’) as inpfile:<br/>
    yamlRec3b=yaml.load(inpfile)<br/>
model3b = model_from_yaml(yamlRec3b)<br/>
model3b.summary() # will print</p>
<div class="reply">
<a aria-label="Reply to jan balewski" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=411756#respond" onclick='return addComment.moveForm( "comment-411756", "411756", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411765">
<div class="comment-container" id="li-comment-411765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 30, 2017 at 4:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-411765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can define your model using the function API and save it as one single model.</p>
<p>Alternatively, perhaps you can load the individual models and use the function API to piece it back together. </p>
<p>I have a post on the functional API scheduled, but until then, you can read about it here:<br/>
<a href="https://keras.io/getting-started/functional-api-guide/" rel="nofollow">https://keras.io/getting-started/functional-api-guide/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=411765#respond" onclick='return addComment.moveForm( "comment-411765", "411765", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-411877">
<div class="comment-container" id="li-comment-411877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d9dfadd5c4688814a033acb75d4a999e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d9dfadd5c4688814a033acb75d4a999e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jan balewski</span>
<span class="date">August 31, 2017 at 12:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-411877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot Jason !<br/>
After I switched to net = concatenate([net1,net2])   it works like a charm.<br/>
I’m attaching working toy-example. Fell free to erase my previous not-working code.<br/>
Thanks again<br/>
Jan</p>
<p>– – – – –<br/>
import yaml<br/>
from keras.layers import Dense,  LSTM, Input, concatenate<br/>
from keras.models import Model, load_model,  model_from_yaml</p>
<p>input1 = Input(shape=(10,11), name=’inp1′)<br/>
input2 = Input(shape=(20,22), name=’inp2′)<br/>
print(‘build_model inp1:’,input1.get_shape(),’ inp2:’,input2.get_shape())<br/>
net1= LSTM(60) (input1)<br/>
net2= LSTM(40) (input2)<br/>
net = concatenate([net1,net2],name=’concat-jan’)<br/>
net=Dense(30, activation=’relu’)(net)<br/>
outputs=Dense(1, activation=’sigmoid’)(net) # predicts only 0/1<br/>
model = Model(inputs=[input1,input2], outputs=outputs)<br/>
# Compile model<br/>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
model.summary() # will print</p>
<p>print(“———–  Save model as YAML ———–“)<br/>
yamlRec = model.to_yaml()<br/>
with open(‘jan.model.yaml’, ‘w’) as outfile:<br/>
    yaml.dump(yamlRec, outfile)</p>
<p>print(“———–  Read model from YAML ———–“)<br/>
with open(‘jan.model.yaml’, ‘r’) as inpfile:<br/>
    yamlRec4=yaml.load(inpfile)<br/>
model4 = model_from_yaml(yamlRec4)<br/>
model4.summary() # will print</p>
<div class="reply">
<a aria-label="Reply to jan balewski" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=411877#respond" onclick='return addComment.moveForm( "comment-411877", "411877", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-411985">
<div class="comment-container" id="li-comment-411985">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-411985" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work Jan!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=411985#respond" onclick='return addComment.moveForm( "comment-411985", "411985", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-413964">
<div class="comment-container" id="li-comment-413964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/986e539b6880b2251b6c0a11827ffe4c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/986e539b6880b2251b6c0a11827ffe4c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Azam</span>
<span class="date">September 16, 2017 at 3:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-413964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I have a five layer model. I have save the model later I want to load only the first four layers. would you plese tell me is it possible?</p>
<div class="reply">
<a aria-label="Reply to Azam" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=413964#respond" onclick='return addComment.moveForm( "comment-413964", "413964", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413999">
<div class="comment-container" id="li-comment-413999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2017 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-413999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend loading the whole model and then re-defining it with the layer you do not want removed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=413999#respond" onclick='return addComment.moveForm( "comment-413999", "413999", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414259">
<div class="comment-container" id="li-comment-414259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42dc0819fc36260be8927820c257eaff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42dc0819fc36260be8927820c257eaff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sirisha</span>
<span class="date">September 19, 2017 at 10:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have trained a CNN containing 3 convolution layers and 3 maxpooling layers for text classification. First top n words are picked from the dataset containing 1000 documents and embedding matrix is constructed for them by looking for these words in Glove embeddings and appending the corresponding word vector to if the word is found in Glove embeddings.<br/>
I tested the validation accuracy. I saved the model in h5 format.</p>
<p>Now, I want to load the model in another python file and use to predict the class label of unseen document. I used the following code<br/>
from keras.models import load_model<br/>
import keras.preprocessing.text<br/>
from keras.preprocessing.text import Tokenizer<br/>
from keras.preprocessing.sequence import pad_sequences<br/>
import numpy as np<br/>
import json</p>
<p>MAX_NUMBER_OF_WORDS= 20000<br/>
MAX_SEQUENCE_LENGTH = 1000<br/>
model1 = load_model(‘my_model.h5’)</p>
<p>f = open(‘/home/siri/Japan_Project/preprocessing/complete_data_stop_words/technology/X.txt’, encoding=’latin-1′)<br/>
text = f.read()<br/>
#print(text.shape)</p>
<p>tokenizer = Tokenizer(num_words=MAX_NUMBER_OF_WORDS)<br/>
tokenizer.fit_on_texts(text)</p>
<p>print(‘\n text = ‘)<br/>
print(text)<br/>
sequence_list = tokenizer.texts_to_sequences(text)<br/>
print(‘\n text to sequences= ‘)<br/>
print(sequence_list)</p>
<p>data = pad_sequences(sequence_list, maxlen=MAX_SEQUENCE_LENGTH)<br/>
print(data)</p>
<p>print(‘\n np.array(data)’)<br/>
print(np.array(data))<br/>
prediction = model1.predict(np.array(data))<br/>
print(prediction)</p>
<p>y_classes = prediction.argmax(axis=-1)</p>
<p>with open(‘data.json’, ‘r’) as fp:<br/>
    labels_index = json.load(fp)</p>
<p>print(y_classes)<br/>
for k, v in labels_index.items():<br/>
	print(“\n key=  “,k,”val=  “,v)</p>
<p>print(‘\n printing class label=’)<br/>
for k, v in labels_index.items():<br/>
	if y_classes[0]==v:<br/>
		print(“\n key=  “,k,”val=  “,v)</p>
<p>My doubt is I did not use word embeddings as input to model now, Instead I used numpy.array(data). Is it correct? Can we give word embeddings as input to predict function of keras.</p>
<p>I also saved the class label index (dictionary of class labels) in data.json file after training. and loaded it back in this file. to know the class label of the prediction. Is it correct?</p>
<div class="reply">
<a aria-label="Reply to sirisha" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414259#respond" onclick='return addComment.moveForm( "comment-414259", "414259", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414273">
<div class="comment-container" id="li-comment-414273">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 3:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414273" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure I follow completely.</p>
<p>Generally, word embeddings are we weights and must be saved and loaded as part of the model in the Embedding layer.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414273#respond" onclick='return addComment.moveForm( "comment-414273", "414273", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-414295">
<div class="comment-container" id="li-comment-414295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42dc0819fc36260be8927820c257eaff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42dc0819fc36260be8927820c257eaff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sirisha</span>
<span class="date">September 19, 2017 at 10:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to check if embedding layer is saved or not? If it is saved, how to give unseen text document as input to predict function?</p>
<div class="reply">
<a aria-label="Reply to sirisha" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414295#respond" onclick='return addComment.moveForm( "comment-414295", "414295", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-414324">
<div class="comment-container" id="li-comment-414324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2017 at 5:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the Embedding layer is part of the model and you save the model, then the embedding layer will be saved with the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414324#respond" onclick='return addComment.moveForm( "comment-414324", "414324", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414383">
<div class="comment-container" id="li-comment-414383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/443b604b5952e57f73b19bde325420bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/443b604b5952e57f73b19bde325420bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://machinelearningmastery.com" rel="external nofollow">Arnab Ganguly</a></span>
<span class="date">September 21, 2017 at 12:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason:</p>
<p>I am able to load weights and the model as well as the label encoder and have verified that the test set gives the same predictions with the loaded model.</p>
<p>My problem – to which I am not able to find a definitive answer even after searching – is that when a new input comes in how do I one-hot encode the categorical variables associated with this new input so that the order of the columns exactly matches the training data?</p>
<p>Without being able to do this my accuracy on a set of new inputs is approaching 10% while the validation accuracy is 89%. </p>
<p>Simple question is how to encode categorical variables so that the input data for the set of new-inputs matches the training set? Probably not a real deep learning question but without doing this my sophisticated LSTM model is just not working.</p>
<p>Help will be greatly appreciated!</p>
<div class="reply">
<a aria-label="Reply to Arnab Ganguly" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414383#respond" onclick='return addComment.moveForm( "comment-414383", "414383", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414413">
<div class="comment-container" id="li-comment-414413">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2017 at 5:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414413" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must use the same encoding as was used during training.</p>
<p>Perhaps you use your own transform code.<br/>
Perhaps you save the transform object.<br/>
Perhaps you re-create the transform when needed from training data and confirm that it is consistent.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414413#respond" onclick='return addComment.moveForm( "comment-414413", "414413", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414455">
<div class="comment-container" id="li-comment-414455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/443b604b5952e57f73b19bde325420bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/443b604b5952e57f73b19bde325420bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arnab Ganguly</span>
<span class="date">September 21, 2017 at 7:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am using pd.get_dummies to transform to a one hot encoded matrix. How do I reuse that as this is not a Label Encoder or a One Hot Encoder? My training set is 24000 rows and 5255 columns</p>
<p>When I use pd.get_dummies on 3 new items I will get a 3 rows by 6 columns matrix and this cannot be fed into the model as the model expects 5255 rows. Padding with zeros to make up the shortfall is only ruining the case and the output accuracy is ranging in 10% range while validation accuracy is 89%; during validation there is no issue as the train test split is being done AFTER the pd.get dummies has executed and turned the input X into a one hot encoded matrix. This seems to be strange problem as ALL who use the trained model for prediction will have exactly the same problem with any one hot encoded model and thus a simple solution should have been found on the net.</p>
<p>Is there a way to transform the pd.get_dummies to an encoder type object and reload and re-use the same on the real time data. That would make life very simple….</p>
<p>Do let me know.</p>
<p>Thanks<br/>
Arnab</p>
<div class="reply">
<a aria-label="Reply to Arnab Ganguly" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414455#respond" onclick='return addComment.moveForm( "comment-414455", "414455", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414490">
<div class="comment-container" id="li-comment-414490">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414490" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using the sklearn encoding over the pandas method so that you can either save the object and/or easily reverse the operation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414490#respond" onclick='return addComment.moveForm( "comment-414490", "414490", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414641">
<div class="comment-container" id="li-comment-414641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b46cf34b284fa4bfdf9e2fb2c9c7ad4a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b46cf34b284fa4bfdf9e2fb2c9c7ad4a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nirmesh</span>
<span class="date">September 23, 2017 at 5:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I am getting following error when I applied this knowledge to my code</p>
<p>##########<br/>
raceback (most recent call last):<br/>
  File “DNNrect_VC_VC_Challenge.py”, line 198, in<br/>
    model.save(path + SRC[sr] + ‘-‘ + TGT[tg] + ‘/DNNerect_25/’+str(NUTTS[nutt])+’/model.hdf5’)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py”, line 2429, in save<br/>
    save_model(self, filepath, overwrite)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/models.py”, line 109, in save_model<br/>
    topology.save_weights_to_hdf5_group(model_weights_group, model_layers)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py”, line 2708, in save_weights_to_hdf5_group<br/>
    g = f.create_group(layer.name)<br/>
  File “/usr/lib/python2.7/dist-packages/h5py/_hl/group.py”, line 41, in create_group<br/>
    gid = h5g.create(self.id, name, lcpl=lcpl)<br/>
  File “h5g.pyx”, line 145, in h5py.h5g.create (h5py/h5g.c:2536)<br/>
ValueError: unable to create group (Symbol table: Unable to initialize object)</p>
<p>#######################</p>
<p>Can you please comment what can be possible reason ?</p>
<div class="reply">
<a aria-label="Reply to Nirmesh" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414641#respond" onclick='return addComment.moveForm( "comment-414641", "414641", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414686">
<div class="comment-container" id="li-comment-414686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 24, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-414686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, the cause of the fault is not obvious.</p>
<p>Perhaps post to stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=414686#respond" onclick='return addComment.moveForm( "comment-414686", "414686", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416771">
<div class="comment-container" id="li-comment-416771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/517dc58bf45a9a4a77dde579b74c497e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/517dc58bf45a9a4a77dde579b74c497e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Srinivas BN</span>
<span class="date">October 15, 2017 at 5:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-416771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Firstly very thanks for your attempt to write this valuable blog.Very great-full to you. I have a question as follows :</p>
<p>1) I am using below code to train the data and target values to RNN using Keras for 1000000 epoch and save the trained model and weights to disk using the JSON and HDF5 as you mentioned in this blog. “This part works well”, and I am able to generate model.h5 and model.json in the same working directory. Now by using another python program in the same directory i want to use the trained model and weights, but for any values I pass to the trained model, I get the same output which I got while training. I tried to compile with new values still it didn’t help. Is there anything I can do? Here are the code that I have:</p>
<p>rnn3.py [First file that trains for 1000000 epoch]<br/>
=========================================<br/>
import numpy as np</p>
<p>from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.layers import LSTM<br/>
from keras.models import model_from_json</p>
<p>data =[688,694.5,700.95,693,665.25,658,660.4,656.5,654.8,652.9,660,642.5,<br/>
655,684,693.8,676.2,673.7,676,676,679.5,681.75,675,657,654.1,657,647.1,647.65,<br/>
651,639.95,636.95,635,635.5,640.15,636,624,629.95,632.9,622.45,630.1,625,607.4,<br/>
600,604.8,616,610.25,585,559.4,567,573,569.7,553.25,560.8,566.95,555,548.9,<br/>
554.4,558,562.3,564,557.55,562.1,564.9,565]</p>
<p>target = [691.6,682.3,690.8,697.25,691.45,661,659,660.8,652.55,649.7,649.35,654.1,639.75,654,687.1,687.65,676.4,672.9,678.95,<br/>
677.7,679.65,682.9,662.6,655.4,652.8,653,652.1,646.55,651.2,638.05,638.65,630.2,635.85,639,634.6,619.6,621.55,625.65,<br/>
625.4,631.2,623.75,596.75,604.35,605.05,616.45,600.05,575.85,559.3,569.25,572.4,567.1,551.9,561.25,565.75,552.95,548.5,<br/>
553.25,557.2,571.2,563.3,559.8,558.4,563.95]</p>
<p>#data = [688,694.5,700.95,693,665.25,658,660.4,656.5,654.8,652.9]<br/>
data = np.array(data, dtype=float)<br/>
#target = [691.6,682.3,690.8,697.25,691.45,661,659,660.8,652.55,649.7]<br/>
target = np.array(target,dtype=float)</p>
<p>data = data.reshape((1,1,len(data)))<br/>
target = target.reshape((1,1,len(target)))</p>
<p>#x_test=[688,694.5,700.95,693,665.25,658,660.4,656.5,654.8,652.9]<br/>
x_test =[688,694.5,700.95,693,665.25,658,660.4,656.5,654.8,652.9,660,642.5,<br/>
655,684,693.8,676.2,673.7,676,676,679.5,681.75,675,657,654.1,657,647.1,647.65,<br/>
651,639.95,636.95,635,635.5,640.15,636,624,629.95,632.9,622.45,630.1,625,607.4,<br/>
600,604.8,616,610.25,585,559.4,567,573,569.7,553.25,560.8,566.95,555,548.9,<br/>
554.4,558,562.3,564,557.55,562.1,564.9,565]<br/>
x_test=np.array(x_test).reshape((1,1,len(x_test)))</p>
<p>#y_test=[660,642.5,655,684,693.8,676.2,673.7,676,676,679.5]<br/>
y_test =[700.95,693,665.25,658,660.4,656.5,654.8,652.9,660,642.5,<br/>
655,684,693.8,676.2,673.7,676,676,679.5,681.75,675,657,654.1,657,647.1,647.65,<br/>
651,639.95,636.95,635,635.5,640.15,636,624,629.95,632.9,622.45,630.1,625,607.4,<br/>
600,604.8,616,610.25,585,559.4,567,573,569.7,553.25,560.8,566.95,555,548.9,<br/>
554.4,558,562.3,564,557.55,562.1,564.9,565,688,694.5]<br/>
y_test=np.array(y_test).reshape((1,1,len(y_test)))</p>
<p>model = Sequential()<br/>
model.add(LSTM(len(data),input_shape=(1,63),return_sequences=True))<br/>
model.add(Dense(63))<br/>
model.compile(loss=’mean_absolute_error’, optimizer=’adam’,metrics=[‘accuracy’])<br/>
model.fit(data,target, nb_epoch=1000000, batch_size=1, verbose=2,validation_data=(x_test,y_test))</p>
<p># serialize model to JSON<br/>
model_json = model.to_json()<br/>
with open(“model.json”, “w”) as json_file:<br/>
    json_file.write(model_json)<br/>
# serialize weights to HDF5<br/>
model.save_weights(“model.h5”)<br/>
print(“Saved model to disk”)</p>
<p># load json and create model<br/>
json_file = open(‘model.json’, ‘r’)<br/>
loaded_model_json = json_file.read()<br/>
json_file.close()<br/>
loaded_model = model_from_json(loaded_model_json)</p>
<p># load weights into new model<br/>
loaded_model.load_weights(“model.h5”)<br/>
print(“Loaded model from disk”)</p>
<p># Evaluate loaded model in test data<br/>
loaded_model.compile(loss=’binary_crossentropy’,optimizer=’rmsprop’,metrics=[‘accuracy’])<br/>
score = loaded_model.evaluate(data,target, verbose=0)<br/>
predict = loaded_model.predict(y_test)<br/>
print(predict)</p>
<p>predict = loaded_model.predict(x_test)<br/>
print(predict)</p>
<p>Output I get for rnn4.py<br/>
====================</p>
<p>[[[ 691.59997559  682.30004883  690.80004883  697.24987793  691.45007324<br/>
    661.00012207  658.99987793  660.80004883  652.55004883  649.70007324<br/>
    649.34997559  654.09997559  639.75        654.          687.09997559<br/>
    687.65002441  676.40002441  672.90002441  678.95007324  677.70007324<br/>
    679.65002441  682.90002441  662.59997559  655.40002441  652.80004883<br/>
    652.99987793  652.09997559  646.55004883  651.20007324  638.05004883<br/>
    638.65002441  630.20007324  635.84997559  639.          634.59997559<br/>
    619.59997559  621.55004883  625.65002441  625.40002441  631.20007324<br/>
    623.74987793  596.74987793  604.34997559  605.05004883  616.45007324<br/>
    600.05004883  575.84997559  559.30004883  569.25        572.40002441<br/>
    567.09997559  551.90002441  561.25012207  565.75012207  552.95007324<br/>
    548.50012207  553.24987793  557.20007324  571.20007324  563.30004883<br/>
    559.80004883  558.40002441  563.95007324]]]<br/>
[[[ 691.59997559  682.30004883  690.80004883  697.24987793  691.45007324<br/>
    661.00012207  658.99987793  660.80004883  652.55004883  649.70007324<br/>
    649.34997559  654.09997559  639.75        654.          687.09997559<br/>
    687.65002441  676.40002441  672.90002441  678.95007324  677.70007324<br/>
    679.65002441  682.90002441  662.59997559  655.40002441  652.80004883<br/>
    652.99987793  652.09997559  646.55004883  651.20007324  638.05004883<br/>
    638.65002441  630.20007324  635.84997559  639.          634.59997559<br/>
    619.59997559  621.55004883  625.65002441  625.40002441  631.20007324<br/>
    623.74987793  596.74987793  604.34997559  605.05004883  616.45007324<br/>
    600.05004883  575.84997559  559.30004883  569.25        572.40002441<br/>
    567.09997559  551.90002441  561.25012207  565.75012207  552.95007324<br/>
    548.50012207  553.24987793  557.20007324  571.20007324  563.30004883<br/>
    559.80004883  558.40002441  563.95007324]]]</p>
<p>rnn4.py [2nd file in the same directory of rnn3.py that like to reuse model.h5 and model.json]<br/>
======================================================================from keras.models import model_from_json<br/>
import numpy as np</p>
<p>#x_test =[688,694.5,700.95,693,665.25,658,660.4,656.5,654.8,652.9,660,642.5,<br/>
#655,684,693.8,676.2,673.7,676,676,679.5,681.75,675,657,654.1,657,647.1,647.65,<br/>
#651,639.95,636.95,635,635.5,640.15,636,624,629.95,632.9,622.45,630.1,625,607.4,<br/>
#600,604.8,616,610.25,585,559.4,567,573,569.7,553.25,560.8,566.95,555,548.9,<br/>
#554.4,558,562.3,564,557.55,562.1,564.9,565]</p>
<p>x_test =[[i for i in range(63)]]</p>
<p>x_test=np.array(x_test).reshape((1,1,63))</p>
<p># load json and create model<br/>
json_file = open(‘model.json’, ‘r’)<br/>
loaded_model_json = json_file.read()<br/>
json_file.close()<br/>
loaded_model = model_from_json(loaded_model_json)</p>
<p># load weights into new model<br/>
loaded_model.load_weights(“model.h5”)<br/>
print(“Loaded model from disk”)</p>
<p>loaded_model.compile(loss=’binary_crossentropy’,optimizer=’rmsprop’,metrics=[‘accuracy’])<br/>
predict = loaded_model.predict(x_test)<br/>
print(predict)</p>
<p>Output I get for rnn4.py<br/>
==================</p>
<p>[[[ 691.59997559  682.30004883  690.80004883  697.24987793  691.45007324<br/>
    661.00012207  658.99987793  660.80004883  652.55004883  649.70007324<br/>
    649.34997559  654.09997559  639.75        654.          687.09997559<br/>
    687.65002441  676.40002441  672.90002441  678.95007324  677.70007324<br/>
    679.65002441  682.90002441  662.59997559  655.40002441  652.80004883<br/>
    652.99987793  652.09997559  646.55004883  651.20007324  638.05004883<br/>
    638.65002441  630.20007324  635.84997559  639.          634.59997559<br/>
    619.59997559  621.55004883  625.65002441  625.40002441  631.20007324<br/>
    623.74987793  596.74987793  604.34997559  605.05004883  616.45007324<br/>
    600.05004883  575.84997559  559.30004883  569.25        572.40002441<br/>
    567.09997559  551.90002441  561.25012207  565.75012207  552.95007324<br/>
    548.50012207  553.24987793  557.20007324  571.20007324  563.30004883<br/>
    559.80004883  558.40002441  563.95007324]]]</p>
<p>Problem<br/>
========<br/>
For different input values we expect different output values after recompiling. Why do we get same output of any input values?</p>
<div class="reply">
<a aria-label="Reply to Srinivas BN" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=416771#respond" onclick='return addComment.moveForm( "comment-416771", "416771", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416833">
<div class="comment-container" id="li-comment-416833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 16, 2017 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-416833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The output of the network should be specific (contingent) to the input provided when making a prediction.</p>
<p>If this is not the case, then perhaps your model has overfit the training data?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=416833#respond" onclick='return addComment.moveForm( "comment-416833", "416833", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-416894">
<div class="comment-container" id="li-comment-416894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/517dc58bf45a9a4a77dde579b74c497e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/517dc58bf45a9a4a77dde579b74c497e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Srinivas BN</span>
<span class="date">October 16, 2017 at 5:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-416894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Brownlee,</p>
<p>Thanks for the quick reply. I was not able to understand “output of the network should be specific (contingent) to the input provided ” Could you explain it more..Perhaps i dint get the context correctly</p>
<div class="reply">
<a aria-label="Reply to Srinivas BN" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=416894#respond" onclick='return addComment.moveForm( "comment-416894", "416894", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-416973">
<div class="comment-container" id="li-comment-416973">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2017 at 5:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-416973" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It suggests that there is a problem with your network as different input should give different output.</p>
<p>I don’t know what the problem could be, I don’t have the capacity to debug your code. Perhaps one of these resources will help:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=416973#respond" onclick='return addComment.moveForm( "comment-416973", "416973", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419464">
<div class="comment-container" id="li-comment-419464">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/472a7fcae2067a7e55fe76a01a4af8b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/472a7fcae2067a7e55fe76a01a4af8b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Falgun</span>
<span class="date">November 9, 2017 at 5:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-419464" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the amazing post. Really helps people who are new to ML.</p>
<p>I am trying to run the below code</p>
<p>model_json = model.to_json()<br/>
with open(“model.json”, “w”) as json_file:<br/>
    json_file.write(model_json)</p>
<p> getting the error as ‘NameError: name ‘model’ is not defined’</p>
<p>Can you help ?</p>
<div class="reply">
<a aria-label="Reply to Falgun" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=419464#respond" onclick='return addComment.moveForm( "comment-419464", "419464", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419498">
<div class="comment-container" id="li-comment-419498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2017 at 10:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-419498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>“model” will be the variable for your trained model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=419498#respond" onclick='return addComment.moveForm( "comment-419498", "419498", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419859">
<div class="comment-container" id="li-comment-419859">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/226a8516dc4c768cabebc66dfba18f78?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/226a8516dc4c768cabebc66dfba18f78?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Santanu Dutta</span>
<span class="date">November 13, 2017 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-419859" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Fantastic post. I could save and retrieve in local. But in AWS lambda facing a problem of loading weights because of HDF5 format. Can you please suggest any resolution or work around for the same.</p>
<div class="reply">
<a aria-label="Reply to Santanu Dutta" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=419859#respond" onclick='return addComment.moveForm( "comment-419859", "419859", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419882">
<div class="comment-container" id="li-comment-419882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-419882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that. I would have expected h5 format to be cross-platform. I believe it is.</p>
<p>Perhaps it is a Python 2 vs Python 3 issue.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=419882#respond" onclick='return addComment.moveForm( "comment-419882", "419882", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419975">
<div class="comment-container" id="li-comment-419975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/453e85572b3b2d9afdf60437c17265f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/453e85572b3b2d9afdf60437c17265f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SHEKINA</span>
<span class="date">November 14, 2017 at 6:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-419975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sir,<br/>
 plz explain the python code for feature selection using meta heuristic algorithms like firefly algorithm,particle swarm optimization,brain storm optimization etc…</p>
<div class="reply">
<a aria-label="Reply to SHEKINA" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=419975#respond" onclick='return addComment.moveForm( "comment-419975", "419975", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420040">
<div class="comment-container" id="li-comment-420040">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-420040" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion, I hope to cover the topic in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=420040#respond" onclick='return addComment.moveForm( "comment-420040", "420040", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-423088">
<div class="comment-container" id="li-comment-423088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57c01fe2e5bf39fd13144b1198447e6b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57c01fe2e5bf39fd13144b1198447e6b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">HyunWoo Cho</span>
<span class="date">December 14, 2017 at 4:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-423088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Should I compile the model for evaluation, after load model and weights</p>
<div class="reply">
<a aria-label="Reply to HyunWoo Cho" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=423088#respond" onclick='return addComment.moveForm( "comment-423088", "423088", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423146">
<div class="comment-container" id="li-comment-423146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2017 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-423146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No need to compile after loading any more I believe, the API has changed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=423146#respond" onclick='return addComment.moveForm( "comment-423146", "423146", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425436">
<div class="comment-container" id="li-comment-425436">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shabnam</span>
<span class="date">January 2, 2018 at 5:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-425436" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for your post. I have a question.<br/>
Is there any similar method to have an output file indicating that a model is compiled? Each time that I run my file, it takes time to compile the model and then fit and evaluate the data. I want to change parameters/variables/hyperparameters and run the file again, so I want to have speed up as mush as possible.</p>
<div class="reply">
<a aria-label="Reply to Shabnam" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=425436#respond" onclick='return addComment.moveForm( "comment-425436", "425436", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425473">
<div class="comment-container" id="li-comment-425473">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-425473" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe you don’t need to compile the model any longer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=425473#respond" onclick='return addComment.moveForm( "comment-425473", "425473", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425555">
<div class="comment-container" id="li-comment-425555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2e867274084c56bfd3ee8dffb9d92b52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2e867274084c56bfd3ee8dffb9d92b52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Edoardo</span>
<span class="date">January 4, 2018 at 3:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-425555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for the invaluable help this blog provides developers,</p>
<p>I am facing the same problem as @Lotem above.</p>
<p>I have one script which builds a model (accuracy 60%)  and saves it in a different directory.<br/>
However, when I load the model back into another script the accuracy decreases to 55%, the predicted values are different. </p>
<p>I have checked the weights and they are the same, </p>
<p>I have set: </p>
<p>from numpy.random import seed<br/>
seed(1)<br/>
from tensorflow import set_random_seed<br/>
set_random_seed(2)</p>
<p>for both files, but I still cannot get the loaded model to give the same accuracy.<br/>
I should also mention that the dataset contains the same features. </p>
<p>Any help would be much appreciated as I have been going round in circles having a look at:</p>
<p><a href="https://github.com/keras-team/keras/issues/4875" rel="nofollow">https://github.com/keras-team/keras/issues/4875</a><br/>
<a href="https://github.com/keras-team/keras/issues/7676" rel="nofollow">https://github.com/keras-team/keras/issues/7676</a></p>
<p>If possible, could you post an example where you save a model and load it in different sessions?<br/>
Thank you again</p>
<div class="reply">
<a aria-label="Reply to Edoardo" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=425555#respond" onclick='return addComment.moveForm( "comment-425555", "425555", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425585">
<div class="comment-container" id="li-comment-425585">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-425585" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting, I have not had this problem myself.</p>
<p>Some ideas to explore:</p>
<p>– Are you able to replicate the same fault on a different machine? e.g. on AWS?<br/>
– Are all of your libraries up to date.<br/>
– Are you saving weights and topology to a single file or separate files?<br/>
– Are you 100% sure the data used to evaluate the model before/after saving is identical?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=425585#respond" onclick='return addComment.moveForm( "comment-425585", "425585", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426846">
<div class="comment-container" id="li-comment-426846">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41a96dd5f19f68404134513fbb656f2a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41a96dd5f19f68404134513fbb656f2a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tarun Madan</span>
<span class="date">January 18, 2018 at 11:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-426846" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, the tutorial is very helpful. </p>
<p>However, there is one question that I have. I trained a LSTM model for sequence classification problem and observed the following.</p>
<p>Within the same python session as the one where model is trained, I get the exact results (loss, accuracy, predicted probabilities) from the loaded_model (using json format). But, in a new python session the results are not exactly the same but are very close. </p>
<p>Can you please help me understand what could be the possible reason for slightly different results? Is there any other random_seed that needs to be fixed for exact match of the results?</p>
<p>Looking forward to your response.</p>
<p>Thanks,<br/>
Tarun</p>
<div class="reply">
<a aria-label="Reply to Tarun Madan" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=426846#respond" onclick='return addComment.moveForm( "comment-426846", "426846", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426880">
<div class="comment-container" id="li-comment-426880">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/#comment-426880" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There must be some randomness related to the internal state.</p>
<p>I don’t know for sure. Interesting finding!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/?replytocom=426880#respond" onclick='return addComment.moveForm( "comment-426880", "426880", "respond", "2573" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/save-load-keras-deep-learning-models/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2573"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="a0a2d0aa10"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="141"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>