<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>Regression Tutorial with the Keras Deep Learning Library in Python - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Regression Tutorial with the Keras Deep Learning Library in Python - Machine Learning Mastery" property="og:title"/>
<meta content="Keras is a deep learning library that wraps the efficient numerical libraries Theano and TensorFlow. In this post you will discover how to develop and evaluate neural network models using Keras for a regression problem. After completing this step-by-step tutorial, you will know: How to load a CSV dataset and make it available to Keras. How …" property="og:description"/>
<meta content="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-06-09T05:00:35+11:00" property="article:published_time"/>
<meta content="2017-03-31T08:13:07+11:00" property="article:modified_time"/>
<meta content="2017-03-31T08:13:07+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="425" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/regression-tutorial-keras-deep-learning-library-python\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/feed/" rel="alternate" title="Machine Learning Mastery » Regression Tutorial with the Keras Deep Learning Library in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2571" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fregression-tutorial-keras-deep-learning-library-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fregression-tutorial-keras-deep-learning-library-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2571 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2571 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Regression Tutorial with the Keras Deep Learning Library in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-09T05:00:35+1100">June 9, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fregression-tutorial-keras-deep-learning-library-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/&amp;summary=Keras+is+a+deep+learning+library+that+wraps+the+efficient+numerical+libraries+Theano+and+TensorFlow...." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/&amp;summary=Keras+is+a+deep+learning+library+that+wraps+the+efficient+numerical+libraries+Theano+and+TensorFlow....');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Keras is a deep learning library that wraps the efficient numerical libraries Theano and TensorFlow.</p>
<p>In this post you will discover how to develop and evaluate neural network models using Keras for a regression problem.</p>
<p>After completing this step-by-step tutorial, you will know:</p>
<ul>
<li>How to load a CSV dataset and make it available to Keras.</li>
<li>How to create a neural network model with Keras for a regression problem.</li>
<li>How to use scikit-learn with Keras to evaluate models using cross-validation.</li>
<li>How to perform data preparation in order to improve skill with Keras models.</li>
<li>How to tune the network topology of models with Keras.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2572" style="max-width: 650px"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="size-full wp-image-2572" height="425" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-300x199.jpg 300w" width="640"/><p class="wp-caption-text">Regression Tutorial with Keras Deep Learning Library in Python<br/>Photo by <a href="https://www.flickr.com/photos/salimfadhley/130295135/">Salim Fadhley</a>, some rights reserved.</p></div>
<h2>1. Problem Description</h2>
<p>The problem that we will look at in this tutorial is the <a href="https://archive.ics.uci.edu/ml/datasets/Housing">Boston house price dataset</a>.</p>
<p>You can <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data">download this dataset</a> and save it to your current working directly with the file name housing.csv.</p>
<p>The dataset describes 13 numerical properties of houses in Boston suburbs and is concerned with modeling the price of houses in those suburbs in thousands of dollars. As such, this is a regression predictive modeling problem. Input attributes include things like crime rate, proportion of nonretail business acres, chemical concentrations and more.</p>
<p>This is a well-studied problem in machine learning. It is convenient to work with because all of the input and output attributes are numerical and there are 506 instances to work with.</p>
<p>Reasonable performance for models evaluated using Mean Squared Error (MSE) are around 20 in squared thousands of dollars (or $4,500 if you take the square root). This is a nice target to aim for with our neural network model.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>2. Develop a Baseline Neural Network Model</h2>
<p>In this section we will create a baseline neural network model for the regression problem.</p>
<p>Let’s start off by including all of the functions and objects we will need for this tutorial.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593462329b538110154" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import numpy
import pandas
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasRegressor
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import KFold
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593462329b538110154-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593462329b538110154-2">2</div><div class="crayon-num" data-line="crayon-5a6593462329b538110154-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593462329b538110154-4">4</div><div class="crayon-num" data-line="crayon-5a6593462329b538110154-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593462329b538110154-6">6</div><div class="crayon-num" data-line="crayon-5a6593462329b538110154-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593462329b538110154-8">8</div><div class="crayon-num" data-line="crayon-5a6593462329b538110154-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593462329b538110154-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593462329b538110154-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5a6593462329b538110154-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593462329b538110154-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5a6593462329b538110154-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593462329b538110154-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5a6593462329b538110154-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593462329b538110154-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5a6593462329b538110154-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-v">Pipeline</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can now load our dataset from a file in the local directory.</p>
<p>The dataset is in fact not in CSV format in the UCI Machine Learning Repository, the attributes are instead separated by whitespace. We can load this easily using the pandas library. We can then split the input (X) and output (Y) attributes so that they are easier to model with Keras and scikit-learn.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232a6306283078" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load dataset
dataframe = pandas.read_csv("housing.csv", delim_whitespace=True, header=None)
dataset = dataframe.values
# split into input (X) and output (Y) variables
X = dataset[:,0:13]
Y = dataset[:,13]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232a6306283078-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a6306283078-2">2</div><div class="crayon-num" data-line="crayon-5a659346232a6306283078-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a6306283078-4">4</div><div class="crayon-num" data-line="crayon-5a659346232a6306283078-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a6306283078-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232a6306283078-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a6306283078-2"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"housing.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delim_whitespace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232a6306283078-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a6306283078-4"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5a659346232a6306283078-5"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">13</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a6306283078-6"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can create Keras models and evaluate them with scikit-learn by using handy wrapper objects provided by the Keras library. This is desirable, because scikit-learn excels at evaluating models and will allow us to use powerful data preparation and model evaluation schemes with very few lines of code.</p>
<p>The Keras wrappers require a function as an argument. This function that we must define is responsible for creating the neural network model to be evaluated.</p>
<p>Below we define the function to create the baseline model to be evaluated. It is a simple model that has a single fully connected hidden layer with the same number of neurons as input attributes (13). The network uses good practices such as the rectifier activation function for the hidden layer. No activation function is used for the output layer because it is a regression problem and we are interested in predicting numerical values directly without transform.</p>
<p>The efficient ADAM optimization algorithm is used and a mean squared error loss function is optimized. This will be the same metric that we will use to evaluate the performance of the model. It is a desirable metric because by taking the square root gives us an error value we can directly understand in the context of the problem (thousands of dollars).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232a9997717496" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define base model
def baseline_model():
	# create model
	model = Sequential()
	model.add(Dense(13, input_dim=13, kernel_initializer='normal', activation='relu'))
	model.add(Dense(1, kernel_initializer='normal'))
	# Compile model
	model.compile(loss='mean_squared_error', optimizer='adam')
	return model</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232a9997717496-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a9997717496-2">2</div><div class="crayon-num" data-line="crayon-5a659346232a9997717496-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a9997717496-4">4</div><div class="crayon-num" data-line="crayon-5a659346232a9997717496-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a9997717496-6">6</div><div class="crayon-num" data-line="crayon-5a659346232a9997717496-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232a9997717496-8">8</div><div class="crayon-num" data-line="crayon-5a659346232a9997717496-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232a9997717496-1"><span class="crayon-p"># define base model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a9997717496-2"><span class="crayon-e">def </span><span class="crayon-e">baseline_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659346232a9997717496-3"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a9997717496-4"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232a9997717496-5"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a9997717496-6"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232a9997717496-7"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232a9997717496-8"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232a9997717496-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The Keras wrapper object for use in scikit-learn as a regression estimator is called KerasRegressor. We create an instance and pass it both the name of the function to create the neural network model as well as some parameters to pass along to the fit() function of the model later, such as the number of epochs and batch size. Both of these are set to sensible defaults.</p>
<p>We also initialize the random number generator with a constant random seed, a process we will repeat for each model evaluated in this tutorial. This is an attempt to ensure we compare models consistently.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232ac247070808" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# evaluate model with standardized dataset
estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232ac247070808-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ac247070808-2">2</div><div class="crayon-num" data-line="crayon-5a659346232ac247070808-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ac247070808-4">4</div><div class="crayon-num" data-line="crayon-5a659346232ac247070808-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232ac247070808-1"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ac247070808-2"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a659346232ac247070808-3"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ac247070808-4"><span class="crayon-p"># evaluate model with standardized dataset</span></div><div class="crayon-line" id="crayon-5a659346232ac247070808-5"><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">baseline_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The final step is to evaluate this baseline model. We will use 10-fold cross validation to evaluate the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232b0963508752" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
kfold = KFold(n_splits=10, random_state=seed)
results = cross_val_score(estimator, X, Y, cv=kfold)
print("Results: %.2f (%.2f) MSE" % (results.mean(), results.std()))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232b0963508752-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232b0963508752-2">2</div><div class="crayon-num" data-line="crayon-5a659346232b0963508752-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232b0963508752-1"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232b0963508752-2"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232b0963508752-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Results: %.2f (%.2f) MSE"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Running this code gives us an estimate of the model’s performance on the problem for unseen data. The result reports the mean squared error including the average and standard deviation (average variance) across all 10 folds of the cross validation evaluation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232b7820434283" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Baseline: 31.64 (26.82) MSE</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232b7820434283-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232b7820434283-1">Baseline: 31.64 (26.82) MSE</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>3. Modeling The Standardized Dataset</h2>
<p>An important concern with the Boston house price dataset is that the input attributes all vary in their scales because they measure different quantities.</p>
<p>It is almost always good practice to prepare your data before modeling it using a neural network model.</p>
<p>Continuing on from the above baseline model, we can re-evaluate the same model using a standardized version of the input dataset.</p>
<p>We can use scikit-learn’s <a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">Pipeline</a> framework to perform the standardization during the model evaluation process, within each fold of the cross validation. This ensures that there is no data leakage from each testset cross validation fold into the training data.</p>
<p>The code below creates a scikit-learn Pipeline that first standardizes the dataset then creates and evaluate the baseline neural network model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232ba956525197" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate model with standardized dataset
numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasRegressor(build_fn=baseline_model, epochs=50, batch_size=5, verbose=0)))
pipeline = Pipeline(estimators)
kfold = KFold(n_splits=10, random_state=seed)
results = cross_val_score(pipeline, X, Y, cv=kfold)
print("Standardized: %.2f (%.2f) MSE" % (results.mean(), results.std()))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232ba956525197-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ba956525197-2">2</div><div class="crayon-num" data-line="crayon-5a659346232ba956525197-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ba956525197-4">4</div><div class="crayon-num" data-line="crayon-5a659346232ba956525197-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ba956525197-6">6</div><div class="crayon-num" data-line="crayon-5a659346232ba956525197-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ba956525197-8">8</div><div class="crayon-num" data-line="crayon-5a659346232ba956525197-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232ba956525197-1"><span class="crayon-p"># evaluate model with standardized dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ba956525197-2"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ba956525197-3"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ba956525197-4"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ba956525197-5"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">baseline_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ba956525197-6"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ba956525197-7"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ba956525197-8"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ba956525197-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Standardized: %.2f (%.2f) MSE"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Running the example provides an improved performance over the baseline model without standardized data, dropping the error.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232bc307498079" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Standardized: 29.54 (27.87) MSE</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232bc307498079-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232bc307498079-1">Standardized: 29.54 (27.87) MSE</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A further extension of this section would be to similarly apply a rescaling to the output variable such as normalizing it to the range of 0-1 and use a Sigmoid or similar activation function on the output layer to narrow output predictions to the same range.</p>
<h2>4. Tune The Neural Network Topology</h2>
<p>There are many concerns that can be optimized for a neural network model.</p>
<p>Perhaps the point of biggest leverage is the structure of the network itself, including the number of layers and the number of neurons in each layer.</p>
<p>In this section we will evaluate two additional network topologies in an effort to further improve the performance of the model. We will look at both a deeper and a wider network topology.</p>
<h3>4.1. Evaluate a Deeper Network Topology</h3>
<p>One way to improve the performance a neural network is to add more layers. This might allow the model to extract and recombine higher order features embedded in the data.</p>
<p>In this section we will evaluate the effect of adding one more hidden layer to the model. This is as easy as defining a new function that will create this deeper model, copied from our baseline model above. We can then insert a new line after the first hidden layer. In this case with about half the number of neurons.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232c0688524918" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define the model
def larger_model():
	# create model
	model = Sequential()
	model.add(Dense(13, input_dim=13, kernel_initializer='normal', activation='relu'))
	model.add(Dense(6, kernel_initializer='normal', activation='relu'))
	model.add(Dense(1, kernel_initializer='normal'))
	# Compile model
	model.compile(loss='mean_squared_error', optimizer='adam')
	return model</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232c0688524918-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c0688524918-2">2</div><div class="crayon-num" data-line="crayon-5a659346232c0688524918-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c0688524918-4">4</div><div class="crayon-num" data-line="crayon-5a659346232c0688524918-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c0688524918-6">6</div><div class="crayon-num" data-line="crayon-5a659346232c0688524918-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c0688524918-8">8</div><div class="crayon-num" data-line="crayon-5a659346232c0688524918-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c0688524918-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232c0688524918-1"><span class="crayon-p"># define the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c0688524918-2"><span class="crayon-e">def </span><span class="crayon-e">larger_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659346232c0688524918-3"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c0688524918-4"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232c0688524918-5"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c0688524918-6"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232c0688524918-7"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c0688524918-8"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5a659346232c0688524918-9"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c0688524918-10"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Our network topology now looks like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232c2591845380" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
13 inputs -&gt; [13 -&gt; 6] -&gt; 1 output</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232c2591845380-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232c2591845380-1">13 inputs -&gt; [13 -&gt; 6] -&gt; 1 output</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can evaluate this network topology in the same way as above, whilst also using the standardization of the dataset that above was shown to improve performance.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232c5070354133" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasRegressor(build_fn=larger_model, epochs=50, batch_size=5, verbose=0)))
pipeline = Pipeline(estimators)
kfold = KFold(n_splits=10, random_state=seed)
results = cross_val_score(pipeline, X, Y, cv=kfold)
print("Larger: %.2f (%.2f) MSE" % (results.mean(), results.std()))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232c5070354133-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c5070354133-2">2</div><div class="crayon-num" data-line="crayon-5a659346232c5070354133-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c5070354133-4">4</div><div class="crayon-num" data-line="crayon-5a659346232c5070354133-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c5070354133-6">6</div><div class="crayon-num" data-line="crayon-5a659346232c5070354133-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232c5070354133-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232c5070354133-1"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c5070354133-2"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659346232c5070354133-3"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c5070354133-4"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">larger_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232c5070354133-5"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c5070354133-6"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232c5070354133-7"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232c5070354133-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Larger: %.2f (%.2f) MSE"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running this model does show a further improvement in performance from 28 down to 24 thousand squared dollars.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232c7804634921" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Larger: 22.83 (25.33) MSE</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232c7804634921-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232c7804634921-1">Larger: 22.83 (25.33) MSE</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h3>4.2. Evaluate a Wider Network Topology</h3>
<p>Another approach to increasing the representational capability of the model is to create a wider network.</p>
<p>In this section we evaluate the effect of keeping a shallow network architecture and nearly doubling the number of neurons in the one hidden layer.</p>
<p>Again, all we need to do is define a new function that creates our neural network model. Here, we have increased the number of neurons in the hidden layer compared to the baseline model from 13 to 20.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232ca858332832" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define wider model
def wider_model():
	# create model
	model = Sequential()
	model.add(Dense(20, input_dim=13, kernel_initializer='normal', activation='relu'))
	model.add(Dense(1, kernel_initializer='normal'))
	# Compile model
	model.compile(loss='mean_squared_error', optimizer='adam')
	return model</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232ca858332832-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ca858332832-2">2</div><div class="crayon-num" data-line="crayon-5a659346232ca858332832-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ca858332832-4">4</div><div class="crayon-num" data-line="crayon-5a659346232ca858332832-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ca858332832-6">6</div><div class="crayon-num" data-line="crayon-5a659346232ca858332832-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ca858332832-8">8</div><div class="crayon-num" data-line="crayon-5a659346232ca858332832-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232ca858332832-1"><span class="crayon-p"># define wider model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ca858332832-2"><span class="crayon-e">def </span><span class="crayon-e">wider_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a659346232ca858332832-3"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ca858332832-4"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ca858332832-5"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ca858332832-6"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ca858332832-7"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ca858332832-8"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ca858332832-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Our network topology now looks like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232cc877562831" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
13 inputs -&gt; [20] -&gt; 1 output</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232cc877562831-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232cc877562831-1">13 inputs -&gt; [20] -&gt; 1 output</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can evaluate the wider network topology using the same scheme as above:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232ce644616648" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasRegressor(build_fn=wider_model, epochs=100, batch_size=5, verbose=0)))
pipeline = Pipeline(estimators)
kfold = KFold(n_splits=10, random_state=seed)
results = cross_val_score(pipeline, X, Y, cv=kfold)
print("Wider: %.2f (%.2f) MSE" % (results.mean(), results.std()))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232ce644616648-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ce644616648-2">2</div><div class="crayon-num" data-line="crayon-5a659346232ce644616648-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ce644616648-4">4</div><div class="crayon-num" data-line="crayon-5a659346232ce644616648-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ce644616648-6">6</div><div class="crayon-num" data-line="crayon-5a659346232ce644616648-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a659346232ce644616648-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232ce644616648-1"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ce644616648-2"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a659346232ce644616648-3"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ce644616648-4"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">wider_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ce644616648-5"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ce644616648-6"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a659346232ce644616648-7"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a659346232ce644616648-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Wider: %.2f (%.2f) MSE"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Building the model does see a further drop in error to about 21 thousand squared dollars. This is not a bad result for this problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346232d2829706786" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Wider: 21.64 (23.75) MSE</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346232d2829706786-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346232d2829706786-1">Wider: 21.64 (23.75) MSE</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>It would have been hard to guess that a wider network would outperform a deeper network on this problem. The results demonstrate the importance of empirical testing when it comes to developing neural network models.</p>
<h2>Summary</h2>
<p>In this post you discovered the Keras deep learning library for modeling regression problems.</p>
<p>Through this tutorial you learned how to develop and evaluate neural network models, including:</p>
<ul>
<li>How to load data and develop a baseline model.</li>
<li>How to lift performance using data preparation techniques like standardization.</li>
<li>How to design and evaluate networks with different varying topologies on a problem.</li>
</ul>
<p>Do you have any questions about the Keras deep learning library or about this post? Ask your questions in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fregression-tutorial-keras-deep-learning-library-python%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/&amp;summary=Keras+is+a+deep+learning+library+that+wraps+the+efficient+numerical+libraries+Theano+and+TensorFlow...." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=Regression%20Tutorial%20with%20the%20Keras%20Deep%20Learning%20Library%20in%20Python&amp;url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/&amp;summary=Keras+is+a+deep+learning+library+that+wraps+the+efficient+numerical+libraries+Theano+and+TensorFlow....');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/save-load-machine-learning-models-python-scikit-learn/" rel="prev"><i class="fa fa-angle-left"></i> Save and Load Machine Learning Models in Python with scikit-learn</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" rel="next">Your First Machine Learning Project in Python Step-By-Step <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">281 Responses to <em>Regression Tutorial with the Keras Deep Learning Library in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-354964">
<div class="comment-container" id="li-comment-354964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38d7171fa26644bad4bf3e892aedd22a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38d7171fa26644bad4bf3e892aedd22a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://test" rel="external nofollow">Gautam Karmakar</a></span>
<span class="date">June 25, 2016 at 4:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-354964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi did you handle string variables in cross_val_score module?</p>
<div class="reply">
<a aria-label="Reply to Gautam Karmakar" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=354964#respond" onclick='return addComment.moveForm( "comment-354964", "354964", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-355031">
<div class="comment-container" id="li-comment-355031">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 26, 2016 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-355031" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The dataset is numeric, no string values.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=355031#respond" onclick='return addComment.moveForm( "comment-355031", "355031", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422522">
<div class="comment-container" id="li-comment-422522">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/24d098b77d25bffb16720c440f628869?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24d098b77d25bffb16720c440f628869?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ramya</span>
<span class="date">December 9, 2017 at 2:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422522" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How do we handle string values</p>
<div class="reply">
<a aria-label="Reply to Ramya" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422522#respond" onclick='return addComment.moveForm( "comment-422522", "422522", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422542">
<div class="comment-container" id="li-comment-422542">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422542" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, I have a whole section on the topic:<br/>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow">https://machinelearningmastery.com/start-here/#nlp</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422542#respond" onclick='return addComment.moveForm( "comment-422542", "422542", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-422839">
<div class="comment-container" id="li-comment-422839">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a8053c7f90023cacda715f9af8dbd34?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a8053c7f90023cacda715f9af8dbd34?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Erika</span>
<span class="date">December 12, 2017 at 7:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422839" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One hot encoder is an option.</p>
<div class="reply">
<a aria-label="Reply to Erika" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422839#respond" onclick='return addComment.moveForm( "comment-422839", "422839", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-355345">
<div class="comment-container" id="li-comment-355345">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c992a86d6bd1239fcdb56bdaa39d35ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c992a86d6bd1239fcdb56bdaa39d35ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">June 30, 2016 at 2:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-355345" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great tutorial(s) they have been very helpful as a crash course for me so far.</p>
<p>Is there a way to have the model output the estimated Ys in this example?  I would like to evaluate the model a little more directly while I’m still learning Keras.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=355345#respond" onclick='return addComment.moveForm( "comment-355345", "355345", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-355359">
<div class="comment-container" id="li-comment-355359">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2016 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-355359" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Paul, you can make predictions by calling model.predict()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=355359#respond" onclick='return addComment.moveForm( "comment-355359", "355359", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-371550">
<div class="comment-container" id="li-comment-371550">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa6f200c29de5ca9917b625a75398a8d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa6f200c29de5ca9917b625a75398a8d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahul</span>
<span class="date">November 22, 2016 at 7:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371550" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Paul,<br/>
              How are you inserting the function model.predict() in the above code to run in on test data? Please let me know.</p>
<div class="reply">
<a aria-label="Reply to Rahul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=371550#respond" onclick='return addComment.moveForm( "comment-371550", "371550", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-399190">
<div class="comment-container" id="li-comment-399190">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c638c10f592cd6dbabbb3d1d22cff2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c638c10f592cd6dbabbb3d1d22cff2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.PuneetMathur.in" rel="external nofollow">DataScientistPM</a></span>
<span class="date">May 9, 2017 at 11:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399190" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Is this how you insert predict and then get predictions in the model?</p>
<p>def mymodel():<br/>
    model = Sequential()<br/>
    model.add(Dense(13, input_dim=13, kernel_initializer=’normal’, activation=’relu’))<br/>
    model.add(Dense(6, kernel_initializer=’normal’, activation=’relu’))<br/>
    model.add(Dense(1, kernel_initializer=’normal’))<br/>
    model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br/>
    model.fit(X,y, nb_epoch=50, batch_size=5)<br/>
    predictions = model.predict(X)<br/>
    return model</p>
<p>I actually want to write the predictions in a file?</p>
<div class="reply">
<a aria-label="Reply to DataScientistPM" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399190#respond" onclick='return addComment.moveForm( "comment-399190", "399190", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-357759">
<div class="comment-container" id="li-comment-357759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8541cab0c8aec1819f95f2980684ef9e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8541cab0c8aec1819f95f2980684ef9e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">July 23, 2016 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-357759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Great post thank you, Could you please give a sample on how to use Keras LSTM layer for considering time impact on this dataset ?<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=357759#respond" onclick='return addComment.moveForm( "comment-357759", "357759", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-357784">
<div class="comment-container" id="li-comment-357784">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 23, 2016 at 1:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-357784" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Chris.</p>
<p>You can see an example of LSTMs on this dataset here:<br/>
<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=357784#respond" onclick='return addComment.moveForm( "comment-357784", "357784", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-357999">
<div class="comment-container" id="li-comment-357999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8541cab0c8aec1819f95f2980684ef9e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8541cab0c8aec1819f95f2980684ef9e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">July 25, 2016 at 9:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-357999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That was Awesome, thank you Json.</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=357999#respond" onclick='return addComment.moveForm( "comment-357999", "357999", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-358046">
<div class="comment-container" id="li-comment-358046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2016 at 5:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome Chris.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358046#respond" onclick='return addComment.moveForm( "comment-358046", "358046", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-358204">
<div class="comment-container" id="li-comment-358204">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c3db7daeba4febe8a556a5b71522038b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c3db7daeba4febe8a556a5b71522038b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marc Huertas-Company</span>
<span class="date">July 28, 2016 at 4:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358204" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thanks for the tutorial. I have a regression problem with bounded outputs (0-1). Is there an opitmal way to deal with this?<br/>
Thanks!<br/>
Marc</p>
<div class="reply">
<a aria-label="Reply to Marc Huertas-Company" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358204#respond" onclick='return addComment.moveForm( "comment-358204", "358204", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-358208">
<div class="comment-container" id="li-comment-358208">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 28, 2016 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358208" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Marc, I think a linear activation function on the output layer will be just fun.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358208#respond" onclick='return addComment.moveForm( "comment-358208", "358208", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-358900">
<div class="comment-container" id="li-comment-358900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/78d28afd985c1d1f870f16f83248155e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/78d28afd985c1d1f870f16f83248155e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James</span>
<span class="date">August 5, 2016 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a good example. However, it is not relevant to Neural networks when over-fitting is  considered. The validation process should be included inside the fit() function to monitor over-fitting status. Moreover, early stopping can be used based on the internal validation step. This example is only applicable for large data compared to the number of all weights of input and hidden nodes.</p>
<div class="reply">
<a aria-label="Reply to James" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358900#respond" onclick='return addComment.moveForm( "comment-358900", "358900", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-358908">
<div class="comment-container" id="li-comment-358908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 5, 2016 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great feedback, thanks James I agree. </p>
<p>It is intended as a good example to show how to develop a net for regression, but the dataset is indeed a bit small.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358908#respond" onclick='return addComment.moveForm( "comment-358908", "358908", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-368046">
<div class="comment-container" id="li-comment-368046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/76fe1ffc07868fa96d7ba574191fda93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/76fe1ffc07868fa96d7ba574191fda93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amir</span>
<span class="date">October 24, 2016 at 11:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-368046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason and James! A few questions (and also how to implement in python):<br/>
1) How can we monitor the over-fitting status in deep learning<br/>
2) how can we include the cross-validation process inside the fit() function to monitor the over-fitting status<br/>
3) How can we use early stopping based on the internal validation step<br/>
4) Why is this example only applicable for a large data set? What should we do if  the data set is small?</p>
<div class="reply">
<a aria-label="Reply to Amir" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=368046#respond" onclick='return addComment.moveForm( "comment-368046", "368046", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-368131">
<div class="comment-container" id="li-comment-368131">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2016 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-368131" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great questions Amir!</p>
<p>1. Monitor the performance of the model on the training and a standalone validation dataset. (even plot these learning curves). When skill on the validation set goes down and skill on training goes up or keeps going up, you are overlearning.<br/>
2. Cross validation is just a method for estimating the performance of a model on unseen data. It wraps everything you are doing to prepare data and your model, it does not go inside fit.<br/>
3. Monitor skill on a validation dataset as in 1, when skill stops improving on the validation set, stop training.<br/>
4. Generally, neural nets need a lot more data to train than other methods.</p>
<p>Here’s a tutorial on checkpointing that you can use to save “early stopped” models:<br/>
<a href="http://machinelearningmastery.com/check-point-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/check-point-deep-learning-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=368131#respond" onclick='return addComment.moveForm( "comment-368131", "368131", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-358931">
<div class="comment-container" id="li-comment-358931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d9096fc10c3caa033aa6fc73394177d9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d9096fc10c3caa033aa6fc73394177d9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Salem</span>
<span class="date">August 5, 2016 at 2:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
How once can predict new data point on a model while during building the model the training data has been standardised using sklearn.</p>
<div class="reply">
<a aria-label="Reply to Salem" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358931#respond" onclick='return addComment.moveForm( "comment-358931", "358931", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-358992">
<div class="comment-container" id="li-comment-358992">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 6, 2016 at 2:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-358992" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can save the object you used to standardize the data and later reuse it to standardize new data before making a prediction. This might be the MinMaxScaler for example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=358992#respond" onclick='return addComment.moveForm( "comment-358992", "358992", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-361568">
<div class="comment-container" id="li-comment-361568">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5524b5aa4845a0935a8d3223d61ca5f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5524b5aa4845a0935a8d3223d61ca5f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Guy</span>
<span class="date">August 25, 2016 at 10:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-361568" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I am not using the automatic data normalization as you show, but simply compute the mean and stdev for each feature (data column) in my training data and manually perform zscore ((data – mean) / stdev). By normalization I mean bringing the data to 0-mean, 1-stdev. I know there are several names for this process but let’s call it “normalization” for the sake of this argument.</p>
<p>So I’ve got 2 questions:</p>
<p>1) Should I also normalize the output column? Or just leave it as it is in my train/test?</p>
<p>2) I take the mean, stdev for my training data and use them to normalize the test data. But it seems that doesn’t center my data; no matter how I split the data, and no matter that each mini-batch is balanced (has the same distribution of output values). What am I missing / what can I do?</p>
<div class="reply">
<a aria-label="Reply to Guy" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=361568#respond" onclick='return addComment.moveForm( "comment-361568", "361568", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-361776">
<div class="comment-container" id="li-comment-361776">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2016 at 10:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-361776" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Guy, yeah this is normally called standardization.</p>
<p>Generally, you can get good results from applying the same transform to the output column. Try and see how it affects your results. If MSE or RMSE is the performance measure, you may need to be careful with the interpretation of the results as the scale of these scores will also change.</p>
<p>Yep, this is a common problem. Ideally, you want a very large training dataset to effectively estimate these values. You could try using bootstrap on the training dataset (or within a fold of cross validation) to create a more robust estimate of these terms. Bootstrap is just the repeated subsampling of your dataset and estimation of the statistical quantities, then take the mean from all the estimates. It works quite well.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=361776#respond" onclick='return addComment.moveForm( "comment-361776", "361776", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-363200">
<div class="comment-container" id="li-comment-363200">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2bf8afb7a23914651e4d5f7620379934?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2bf8afb7a23914651e4d5f7620379934?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://pranith-kumar-pola.herokuapp.com" rel="external nofollow">Pranith Kumar Pola</a></span>
<span class="date">September 2, 2016 at 3:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-363200" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>How should i load multiple finger print images into keras.</p>
<p>Can you please advise further.</p>
<p>Best Regards,<br/>
Pranith</p>
<div class="reply">
<a aria-label="Reply to Pranith Kumar Pola" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=363200#respond" onclick='return addComment.moveForm( "comment-363200", "363200", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364099">
<div class="comment-container" id="li-comment-364099">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f596df7f0d92b7403a1f027dc2cae54?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f596df7f0d92b7403a1f027dc2cae54?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://lucianogviola.com" rel="external nofollow">Luciano</a></span>
<span class="date">September 10, 2016 at 3:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-364099" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial. The best out there for free. </p>
<p>Can I use R² as my metric? If so, how?</p>
<p>Regards</p>
<div class="reply">
<a aria-label="Reply to Luciano" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=364099#respond" onclick='return addComment.moveForm( "comment-364099", "364099", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364110">
<div class="comment-container" id="li-comment-364110">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 10, 2016 at 7:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-364110" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Luciano.</p>
<p>You can use R^2, see this list of metrics you can use:<br/>
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html" rel="nofollow">http://scikit-learn.org/stable/modules/model_evaluation.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=364110#respond" onclick='return addComment.moveForm( "comment-364110", "364110", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365932">
<div class="comment-container" id="li-comment-365932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d31da2a47419d236cb2b46248181ac24?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d31da2a47419d236cb2b46248181ac24?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sumon</span>
<span class="date">October 1, 2016 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-365932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>shouldn’t results.mean() print accuracy instead of error?</p>
<div class="reply">
<a aria-label="Reply to sumon" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=365932#respond" onclick='return addComment.moveForm( "comment-365932", "365932", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365957">
<div class="comment-container" id="li-comment-365957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 1, 2016 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-365957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We summarize error for regression problems instead of accuracy (x/y correct). I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=365957#respond" onclick='return addComment.moveForm( "comment-365957", "365957", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-367501">
<div class="comment-container" id="li-comment-367501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">October 19, 2016 at 7:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-367501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>if I have a new dataset, X_new, and I want to make a prediction, the model.predict(X_new) shows the error ”NameError: name model is not defined’ and estimator.predict(X_test) shows the error message ‘KerasRegressor object has no attribute model’.</p>
<p>Do you have any suggestion? Thanks.</p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=367501#respond" onclick='return addComment.moveForm( "comment-367501", "367501", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-367554">
<div class="comment-container" id="li-comment-367554">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2016 at 8:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-367554" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi David, this post will get you started with the lifecycle of a Keras model:<br/>
<a href="http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow">http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=367554#respond" onclick='return addComment.moveForm( "comment-367554", "367554", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-379638">
<div class="comment-container" id="li-comment-379638">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed6b1b7fc900778e1b94f2347e7c00fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed6b1b7fc900778e1b94f2347e7c00fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Heinz Hemken</span>
<span class="date">January 3, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-379638" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>That page does not use KerasRegressor. How can we save the model and its weights in the code from this tutorial?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Heinz Hemken" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=379638#respond" onclick='return addComment.moveForm( "comment-379638", "379638", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-367913">
<div class="comment-container" id="li-comment-367913">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Avhirup</span>
<span class="date">October 22, 2016 at 11:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-367913" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m getting more error by standardizing dataset using the same seed.What must be the reason behind it?</p>
<div class="reply">
<a aria-label="Reply to Avhirup" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=367913#respond" onclick='return addComment.moveForm( "comment-367913", "367913", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-367915">
<div class="comment-container" id="li-comment-367915">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Avhirup</span>
<span class="date">October 22, 2016 at 11:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-367915" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>also deeper network topology seems not to help .It increases the MSE</p>
<div class="reply">
<a aria-label="Reply to Avhirup" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=367915#respond" onclick='return addComment.moveForm( "comment-367915", "367915", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-367916">
<div class="comment-container" id="li-comment-367916">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f6dbfeb2ddb6b2e2783649422e15a908?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Avhirup</span>
<span class="date">October 22, 2016 at 11:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-367916" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>deeper network without standardisation gives better results.Somehow standardisation is adding more noise</p>
<div class="reply">
<a aria-label="Reply to Avhirup" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=367916#respond" onclick='return addComment.moveForm( "comment-367916", "367916", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-369153">
<div class="comment-container" id="li-comment-369153">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c84fd3e8b4ec82c53f2016c6c1f76606?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c84fd3e8b4ec82c53f2016c6c1f76606?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michele Vascellari</span>
<span class="date">November 2, 2016 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-369153" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey great tutorial. I tried to use both Theano and Tensorflow backend, but I obtained very different results for the larger_model. With Theano I obtained results very similar to you, but with Tensorflow I have MSE larger than 100.</p>
<p>Do you have any clue?</p>
<p>Michele</p>
<div class="reply">
<a aria-label="Reply to Michele Vascellari" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=369153#respond" onclick='return addComment.moveForm( "comment-369153", "369153", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369228">
<div class="comment-container" id="li-comment-369228">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2016 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-369228" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Michele,</p>
<p>Off the cuff, I would think it is probably the reproducibility problems we are seeing with Python deep learning stack. It seems near impossible to tie down the random number generators used to get repeatable results.</p>
<p>I would not rule out a bug in one implementation or another, but I would find this very surprising for such a simple network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=369228#respond" onclick='return addComment.moveForm( "comment-369228", "369228", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-369777">
<div class="comment-container" id="li-comment-369777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/90a78f9bfda3d58ebddd8d83cd047ba4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/90a78f9bfda3d58ebddd8d83cd047ba4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kenny</span>
<span class="date">November 7, 2016 at 4:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-369777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi, i have a question about sklearn interface.<br/>
although we sent the NN model to sklearn and evaluate the regression performance, how can we get the exactly predictions of the input data X, like usually when we r using Keras we can  call the model.predict(X) function in keras.  btw, I mean the model is in sklearn right?</p>
<div class="reply">
<a aria-label="Reply to Kenny" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=369777#respond" onclick='return addComment.moveForm( "comment-369777", "369777", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369863">
<div class="comment-container" id="li-comment-369863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-369863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Kenny,</p>
<p>You can use the sklearn model.predict() function in the same way to make predictions on new input data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=369863#respond" onclick='return addComment.moveForm( "comment-369863", "369863", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-371659">
<div class="comment-container" id="li-comment-371659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fd780bed85872f3850e74a08e9b0096?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fd780bed85872f3850e74a08e9b0096?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://muehlemann.com" rel="external nofollow">Silvan Mühlemann</a></span>
<span class="date">November 23, 2016 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>I bought the book “Deep Learning with Python”. Thanks for your great work!</p>
<p>I see the question about “model.predict()” quite often. I have it as well. In the code above “model” is undefined. So what variable contains the trained model? I tried “estimator.predict()” but there I get the following error:</p>
<p>&gt; ‘KerasRegressor’ object has no attribute ‘model’</p>
<p>I think it would help many readers</p>
<div class="reply">
<a aria-label="Reply to Silvan Mühlemann" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=371659#respond" onclick='return addComment.moveForm( "comment-371659", "371659", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371700">
<div class="comment-container" id="li-comment-371700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 9:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your support Silvan.</p>
<p>With a keras model, you can train the model, assign it to a variable and call model.predict(). See this post:<br/>
<a href="http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow">http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>
<p>In the above example, we use a pipeline, which is also a sklearn Estimator. We can call estimator.predict() directly (same function name, different API), more here:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.predict" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.predict</a></p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=371700#respond" onclick='return addComment.moveForm( "comment-371700", "371700", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-371921">
<div class="comment-container" id="li-comment-371921">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2c4b8943676230408670850a32d634d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2c4b8943676230408670850a32d634d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dee</span>
<span class="date">November 24, 2016 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371921" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Is there anyway for you to provide a direct example of using the model.predict() for the example shown in this post? I’ve been following your posts for a couple months now and have gotten much more comfortable with Keras. However, I still cannot seem to be able to use .predict() on this example.</p>
<p>Thanks!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-371939">
<div class="comment-container" id="li-comment-371939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 24, 2016 at 10:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dee,</p>
<p>There info on the predict function here:<br/>
<a href="http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow">http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>
<p>There’s an example of calling predict in this post:<br/>
<a href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<p>Does that help?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-372159">
<div class="comment-container" id="li-comment-372159">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fd780bed85872f3850e74a08e9b0096?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fd780bed85872f3850e74a08e9b0096?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://muehlemann.com" rel="external nofollow">Silvan Mühlemann</a></span>
<span class="date">November 25, 2016 at 7:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-372159" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dee </p>
<p>Jason, correct me if I am wrong: If I understand correctly the sample above does *not* provide a trained model as output. So you won’t be able to use the .predict() function immediately. </p>
<p>Instead you have to train the pipeline:</p>
<p>pipeline.fit(X,Y)</p>
<p>Then only you can do predictions:</p>
<p>pipeline.predict(numpy.array([[   0.0273,    0.    ,    7.07  ,    0.    ,    0.469 ,    6.421 ,<br/>
          78.9   ,    4.9671,    2.    ,  242.    ,   17.8   ,  396.9   ,<br/>
           9.14  ]]))</p>
<p># will return array(22.125564575195312, dtype=float32)</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-372189">
<div class="comment-container" id="li-comment-372189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2016 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-372189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, thanks for the correction. </p>
<p>Sorry, for the confusion.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-372695">
<div class="comment-container" id="li-comment-372695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbe4da0ad46033965ebe295238a0cfcb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbe4da0ad46033965ebe295238a0cfcb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dee</span>
<span class="date">November 28, 2016 at 12:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-372695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Silvan,</p>
<p>Thanks for the tip! I had a feeling that the crossval from SciKit did not output the fitted model but just the RMSE or MSE of the crossval cost function. </p>
<p>I’ll give it a go with the .fit()!</p>
<p>Thanks!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-392935">
<div class="comment-container" id="li-comment-392935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc1f4fbe3b1bb6127598a0f995a1b12e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc1f4fbe3b1bb6127598a0f995a1b12e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sud</span>
<span class="date">March 17, 2017 at 1:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-392935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason &amp; Silvan,</p>
<p>Could you pls tell me whether I am given “pipeline.fit(X,Y)” in correct position?<br/>
pls correct me if I am wrong.</p>
<p>numpy.random.seed(seed)<br/>
estimators = []<br/>
estimators.append((‘standardize’, StandardScaler()))<br/>
estimators.append((‘mlp’, KerasRegressor(build_fn=larger_model, nb_epoch=50, batch_size=5, verbose=0)))<br/>
pipeline = Pipeline(estimators)<br/>
pipeline.fit(X,Y)<br/>
kfold = KFold(n_splits=10, random_state=seed)<br/>
results = cross_val_score(pipeline, X, Y, cv=kfold)<br/>
print(“Larger: %.2f (%.2f) MSE” % (results.mean(), results.std()))</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Sud" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=392935#respond" onclick='return addComment.moveForm( "comment-392935", "392935", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-392987">
<div class="comment-container" id="li-comment-392987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 17, 2017 at 8:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-392987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>pipeline.fit is not needed as you are evaluating the pipeline using kfold cross validation.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-371077">
<div class="comment-container" id="li-comment-371077">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa6f200c29de5ca9917b625a75398a8d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa6f200c29de5ca9917b625a75398a8d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahul</span>
<span class="date">November 18, 2016 at 3:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371077" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
                   I have a few questions. I am running the wider neural network on a dataset that corresponds to modelling with better accuracy the number of people walking in and out of a store. I get Wider: 24.73 (7.64) MSE. &lt;– Can you explain exactly what those values mean?</p>
<p>Also can you suggest any other method of improving the neural network? Do I have to keep re-iterating and tuning according to different topological methods? </p>
<p>Also what exact function do you use to predict the new data with no ground truth? Is it the sklearn model.predict(X) where X is the new dataset with one lesser dimension because there is no output? Could you please elaborate and explain in detail. I would be really grateful to you. </p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Rahul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=371077#respond" onclick='return addComment.moveForm( "comment-371077", "371077", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371189">
<div class="comment-container" id="li-comment-371189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2016 at 8:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-371189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Rahul,</p>
<p>The model reports on Mean Squared Error (MSE). It reports both the mean and the standard deviation of performance across 10 cross validation folds. This gives an idea of the expected spread in the performance results on new data.</p>
<p>I would suggest trying different network configurations until you find a setup that performs well on your problem. There are no good rules for net configuration.</p>
<p>You can use model.predict() to make new predictions. You are correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=371189#respond" onclick='return addComment.moveForm( "comment-371189", "371189", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-414013">
<div class="comment-container" id="li-comment-414013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e6584baecbad379b05d85953427c803a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e6584baecbad379b05d85953427c803a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishabh Agrawal</span>
<span class="date">September 16, 2017 at 1:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey! Jason.</p>
<p>Great work on machine learning. I have learned everything from here. </p>
<p>One question.<br/>
When we say that we have to train the model first and then predict, are we trying to determine what no. of layers and what no. of neurons, along with other Keras attributes, to get the best fit…and then use the same attributes on prediction dataset?</p>
<p>Bottom line: are we trying to determine what keras attributes fits our model while we are training the model?</p>
<div class="reply">
<a aria-label="Reply to Rishabh Agrawal" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414013#respond" onclick='return addComment.moveForm( "comment-414013", "414013", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-414064">
<div class="comment-container" id="li-comment-414064">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 17, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414064" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, we want a model that makes good predictions on new data where we don’t know the answer.</p>
<p>We evaluate different models and model configurations on test data to get an idea of how the models will perform when making predictions on new data, so that we can pick one or a few that we think will work well.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414064#respond" onclick='return addComment.moveForm( "comment-414064", "414064", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-379052">
<div class="comment-container" id="li-comment-379052">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c291bd2c978cb2bff3973a224958c9c2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c291bd2c978cb2bff3973a224958c9c2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kim</span>
<span class="date">December 31, 2016 at 5:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-379052" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for the great tutorial.<br/>
I redo the code on a Ubuntu machine and run them on TITAN X GPU. While I get similar results for experiment in section 4.1, my results in section 4.2 is different from yours:</p>
<p>Larger: 103.31 (236.28) MSE</p>
<p>no_epoch is 50 and batch_size is 5.</p>
<div class="reply">
<a aria-label="Reply to Kim" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=379052#respond" onclick='return addComment.moveForm( "comment-379052", "379052", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-379164">
<div class="comment-container" id="li-comment-379164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 1, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-379164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This can happen, it is hard to control the random number generators in Keras.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=379164#respond" onclick='return addComment.moveForm( "comment-379164", "379164", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-383153">
<div class="comment-container" id="li-comment-383153">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/883ce2b9d7b7ef1c3fa1f39cb5eb93e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/883ce2b9d7b7ef1c3fa1f39cb5eb93e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">A. Batuhan D.</span>
<span class="date">January 20, 2017 at 8:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383153" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for sharing these useful tutorials. Two questions:</p>
<p>1) If regression model calculates the error and returns as result (no doubt for this) then what is those ‘accuracy’ values printed for each epoch when ‘verbose=1’? </p>
<p>2) With those predicted values (fit.predict() or cross_val_predict), is it meaningful to find the closest value(s) to predicted result and calculate an accuracy? (This way, more than one accuracy can be calculated: accuracy for closest 2, closest 3, …)</p>
<div class="reply">
<a aria-label="Reply to A. Batuhan D." class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383153#respond" onclick='return addComment.moveForm( "comment-383153", "383153", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-383246">
<div class="comment-container" id="li-comment-383246">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2017 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383246" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi A. Batuhan D.,</p>
<p>1. You cannot print accuracy for a regression problem, it does not make sense. It would be loss or error.<br/>
2. Again, accuracy does not make sense for regression. It sounds like you are describing an instance based regression model like kNN?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383246#respond" onclick='return addComment.moveForm( "comment-383246", "383246", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-383658">
<div class="comment-container" id="li-comment-383658">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/883ce2b9d7b7ef1c3fa1f39cb5eb93e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/883ce2b9d7b7ef1c3fa1f39cb5eb93e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">A. Batuhan D.</span>
<span class="date">January 23, 2017 at 7:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383658" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason,</p>
<p>1. I know, it doesn’t make any sense to calculate accuracy for a regression problem but when using Keras library and set verbose=1, function prints accuracy values also alongside with loss values. I’d like to ask the reason of this situation. It is confusing. In your example, verbose parameter is set to 0.</p>
<p>2. What i do is to calculate some vectors. As input, i’m using vectors (say embedded word vectors of a phrase) and trying to calculate a vector (next word prediction) as an output (may not belong to any known vector in dictionary and probably not). Afterwards, i’m searching the closest vector in dictionary to one calculated by network by cosine distance approach. Counting model predicted vectors who are most similar to the true words vector (say next words vector) than others in dictionary may lead to a reasonable accuracy in my opinion. That’s a brief summary of what i do. I think that it is not related to instance based regression models.</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to A. Batuhan D." class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383658#respond" onclick='return addComment.moveForm( "comment-383658", "383658", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-383794">
<div class="comment-container" id="li-comment-383794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2017 at 11:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is very odd that accuracy is printed for a regression problem. I have not seen it, perhaps it’s a new bug in Keras?</p>
<p>Are you able to paste a short code + output example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383794#respond" onclick='return addComment.moveForm( "comment-383794", "383794", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-383751">
<div class="comment-container" id="li-comment-383751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5161772b86acf52d1848e9667fbb7272?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5161772b86acf52d1848e9667fbb7272?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Partha</span>
<span class="date">January 24, 2017 at 7:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I tried this tutorial – but it crashes with the following:<br/>
Traceback (most recent call last):<br/>
  File “Riskind_p1.py”, line 132, in<br/>
    results = cross_val_score(estimator, X, Y, cv=kfold)<br/>
  File “C:\Python27\lib\site-packages\sklearn\model_selection\_validation.py”, line 140, in cross_val_score<br/>
    for train, test in cv_iter)<br/>
  File “C:\Python27\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 758, in __call__<br/>
    while self.dispatch_one_batch(iterator):<br/>
  File “C:\Python27\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 603, in dispatch_one_batch<br/>
    tasks = BatchedCalls(itertools.islice(iterator, batch_size))<br/>
  File “C:\Python27\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 127, in __init__<br/>
    self.items = list(iterator_slice)<br/>
  File “C:\Python27\lib\site-packages\sklearn\model_selection\_validation.py”, line 140, in<br/>
    for train, test in cv_iter)<br/>
  File “C:\Python27\lib\site-packages\sklearn\base.py”, line 67, in clone<br/>
    new_object_params = estimator.get_params(deep=False)<br/>
TypeError: get_params() got an unexpected keyword argument ‘deep’</p>
<p>Some one else also got this same error and posted a question on StackOverflow.</p>
<p>Any help is appreciated.</p>
<div class="reply">
<a aria-label="Reply to Partha" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383751#respond" onclick='return addComment.moveForm( "comment-383751", "383751", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-383798">
<div class="comment-container" id="li-comment-383798">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2017 at 11:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383798" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that.</p>
<p>What versions of sklearn, Keras and tensorflow or theano are you using?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383798#respond" onclick='return addComment.moveForm( "comment-383798", "383798", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-383913">
<div class="comment-container" id="li-comment-383913">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">January 25, 2017 at 12:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383913" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same problem after an update to Keras 1.2.1. In my case: theano is 0.8.2 and sklearn is 0.18.1.</p>
<p>I could be wrong, but this could be a problem with the latest version of Keras…</p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383913#respond" onclick='return addComment.moveForm( "comment-383913", "383913", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-383937">
<div class="comment-container" id="li-comment-383937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">January 25, 2017 at 3:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, I think I have managed to solve the issues. I think the problem are crashess between different version of the packages. What it solves everything is to create an evironment. I have posted in stack overflow a solution, @Partha, here: <a href="http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41832675#41832675" rel="nofollow">http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41832675#41832675</a></p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383937#respond" onclick='return addComment.moveForm( "comment-383937", "383937", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-383955">
<div class="comment-container" id="li-comment-383955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5161772b86acf52d1848e9667fbb7272?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5161772b86acf52d1848e9667fbb7272?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Partha</span>
<span class="date">January 25, 2017 at 4:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My versions are 0.8.2 for theano and 0.18.1 for sklearn  and 1.2.1 for keras.<br/>
I did a new anaconda installation on another machine and it worked there.<br/>
Thanks,</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-384015">
<div class="comment-container" id="li-comment-384015">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384015" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks David, I’ll take a look at the post.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-384024">
<div class="comment-container" id="li-comment-384024">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384024" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi David, I have reproduced the fault and understand the cause.</p>
<p>The error is caused by a bug in Keras 1.2.1 and I have two candidate fixes for the issue.</p>
<p>I have written up the problem and fixes here:<br/>
<a href="http://stackoverflow.com/a/41841066/78453" rel="nofollow">http://stackoverflow.com/a/41841066/78453</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-384013">
<div class="comment-container" id="li-comment-384013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I will investigate and attempt to reproduce.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384013#respond" onclick='return addComment.moveForm( "comment-384013", "384013", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-384128">
<div class="comment-container" id="li-comment-384128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">January 25, 2017 at 8:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
yes, Jason’s solution is the correct one. My solution works because in the environment the Keras version installed is 1.1.1, not the one with the bug (1.2.1).</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-383960">
<div class="comment-container" id="li-comment-383960">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d02f5676ebc58aabf87b9ae3decd9daa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d02f5676ebc58aabf87b9ae3decd9daa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">January 25, 2017 at 5:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383960" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial, many thanks!</p>
<p>Just wondering how do you train on a standardaised dataset (as per section 3), but produce actual (i.e. NOT standardised) predictions with scikit-learn Pipeline?</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383960#respond" onclick='return addComment.moveForm( "comment-383960", "383960", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-384016">
<div class="comment-container" id="li-comment-384016">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384016" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Andy,</p>
<p>The standardization occurs within the pipeline which can invert the transforms as needed. This is one of the benefits of using the sklearn Pipeline.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384016#respond" onclick='return addComment.moveForm( "comment-384016", "384016", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-383977">
<div class="comment-container" id="li-comment-383977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d02f5676ebc58aabf87b9ae3decd9daa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d02f5676ebc58aabf87b9ae3decd9daa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://na" rel="external nofollow">AndyS</a></span>
<span class="date">January 25, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-383977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial, many thanks!</p>
<p>How do I recover actual predictions (NOT standardized ones) having fit the pipeline in section 3 with pipeline.fit(X,Y)? I believe pipeline.predict(testX) yields a standardised predictedY?</p>
<p>I see there is an inverse_transform method for Pipeline, however appears to be for only reverting a transformed X.</p>
<div class="reply">
<a aria-label="Reply to AndyS" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=383977#respond" onclick='return addComment.moveForm( "comment-383977", "383977", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-384178">
<div class="comment-container" id="li-comment-384178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/03471efa25a9e2df34cb754c448cf5eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03471efa25a9e2df34cb754c448cf5eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James Bond</span>
<span class="date">January 26, 2017 at 1:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for you post.. </p>
<p>I am currently having some problems with an regression problem, as such you represent here. </p>
<p>you seem to both normal both input and output, but what do you do if if the output should be used by a different component?… unnormalize it? and if so, wouldn’t the error scale up as well?</p>
<p>I am currently working on mapping framed audio to MFCC features.<br/>
I tried a lot of different network structures.. cnn,  multiple layers.. </p>
<p>I just recently tried adding a linear layer at the end… and wauw.. what an effect..  it keeps declining.. how come?.. do you have any idea?</p>
<div class="reply">
<a aria-label="Reply to James Bond" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384178#respond" onclick='return addComment.moveForm( "comment-384178", "384178", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384216">
<div class="comment-container" id="li-comment-384216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 26, 2017 at 4:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi James, yes the output must be denormalized (invert any data prep process) before use.</p>
<p>If the data prep processes are separate, you can keep track of the Python object (or coefficients) and invert the process ad hoc on predictions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384216#respond" onclick='return addComment.moveForm( "comment-384216", "384216", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384554">
<div class="comment-container" id="li-comment-384554">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/223b09d31b6b77182f6b3292941d6a72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/223b09d31b6b77182f6b3292941d6a72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://sarick.me" rel="external nofollow">Sarick</a></span>
<span class="date">January 27, 2017 at 6:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384554" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there any way to use pipeline but still be able to graph MSE over epochs for kerasregressor?</p>
<div class="reply">
<a aria-label="Reply to Sarick" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384554#respond" onclick='return addComment.moveForm( "comment-384554", "384554", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384648">
<div class="comment-container" id="li-comment-384648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 28, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not that I have seen Sarick. If you figure a way, let me know.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384648#respond" onclick='return addComment.moveForm( "comment-384648", "384648", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-384760">
<div class="comment-container" id="li-comment-384760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/882e27127a49a3471c86902f08d9a620?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/882e27127a49a3471c86902f08d9a620?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aritra</span>
<span class="date">January 28, 2017 at 9:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you tell me how to do regression with convolutional neural network?</p>
<div class="reply">
<a aria-label="Reply to Aritra" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384760#respond" onclick='return addComment.moveForm( "comment-384760", "384760", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385382">
<div class="comment-container" id="li-comment-385382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-385382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Aritra.</p>
<p>You can use the standard CNN structure and modify the example to use a linear output function and a suitable regression loss function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=385382#respond" onclick='return addComment.moveForm( "comment-385382", "385382", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384887">
<div class="comment-container" id="li-comment-384887">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kono</span>
<span class="date">January 29, 2017 at 4:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384887" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Could you tell me how to decide batch_size? Is there a rule of thumb for this?</p>
<div class="reply">
<a aria-label="Reply to kono" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384887#respond" onclick='return addComment.moveForm( "comment-384887", "384887", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385389">
<div class="comment-container" id="li-comment-385389">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-385389" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question kono.</p>
<p>Generally, I treat it like a parameter to be optimized for the problem, like learning rate.</p>
<p>These posts might help:</p>
<p>How large should the batch size be for stochastic gradient descent?<br/>
<a href="http://stats.stackexchange.com/questions/140811/how-large-should-the-batch-size-be-for-stochastic-gradient-descent" rel="nofollow">http://stats.stackexchange.com/questions/140811/how-large-should-the-batch-size-be-for-stochastic-gradient-descent</a></p>
<p>What is batch size in neural network?<br/>
<a href="http://stats.stackexchange.com/questions/153531/what-is-batch-size-in-neural-network" rel="nofollow">http://stats.stackexchange.com/questions/153531/what-is-batch-size-in-neural-network</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=385389#respond" onclick='return addComment.moveForm( "comment-385389", "385389", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-384893">
<div class="comment-container" id="li-comment-384893">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kono</span>
<span class="date">January 29, 2017 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-384893" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I see some people use fit_generator to train a MLP. Could you tell me when to use fit_generator() and when to use fit()?</p>
<div class="reply">
<a aria-label="Reply to kono" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=384893#respond" onclick='return addComment.moveForm( "comment-384893", "384893", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385390">
<div class="comment-container" id="li-comment-385390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-385390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi kono, fit_generator() is used when working with a Data Generator, such as is the case with image augmentation:<br/>
<a href="http://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="nofollow">http://machinelearningmastery.com/image-augmentation-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=385390#respond" onclick='return addComment.moveForm( "comment-385390", "385390", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-385549">
<div class="comment-container" id="li-comment-385549">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/762a6faf4481e8ae104c83fa902dfda1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/762a6faf4481e8ae104c83fa902dfda1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pratik Patil</span>
<span class="date">February 2, 2017 at 12:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-385549" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for the post. I used two of your post this and one on GridSearchCV to get a keras regression workflow with Pipeline.<br/>
My question is how to get weight matrices and bias vectors of keras regressor in a fit, that is on the pipeline.<br/>
(My posts keep getting rejected/disappear, am I breaking some protocol/rule of the site?)</p>
<div class="reply">
<a aria-label="Reply to Pratik Patil" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=385549#respond" onclick='return addComment.moveForm( "comment-385549", "385549", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385639">
<div class="comment-container" id="li-comment-385639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 2, 2017 at 1:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-385639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Comments are moderated, that is why you do not seem the immediately.</p>
<p>To access the weights, I would recommend training a standalone Keras model rather than using the KerasClassifier and sklearn Pipeline.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=385639#respond" onclick='return addComment.moveForm( "comment-385639", "385639", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-388778">
<div class="comment-container" id="li-comment-388778">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pedro</span>
<span class="date">February 18, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-388778" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thank you for the excelent example! as a beginner, it was the best to start with.<br/>
But I have some questions:</p>
<p>In the wider topology, what does it mean to have more neurons?</p>
<p>e.g., in my input layer I “receive” 150 dimensions/features (input_dim) and output 250 dimensions (output_dim). What is in those 100 “extra” neurons (that are propagated to the next hidden layers) ?</p>
<p>Best,<br/>
Pedro</p>
<div class="reply">
<a aria-label="Reply to Pedro" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=388778#respond" onclick='return addComment.moveForm( "comment-388778", "388778", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-388802">
<div class="comment-container" id="li-comment-388802">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 18, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-388802" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Pedro,</p>
<p>A neuron is a single learning unit. A layer is comprised of neurons. </p>
<p>The size of the input layer must match the number of input variables. The size of the output layer must match the number of output variables or output classes in the case of classification.</p>
<p>The number of hidden layers can vary and the number of neurons per hidden layer can vary. This is the art of configuring a neural net for a given problem.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=388802#respond" onclick='return addComment.moveForm( "comment-388802", "388802", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-389128">
<div class="comment-container" id="li-comment-389128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pedro Fialho</span>
<span class="date">February 20, 2017 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>In your wider example, the input layer does not match/output the number of input variables/features:</p>
<p>model.add(Dense(20, input_dim=13, init=’normal’, activation=’relu’))</p>
<p>so my question is: apart from the 13 input features, what’s in the 7 neurons, output by this (input) layer?</p>
<div class="reply">
<a aria-label="Reply to Pedro Fialho" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=389128#respond" onclick='return addComment.moveForm( "comment-389128", "389128", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-389155">
<div class="comment-container" id="li-comment-389155">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 20, 2017 at 9:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389155" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Pedro, I’m not sure I understand, sorry.</p>
<p>The example takes as input 13 features. The input layer (input_dim) expects 13 input values. The first hidden layer combines these weighted inputs 20 times or 20 different ways (20 neurons in the layer) and each neuron outputs one value. These are combined into one neuron (poor guy!) which outputs a prediction.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=389155#respond" onclick='return addComment.moveForm( "comment-389155", "389155", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-389414">
<div class="comment-container" id="li-comment-389414">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d88f83eddc031caa206ab8d59b5dc45b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pedro Fialho</span>
<span class="date">February 21, 2017 at 9:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389414" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Yes, now I understand (I was not confident that the input layer was also an hidden layer). Thank you again</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-389468">
<div class="comment-container" id="li-comment-389468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 22, 2017 at 10:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The input layer is separate from the first hidden layer. The Keras API makes this confusing because both are specified on the same line.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389001">
<div class="comment-container" id="li-comment-389001">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/398e3fc46b10afc784ab6d1c90ac72b7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/398e3fc46b10afc784ab6d1c90ac72b7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bartosz</span>
<span class="date">February 19, 2017 at 11:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389001" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>You’ve said that an activation function is not necessary as we want a numerical value as an output of our network. I’ve been looking at recurrent network and in particular this guide: <a href="https://deeplearning4j.org/lstm" rel="nofollow">https://deeplearning4j.org/lstm</a> . It recommended using an identity activation function at the output. I was wondering is there any difference between your approach: using Dense(1) as the output layer, and adding an identity activation function at the output of the network: Activation(‘linear’) ? are there any situations when I should use the identity activation layer? Could you elaborate on this?</p>
<p>In case of this tutorial the network would look like this with the identity function:<br/>
model = Sequential()<br/>
model.add(Dense(13, input_dim=13, init=’normal’, activation=’relu’))<br/>
model.add(Dense(6, init=’normal’, activation=’relu’))<br/>
model.add(Dense(1, init=’normal’))<br/>
model.add(Activation(‘linear’))</p>
<p>Regards,<br/>
Bartosz</p>
<div class="reply">
<a aria-label="Reply to Bartosz" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=389001#respond" onclick='return addComment.moveForm( "comment-389001", "389001", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-389147">
<div class="comment-container" id="li-comment-389147">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 20, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-389147" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Indeed, the example uses a linear activation function by default.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=389147#respond" onclick='return addComment.moveForm( "comment-389147", "389147", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-393113">
<div class="comment-container" id="li-comment-393113">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dan</span>
<span class="date">March 18, 2017 at 7:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-393113" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
my current understanding is that we want to fit + transform the scaling only on our training set and transform without fit on the testset. In case we use the pipeline in the cv like you did. Do we ensure that for each cv the scaling fit only takes place for the 9 training sets and the transform without the fit on the test set?</p>
<p>Thanks very much</p>
<div class="reply">
<a aria-label="Reply to Dan" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=393113#respond" onclick='return addComment.moveForm( "comment-393113", "393113", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393128">
<div class="comment-container" id="li-comment-393128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 18, 2017 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-393128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Top question.</p>
<p>The Pipeline does this for us. It is fit then applied to the training set each CV fold, then the fit transforms are applied to the test set to evaluate the model on the fold. It’s a great automatic pattern built into sklearn.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=393128#respond" onclick='return addComment.moveForm( "comment-393128", "393128", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393648">
<div class="comment-container" id="li-comment-393648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e812f874b72ab51fdf7cdfcdcd7b8c68?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e812f874b72ab51fdf7cdfcdcd7b8c68?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paula</span>
<span class="date">March 21, 2017 at 11:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-393648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi! I ran your code with your data and we got a different MSE. Should I be concerned? Thanks for help!</p>
<div class="reply">
<a aria-label="Reply to Paula" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=393648#respond" onclick='return addComment.moveForm( "comment-393648", "393648", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393708">
<div class="comment-container" id="li-comment-393708">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 22, 2017 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-393708" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally no, machine learning algorithms are stochastic.</p>
<p>More details here:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=393708#respond" onclick='return addComment.moveForm( "comment-393708", "393708", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394530">
<div class="comment-container" id="li-comment-394530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ee1ddc3c25a2fb4a1a7751c8e21ba11?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ee1ddc3c25a2fb4a1a7751c8e21ba11?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Annanya</span>
<span class="date">March 29, 2017 at 4:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason </p>
<p>while running this above code i found the error as</p>
<p> Y = dataset[:,25]<br/>
IndexError: index 25 is out of bounds for axis 1 with size 1</p>
<p>i had declared X and Y as</p>
<p>X = dataset[:,0:25]<br/>
Y = dataset[:,25]</p>
<p> help me for solving this</p>
<div class="reply">
<a aria-label="Reply to Annanya" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394530#respond" onclick='return addComment.moveForm( "comment-394530", "394530", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394580">
<div class="comment-container" id="li-comment-394580">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sagar</span>
<span class="date">March 29, 2017 at 10:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394580" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thanks for your great article ! </p>
<p>I am working with same problem [No of samples: 460000 , No of Features:8  ] but my target column output has too big values like in between 20000 to 90000 !</p>
<p>I tried  different NN architecture [ larger to small ] with different batch size and epoch but still not getting good accuracy ! </p>
<p>should i have to normalize my target column ? Please help me for solving this ! </p>
<p>Thanks for your time !</p>
<div class="reply">
<a aria-label="Reply to Sagar" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394580#respond" onclick='return addComment.moveForm( "comment-394580", "394580", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394694">
<div class="comment-container" id="li-comment-394694">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 30, 2017 at 8:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394694" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you must rescale your input and output data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394694#respond" onclick='return addComment.moveForm( "comment-394694", "394694", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-394899">
<div class="comment-container" id="li-comment-394899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sagar</span>
<span class="date">March 31, 2017 at 4:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thanks for your reply ! </p>
<p>Yes i tried different ways to rescale my data using </p>
<p><a href="http://machinelearningmastery.com/prepare-data-machine-learning-python-scikit-learn/" rel="nofollow">http://machinelearningmastery.com/prepare-data-machine-learning-python-scikit-learn/</a> </p>
<p>url but i still i only got 20% accuracy ! </p>
<p>I tried different NN topology with different batch size and epoch but not getting good results ! </p>
<p>My code : </p>
<p>inputFilePath = “path-to-input-file”</p>
<p>dataframe = pandas.read_csv(inputFilePath, sep=”\t”, header=None)<br/>
dataset = dataframe._values</p>
<p># split into input (X) and output (Y) variables<br/>
X = dataset[:,0:8]<br/>
Y = dataset[:,8]</p>
<p>scaler = StandardScaler().fit(X)<br/>
X = scaler.fit_transform(X)</p>
<p>maxnumber = max(Y)  #Max number i got is : 79882.0</p>
<p>Y=Y / maxnumber</p>
<p># create model<br/>
model = Sequential()<br/>
model.add(Dense(100, input_dim=8, init=’normal’, activation=’relu’))<br/>
model.add(Dense(100, init=’normal’, activation=’relu’))<br/>
model.add(Dense(80, init=’normal’, activation=’relu’))<br/>
model.add(Dense(40, init=’normal’, activation=’relu’))<br/>
model.add(Dense(20, init=’normal’, activation=’relu’))<br/>
model.add(Dense(8, init=’normal’, activation=’relu’))<br/>
model.add(Dense(6, init=’normal’, activation=’relu’))<br/>
model.add(Dense(6, init=’normal’, activation=’relu’))<br/>
model.add(Dense(1, init=’normal’,activation=’relu’))</p>
<p>model.compile(loss=’mean_absolute_error’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
# checkpoint<br/>
model.fit(X, Y,nb_epoch=100, batch_size=400)<br/>
# 4. evaluate the network<br/>
loss, accuracy = model.evaluate(X, Y)<br/>
print(“\nLoss: %.2f, Accuracy: %.2f%%” % (loss, accuracy*100))</p>
<p>I tried MSE and MAE in loss with adam and rmsprop optimizer but still not getting accuracy ! </p>
<p>Please help me ! Thanks</p>
<div class="reply">
<a aria-label="Reply to Sagar" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394899#respond" onclick='return addComment.moveForm( "comment-394899", "394899", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-394975">
<div class="comment-container" id="li-comment-394975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 1, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>100 epochs will not be enough for such a deep network. It might need millions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394975#respond" onclick='return addComment.moveForm( "comment-394975", "394975", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-395546">
<div class="comment-container" id="li-comment-395546">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c88b5de0a4c304876d06200ff59ee294?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sagar</span>
<span class="date">April 6, 2017 at 11:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-395546" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, Thanks for your reply ! </p>
<p>How can i ensure that i will get output after millions of epoch because after 10000 epoch accuracy is  still 0.2378 ! </p>
<p>How can i dynamically decide the number of layers and Neurons size in my neural network ? Is there any way ? </p>
<p>I already used neural network checkpoint mechanism to ensure its accuracy on validation spilt  !<br/>
My code looks like</p>
<p>model.compile(loss=’mean_absolute_error’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>checkpoint = ModelCheckpoint(save_file_path, monitor=’val_acc’, verbose=1, save_best_only=True, mode=’max’)</p>
<p>callbacks_list = [checkpoint]</p>
<p>model.fit(X_Feature_Vector, Y_Output_Vector,validation_split=0.33, nb_epoch=1000000, batch_size=1300, callbacks=callbacks_list, verbose=0)</p>
<p>Let me know if i miss something !</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-395802">
<div class="comment-container" id="li-comment-395802">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-395802" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks good.</p>
<p>There are neural net growing and pruning algorithms but I do not have tutorials sorry.</p>
<p>See the book: Neural Smithing <a href="http://amzn.to/2oOfXOz" rel="nofollow">http://amzn.to/2oOfXOz</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394709">
<div class="comment-container" id="li-comment-394709">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64c998ec0cc418764d5e35cd09d04982?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64c998ec0cc418764d5e35cd09d04982?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charlotte</span>
<span class="date">March 30, 2017 at 8:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394709" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for this great tutorial. </p>
<p>I do believe that there is a small mistake, when giving as parameters the number of epochs, the documentations shows that it should be given as:<br/>
estimator = KerasRegressor(build_fn=baseline_model, epochs=100, batch_size=5, verbose=0).</p>
<p>When giving:<br/>
estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)<br/>
the function doesn’t recognise the argument and just ignore it.</p>
<p>Can you confirm?</p>
<p>I’m using your ‘How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras’ tutorial and have trouble tuning the number of epochs. If I checked one of the results of the GridSearchCv with a simple cross validation with the same number of folds I don’t obtain the same results at all. There might be a similar mistake there?</p>
<p>Thank your for your time!</p>
<div class="reply">
<a aria-label="Reply to Charlotte" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394709#respond" onclick='return addComment.moveForm( "comment-394709", "394709", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394711">
<div class="comment-container" id="li-comment-394711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 30, 2017 at 9:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can pass through any parameters you wish:<br/>
<a href="https://keras.io/scikit-learn-api/" rel="nofollow">https://keras.io/scikit-learn-api/</a></p>
<p>You will get different results on each run because neural network behavior is stochastic. this post will help:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394711#respond" onclick='return addComment.moveForm( "comment-394711", "394711", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-394714">
<div class="comment-container" id="li-comment-394714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64c998ec0cc418764d5e35cd09d04982?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64c998ec0cc418764d5e35cd09d04982?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charlotte</span>
<span class="date">March 30, 2017 at 9:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p><a href="https://keras.io/scikit-learn-api/" rel="nofollow">https://keras.io/scikit-learn-api/</a> precises that number of epochs should be given as epochs=n and not nb_epoch=n. When giving the latter, the function will ignore the argument. As an example:</p>
<p>    np.random.seed(seed)<br/>
    estimators = []<br/>
    estimators.append((‘standardize’, StandardScaler()))<br/>
    estimators.append((‘mlp’, KerasRegressor(build_fn=baseline_model, nb_epoch=’hi’, batch_size=50, verbose=0)))<br/>
    pipeline = Pipeline(estimators)<br/>
    kfold = KFold(n_splits=10, random_state=seed)<br/>
    results = cross_val_score(pipeline, X1, Y, cv=kfold)<br/>
    print(“Standardized: %.5f (%.2f) MSE” % (results.mean(), results.std()))</p>
<p>will not raise any error.</p>
<p>Am I missing something?</p>
<p>The results I get are strongly different and I don’t think that this can be due to the stochasticity of the NN behaviour.</p>
<div class="reply">
<a aria-label="Reply to Charlotte" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394714#respond" onclick='return addComment.moveForm( "comment-394714", "394714", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-394828">
<div class="comment-container" id="li-comment-394828">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-394828" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Charlotte, that looks like a recent change for Keras 2.0. I will update the examples soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=394828#respond" onclick='return addComment.moveForm( "comment-394828", "394828", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-397529">
<div class="comment-container" id="li-comment-397529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6593a27dfca2e3710ea4b0b759381307?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6593a27dfca2e3710ea4b0b759381307?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://caleb@calebeverett.io" rel="external nofollow">Caleb Everett</a></span>
<span class="date">April 25, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Caleb Everett" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397529#respond" onclick='return addComment.moveForm( "comment-397529", "397529", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396579">
<div class="comment-container" id="li-comment-396579">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a43f36bc69b5515518468eb041bd4358?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a43f36bc69b5515518468eb041bd4358?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jens</span>
<span class="date">April 16, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-396579" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I tried the first part and got a different result for the baseline.<br/>
I figured that the<br/>
estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)</p>
<p>is not working as expected for me as it takes the default epoch of 10. When I change it to epochs=100 it works. </p>
<p>I just read the above comment, it seems like they changed that in the API</p>
<div class="reply">
<a aria-label="Reply to Jens" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=396579#respond" onclick='return addComment.moveForm( "comment-396579", "396579", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396592">
<div class="comment-container" id="li-comment-396592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 16, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-396592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Neural networks are a stochastic algorithm that gives different results each time they are run (unless you fix the seed and make everything else the same).</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=396592#respond" onclick='return addComment.moveForm( "comment-396592", "396592", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396937">
<div class="comment-container" id="li-comment-396937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f31884ecf411e4f9001ba10acda2736?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f31884ecf411e4f9001ba10acda2736?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Martin</span>
<span class="date">April 19, 2017 at 11:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-396937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>how can i get regression coefficients?</p>
<div class="reply">
<a aria-label="Reply to Martin" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=396937#respond" onclick='return addComment.moveForm( "comment-396937", "396937", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396991">
<div class="comment-container" id="li-comment-396991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-396991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use an optimization algorithm to “find them”.</p>
<p>Stochastic gradient descent with linear regression may be a place to start:<br/>
<a href="http://machinelearningmastery.com/simple-linear-regression-tutorial-for-machine-learning/" rel="nofollow">http://machinelearningmastery.com/simple-linear-regression-tutorial-for-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=396991#respond" onclick='return addComment.moveForm( "comment-396991", "396991", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397698">
<div class="comment-container" id="li-comment-397698">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/334cb8ae0d23355f48e7424ddfdfb178?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/334cb8ae0d23355f48e7424ddfdfb178?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luca</span>
<span class="date">April 27, 2017 at 12:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397698" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>Thanks for your tutorials!!<br/>
I made it work in a particle physics example I’m working on, and I have 2 questions.<br/>
1) Imagine my target is T=a/b (T=true_value/reco_value). If I give to the regression both “a” and “b” as features, then it should be able to find exactly the correct solution every time, right? Or there is some procedure that try to avoid overtraining, and do not allow to give a results precise at 100%? I ask because I tried, and I got “good” performances, not optimal as I would expect (if it has “a” and “b” it should be able to find the correct T in the test too at 100% ). If I remove b from the regression, and I add other features, then y_hat/y_test is peaking at 0.75, meaning the the regression is biassed. Could you help me understanding these two facts?<br/>
2) I want to save the regression in order to use it later. After the training I do: a) estimator.model.save_weights and b) open(‘models/’+model_name, ‘w’).write(estimator.model.to_json()).<br/>
Estimator is “estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=50, verbose=1)”. How can I later use those 2 files to directly make predictions?</p>
<p>Thanks a lot,<br/>
Luca</p>
<div class="reply">
<a aria-label="Reply to Luca" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397698#respond" onclick='return addComment.moveForm( "comment-397698", "397698", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397739">
<div class="comment-container" id="li-comment-397739">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 27, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397739" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I follow your first question, perhaps you can restate it briefly?</p>
<p>See this post on saving and loading keras models:<br/>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397739#respond" onclick='return addComment.moveForm( "comment-397739", "397739", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-397805">
<div class="comment-container" id="li-comment-397805">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/334cb8ae0d23355f48e7424ddfdfb178?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/334cb8ae0d23355f48e7424ddfdfb178?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luca</span>
<span class="date">April 28, 2017 at 1:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397805" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
my point is the following. The regression is trained on a set of features (a set of floats), and it provides a single output (a float), the target. During the training the regression learn how to guess the target as a function of the features.<br/>
Of course the target should not be function of the features, otherwise the problem is trivial, but I tried to test this scenario as an initial check. What I did (as a test) is to define a target that is division of 2 features, i.e. I’m giving to the regression “a” and “b”, and I’m saying that the target to find is a/b. In that simple case, the regression should be smart enough to understand during the training that my target is simply a/b. So in the test it should be able to find the correct value with 100% precision, i.e. dividing the 2 features. What I found is that in the test the regression find a value (y_hat) that is close to a/b, but not exactly a/b. So I was wondering why the regression is behaving like that.</p>
<p>Thanks,<br/>
Luca</p>
<div class="reply">
<a aria-label="Reply to Luca" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397805#respond" onclick='return addComment.moveForm( "comment-397805", "397805", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-397854">
<div class="comment-container" id="li-comment-397854">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397854" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a great question.</p>
<p>At best machine learning can approximate a function, some approximations are better than others.</p>
<p>That is the best that I can answer it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397854#respond" onclick='return addComment.moveForm( "comment-397854", "397854", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-397700">
<div class="comment-container" id="li-comment-397700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee785cacc437e612b253cd76344561f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee785cacc437e612b253cd76344561f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ignacio</span>
<span class="date">April 27, 2017 at 12:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>thanks for your posts, I really enjoy them. I have a quick question: If I want to use sklearn’s GridSearchCV and :<br/>
 model.compile(loss=’mean_squared_error’<br/>
in my model, will the highest score correspond to the combination with the *highest* mse?<br/>
If that’s the case I assume there is a way to invert the scoring in GridSearchCV?</p>
<div class="reply">
<a aria-label="Reply to Ignacio" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397700#respond" onclick='return addComment.moveForm( "comment-397700", "397700", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397740">
<div class="comment-container" id="li-comment-397740">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 27, 2017 at 8:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-397740" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When using MSE you will want to find the config that results in the lowest error, e.g. lowest mean squared error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=397740#respond" onclick='return addComment.moveForm( "comment-397740", "397740", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398307">
<div class="comment-container" id="li-comment-398307">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7df14518277b57463bb06dfd5425c409?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7df14518277b57463bb06dfd5425c409?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Navdeep</span>
<span class="date">May 2, 2017 at 10:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-398307" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>I have datafile with 7 variables, 6 inputs and 1 output</p>
<p>#from sklearn.cross_validation import train_test_split<br/>
#rain, test = train_test_split(data2, train_size = 0.8)</p>
<p>#train_y= train[‘Average RT’]<br/>
#train_x= train[train.columns.difference([‘Average RT’])]</p>
<p>##test_y= test[‘Average RT’]<br/>
#est_x= test[test.columns.difference([‘Average RT’])]</p>
<p>x=data2[data2.columns.difference([‘Average RT’])]<br/>
y=data2[‘Average RT’]</p>
<p>print x.shape<br/>
print y.shape</p>
<p>(1035, 6)<br/>
(1035L,)<br/>
# define base model<br/>
def baseline_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(7, input_dim=7, kernel_initializer=’normal’, activation=’relu’))<br/>
	model.add(Dense(1, kernel_initializer=’normal’))<br/>
	# Compile model<br/>
	model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br/>
	return model</p>
<p># fix random seed for reproducibility<br/>
#seed = 7<br/>
#numpy.random.seed(seed)<br/>
# evaluate model with standardized dataset<br/>
estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)</p>
<p>kfold = KFold(n_splits=5, random_state=seed)<br/>
results = cross_val_score(estimator, x,y, cv=kfold)<br/>
print(“Results: %.2f (%.2f) MSE” % (results.mean(), results.std()))</p>
<p>but getting error below<br/>
ValueError: Error when checking input: expected dense_15_input to have shape (None, 7) but got array with shape (828, 6)</p>
<p>Also i tried changing</p>
<p>model.add(Dense(7, input_dim=7, kernel_initializer=’normal’, activation=’relu’))<br/>
to<br/>
model.add(Dense(6, input_dim=6, kernel_initializer=’normal’, activation=’relu’))</p>
<p>because total i have 7 variables out of which 6 are input, 7th Average RT is output</p>
<p>could u help pls</p>
<p>could you help pls<br/>
there is non linear relationship also bw o/p and i/p, as ai am trying keras neural to develop relationship that is non linear by itself</p>
<div class="reply">
<a aria-label="Reply to Navdeep" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=398307#respond" onclick='return addComment.moveForm( "comment-398307", "398307", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398360">
<div class="comment-container" id="li-comment-398360">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2017 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-398360" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you have 6 inputs and 1 output, you will have 7 rows.</p>
<p>You can separate your data as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593462961e440431466" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X = data[:, 0:6]
y = datap[:, 6]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593462961e440431466-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593462961e440431466-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593462961e440431466-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593462961e440431466-2"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">datap</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>Then, you can configure the input layer of your neural net to expect 6 inputs by setting the “input_dim” to 6.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=398360#respond" onclick='return addComment.moveForm( "comment-398360", "398360", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-402231">
<div class="comment-container" id="li-comment-402231">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8ce1dc58cbb4a08256880b99045c072a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8ce1dc58cbb4a08256880b99045c072a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aghiles</span>
<span class="date">June 12, 2017 at 1:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402231" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>and if I have 2 output, can I write </p>
<p>y = data[:, 0:6]<br/>
y = data[:, 6:7]</p>
<p>?</p>
<div class="reply">
<a aria-label="Reply to Aghiles" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402231#respond" onclick='return addComment.moveForm( "comment-402231", "402231", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-402247">
<div class="comment-container" id="li-comment-402247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 12, 2017 at 7:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not quite.</p>
<p>You can retrieve the 2 columns from your matrix and assign them to y so that y is now 2 columns and n rows.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a65934628f6b935631322" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
y = data[:, 6:]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a65934628f6b935631322-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a65934628f6b935631322-1"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Perhaps get more comfortable with numpy array slicing first?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402247#respond" onclick='return addComment.moveForm( "comment-402247", "402247", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399229">
<div class="comment-container" id="li-comment-399229">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5d077b201033dde2538a51e6f0f6d544?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5d077b201033dde2538a51e6f0f6d544?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">amit kumar</span>
<span class="date">May 10, 2017 at 4:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399229" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sir plz give me code of “to calculayte cost estimation usin back prpoation technique uses simodial activation function”</p>
<div class="reply">
<a aria-label="Reply to amit kumar" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399229#respond" onclick='return addComment.moveForm( "comment-399229", "399229", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399260">
<div class="comment-container" id="li-comment-399260">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399260" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="nofollow">http://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399260#respond" onclick='return addComment.moveForm( "comment-399260", "399260", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-399383">
<div class="comment-container" id="li-comment-399383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/28e06efe34a2770f66a774d359f98110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/28e06efe34a2770f66a774d359f98110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Francis</span>
<span class="date">May 11, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’m new in deep learning and thanks for this impressive tutorial. However, I have an important question about deep learning methods:</p>
<p>How can we interpret these features just like lasso or other feature selection methods?</p>
<p>In my project, I have about 20000 features and I want to selected or ranking these features using deep learning methods. How can we do this?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Francis" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399383#respond" onclick='return addComment.moveForm( "comment-399383", "399383", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399435">
<div class="comment-container" id="li-comment-399435">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399435" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>I would recommend performing feature selection as a pre-processing step.</p>
<p>Here’s more information on feature selection:<br/>
<a href="http://machinelearningmastery.com/an-introduction-to-feature-selection/" rel="nofollow">http://machinelearningmastery.com/an-introduction-to-feature-selection/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399435#respond" onclick='return addComment.moveForm( "comment-399435", "399435", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399704">
<div class="comment-container" id="li-comment-399704">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a90def5dc678a8bb3404121a62244f6a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a90def5dc678a8bb3404121a62244f6a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alogomining</span>
<span class="date">May 15, 2017 at 1:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399704" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Thks a lot for this post.<br/>
is there a way to implement a Tweedie regression in thsi framework ?<br/>
A</p>
<div class="reply">
<a aria-label="Reply to Alogomining" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399704#respond" onclick='return addComment.moveForm( "comment-399704", "399704", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399764">
<div class="comment-container" id="li-comment-399764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2017 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-399764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not heard of “tweedie regression”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=399764#respond" onclick='return addComment.moveForm( "comment-399764", "399764", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400382">
<div class="comment-container" id="li-comment-400382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1ff095656c31aefb09f2a165685a4f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1ff095656c31aefb09f2a165685a4f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Inge</span>
<span class="date">May 23, 2017 at 10:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-400382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thank you for the sharing.<br/>
I met a problem, and do not know how to deal with it.<br/>
When it goes to “results = cross_val_score(estimator, X, Y, cv=kfold)”, I got warnings shown as below:<br/>
C:\Program Files\Anaconda3\lib\site-packages\ipykernel\__main__.py:11: UserWarning: Update your <code>Dense</code> call to the Keras 2 API: <code>Dense(13, input_dim=13, kernel_initializer="normal", activation="relu")</code><br/>
C:\Program Files\Anaconda3\lib\site-packages\ipykernel\__main__.py:12: UserWarning: Update your <code>Dense</code> call to the Keras 2 API: <code>Dense(1, kernel_initializer="normal")</code><br/>
C:\Program Files\Anaconda3\lib\site-packages\keras\backend\tensorflow_backend.py:2289: UserWarning: Expected no kwargs, you passed 1<br/>
kwargs passed to function are ignored with Tensorflow backend<br/>
  warnings.warn(‘\n’.join(msg))</p>
<p>I’ve tried to update Anaconda and its all packages,but cannot fix it.</p>
<div class="reply">
<a aria-label="Reply to Inge" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=400382#respond" onclick='return addComment.moveForm( "comment-400382", "400382", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400605">
<div class="comment-container" id="li-comment-400605">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huyen</span>
<span class="date">May 27, 2017 at 2:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-400605" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a classic question about neural network for regression but I haven’t found any crystal answer. I have seen the very good performances of neural network on classification for image and so on but still doubt about its performances on regression. In fact, I have tested with 2 cases of data linear and non linear, 2 input and 1 output with random bias but the performances were not good in comparison with other classic machine learning methods such as SVM or Gradient Boosting… So for regression, which kind of data we should apply neural network? Whether the data is more complexity, its performance will be better? </p>
<p>Thank you for your answer in advance. Hope you have a good day 🙂</p>
<div class="reply">
<a aria-label="Reply to Huyen" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=400605#respond" onclick='return addComment.moveForm( "comment-400605", "400605", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401146">
<div class="comment-container" id="li-comment-401146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Deep learning will work well for regression but requires larger/harder problems with lots more data.</p>
<p>Small problems will be better suited to classical linear or even non-linear methods.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401146#respond" onclick='return addComment.moveForm( "comment-401146", "401146", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401779">
<div class="comment-container" id="li-comment-401779">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huyen</span>
<span class="date">June 7, 2017 at 4:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401779" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason,</p>
<p>Return in your examples, I have one question about the appropriate number of neurons should be in each hidden layer and the number of hidden layers in a network. I have read some recommendations such that number of hidden layer neurons are 2/3 of size of input layer and the number of neurons it should (a) be between the input and output layer size, (b) set to something near (inputs+outputs) * 2/3, or (c) never larger than twice the size of the input layer to prevent the overfitting. I doubt about these constraints because I haven’t found any mathematical proofs about them.</p>
<p> With your example, I increase the number of layers to 7 and with each layer, I use a large number of neurons (approximately 300-200) and it gave MSQ to 0.1394 through 5000 epochs. So do you have any conditions about these number when you build a network?</p>
<div class="reply">
<a aria-label="Reply to Huyen" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401779#respond" onclick='return addComment.moveForm( "comment-401779", "401779", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-401830">
<div class="comment-container" id="li-comment-401830">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 8, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401830" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, generally neural network configuration is trial and error with a robust test harness.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401830#respond" onclick='return addComment.moveForm( "comment-401830", "401830", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401260">
<div class="comment-container" id="li-comment-401260">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">June 2, 2017 at 4:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401260" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason.Can i apply regression for Autoencoders?</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401260#respond" onclick='return addComment.moveForm( "comment-401260", "401260", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401311">
<div class="comment-container" id="li-comment-401311">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2017 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401311" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but I do not have examples sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401311#respond" onclick='return addComment.moveForm( "comment-401311", "401311", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401301">
<div class="comment-container" id="li-comment-401301">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ac29fe152726bcc984e6e9bf2a2fc14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ac29fe152726bcc984e6e9bf2a2fc14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">KK</span>
<span class="date">June 3, 2017 at 4:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401301" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Thank you for the great tutorial code! I have some questions regarding regularization and kenel initializer.</p>
<p>I’d like to add L1/L2 regularization when updating the weights. Where should I put the commands? </p>
<p>I also have a question abut assigning ” kernel_initializer=’normal’,” Is it necessary to initialize normal kernel?</p>
<p>Thanks!</p>
<p>KK</p>
<div class="reply">
<a aria-label="Reply to KK" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401301#respond" onclick='return addComment.moveForm( "comment-401301", "401301", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401318">
<div class="comment-container" id="li-comment-401318">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401318" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example of weight regularization:<br/>
<a href="http://machinelearningmastery.com/use-weight-regularization-lstm-networks-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/use-weight-regularization-lstm-networks-time-series-forecasting/</a></p>
<p>I would recommend evaluating different weight initialization schemes on your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401318#respond" onclick='return addComment.moveForm( "comment-401318", "401318", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401560">
<div class="comment-container" id="li-comment-401560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ac29fe152726bcc984e6e9bf2a2fc14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ac29fe152726bcc984e6e9bf2a2fc14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">KK</span>
<span class="date">June 5, 2017 at 5:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason.</p>
<p>I have one more question. I will use convolution2D with dropout. Do I still need to use L1/L2 regularization if I have dropout in my model?</p>
<p>Thanks!</p>
<p>KK</p>
<div class="reply">
<a aria-label="Reply to KK" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401560#respond" onclick='return addComment.moveForm( "comment-401560", "401560", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-401626">
<div class="comment-container" id="li-comment-401626">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 6, 2017 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401626" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try with and without and compare performance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401626#respond" onclick='return addComment.moveForm( "comment-401626", "401626", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401877">
<div class="comment-container" id="li-comment-401877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/892276a2aa6976746b2702857e4f522a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/892276a2aa6976746b2702857e4f522a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kid</span>
<span class="date">June 8, 2017 at 6:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Dr., </p>
<p>I need you favor on how to use pre trained Keras based sequential model for NER with input text.</p>
<p>Example if “word1 word2 word3.” is a sentence with three words, how I can convert it to numpy array expected by Keras to predict each words NE tag set from the loaded pretrained Keras model.</p>
<p>With regards,</p>
<div class="reply">
<a aria-label="Reply to Kid" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401877#respond" onclick='return addComment.moveForm( "comment-401877", "401877", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401937">
<div class="comment-container" id="li-comment-401937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-401937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Convert the words to integers first.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=401937#respond" onclick='return addComment.moveForm( "comment-401937", "401937", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402547">
<div class="comment-container" id="li-comment-402547">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e041d9365863d211e7cded4b128fb2c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e041d9365863d211e7cded4b128fb2c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sayak Paul</span>
<span class="date">June 15, 2017 at 4:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402547" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am getting a rate of more than 58 every time. </p>
<p>Here’s the exact code being used:<br/>
#Dependencies</p>
<p>from numpy.random import seed<br/>
seed(1)</p>
<p>import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasRegressor<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.preprocessing import StandardScaler<br/>
from sklearn.pipeline import Pipeline</p>
<p># load dataset<br/>
dataframe = pandas.read_csv(“housing.csv”, delim_whitespace=True, header=None)<br/>
dataset = dataframe.values<br/>
# split into input (X) and output (Y) variables<br/>
X = dataset[:,0:13]<br/>
Y = dataset[:,13]</p>
<p># Basic NN model using Keras</p>
<p>def baseline_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(13, input_dim=13, kernel_initializer=’normal’, activation=’relu’))<br/>
	model.add(Dense(1, kernel_initializer=’normal’))<br/>
	# Compile model<br/>
	model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br/>
	return model</p>
<p>#seed = 1<br/>
# evaluate model with standardized dataset<br/>
estimator = KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)</p>
<p>#kfold = KFold(n_splits=10, random_state=seed)<br/>
results = cross_val_score(estimator, X, Y, cv=10)<br/>
print(“Results: %.2f (%.2f) MSE” % (results.mean(), results.std()))</p>
<div class="reply">
<a aria-label="Reply to Sayak Paul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402547#respond" onclick='return addComment.moveForm( "comment-402547", "402547", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402583">
<div class="comment-container" id="li-comment-402583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 15, 2017 at 8:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean by “a rate of more than 58”?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402583#respond" onclick='return addComment.moveForm( "comment-402583", "402583", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402670">
<div class="comment-container" id="li-comment-402670">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e76f117ebb9d67531dbed48e4f19362?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e76f117ebb9d67531dbed48e4f19362?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hossein</span>
<span class="date">June 16, 2017 at 3:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402670" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much,<br/>
Cant we use CNN instead of Dense layers? in case we want to use CNN, should we use conv2d or simply conv?<br/>
In regression problems using deep architectures, can we use AlexNet, VGGNet, and the likes just like how we use them with images?<br/>
I would appreciate if you could have an example in this regard as well<br/>
Best Regards</p>
<div class="reply">
<a aria-label="Reply to Hossein" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402670#respond" onclick='return addComment.moveForm( "comment-402670", "402670", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402703">
<div class="comment-container" id="li-comment-402703">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 16, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402703" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would not recommend a CNN for regression. I would recommend a MLP.</p>
<p>The shape of your input data (1d, 2d, …) will define the type of CNN to use.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402703#respond" onclick='return addComment.moveForm( "comment-402703", "402703", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402964">
<div class="comment-container" id="li-comment-402964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a8614cb2991b8bd9319585f7c84a604?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a8614cb2991b8bd9319585f7c84a604?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jose</span>
<span class="date">June 18, 2017 at 1:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-402964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial! I liked to save the weight that I adjusted in training, how can I do it?</p>
<div class="reply">
<a aria-label="Reply to Jose" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=402964#respond" onclick='return addComment.moveForm( "comment-402964", "402964", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403019">
<div class="comment-container" id="li-comment-403019">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 19, 2017 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-403019" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This tutorial will show you how to save network weights:<br/>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=403019#respond" onclick='return addComment.moveForm( "comment-403019", "403019", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403161">
<div class="comment-container" id="li-comment-403161">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e95d2b54b12c62db6da6151bc4fe64d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e95d2b54b12c62db6da6151bc4fe64d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jacob</span>
<span class="date">June 20, 2017 at 11:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-403161" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much.<br/>
I have a question.<br/>
Is this tutorial suitable for wind speed prediction?</p>
<div class="reply">
<a aria-label="Reply to Jacob" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=403161#respond" onclick='return addComment.moveForm( "comment-403161", "403161", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403255">
<div class="comment-container" id="li-comment-403255">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2017 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-403255" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=403255#respond" onclick='return addComment.moveForm( "comment-403255", "403255", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404538">
<div class="comment-container" id="li-comment-404538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29715919f1ab25f143b8f9b00f32a16c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29715919f1ab25f143b8f9b00f32a16c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roy</span>
<span class="date">July 2, 2017 at 3:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thank you for the tutorial. Few questions here.</p>
<p>1. What is the differences when we use<br/>
KerasRegressor(build_fn=baseline_model, nb_epoch=100, batch_size=5, verbose=0)</p>
<p>and with</p>
<p>model.fit(x_train, y_train, batch_size=batch_size,epochs=epochs,verbose=1,validation_data=(x_test, y_test))? AFAIK, with when using KerasRegressor, we can do CV while can’t on model.fit. Am I right? Will both result in the same MSE etc?</p>
<p>2. How do create a neural network that predict two continuous output using Keras? Here, we only predict one output, how about two or more output? How do we implement that? (Multioutput regression problem?)</p>
<div class="reply">
<a aria-label="Reply to Roy" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404538#respond" onclick='return addComment.moveForm( "comment-404538", "404538", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404581">
<div class="comment-container" id="li-comment-404581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 3, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct, using the sklearn wrapper lets us use tools like CV on small models.</p>
<p>You can have two outputs by changing the number of nodes in the output layer to 2.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404581#respond" onclick='return addComment.moveForm( "comment-404581", "404581", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-404688">
<div class="comment-container" id="li-comment-404688">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29715919f1ab25f143b8f9b00f32a16c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29715919f1ab25f143b8f9b00f32a16c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roy</span>
<span class="date">July 4, 2017 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404688" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the reply. </p>
<p>Does that mean that with sklearn wrapper model and with model.fit(without sklearn) model are able to get the same mse if both are given same train, valid, and test dataset (assume sklearn wrapper only run 1st fold)? Or there are some differences behind the model?</p>
<p>I read about the Keras Model class (functional API) ( <a href="https://keras.io/models/model/" rel="nofollow">https://keras.io/models/model/</a> ). Is the implementation of the Model class, </p>
<p>model = Model(inputs=a1, outputs=[output1, output2])</p>
<p>the same as adding 1 node more at the output layer? If no, what’s the differences?</p>
<div class="reply">
<a aria-label="Reply to Roy" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404688#respond" onclick='return addComment.moveForm( "comment-404688", "404688", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-404878">
<div class="comment-container" id="li-comment-404878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Same keras model under the covers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404878#respond" onclick='return addComment.moveForm( "comment-404878", "404878", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404710">
<div class="comment-container" id="li-comment-404710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nandini</span>
<span class="date">July 4, 2017 at 5:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>from keras.layers.core import Dense,Activation,Dropout<br/>
from json import load,dump<br/>
from sklearn.metrics import mean_squared_error<br/>
from sklearn.metrics import mean_absolute_error<br/>
from keras.models import Sequential<br/>
from keras2pmml import keras2pmml<br/>
from pyspark import SparkContext,SparkConf<br/>
from pyspark.mllib.linalg import Matrix, Vector<br/>
from elephas.utils.rdd_utils import to_simple_rdd,to_labeled_point<br/>
from elephas import optimizers as elephas_optimizers<br/>
from elephas.spark_model import SparkModel<br/>
from CommonFunctions import DataRead,PMMLGenaration,ModelSave,LoadModel,UpdateDictionary,ModelInfo<br/>
from keras import regularizers<br/>
from sklearn.metrics import r2_score<br/>
from keras.optimizers import SGD<br/>
#from keras.models import model_from_config<br/>
#from keras.utils.generic_utils import get_from_module</p>
<p>class SNNReg:</p>
<p>	    def train(self,sc,xml,data,hdfs_path):<br/>
		## Variable initialization ##<br/>
		hActivation = xml.HiddenActivation<br/>
		#print hActivation<br/>
		nodeList = map(int,(xml.NodeList.split(“,”)))<br/>
		#print nodeList<br/>
		Accuracy = xml.Accuracy<br/>
		#print Accuracy<br/>
		lossFn = xml.LossFunction<br/>
		#print nodeList<br/>
		optimi = xml.Optimizer<br/>
		#print optimi<br/>
		hCount = int(xml.HiddenNodeCount)<br/>
		#print hCount<br/>
		inputDim = int(xml.InputDimension)<br/>
		opNodes = int(xml.OutputNodes)<br/>
		print (‘opNodes’,opNodes)<br/>
		nbEpoch = int(xml.NumEpoch)<br/>
		batchSize = int(xml.BatchSize)<br/>
		#settings default paramerters if not the provided the values for it<br/>
		if hActivation==””:<br/>
		    hActivation=”relu”<br/>
		if lossFn==””:<br/>
		    lossFn=”mean_squared_error”<br/>
		if optimi==””:<br/>
		    optimi=”adam”<br/>
		if Accuracy==””:<br/>
		    Accuracy=”Accuracy”<br/>
		print “now going to read ”<br/>
	       	#print(“lossFn”,lossFn)<br/>
		X,Y = DataRead(self,xml.NeuralNetCategory,xml.NeuralNetType,data,xml.ColumnNames,xml.TargetColumnName,xml.InputDimension)</p>
<p>		# Creating a sequential model for simple neural network<br/>
		model=Sequential()</p>
<p>		model.add(Dense(nodeList[0],input_dim = inputDim,init=’normal’,activation =hActivation ))</p>
<p>		# Creating hidden model nodes based on the hidden layers count<br/>
		if hCount &gt; 1:<br/>
		    for x in range(1,hCount):<br/>
		        model.add(Dense(nodeList[x],init=’normal’,activation = hActivation))<br/>
		model.add(Dense(opNodes,activation=’linear’))<br/>
		# Compile model<br/>
		print “model complilation stage”<br/>
		model.compile(loss = lossFn, optimizer=optimi)<br/>
		rdd =to_simple_rdd(sc,X,Y)<br/>
		print rdd<br/>
		#adam= elephas_optimizers.Adam()<br/>
		adam = elephas_optimizers.Adam()<br/>
		#adagrad = elephas_optimizers.Adagrad()<br/>
		#adadelta = elephas_optimizers.Adadelta()<br/>
		#print (“type of rdd”,type(rdd))<br/>
		print “now going to create spark model using elphass”<br/>
		# Creating Spark elephas model from the spark model<br/>
		print(“no of workers”,int(sc._conf.get(‘spark.pangea.ae.workers’)))</p>
<p>		sparkModel = SparkModel(sc,<br/>
		                 model,<br/>
		                 optimizer=adam,<br/>
		                 frequency=’epoch’,<br/>
		                 mode=’asynchronous’,<br/>
				 master_loss=lossFn,<br/>
		                 num_workers=int(sc._conf.get(‘spark.pangea.ae.workers’)))</p>
<p>		# Train Spark model</p>
<p>		print “now it is going to run train fucntion”<br/>
		sparkModel.train(rdd,nb_epoch=nbEpoch, batch_size=batchSize)</p>
<p>i am trying to implement  regression in Neural networks usign elphas and keras in python in a distributed way,but while trianing the i am getting to much high loss values , what i have to do ,give me any suggestions for go further.</p>
<div class="reply">
<a aria-label="Reply to Nandini" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404710#respond" onclick='return addComment.moveForm( "comment-404710", "404710", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404883">
<div class="comment-container" id="li-comment-404883">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404883" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I cannot help with distributing a Keras model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404883#respond" onclick='return addComment.moveForm( "comment-404883", "404883", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404857">
<div class="comment-container" id="li-comment-404857">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51dfe0346dd6dfdf5b8e13defa43e7d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51dfe0346dd6dfdf5b8e13defa43e7d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Foad</span>
<span class="date">July 6, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404857" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>two small points:<br/>
1. please mention in the text that it is required to have TensorFlow installed<br/>
2. CSV, means comma separated file, but data in the file are not separated by commas. not a big deal though</p>
<div class="reply">
<a aria-label="Reply to Foad" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404857#respond" onclick='return addComment.moveForm( "comment-404857", "404857", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404906">
<div class="comment-container" id="li-comment-404906">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404906" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404906#respond" onclick='return addComment.moveForm( "comment-404906", "404906", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404918">
<div class="comment-container" id="li-comment-404918">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c4fd3b54883ba718c8e3b2f0964ae92?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c4fd3b54883ba718c8e3b2f0964ae92?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Timothy Yan</span>
<span class="date">July 6, 2017 at 1:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-404918" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for the nice tutorial! In the post, you used “relu”, but I was wondering how to customize the activation function?</p>
<div class="reply">
<a aria-label="Reply to Timothy Yan" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=404918#respond" onclick='return addComment.moveForm( "comment-404918", "404918", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405217">
<div class="comment-container" id="li-comment-405217">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405217" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use sigmoid or tanh if you prefer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405217#respond" onclick='return addComment.moveForm( "comment-405217", "405217", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405095">
<div class="comment-container" id="li-comment-405095">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Don</span>
<span class="date">July 8, 2017 at 10:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405095" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the great tutorial!</p>
<p>What are the advantages of the deep learning library Keras (with let’s say TensorFlow as the backend) over the sklearn neuron network function MLPRegressor? In both cases, the procedure (input) is very similar, where you have to decide which architecture, activation functions, and solver you want to use.</p>
<p>Thanks,<br/>
Don</p>
<div class="reply">
<a aria-label="Reply to Don" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405095#respond" onclick='return addComment.moveForm( "comment-405095", "405095", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405260">
<div class="comment-container" id="li-comment-405260">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405260" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Speed of development and size of community.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405260#respond" onclick='return addComment.moveForm( "comment-405260", "405260", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-405358">
<div class="comment-container" id="li-comment-405358">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Don</span>
<span class="date">July 10, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405358" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the quick reply!</p>
<p>Can you please elaborate a little bit more?</p>
<p>When you are writing speed of development, can you please give a few practical examples for when it matters or what exactly you mean? When you are writing size of community, do you mean that the Keras/TensorFlow community is larger than the sklearn one? If not, what do you mean?</p>
<p>In addition, can you please add a few words on the epochs and batch_size parameters? Why is epochs used and not some tolerance, which makes more sense to me? Does it make sense that sometimes when I increase the the epocks value, the score decreases?</p>
<p>Thanks a  lot!<br/>
Don</p>
<div class="reply">
<a aria-label="Reply to Don" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405358#respond" onclick='return addComment.moveForm( "comment-405358", "405358", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-405471">
<div class="comment-container" id="li-comment-405471">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405471" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I believe it is easier/faster to develop models with Keras than other tools currently available.</p>
<p>I believe the Keras community is active and this is important to having the library stay current and useful. Keras is complementary to sklearn, tensorflow and theano.</p>
<p>One epoch is one pass through all training samples. One epoch is comprised of one or more batches. One batch involves a pass through one or more samples before updating the network weights.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405471#respond" onclick='return addComment.moveForm( "comment-405471", "405471", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405211">
<div class="comment-container" id="li-comment-405211">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/902c151373d6e3c407f200b462f1c9fd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/902c151373d6e3c407f200b462f1c9fd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adam</span>
<span class="date">July 9, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405211" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m a little confused. If you define x as:<br/>
X = dataset[:,0:13]</p>
<p>then the last column in X is the same as Y. Shouldn’t X be:<br/>
X = dataset[:,0:12]<br/>
and then<br/>
Y = dataset[:,13]</p>
<p>If you define X to include the outputs, why wouldn’t it just set all the weights for dataset[0:12] to zero then perfectly fit the data since it already knows the answer?</p>
<div class="reply">
<a aria-label="Reply to Adam" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405211#respond" onclick='return addComment.moveForm( "comment-405211", "405211", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-405554">
<div class="comment-container" id="li-comment-405554">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f530c13a149c4cabd50014dfe8ba516?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f530c13a149c4cabd50014dfe8ba516?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Justtestityourselfnexttime</span>
<span class="date">July 12, 2017 at 12:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405554" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>&gt; X = [0,1,2,3,4]<br/>
&gt; print(X[0:3])<br/>
[0, 1, 2]</p>
<p>End index is exclusive.</p>
<div class="reply">
<a aria-label="Reply to Justtestityourselfnexttime" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405554#respond" onclick='return addComment.moveForm( "comment-405554", "405554", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-405604">
<div class="comment-container" id="li-comment-405604">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405604" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. The more questions I get like this, the more I feel I need a post on basic numpy syntax.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405604#respond" onclick='return addComment.moveForm( "comment-405604", "405604", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405533">
<div class="comment-container" id="li-comment-405533">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f69c98b70e95bb35ba93f7dc044375ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f69c98b70e95bb35ba93f7dc044375ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nandu</span>
<span class="date">July 11, 2017 at 7:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405533" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What are methods to validate the regression model in keras?Please can you help in that</p>
<div class="reply">
<a aria-label="Reply to Nandu" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405533#respond" onclick='return addComment.moveForm( "comment-405533", "405533", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405597">
<div class="comment-container" id="li-comment-405597">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405597" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can estimate the skill of a model on unseen data using a validation dataset when fitting the model.</p>
<p>See the validation_split  and validation_data arguments to the fit() function:<br/>
<a href="https://keras.io/models/sequential/" rel="nofollow">https://keras.io/models/sequential/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405597#respond" onclick='return addComment.moveForm( "comment-405597", "405597", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405534">
<div class="comment-container" id="li-comment-405534">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f69c98b70e95bb35ba93f7dc044375ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f69c98b70e95bb35ba93f7dc044375ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ambika</span>
<span class="date">July 11, 2017 at 7:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405534" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how can we recognize the keras regresssion model and classification model with code.</p>
<div class="reply">
<a aria-label="Reply to Ambika" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405534#respond" onclick='return addComment.moveForm( "comment-405534", "405534", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405598">
<div class="comment-container" id="li-comment-405598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>By the choice of activation function on the output layer and the number of nodes.</p>
<p>Regression will use a linear activation, have one output and likely use a mse loss function.<br/>
Classification will use a softmax, tanh or sigmoid activation function, have one node per class (or one node for binary classification) and use a log loss function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405598#respond" onclick='return addComment.moveForm( "comment-405598", "405598", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405738">
<div class="comment-container" id="li-comment-405738">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f6be2871b4e3a99c3f5d5f80f16843f4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f6be2871b4e3a99c3f5d5f80f16843f4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">FrankLu</span>
<span class="date">July 13, 2017 at 11:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405738" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your tutotials and I find it helpful. However, I have a question.<br/>
When I use checkpoint callbacks in estimator.fit, it save a best trained weights, as a hd5 file.<br/>
But I cant load this pre trained weights, caz estimator does not have the method of load_weights which is one in keras models. What can I do, thank you!!!</p>
<div class="reply">
<a aria-label="Reply to FrankLu" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405738#respond" onclick='return addComment.moveForm( "comment-405738", "405738", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405759">
<div class="comment-container" id="li-comment-405759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 4:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must load the weights as a Keras model.</p>
<p>Learn more in this tutorial:<br/>
<a href="http://machinelearningmastery.com/check-point-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/check-point-deep-learning-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405759#respond" onclick='return addComment.moveForm( "comment-405759", "405759", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405750">
<div class="comment-container" id="li-comment-405750">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">July 13, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405750" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason<br/>
Thanks for the amazing tutorial! I learned alot from your blogs.<br/>
I have a question about np.random.seed.<br/>
What does the ‘np.random.seed’ actually do?<br/>
You explained that it is for reproducibility above but I didn’t understand what it means..</p>
<p>Thank you and hope you have a great one!</p>
<p>Best,<br/>
Paul</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405750#respond" onclick='return addComment.moveForm( "comment-405750", "405750", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405762">
<div class="comment-container" id="li-comment-405762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 4:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Many machine learning algorithms are stochastic by design:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>We can remove this randomness in tutorials (purely for demonstration purposes) by ensuring we have the same amount of randomness each time the code is run:<br/>
<a href="http://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow">http://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>
<p>This is not recommended for evaluating models in practice:<br/>
<a href="http://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>Does that help Paul?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405762#respond" onclick='return addComment.moveForm( "comment-405762", "405762", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405914">
<div class="comment-container" id="li-comment-405914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nandu</span>
<span class="date">July 14, 2017 at 7:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you suggest  the hidden activation functions for regression Neural networks other than relu.</p>
<div class="reply">
<a aria-label="Reply to nandu" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405914#respond" onclick='return addComment.moveForm( "comment-405914", "405914", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405998">
<div class="comment-container" id="li-comment-405998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2017 at 9:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-405998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, sigmoid and tanh were used for decades before relu came along.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=405998#respond" onclick='return addComment.moveForm( "comment-405998", "405998", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-406331">
<div class="comment-container" id="li-comment-406331">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nandini</span>
<span class="date">July 18, 2017 at 3:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406331" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have given tanh to regression model usign keras,i am not getting good results,you said tanh also supported for regression,please give me any suggesstions.</p>
<div class="reply">
<a aria-label="Reply to Nandini" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406331#respond" onclick='return addComment.moveForm( "comment-406331", "406331", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-406345">
<div class="comment-container" id="li-comment-406345">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 18, 2017 at 5:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406345" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, use a “linear” activation on the output layer for regression problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406345#respond" onclick='return addComment.moveForm( "comment-406345", "406345", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-406474">
<div class="comment-container" id="li-comment-406474">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NANDINI</span>
<span class="date">July 19, 2017 at 3:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406474" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>yeah of course , for output layer i have given the linear activation function only,but i am talking about hidden activation function i have given relu,if i would give tanh i am not getting good results.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-406480">
<div class="comment-container" id="li-comment-406480">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2017 at 4:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406480" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that. I have a list of ideas to try in this post:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406033">
<div class="comment-container" id="li-comment-406033">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b0b51019abd2982a7c1ab7fea5c6d77?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b0b51019abd2982a7c1ab7fea5c6d77?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wayne Tobin</span>
<span class="date">July 15, 2017 at 7:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406033" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Now that Keras and Tensorflow are available in R (RStudio) do you have any plans on doing above tutorial in R? I’ve got you book where you process the Boston Housing dataset using cubist and would love to see/run a direct comparison to get a sense of what improvement is possible.</p>
<div class="reply">
<a aria-label="Reply to Wayne Tobin" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406033#respond" onclick='return addComment.moveForm( "comment-406033", "406033", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406082">
<div class="comment-container" id="li-comment-406082">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 16, 2017 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406082" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps in the future, thanks for the suggestion Wayne.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406082#respond" onclick='return addComment.moveForm( "comment-406082", "406082", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-406417">
<div class="comment-container" id="li-comment-406417">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/abe1db0102bd719c92f8c65d506c803b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/abe1db0102bd719c92f8c65d506c803b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://greybeardgeek.com" rel="external nofollow">Ronald Levine</a></span>
<span class="date">July 19, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406417" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My problem is that everything is hidden in the Pipeline object.  How do I pull out the components, such as the model predict  method, then to pull out the predicted values to plot against the input values.</p>
<div class="reply">
<a aria-label="Reply to Ronald Levine" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406417#respond" onclick='return addComment.moveForm( "comment-406417", "406417", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406449">
<div class="comment-container" id="li-comment-406449">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406449" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Don’t use the Pipeline and pass data between the objects manually.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406449#respond" onclick='return addComment.moveForm( "comment-406449", "406449", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406484">
<div class="comment-container" id="li-comment-406484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nandu</span>
<span class="date">July 19, 2017 at 4:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have train the keras model, i need the logic for model.predict() ,how we are predicting the the values on test data,i have logic for predict_classes,but i don’t have logic for predict ,Please can you tell me logic for model.predict.</p>
<p> def predict_proba(self, X):<br/>
        a = X<br/>
        for i in range(self._num_layers):<br/>
            g = self._activations[i]<br/>
            W = self._weights[i]<br/>
            b = self._biases[i]<br/>
            a = g(np.dot(a, W.T) + b)<br/>
        print(len(a))<br/>
        return a</p>
<p>    def predict_classes(self, X):<br/>
        probs = self.predict_proba(X)<br/>
	print(np.argmax(probs,1))<br/>
        return np.argmax(probs,1)</p>
<p>predict_classes for classification.<br/>
i need predict logic for regression.</p>
<div class="reply">
<a aria-label="Reply to nandu" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406484#respond" onclick='return addComment.moveForm( "comment-406484", "406484", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406545">
<div class="comment-container" id="li-comment-406545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 20, 2017 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-406545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use the predict() function:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a659346284a0389627984" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
yhat = model.predict()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a659346284a0389627984-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a659346284a0389627984-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=406545#respond" onclick='return addComment.moveForm( "comment-406545", "406545", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-407307">
<div class="comment-container" id="li-comment-407307">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/828c04d27998e159abd135088d02775c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/828c04d27998e159abd135088d02775c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mustafa</span>
<span class="date">July 26, 2017 at 7:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407307" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the blog. I am trying to use the example for my case where I try to build a model and  evaluate it for audio data. I use only spectrum data. Original data are in .wav format.</p>
<p>However, I am getting an error </p>
<p>“TypeError: can’t pickle NotImplementedType objects” </p>
<p>in line results = cross_val_score(pipeline, X, Y, cv=kfold)<br/>
My data is very small, only 5 samples. </p>
<p>Do you have any idea for this error?</p>
<p>Best,<br/>
Mustafa</p>
<div class="reply">
<a aria-label="Reply to Mustafa" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407307#respond" onclick='return addComment.moveForm( "comment-407307", "407307", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407336">
<div class="comment-container" id="li-comment-407336">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407336" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend talking to the people from which you got the pickled data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407336#respond" onclick='return addComment.moveForm( "comment-407336", "407336", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-408996">
<div class="comment-container" id="li-comment-408996">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/558ef8ab8cfa46713cba0d7d4ff85b41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/558ef8ab8cfa46713cba0d7d4ff85b41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Heringsalat</span>
<span class="date">August 9, 2017 at 12:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-408996" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Mustafa,</p>
<p>how is your pipeline initialized/defined? I had the exactly same error message at a line where I used cross_val_score with the KerasRegressor estimator. When you use something like</p>
<p>estimator = KerasRegressor(build_fn=myModel, nb_epoch=100, batch_size=5, verbose=0)</p>
<p>with a Keras-Model “myModel” and NOT with a function called “myModel” to return the model after compiling it like in the tutorial at the beginning you should get the same Pickle error. You can reproduce it with the tutorial code via myModel=baseline_model().</p>
<p>I hope this is helpful…</p>
<p>Best regards,<br/>
Heringsalat</p>
<div class="reply">
<a aria-label="Reply to Heringsalat" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=408996#respond" onclick='return addComment.moveForm( "comment-408996", "408996", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407423">
<div class="comment-container" id="li-comment-407423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ambika</span>
<span class="date">July 26, 2017 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>why we are caluculating error rather than accuracy in regression problem,why accuracy does not make sence regression ,Please can you explain it.</p>
<div class="reply">
<a aria-label="Reply to ambika" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407423#respond" onclick='return addComment.moveForm( "comment-407423", "407423", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407484">
<div class="comment-container" id="li-comment-407484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2017 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We are not using accuracy. We are calculating error, specifically mean squared error (MSE).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407484#respond" onclick='return addComment.moveForm( "comment-407484", "407484", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-407520">
<div class="comment-container" id="li-comment-407520">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ambika</span>
<span class="date">July 27, 2017 at 2:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407520" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>why we are calculating mse rather than accuracy sir?</p>
<div class="reply">
<a aria-label="Reply to ambika" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407520#respond" onclick='return addComment.moveForm( "comment-407520", "407520", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-407612">
<div class="comment-container" id="li-comment-407612">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 28, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407612" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Because it is a regression problem and accuracy is only for classification problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407612#respond" onclick='return addComment.moveForm( "comment-407612", "407612", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-407665">
<div class="comment-container" id="li-comment-407665">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ambika</span>
<span class="date">July 28, 2017 at 3:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407665" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>while i am calulating loss and mse i am getting same values for regression,is that loss and mse are same in regression or different,if it is different ,how it is different,please can you explain it.</p>
<div class="reply">
<a aria-label="Reply to ambika" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407665#respond" onclick='return addComment.moveForm( "comment-407665", "407665", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407742">
<div class="comment-container" id="li-comment-407742">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407742" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Loss is the objective minimized by the network. If you use mse as the loss, then you will not need to track mse as a metric as well. They will be the same thing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407742#respond" onclick='return addComment.moveForm( "comment-407742", "407742", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407701">
<div class="comment-container" id="li-comment-407701">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/03bba779d35c00743cb497897cdb550a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03bba779d35c00743cb497897cdb550a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Masuk</span>
<span class="date">July 28, 2017 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407701" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello!<br/>
I am trying to train a ppg signal to estimate the heart rate i.e BPM.<br/>
Do you think it is appropriate to follow this structure?<br/>
If not please kindly help me by suggesting better methods.</p>
<p>Thank You!</p>
<div class="reply">
<a aria-label="Reply to Masuk" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407701#respond" onclick='return addComment.moveForm( "comment-407701", "407701", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407757">
<div class="comment-container" id="li-comment-407757">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-407757" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps. Also consider a time series formulation. Evaluate every framing you can think of.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=407757#respond" onclick='return addComment.moveForm( "comment-407757", "407757", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-408823">
<div class="comment-container" id="li-comment-408823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">August 7, 2017 at 1:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-408823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! 🙂<br/>
Thank you for great post! 🙂 I have a question about StandardScaler and Normalization.<br/>
What is difference between them? Also, can I use Min Max scaler instead of StandardScaler?</p>
<p>Thanks in advance.</p>
<p>Best,<br/>
Paul</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=408823#respond" onclick='return addComment.moveForm( "comment-408823", "408823", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408895">
<div class="comment-container" id="li-comment-408895">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2017 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-408895" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Normalization via the MinMaxScaler scales data between 0-1. Standardization via the StandardScaler subtracts the mean to give the distribution a mean of 0 and a standard deviation of 1.</p>
<p>Standardization is good for Gaussian distributions, normalization is good otherwise.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=408895#respond" onclick='return addComment.moveForm( "comment-408895", "408895", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-409077">
<div class="comment-container" id="li-comment-409077">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">August 9, 2017 at 1:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-409077" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ah ha! Thanks for replying me back! 🙂<br/>
I’ll try MinMaxScaler()</p>
<p>Best,<br/>
Paul</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=409077#respond" onclick='return addComment.moveForm( "comment-409077", "409077", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-409146">
<div class="comment-container" id="li-comment-409146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2017 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-409146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good luck Paul.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=409146#respond" onclick='return addComment.moveForm( "comment-409146", "409146", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-412419">
<div class="comment-container" id="li-comment-412419">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9feaca69d922a7e54eea179ea5a2f861?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9feaca69d922a7e54eea179ea5a2f861?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vipul</span>
<span class="date">September 3, 2017 at 7:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-412419" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Again, its very informative blog. I am implementing keras in R but I couldn´t find keras regressor to fit the model. Do you have workaround for this or could you please suggest what can be used as an alternative?</p>
<div class="reply">
<a aria-label="Reply to Vipul" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=412419#respond" onclick='return addComment.moveForm( "comment-412419", "412419", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412465">
<div class="comment-container" id="li-comment-412465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 4, 2017 at 4:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-412465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t know about Keras in R.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=412465#respond" onclick='return addComment.moveForm( "comment-412465", "412465", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-412787">
<div class="comment-container" id="li-comment-412787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d55bb6a4519ac6baffec491ac2a4a900?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d55bb6a4519ac6baffec491ac2a4a900?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James</span>
<span class="date">September 6, 2017 at 2:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-412787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason – Thanks for the post. </p>
<p>I’d love to hear about some other regression models Keras offers and your thoughts on their use-cases. </p>
<p>Thanks,<br/>
James</p>
<div class="reply">
<a aria-label="Reply to James" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=412787#respond" onclick='return addComment.moveForm( "comment-412787", "412787", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412957">
<div class="comment-container" id="li-comment-412957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-412957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean James? Do you have an example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=412957#respond" onclick='return addComment.moveForm( "comment-412957", "412957", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414027">
<div class="comment-container" id="li-comment-414027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohit Jain</span>
<span class="date">September 16, 2017 at 5:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi David,</p>
<p>Thanks of the tutorials. These have been very helpful both for the implementation side to getting an insight about the possibilities of machine learning in various fields. </p>
<p>I was trying to run the code in section 2 and came across the following error: </p>
<p>………………….<br/>
Traceback (most recent call last):<br/>
  File “regression.py”, line 48, in<br/>
    results = cross_val_score(estimator, X, Y, cv=kfold)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/model_selection/_validation.py”, line 321, in cross_val_score<br/>
    pre_dispatch=pre_dispatch)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/model_selection/_validation.py”, line 195, in cross_validate<br/>
    for train, test in cv.split(X, y, groups))<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py”, line 779, in __call__<br/>
    while self.dispatch_one_batch(iterator):<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py”, line 625, in dispatch_one_batch<br/>
    self._dispatch(tasks)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py”, line 588, in _dispatch<br/>
    job = self._backend.apply_async(batch, callback=cb)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/_parallel_backends.py”, line 111, in apply_async<br/>
    result = ImmediateResult(func)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/_parallel_backends.py”, line 332, in __init__<br/>
    self.results = batch()<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py”, line 131, in __call__<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/sklearn/model_selection/_validation.py”, line 437, in _fit_and_score<br/>
    estimator.fit(X_train, y_train, **fit_params)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/keras/wrappers/scikit_learn.py”, line 137, in fit<br/>
    self.model = self.build_fn(**self.filter_sk_params(self.build_fn))<br/>
  File “regression.py”, line 35, in baseline_model<br/>
    model.add(Dense(13, input_dim=13, kernel_initializer=’normal’, activation=’relu’))<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/keras/layers/core.py”, line 686, in __init__<br/>
    super(Dense, self).__init__(**kwargs)<br/>
  File “/home/mjennet/anaconda2/lib/python2.7/site-packages/keras/engine/topology.py”, line 307, in __init__<br/>
    assert kwarg in allowed_kwargs, ‘Keyword argument not understood: ‘ + kwarg<br/>
AssertionError: Keyword argument not understood: kernel_initializer<br/>
……………….</p>
<p>I tried to get more insight about the problem and came across the problem described by Mr. Partha which seems to be similar as mine and hence checked the version of Keras. The version of keras that I am using is 1.1.1 with tensorflow(1.2.1) as backend. Can you help me with this?</p>
<div class="reply">
<a aria-label="Reply to Mohit Jain" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414027#respond" onclick='return addComment.moveForm( "comment-414027", "414027", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414067">
<div class="comment-container" id="li-comment-414067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 17, 2017 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My name is Jason.</p>
<p>It looks like you need to update to Keras 2.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414067#respond" onclick='return addComment.moveForm( "comment-414067", "414067", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-421231">
<div class="comment-container" id="li-comment-421231">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohit Jain</span>
<span class="date">November 26, 2017 at 8:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421231" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Apologies Mr. Jason</p>
<p>I tried to upgrade Keras as well as other dependencies but again the same error pops up. I am currently working on Keras 2.1.1 with Numpy 1.13.3 and scipy 1.0.0</p>
<div class="reply">
<a aria-label="Reply to Mohit Jain" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421231#respond" onclick='return addComment.moveForm( "comment-421231", "421231", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-421283">
<div class="comment-container" id="li-comment-421283">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421283" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am surprised as your error suggests an older version of Keras. </p>
<p>I have a good list of places to get help with Keras here that you could try:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421283#respond" onclick='return addComment.moveForm( "comment-421283", "421283", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-422775">
<div class="comment-container" id="li-comment-422775">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c3309f8234acf4601c56b7b3607759c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c3309f8234acf4601c56b7b3607759c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bharath</span>
<span class="date">December 11, 2017 at 5:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422775" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the example. I get the same error too. Keras/Theano/sklearn: 2.1.2/0.90/0.19.1. Mohit, were you able to debug it?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-422821">
<div class="comment-container" id="li-comment-422821">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422821" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, I normally think it would be a version issue, but you look up to date.</p>
<p>I don’t have any good ideas, let me know if you learn more?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414854">
<div class="comment-container" id="li-comment-414854">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c855e0e7430061d74506e573ed298cf1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c855e0e7430061d74506e573ed298cf1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">asyraf</span>
<span class="date">September 26, 2017 at 4:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414854" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I used r2 metric on above code and figured that wider model has better score than deeper model. does this mean wider model is better than deeper? is r2 score a good metric to rate a regression model in this case?</p>
<div class="reply">
<a aria-label="Reply to asyraf" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414854#respond" onclick='return addComment.moveForm( "comment-414854", "414854", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414890">
<div class="comment-container" id="li-comment-414890">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414890" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, neural network models are stochastic, meaning that they can give different results each time they are run:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>I generally recommend this process to effectively evaluate neural networks:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414890#respond" onclick='return addComment.moveForm( "comment-414890", "414890", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414986">
<div class="comment-container" id="li-comment-414986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc74b4d5a676cbb21dadb2f1fe581a66?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc74b4d5a676cbb21dadb2f1fe581a66?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tim</span>
<span class="date">September 28, 2017 at 12:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-414986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, I am using your code from section</p>
<p>”<br/>
import numpy<br/>
import pandas<br/>
…<br/>
”</p>
<p>to this section</p>
<p>”<br/>
kfold = KFold(n_splits=10, random_state=seed)<br/>
results = cross_val_score(estimator, X, Y, cv=kfold)<br/>
print(“Results: %.2f (%.2f) MSE” % (results.mean(), results.std()))</p>
<p>”</p>
<p>but mean and std values are  always higher than your result</p>
<p>”<br/>
Results: 60.40 (41.96) MSE<br/>
”</p>
<p>where is the problem??</p>
<div class="reply">
<a aria-label="Reply to tim" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=414986#respond" onclick='return addComment.moveForm( "comment-414986", "414986", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415002">
<div class="comment-container" id="li-comment-415002">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2017 at 4:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-415002" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Machine learning algorithms are stochastic, it may simply be different results on different hardware/library versions.</p>
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=415002#respond" onclick='return addComment.moveForm( "comment-415002", "415002", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415078">
<div class="comment-container" id="li-comment-415078">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ae5ae8298f2a0530f37f57187cd282aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ae5ae8298f2a0530f37f57187cd282aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tim</span>
<span class="date">September 29, 2017 at 1:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-415078" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The result of cross_val_score </p>
<p>”<br/>
[ 10.79553125,   7.68724794,  11.24587975,  27.62757629,<br/>
        10.6425943 ,   8.12384602,   4.93369368,  91.03362441,<br/>
        13.37441713,  21.56249909]</p>
<p>”</p>
<p>are “Mean square error” ?? or something else??</p>
<p>If they are MSE,<br/>
can I say this prediction model is very bad??</p>
<div class="reply">
<a aria-label="Reply to tim" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=415078#respond" onclick='return addComment.moveForm( "comment-415078", "415078", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415154">
<div class="comment-container" id="li-comment-415154">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-415154" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The score are MSE. You could take the sqrt to convert them to RMSE.<br/>
How good a score is, depends on the skill of a baseline model (e.g. they’re relative) on the problem and domain knowledge (e.g. their interpretation).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=415154#respond" onclick='return addComment.moveForm( "comment-415154", "415154", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415725">
<div class="comment-container" id="li-comment-415725">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/db658d0e790079fe0e3fdbc15f442c65?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/db658d0e790079fe0e3fdbc15f442c65?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gabby</span>
<span class="date">October 5, 2017 at 7:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-415725" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am having issues with cross_val_score. Whenever I run the code, I get the error: </p>
<p>#TypeError: The added layer must be an instance of class Layer. Found: </p>
<p>Suggestions?</p>
<p>Thank you!</p>
<p>The full output:<br/>
Traceback (most recent call last):<br/>
  File “Y:\Tutorials\Keras_Regression_Tutorial\Keras_Regression_Tutorial\module1.py”, line 39, in<br/>
    results = cross_val_score(estimator, X, Y, cv=kfold)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\model_selection\_validation.py”, line 321, in cross_val_score<br/>
    pre_dispatch=pre_dispatch)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\model_selection\_validation.py”, line 195, in cross_validate<br/>
    for train, test in cv.split(X, y, groups))<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 779, in __call__<br/>
    while self.dispatch_one_batch(iterator):<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 625, in dispatch_one_batch<br/>
    self._dispatch(tasks)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 588, in _dispatch<br/>
    job = self._backend.apply_async(batch, callback=cb)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\_parallel_backends.py”, line 111, in apply_async<br/>
    result = ImmediateResult(func)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\_parallel_backends.py”, line 332, in __init__<br/>
    self.results = batch()<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 131, in __call__<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 131, in<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\sklearn\model_selection\_validation.py”, line 437, in _fit_and_score<br/>
    estimator.fit(X_train, y_train, **fit_params)<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\tensorflow\contrib\keras\python\keras\wrappers\scikit_learn.py”, line 157, in fit<br/>
    self.model = self.build_fn(**self.filter_sk_params(self.build_fn))<br/>
  File “Y:\Tutorials\Keras_Regression_Tutorial\Keras_Regression_Tutorial\module1.py”, line 25, in baseline_model<br/>
    model.add(Dense(13, input_dim=13, kernel_initializer=’normal’, activation=’relu’))<br/>
  File “C:\Users\Gabby\y35\lib\site-packages\tensorflow\contrib\keras\python\keras\models.py”, line 460, in add<br/>
    ‘Found: ‘ + str(layer))<br/>
TypeError: The added layer must be an instance of class Layer. Found:<br/>
Press any key to continue . . .</p>
<div class="reply">
<a aria-label="Reply to Gabby" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=415725#respond" onclick='return addComment.moveForm( "comment-415725", "415725", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415767">
<div class="comment-container" id="li-comment-415767">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-415767" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not seen this error before.</p>
<p>Confirm that you Python libraries including Keras and sklearn are up to date.</p>
<p>Confirm that you copied all of the code from the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=415767#respond" onclick='return addComment.moveForm( "comment-415767", "415767", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416271">
<div class="comment-container" id="li-comment-416271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Piotr</span>
<span class="date">October 11, 2017 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-416271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello! Thanks for really great tutorial. It’s help a lot! </p>
<p>But I have a question: Do you know how Can I use StandarsScaler in a pipeline, when I deal with CNN and 2D images? My X data has shape e.g. (39, 256, 256, 1). </p>
<p>It works perfectly without StandardScaler, but with StandardScaler I’ve got following error:<br/>
ValueError: Found array with dim 4. StandardScaler expected &lt;= 2.</p>
<p>Do you know how can I convert my input data and where in order to work with CNN, 2D images and StandardScaler?</p>
<div class="reply">
<a aria-label="Reply to Piotr" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=416271#respond" onclick='return addComment.moveForm( "comment-416271", "416271", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416300">
<div class="comment-container" id="li-comment-416300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-416300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using the built-in data scaling features for images built into Keras:<br/>
<a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/image-augmentation-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=416300#respond" onclick='return addComment.moveForm( "comment-416300", "416300", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-416331">
<div class="comment-container" id="li-comment-416331">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Piotr</span>
<span class="date">October 11, 2017 at 7:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-416331" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot, for quick response! It’s good to know that Keras has already ImageDataGenerator for augmenting images. </p>
<p>I have one more question, do you know how can I rescale back outputs from NN to original scale? I mean if ImageDataGenerator has something similar to StandardScaler.inverse_transform() from sci-kit learn?</p>
<div class="reply">
<a aria-label="Reply to Piotr" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=416331#respond" onclick='return addComment.moveForm( "comment-416331", "416331", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-416378">
<div class="comment-container" id="li-comment-416378">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 12, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-416378" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure, I don’t think so.</p>
<p>If the image is an input, why would you need to reverse the operation?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=416378#respond" onclick='return addComment.moveForm( "comment-416378", "416378", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-416448">
<div class="comment-container" id="li-comment-416448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Piotr</span>
<span class="date">October 12, 2017 at 9:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-416448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In my case output of my network is based on actual values of pixels. I think, that in my case I will simply omit standardization. But thank you for mentioning ImageDataGenerator, it will help me much in other cases 🙂</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417670">
<div class="comment-container" id="li-comment-417670">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">October 24, 2017 at 3:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417670" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
Thank you very much for your post<br/>
I use the data you uploaded.<br/>
However, when I print the MSE, it noticed that : Found input variables with inconsistent numbers of sample [506, 1]. It is the final sample in the data.<br/>
please help me</p>
<p>Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417670#respond" onclick='return addComment.moveForm( "comment-417670", "417670", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417692">
<div class="comment-container" id="li-comment-417692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow, can you restate the issue please?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417692#respond" onclick='return addComment.moveForm( "comment-417692", "417692", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417714">
<div class="comment-container" id="li-comment-417714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">October 24, 2017 at 11:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>At the end of step 2, evaluate the baseline model, I could’t print because that error:<br/>
” Found input variables with inconsistent numbers of sample [506, 1]. It is the final sample in the data.”</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417714#respond" onclick='return addComment.moveForm( "comment-417714", "417714", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417737">
<div class="comment-container" id="li-comment-417737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 3:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check that you copied all of the code exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417737#respond" onclick='return addComment.moveForm( "comment-417737", "417737", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417751">
<div class="comment-container" id="li-comment-417751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">October 24, 2017 at 5:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My mistake. I splitted data into columns already in Excel by “Text to Columns” function.</p>
<p>Thank you so much 🙂</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417751#respond" onclick='return addComment.moveForm( "comment-417751", "417751", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417801">
<div class="comment-container" id="li-comment-417801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/91188f73bdfea9efe87a0e1b61e1ea76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/91188f73bdfea9efe87a0e1b61e1ea76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harry</span>
<span class="date">October 25, 2017 at 2:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much for these articles.  Two questions:</p>
<p>1)  You state “a mean squared error loss function is [used]….This will be the same metric that we will use to evaluate the performance of the model.”  I see where ‘mean_squared_error’ is passed as the ‘loss’, but there no ‘metrics=[…]’ arg passed.  Does Keras simply use the ‘loss’ function as the metric, if no metric is specified?</p>
<p>2)  I recreated this experiment and added the arg “shuffle=True” to the KFold function.  This appears to improve performance down to 13.52 (6.99) MSE (wider_model).  Any thoughts on this potential optimization?  It seemed almost “too good to be true”.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Harry" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417801#respond" onclick='return addComment.moveForm( "comment-417801", "417801", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417834">
<div class="comment-container" id="li-comment-417834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 6:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, Keras will report the loss and the metrics during training, this post might help you understand what is going on:<br/>
<a href="https://machinelearningmastery.com/custom-metrics-deep-learning-keras-python/" rel="nofollow">https://machinelearningmastery.com/custom-metrics-deep-learning-keras-python/</a></p>
<p>Great work. </p>
<p>The result might not be real (e.g. not statistically significant), consider this methodology for evaluating deep learning model skill:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417834#respond" onclick='return addComment.moveForm( "comment-417834", "417834", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417938">
<div class="comment-container" id="li-comment-417938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">October 26, 2017 at 3:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello<br/>
The NN model you created contains 1 output.</p>
<p>I have a problem with more than 1 output.<br/>
I want to apply this code by modifying it. Is it ok ?<br/>
Can you suggest some solutions or notice to solve the problem?</p>
<p>Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417938#respond" onclick='return addComment.moveForm( "comment-417938", "417938", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417970">
<div class="comment-container" id="li-comment-417970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 26, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-417970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can change the number of outputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=417970#respond" onclick='return addComment.moveForm( "comment-417970", "417970", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418021">
<div class="comment-container" id="li-comment-418021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">October 26, 2017 at 6:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I’m getting an error when running this code. I have karas 2, and scikit learn .17 installed. I keep getting this error:</p>
<p>Connected to pydev debugger (build 172.3968.37)<br/>
Using TensorFlow backend.<br/>
Traceback (most recent call last):<br/>
  File “/home/b/pycharm-community-2017.2.3/helpers/pydev/pydevd.py”, line 1599, in<br/>
    globals = debugger.run(setup[‘file’], None, None, is_module)<br/>
  File “/home/b/pycharm-community-2017.2.3/helpers/pydev/pydevd.py”, line 1026, in run<br/>
    pydev_imports.execfile(file, globals, locals)  # execute the script<br/>
  File “/home/b/PycharmProjects/ANN1a/ANN2-Keras1a”, line 6, in<br/>
    from sklearn.model_selection import cross_val_score<br/>
ImportError: No module named model_selection<br/>
Backend TkAgg is interactive backend. Turning interactive mode on.</p>
<p>Is it saying I have no module for Sklearn because I only have .17 instead of the current version which i think is .19? I’m having a lot of trouble updating my scikit-learn package.</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418021#respond" onclick='return addComment.moveForm( "comment-418021", "418021", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418051">
<div class="comment-container" id="li-comment-418051">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 5:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418051" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need to update your sklearn to 0.18 or higher.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418051#respond" onclick='return addComment.moveForm( "comment-418051", "418051", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418138">
<div class="comment-container" id="li-comment-418138">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">October 27, 2017 at 11:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418138" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason I need some help with this error message. I’m not sure whats going on with it.</p>
<p>‘ValueError: could not convert string to float: Close’</p>
<p>I think it may be talking about one of my columns in my dataset.csv file which is named ‘Close’.</p>
<p>Here is the code:</p>
<p>import numpy<br/>
import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasRegressor<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.preprocessing import StandardScaler<br/>
from sklearn.pipeline import Pipeline</p>
<p># load dataset<br/>
dataframe = pandas.read_csv(“PTNprice.csv”, delim_whitespace=True, header=None, usecols=[1,2,3,4])<br/>
dataset = dataframe.values<br/>
# split into input (X) and output (Y) variables<br/>
X = dataset[:,0:4]<br/>
Y = dataset[:,1]</p>
<p># define the model<br/>
def larger_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(100, input_dim=4, kernel_initializer=’normal’, activation=’relu’))<br/>
	model.add(Dense(50, kernel_initializer=’normal’, activation=’relu’))<br/>
	model.add(Dense(1, kernel_initializer=’normal’))<br/>
	# Compile model<br/>
	model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br/>
	return model</p>
<p># fix random seed for reproducibility<br/>
seed = 7<br/>
numpy.random.seed(seed)</p>
<p># evaluate model with standardized dataset<br/>
numpy.random.seed(seed)<br/>
estimators = []<br/>
estimators.append((‘standardize’, StandardScaler()))<br/>
estimators.append((‘mlp’, KerasRegressor(build_fn=larger_model, epochs=50, batch_size=5, verbose=0)))<br/>
pipeline = Pipeline(estimators)<br/>
kfold = KFold(n_splits=10, random_state=seed)<br/>
results = cross_val_score(pipeline, X, Y, cv=kfold)<br/>
print(“Standardized: %.2f (%.2f) MSE” % (results.mean(), results.std()))</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418138#respond" onclick='return addComment.moveForm( "comment-418138", "418138", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418171">
<div class="comment-container" id="li-comment-418171">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418171" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you using the code and the data from the tutorial?</p>
<p>Did you copy it all exactly, including indenting?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418171#respond" onclick='return addComment.moveForm( "comment-418171", "418171", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418181">
<div class="comment-container" id="li-comment-418181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">October 28, 2017 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>No my code is modified to try and handle a new data text. I felt the data was very similar to the original dataset. I actually got it to work with no errors. I just changed header=none to header=1</p>
<p>code:</p>
<p># load dataset<br/>
dataframe = pandas.read_csv(“PTNprice.csv”, delim_whitespace=True, header=1, usecols=[1,2,3,4])<br/>
dataset = dataframe.values<br/>
# split into input (X) and output (Y) variables<br/>
X = dataset[:,0:4]<br/>
Y = dataset[:,1]</p>
<p>  It took longer then expected for the script to finish. I’m trying to get it to make a prediction as well, but my output is less the satisfactory. Here is what the out gave me. What does this mean do you think?</p>
<p>output:</p>
<p>Larger: 0.00 (0.00) MSE<br/>
[ 0.78021598  0.79241288  0.81000006 …,  3.64232779  3.59621549<br/>
  3.79605269]</p>
<p>My data is just stock prices from a 10 year period example: 0.75674  0.9655  3.753  1.0293<br/>
columns set up like this.</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418181#respond" onclick='return addComment.moveForm( "comment-418181", "418181", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-418281">
<div class="comment-container" id="li-comment-418281">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418281" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may need to tune the model for your specific problem, here are some ideas on how to get better skill:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418281#respond" onclick='return addComment.moveForm( "comment-418281", "418281", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418939">
<div class="comment-container" id="li-comment-418939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b317bb73f8da18112cf15ab188f2e810?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b317bb73f8da18112cf15ab188f2e810?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Duccio</span>
<span class="date">November 4, 2017 at 4:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>thank you so much, these courses are great, and very helpful !</p>
<p>I have written the code, following yours, but with the only difference that I have not used Pipeline, and take care of the scaling separately </p>
<p>seed = 7<br/>
np.random.seed(seed)</p>
<p>X = (X – X.mean(axis=0))/X.std(axis=0)</p>
<p>estimator = KerasRegressor(build_fn=baseline_model, nb_epoch = 100, batch_size=5,verbose=0)</p>
<p>kfold = KFold(n_splits=10,random_state=seed)</p>
<p>results = cross_val_score(estimator, X, y, cv=kfold)</p>
<p>For some reason, I don’t understand, your method constantly produces better results. Any idea why it performs  better ? </p>
<p>Thanks a lot</p>
<div class="reply">
<a aria-label="Reply to Duccio" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418939#respond" onclick='return addComment.moveForm( "comment-418939", "418939", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418956">
<div class="comment-container" id="li-comment-418956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-418956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It might be a statistical fluke, try varying the random seed and repeat the experiment 10 to 30 times and take the average score for each model. </p>
<p>This post has more ideas on effective ways to evaluate stochastic algorithms:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=418956#respond" onclick='return addComment.moveForm( "comment-418956", "418956", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-419122">
<div class="comment-container" id="li-comment-419122">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b317bb73f8da18112cf15ab188f2e810?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b317bb73f8da18112cf15ab188f2e810?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Duccio</span>
<span class="date">November 6, 2017 at 9:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-419122" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much. I will do that.</p>
<div class="reply">
<a aria-label="Reply to Duccio" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=419122#respond" onclick='return addComment.moveForm( "comment-419122", "419122", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419180">
<div class="comment-container" id="li-comment-419180">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">November 7, 2017 at 7:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-419180" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Just wanted to stop by and say thanks again!</p>
<p>I’ve been tweaking my learning models for the past three days and this is what I got</p>
<p>Larger: 0.12 (0.36) MSE</p>
<p>That’s pretty good right? I’m using a different data set from you, but it is very similar in structure. I was having a underfitting problem with my model for a while and I was getting like 500%(500%) error. I realized that I needed to make it a bit more complex. So I tripled my features, made my layers deeper and wider at the same time, as well as up the amount of epochs to 50000 and batch size to 10000. I also changed the number of splits from 10 to 25.</p>
<p>Question: Will I be able to get a smaller error% or is “Larger: 0.12 (0.36) MSE” about the lowest I can expect?</p>
<p>thanks again Jason,</p>
<p>Brence</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=419180#respond" onclick='return addComment.moveForm( "comment-419180", "419180", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419209">
<div class="comment-container" id="li-comment-419209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-419209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work.</p>
<p>I’m not sure of the limits of this problem, push as much as you have time/interest. In practice “good” is relative to what you have achieved previously. This is a good lesson in applied ML!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=419209#respond" onclick='return addComment.moveForm( "comment-419209", "419209", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419613">
<div class="comment-container" id="li-comment-419613">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e89aa08373673b19508354c85ddea41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">November 10, 2017 at 7:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-419613" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Sir.</p>
<p>I applied your code and used it to predict successfully. </p>
<p>As same as my last question. I want to add 1 more output: the age of house: has built in 5 years, 7 years, 10 years….. for instance. The price and age are independent.<br/>
This is not a classify problem as I know.<br/>
So, would you suggest a code or what should I do next to solve the problem, please ?</p>
<p>Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=419613#respond" onclick='return addComment.moveForm( "comment-419613", "419613", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419959">
<div class="comment-container" id="li-comment-419959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">November 14, 2017 at 11:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-419959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it possible to do a recursive multi step forecast prediction with this regression model?</p>
<p>I’m not sure how this code would fit into this.</p>
<p>prediction(t+1) = model(obs(t-1), obs(t-2), …, obs(t-n))<br/>
prediction(t+2) = model(prediction(t+1), obs(t-1), …, obs(t-n))</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=419959#respond" onclick='return addComment.moveForm( "comment-419959", "419959", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420034">
<div class="comment-container" id="li-comment-420034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2017 at 9:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-420034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, perhaps this post could be used a template:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=420034#respond" onclick='return addComment.moveForm( "comment-420034", "420034", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420396">
<div class="comment-container" id="li-comment-420396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a7fbe53506bead80a21a60c3a8b82e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a7fbe53506bead80a21a60c3a8b82e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Toby</span>
<span class="date">November 18, 2017 at 3:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-420396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your tutorial. I just tried running your sample code for step 2 but unfortunately obtained a negative MSE which obviously does not make sense. </p>
<p>Results: -57.82 (42.31) MSE</p>
<p>Any ideas?</p>
<p>The code is exactly the same with minor exception that I had to changed<br/>
model.compile(loss=’mean_square_error’,optimizer=’adam’)<br/>
to:<br/>
model.compile(loss=’mse’,optimizer=’adam’)</p>
<p>Thanks<br/>
Toby</p>
<div class="reply">
<a aria-label="Reply to Toby" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=420396#respond" onclick='return addComment.moveForm( "comment-420396", "420396", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420432">
<div class="comment-container" id="li-comment-420432">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2017 at 10:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-420432" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, sklearn inverts minimizing scores to make them maximizing for optimization. Just take the absolute value.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=420432#respond" onclick='return addComment.moveForm( "comment-420432", "420432", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-420784">
<div class="comment-container" id="li-comment-420784">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a7fbe53506bead80a21a60c3a8b82e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a7fbe53506bead80a21a60c3a8b82e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Toby</span>
<span class="date">November 22, 2017 at 7:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-420784" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great thanks. Yes I found this out after I posed the question.</p>
<div class="reply">
<a aria-label="Reply to Toby" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=420784#respond" onclick='return addComment.moveForm( "comment-420784", "420784", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-420826">
<div class="comment-container" id="li-comment-420826">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 11:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-420826" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=420826#respond" onclick='return addComment.moveForm( "comment-420826", "420826", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421255">
<div class="comment-container" id="li-comment-421255">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af50c453afcc377880bafe313966d94e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohit Jain</span>
<span class="date">November 27, 2017 at 2:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421255" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you this amazing tutorial. I just wanted to know what are the ways such that we can predict the output of neural network for some specific values of X and compare the performance by plotting the predicted and actual value </p>
<p>Thanks</p>
<p>Mohit</p>
<div class="reply">
<a aria-label="Reply to Mohit Jain" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421255#respond" onclick='return addComment.moveForm( "comment-421255", "421255", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421287">
<div class="comment-container" id="li-comment-421287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It really depends on the application as to what and how to plot.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421287#respond" onclick='return addComment.moveForm( "comment-421287", "421287", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421862">
<div class="comment-container" id="li-comment-421862">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26c8fed8fd5077f46867b6804f501596?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26c8fed8fd5077f46867b6804f501596?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Moritz</span>
<span class="date">December 1, 2017 at 8:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421862" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
first: thanks for this and all your other amazing tutorials. Really helps a lot as a beginner to get actual useful advice.<br/>
However, I reached a point where I’m looking for further advice – hope you can help me out!<br/>
I understand the concept of regression and MSE – in my case, I try to predict two values based on various other parameters. It’s really not complicated and the correlation between the values is pretty clear, so I think this shouldn’t be a problem.<br/>
Now when having a value predicted, I don’t want to know the MSE but I’d rather know, if the prediction is within a certain range from the original value.<br/>
Example:<br/>
‘accepted’ range: y +/- 0,1<br/>
y = 1<br/>
y^ = 1,08<br/>
y – y^ = | 0,08| –&gt; OK, because it’s within y +/- 0,1.</p>
<p>Is there a way to do this in Python or KERAS? I just started working with it, so any advice would be helpful. Thanks!</p>
<div class="reply">
<a aria-label="Reply to Moritz" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421862#respond" onclick='return addComment.moveForm( "comment-421862", "421862", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421909">
<div class="comment-container" id="li-comment-421909">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 8:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-421909" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can calculate a confidence interval for linear models.</p>
<p>I have an example for linear regression on time series here that might give you ideas:<br/>
<a href="https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=421909#respond" onclick='return addComment.moveForm( "comment-421909", "421909", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422073">
<div class="comment-container" id="li-comment-422073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26c8fed8fd5077f46867b6804f501596?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26c8fed8fd5077f46867b6804f501596?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Moritz</span>
<span class="date">December 4, 2017 at 12:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks! I will look into that.</p>
<div class="reply">
<a aria-label="Reply to Moritz" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422073#respond" onclick='return addComment.moveForm( "comment-422073", "422073", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422900">
<div class="comment-container" id="li-comment-422900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4f407e0c54e0673da3b526fd3315108?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4f407e0c54e0673da3b526fd3315108?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chenys</span>
<span class="date">December 12, 2017 at 7:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your tutorial.<br/>
I want to know</p>
<p>if a regression problem dataset a 10000 feature. the input_dim is so big …….but all the feature are meaningful(it’s an procedure data)  and can’t be delete.</p>
<p>how to change this example to handle my problem,and what should i care,is there any trick?</p>
<div class="reply">
<a aria-label="Reply to chenys" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422900#respond" onclick='return addComment.moveForm( "comment-422900", "422900", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422941">
<div class="comment-container" id="li-comment-422941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can use a projection such as PCA? SVD? or others?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422941#respond" onclick='return addComment.moveForm( "comment-422941", "422941", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-422943">
<div class="comment-container" id="li-comment-422943">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/302c7534e57c25ab4241fdf3fdf5ca67?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/302c7534e57c25ab4241fdf3fdf5ca67?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve</span>
<span class="date">December 13, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422943" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason – Thank you for all these tutorials. These are awesome!!</p>
<p>Since the NN architecture is black box. Is there a way to access hidden layer data for debugging? When I run the regression code (from above) I get slightly different numbers. Thx again!</p>
<div class="reply">
<a aria-label="Reply to Steve" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422943#respond" onclick='return addComment.moveForm( "comment-422943", "422943", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422962">
<div class="comment-container" id="li-comment-422962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-422962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will get different numbers every time you run the same algorithm on the same data Steve. This is a feature, not a bug:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>You can access the layers on the model as an array: model.layers I think.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=422962#respond" onclick='return addComment.moveForm( "comment-422962", "422962", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425023">
<div class="comment-container" id="li-comment-425023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">December 28, 2017 at 11:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, </p>
<p>Is it possible to get an prediction output for each column used in the dataset? Like for example the dataset was made up of<br/>
                                                             12  1    22  45<br/>
                                                             2    34  55  8           like this. Could I get it to give me four output numbers, one for each column in the dataset?</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425023#respond" onclick='return addComment.moveForm( "comment-425023", "425023", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425030">
<div class="comment-container" id="li-comment-425030">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 28, 2017 at 2:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425030" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can call model.predict()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425030#respond" onclick='return addComment.moveForm( "comment-425030", "425030", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-425054">
<div class="comment-container" id="li-comment-425054">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">December 28, 2017 at 10:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425054" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>but how do I predict for more then one column in the dataset? My dataset has 6 of them, and my output always has just 5 columns. Which leads me to believe that its just predicting for one column instead of all 6. Could I accomplish this by setting the output layer to have more then one neuron?</p>
<div class="reply">
<a aria-label="Reply to Brence" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425054#respond" onclick='return addComment.moveForm( "comment-425054", "425054", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-425076">
<div class="comment-container" id="li-comment-425076">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 29, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425076" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could configure the model to predict a vector via the number of neurons in the output layer.</p>
<p>You could configure the model output one column at a time via an encoder-decoder model.</p>
<p>I have examples of each on the blog.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425076#respond" onclick='return addComment.moveForm( "comment-425076", "425076", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-425102">
<div class="comment-container" id="li-comment-425102">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dc75cf969613e11e25ebf825c71a04d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brence</span>
<span class="date">December 29, 2017 at 9:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425102" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is exactly what I was looking for. I found your examples on the blog. Thank you so much Jason.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-425121">
<div class="comment-container" id="li-comment-425121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 29, 2017 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425441">
<div class="comment-container" id="li-comment-425441">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">January 2, 2018 at 6:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425441" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your tutorial! I’m not a programmer or anything, in fact, I’ve never wriiten a line of code my entire life. But I find your tutorial very helpful.<br/>
Recently I came acoss a regression problem and I tried to solve it using deep learning. So I followed this article and step by step I got Keras up and running and got a result. The problem is I don’t know how to tune the neural network and optimize it. The result I got is far from satisfactory. Do I have to adjust the parameter of the model one by one and see how it goes or is there a quicker way to optimize the neural network?<br/>
Also I see there’s a mini-course here, and I tried so sign up for it but I didn’t get the email. Maybe because I’m from China or anything, I don’t know. Is there any crash course I can get? cause I know nothing about Python yet…</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425441#respond" onclick='return addComment.moveForm( "comment-425441", "425441", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425477">
<div class="comment-container" id="li-comment-425477">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425477" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done!</p>
<p>This post will show you how to tune a network:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>You can access the mini course here:<br/>
<a href="http://machinelearningmastery.com/applied-deep-learning-in-python-mini-course/" rel="nofollow">http://machinelearningmastery.com/applied-deep-learning-in-python-mini-course/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425477#respond" onclick='return addComment.moveForm( "comment-425477", "425477", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-426926">
<div class="comment-container" id="li-comment-426926">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">January 19, 2018 at 8:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426926" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your response. I have another quesion though. The lines involving the ‘estimator’ is for training the model, right? How can I save the model and use it for prediction?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426926#respond" onclick='return addComment.moveForm( "comment-426926", "426926", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-426984">
<div class="comment-container" id="li-comment-426984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 20, 2018 at 8:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426984#respond" onclick='return addComment.moveForm( "comment-426984", "426984", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-427020">
<div class="comment-container" id="li-comment-427020">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">January 20, 2018 at 8:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-427020" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much! I’ve learnt a lot. In this example I can use pipeline.fit(X,Y) to train the model and use pipeline.predict(X) for prediction, is that right? I think the ‘pipeline’ in the tutorial involves the standardization process. So when I use pipeline.predict(X) I can just put in raw data and get the prediction and the prediction will be the inverse-standardization result. Am I understanding this right?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-427050">
<div class="comment-container" id="li-comment-427050">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2018 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-427050" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe so.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425528">
<div class="comment-container" id="li-comment-425528">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b83acb811644ae0d589be1345bb13e29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b83acb811644ae0d589be1345bb13e29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatma</span>
<span class="date">January 3, 2018 at 7:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425528" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I need to ask for this line X = dataset[:,0:13], as I can see from the data set it contains 14 columns (0 to 13) and the last column is the labels column then this line should be X = dataset [:,0:12]. is it correct or I’m wrong?</p>
<div class="reply">
<a aria-label="Reply to fatma" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425528#respond" onclick='return addComment.moveForm( "comment-425528", "425528", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425576">
<div class="comment-container" id="li-comment-425576">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425576" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. You can learn more about slicing arrays here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425576#respond" onclick='return addComment.moveForm( "comment-425576", "425576", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425563">
<div class="comment-container" id="li-comment-425563">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ba587052add6f256834112f7eee27159?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ba587052add6f256834112f7eee27159?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanya</span>
<span class="date">January 4, 2018 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425563" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am trying to apply the code in this tutorial to forecast my time series data. But since the beginning when I am trying to split the data into X and Y, I am getting an error “TypeError: unhashable type: ‘slice'”. Unfortunately I cannot find the source of it.<br/>
Can you help me?<br/>
Thanks in advance!</p>
<p>runfile(‘D:/LOCAL_DROPBOX/MasterArbeit_Sammlung_V01/Python/MasterArbeit/ARIMA/Test/BaselineRegressionKNN.py’, wdir=’D:/LOCAL_DROPBOX/MasterArbeit_Sammlung_V01/Python/MasterArbeit/ARIMA/Test’)<br/>
[[‘3,6’ ‘20,3’ ‘0’ …, 173 1136 0]<br/>
 [‘11,4’ ‘18,8’ ‘15,2’ …, 105 1676 0]<br/>
 [‘8,9’ ‘15,3’ ‘1,4’ …, 372 733 0]<br/>
 …,<br/>
 [‘-2,3’ ‘4,5’ ‘0’ …, 0 0 0]<br/>
 [‘0,2’ ‘7,9’ ‘0’ …, 0 0 0]<br/>
 [‘-3,5’ ‘4,4’ ‘0’ …, 0 0 0]]<br/>
Traceback (most recent call last):</p>
<p>  File “”, line 1, in<br/>
    runfile(‘D:/LOCAL_DROPBOX/MasterArbeit_Sammlung_V01/Python/MasterArbeit/ARIMA/Test/BaselineRegressionKNN.py’, wdir=’D:/LOCAL_DROPBOX/MasterArbeit_Sammlung_V01/Python/MasterArbeit/ARIMA/Test’)</p>
<p>  File “C:\Users\Tanya\Anaconda3\lib\site-packages\spyder\utils\site\sitecustomize.py”, line 710, in runfile<br/>
    execfile(filename, namespace)</p>
<p>  File “C:\Users\Tanya\Anaconda3\lib\site-packages\spyder\utils\site\sitecustomize.py”, line 101, in execfile<br/>
    exec(compile(f.read(), filename, ‘exec’), namespace)</p>
<p>  File “D:/LOCAL_DROPBOX/MasterArbeit_Sammlung_V01/Python/MasterArbeit/ARIMA/Test/BaselineRegressionKNN.py”, line 25, in<br/>
    X = dataset[:,0:8]</p>
<p>  File “C:\Users\Tanya\Anaconda3\lib\site-packages\pandas\core\frame.py”, line 2139, in __getitem__<br/>
    return self._getitem_column(key)</p>
<p>  File “C:\Users\Tanya\Anaconda3\lib\site-packages\pandas\core\frame.py”, line 2146, in _getitem_column<br/>
    return self._get_item_cache(key)</p>
<p>  File “C:\Users\Tanya\Anaconda3\lib\site-packages\pandas\core\generic.py”, line 1840, in _get_item_cache<br/>
    res = cache.get(item)</p>
<p>TypeError: unhashable type: ‘slice’</p>
<div class="reply">
<a aria-label="Reply to Tanya" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425563#respond" onclick='return addComment.moveForm( "comment-425563", "425563", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425587">
<div class="comment-container" id="li-comment-425587">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425587" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about array slicing here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425587#respond" onclick='return addComment.moveForm( "comment-425587", "425587", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425902">
<div class="comment-container" id="li-comment-425902">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d59825d8fadf97a83c8ebbca7a0cd199?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d59825d8fadf97a83c8ebbca7a0cd199?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Oscar Reyes</span>
<span class="date">January 9, 2018 at 3:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425902" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Regarding to “A further extension of this section would be to similarly apply a rescaling to the output variable such as normalizing it to the range of 0-1”.</p>
<p>I do not know how can I get that the StandarScaler object also apply the transformation to the ouput variable Y, instead of applying it only over X . I did the following</p>
<p>results = cross_val_score(pipeline, preprocessing.scale(X), preprocessing.scale(Y), cv=kfold)</p>
<p>However, in this way the preprocessing step is made prior to the kfold cross validation, and not in each fold execution as in your previous example.</p>
<div class="reply">
<a aria-label="Reply to Oscar Reyes" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425902#respond" onclick='return addComment.moveForm( "comment-425902", "425902", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425925">
<div class="comment-container" id="li-comment-425925">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-425925" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the data preparation would have to happen prior to cross validation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=425925#respond" onclick='return addComment.moveForm( "comment-425925", "425925", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426224">
<div class="comment-container" id="li-comment-426224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b83acb811644ae0d589be1345bb13e29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b83acb811644ae0d589be1345bb13e29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatma</span>
<span class="date">January 11, 2018 at 7:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How we can draw the relation between the expected  values and the prediction one</p>
<div class="reply">
<a aria-label="Reply to fatma" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426224#respond" onclick='return addComment.moveForm( "comment-426224", "426224", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426258">
<div class="comment-container" id="li-comment-426258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using matplotlib.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426258#respond" onclick='return addComment.moveForm( "comment-426258", "426258", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426762">
<div class="comment-container" id="li-comment-426762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reed Guo</span>
<span class="date">January 18, 2018 at 12:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
When I search some tutorials on google, if your posts appears, I always check your blog first.</p>
<p>Thanks very much.</p>
<div class="reply">
<a aria-label="Reply to Reed Guo" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426762#respond" onclick='return addComment.moveForm( "comment-426762", "426762", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426803">
<div class="comment-container" id="li-comment-426803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I hope they help.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426803#respond" onclick='return addComment.moveForm( "comment-426803", "426803", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426767">
<div class="comment-container" id="li-comment-426767">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reed Guo</span>
<span class="date">January 18, 2018 at 2:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426767" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>What is the activation function of the output layer? You didn’t write it.</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Reed Guo" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426767#respond" onclick='return addComment.moveForm( "comment-426767", "426767", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426807">
<div class="comment-container" id="li-comment-426807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/#comment-426807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Linear, which is the default.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/?replytocom=426807#respond" onclick='return addComment.moveForm( "comment-426807", "426807", "respond", "2571" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/regression-tutorial-keras-deep-learning-library-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2571"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="515b728935"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="179"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>