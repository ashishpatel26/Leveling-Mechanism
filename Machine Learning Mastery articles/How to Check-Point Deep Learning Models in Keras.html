<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<title>How to Check-Point Deep Learning Models in Keras - Machine Learning Mastery</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v6.1.1 - https://yoa.st/1yg?utm_content=6.1.1 -->
<link href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Check-Point Deep Learning Models in Keras - Machine Learning Mastery" property="og:title"/>
<meta content="Deep learning models can take hours, days or even weeks to train. If the run is stopped unexpectedly, you can lose a lot of work. In this post you will discover how you can check-point your deep learning models during training in Python using the Keras library. Let’s get started. Update Mar/2017: Updated example for …" property="og:description"/>
<meta content="https://machinelearningmastery.com/check-point-deep-learning-models-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-06-15T05:00:13+11:00" property="article:published_time"/>
<meta content="2017-03-31T08:30:02+11:00" property="article:modified_time"/>
<meta content="2017-03-31T08:30:02+11:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/How-to-Check-Point-Deep-Learning-Models-in-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/How-to-Check-Point-Deep-Learning-Models-in-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="480" property="og:image:height"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/machinelearningmastery.com\/","name":"Machine Learning Mastery","potentialAction":{"@type":"SearchAction","target":"https:\/\/machinelearningmastery.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/check-point-deep-learning-models-keras\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//cdnjs.cloudflare.com" rel="dns-prefetch"/>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/feed/" rel="alternate" title="Machine Learning Mastery » How to Check-Point Deep Learning Models in Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9.2" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-font-awesome-css" media="all" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=Open+Sans&amp;ver=4.9.2" id="apss-font-opensans-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/css/frontend.css?ver=4.2.2.0.iis7_supports_permalinks" id="apss-frontend-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.2" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.2" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2575" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fcheck-point-deep-learning-models-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fcheck-point-deep-learning-models-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript><img height="1" src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"/></noscript>
<!-- End Facebook Pixel Code -->
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2575 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningMastery.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-3"> <div class="textwidget"><br/>
<div style="font-size:12pt;">
<a href="/start-here"><strong>Start Here</strong></a>
     
<a href="/blog">Blog</a>
     
<a href="/products">Books</a>
     
<a href="/about">About</a>
     
<a href="/contact">Contact</a>
</div></div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div><div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Empty Menu</h3> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2575 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">How to Check-Point Deep Learning Models in Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-15T05:00:13+1100">June 15, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fcheck-point-deep-learning-models-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/check-point-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/check-point-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/&amp;summary=Deep+learning+models+can+take+hours%2C+days+or+even+weeks+to+train.%0D%0A%0D%0AIf+the+run+is+stopped+unexpecte..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/&amp;summary=Deep+learning+models+can+take+hours%2C+days+or+even+weeks+to+train.%0D%0A%0D%0AIf+the+run+is+stopped+unexpecte...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div><p>Deep learning models can take hours, days or even weeks to train.</p>
<p>If the run is stopped unexpectedly, you can lose a lot of work.</p>
<p>In this post you will discover how you can check-point your deep learning models during training in Python using the Keras library.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2605" style="max-width: 650px"><img alt="How to Check-Point Deep Learning Models in Keras" class="size-full wp-image-2605" height="480" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/How-to-Check-Point-Deep-Learning-Models-in-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/How-to-Check-Point-Deep-Learning-Models-in-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/How-to-Check-Point-Deep-Learning-Models-in-Keras-300x225.jpg 300w" width="640"/><p class="wp-caption-text">How to Check-Point Deep Learning Models in Keras<br/>Photo by <a href="https://www.flickr.com/photos/saragoldsmith/2353051153/">saragoldsmith</a>, some rights reserved.</p></div>
<h2>Checkpointing Neural Network Models</h2>
<p><a href="https://en.wikipedia.org/wiki/Application_checkpointing">Application checkpointing</a> is a fault tolerance technique for long running processes.</p>
<p>It is an approach where a snapshot of the state of the system is taken in case of system failure. If there is a problem, not all is lost. The checkpoint may be used directly, or used as the starting point for a new run, picking up where it left off.</p>
<p>When training deep learning models, the checkpoint is the weights of the model. These weights can be used to make predictions as is, or used as the basis for ongoing training.</p>
<p>The Keras library provides a <a href="http://keras.io/callbacks/#modelcheckpoint">checkpointing capability by a callback API</a>.</p>
<p>The ModelCheckpoint callback class allows you to define where to checkpoint the model weights, how the file should named and under what circumstances to make a checkpoint of the model.</p>
<p>The API allows you to specify which metric to monitor, such as loss or accuracy on the training or validation dataset. You can specify whether to look for an improvement in maximizing or minimizing the score. Finally, the filename that you use to store the weights can include variables like the epoch number or metric.</p>
<p>The ModelCheckpoint can then be passed to the training process when calling the fit() function on the model.</p>
<p>Note, you may need to install the <a href="http://www.h5py.org/">h5py library</a> to output network weights in HDF5 format.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><!-- End shortcoder v4.1.5-->
<h2>Checkpoint Neural Network Model Improvements</h2>
<p>A good use of checkpointing is to output the model weights each time an improvement is observed during training.</p>
<p>The example below creates a small neural network for the <a href="http://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians onset of diabetes binary classification problem</a>. The example assume that the pima-indians-diabetes.csv file is in your working directory. You can <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">download this dataset</a> from the UCI machine learning repository. The example uses 33% of the data for validation.</p>
<p>Checkpointing is setup to save the network weights only when there is an improvement in classification accuracy on the validation dataset (monitor=’val_acc’ and mode=’max’). The weights are stored in a file that includes the score in the filename (weights-improvement-{val_acc=.2f}.hdf5).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f27360314326" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Checkpoint the weights when validation accuracy improves
from keras.models import Sequential
from keras.layers import Dense
from keras.callbacks import ModelCheckpoint
import matplotlib.pyplot as plt
import numpy
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# checkpoint
filepath="weights-improvement-{epoch:02d}-{val_acc:.2f}.hdf5"
checkpoint = ModelCheckpoint(filepath, monitor='val_acc', verbose=1, save_best_only=True, mode='max')
callbacks_list = [checkpoint]
# Fit the model
model.fit(X, Y, validation_split=0.33, epochs=150, batch_size=10, callbacks=callbacks_list, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-6">6</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-8">8</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-10">10</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-12">12</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-14">14</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-16">16</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-18">18</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-20">20</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-22">22</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-24">24</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f27360314326-26">26</div><div class="crayon-num" data-line="crayon-5a6593f1d8f27360314326-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-1"><span class="crayon-p"># Checkpoint the weights when validation accuracy improves</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">callbacks </span><span class="crayon-e">import </span><span class="crayon-e">ModelCheckpoint</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-5"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-6"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-7"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-8"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-10"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-11"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-12"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-14"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-15"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-16"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-20"><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-22"><span class="crayon-p"># checkpoint</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-23"><span class="crayon-v">filepath</span><span class="crayon-o">=</span><span class="crayon-s">"weights-improvement-{epoch:02d}-{val_acc:.2f}.hdf5"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-24"><span class="crayon-v">checkpoint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ModelCheckpoint</span><span class="crayon-sy">(</span><span class="crayon-v">filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">monitor</span><span class="crayon-o">=</span><span class="crayon-s">'val_acc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">save_best_only</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'max'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-25"><span class="crayon-v">callbacks_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">checkpoint</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f27360314326-26"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line" id="crayon-5a6593f1d8f27360314326-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_split</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callbacks</span><span class="crayon-o">=</span><span class="crayon-v">callbacks_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>Running the example produces the following output (truncated for brevity):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f31772825626" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 00134: val_acc did not improve
Epoch 00135: val_acc did not improve
Epoch 00136: val_acc did not improve
Epoch 00137: val_acc did not improve
Epoch 00138: val_acc did not improve
Epoch 00139: val_acc did not improve
Epoch 00140: val_acc improved from 0.83465 to 0.83858, saving model to weights-improvement-140-0.84.hdf5
Epoch 00141: val_acc did not improve
Epoch 00142: val_acc did not improve
Epoch 00143: val_acc did not improve
Epoch 00144: val_acc did not improve
Epoch 00145: val_acc did not improve
Epoch 00146: val_acc improved from 0.83858 to 0.84252, saving model to weights-improvement-146-0.84.hdf5
Epoch 00147: val_acc did not improve
Epoch 00148: val_acc improved from 0.84252 to 0.84252, saving model to weights-improvement-148-0.84.hdf5
Epoch 00149: val_acc did not improve</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-6">6</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-8">8</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-10">10</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-12">12</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-14">14</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f31772825626-16">16</div><div class="crayon-num" data-line="crayon-5a6593f1d8f31772825626-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-2">Epoch 00134: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-3">Epoch 00135: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-4">Epoch 00136: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-5">Epoch 00137: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-6">Epoch 00138: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-7">Epoch 00139: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-8">Epoch 00140: val_acc improved from 0.83465 to 0.83858, saving model to weights-improvement-140-0.84.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-9">Epoch 00141: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-10">Epoch 00142: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-11">Epoch 00143: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-12">Epoch 00144: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-13">Epoch 00145: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-14">Epoch 00146: val_acc improved from 0.83858 to 0.84252, saving model to weights-improvement-146-0.84.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-15">Epoch 00147: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f31772825626-16">Epoch 00148: val_acc improved from 0.84252 to 0.84252, saving model to weights-improvement-148-0.84.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f31772825626-17">Epoch 00149: val_acc did not improve</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You will see a number of files in your working directory containing the network weights in HDF5 format. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f35966505013" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
weights-improvement-53-0.76.hdf5
weights-improvement-71-0.76.hdf5
weights-improvement-77-0.78.hdf5
weights-improvement-99-0.78.hdf5</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f35966505013-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f35966505013-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f35966505013-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f35966505013-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f35966505013-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f35966505013-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f35966505013-2">weights-improvement-53-0.76.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f35966505013-3">weights-improvement-71-0.76.hdf5</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f35966505013-4">weights-improvement-77-0.78.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f35966505013-5">weights-improvement-99-0.78.hdf5</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This is a very simple checkpointing strategy. It may create a lot of unnecessary check-point files if the validation accuracy moves up and down over training epochs. Nevertheless, it will ensure that you have a snapshot of the best model discovered during your run.</p>
<h2>Checkpoint Best Neural Network Model Only</h2>
<p>A simpler check-point strategy is to save the model weights to the same file, if and only if the validation accuracy improves.</p>
<p>This can be done easily using the same code from above and changing the output filename to be fixed (not include score or epoch information).</p>
<p>In this case, model weights are written to the file “weights.best.hdf5” only if the classification accuracy of the model on the validation dataset improves over the best seen so far.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f38803531336" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Checkpoint the weights for best model on validation accuracy
from keras.models import Sequential
from keras.layers import Dense
from keras.callbacks import ModelCheckpoint
import matplotlib.pyplot as plt
import numpy
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# checkpoint
filepath="weights.best.hdf5"
checkpoint = ModelCheckpoint(filepath, monitor='val_acc', verbose=1, save_best_only=True, mode='max')
callbacks_list = [checkpoint]
# Fit the model
model.fit(X, Y, validation_split=0.33, epochs=150, batch_size=10, callbacks=callbacks_list, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-6">6</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-8">8</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-10">10</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-12">12</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-14">14</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-16">16</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-18">18</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-20">20</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-22">22</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-24">24</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f38803531336-26">26</div><div class="crayon-num" data-line="crayon-5a6593f1d8f38803531336-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-1"><span class="crayon-p"># Checkpoint the weights for best model on validation accuracy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">callbacks </span><span class="crayon-e">import </span><span class="crayon-e">ModelCheckpoint</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-5"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-6"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-7"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-8"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-10"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-11"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-12"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-13"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-14"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-15"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-16"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-20"><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-22"><span class="crayon-p"># checkpoint</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-23"><span class="crayon-v">filepath</span><span class="crayon-o">=</span><span class="crayon-s">"weights.best.hdf5"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-24"><span class="crayon-v">checkpoint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ModelCheckpoint</span><span class="crayon-sy">(</span><span class="crayon-v">filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">monitor</span><span class="crayon-o">=</span><span class="crayon-s">'val_acc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">save_best_only</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'max'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-25"><span class="crayon-v">callbacks_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">checkpoint</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f38803531336-26"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line" id="crayon-5a6593f1d8f38803531336-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_split</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callbacks</span><span class="crayon-o">=</span><span class="crayon-v">callbacks_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0039 seconds] -->
<p>Running this example provides the following output (truncated for brevity):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f3a111997004" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 00139: val_acc improved from 0.79134 to 0.79134, saving model to weights.best.hdf5
Epoch 00140: val_acc did not improve
Epoch 00141: val_acc did not improve
Epoch 00142: val_acc did not improve
Epoch 00143: val_acc did not improve
Epoch 00144: val_acc improved from 0.79134 to 0.79528, saving model to weights.best.hdf5
Epoch 00145: val_acc improved from 0.79528 to 0.79528, saving model to weights.best.hdf5
Epoch 00146: val_acc did not improve
Epoch 00147: val_acc did not improve
Epoch 00148: val_acc did not improve
Epoch 00149: val_acc did not improve</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-6">6</div><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-8">8</div><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-10">10</div><div class="crayon-num" data-line="crayon-5a6593f1d8f3a111997004-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f3a111997004-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-2">Epoch 00139: val_acc improved from 0.79134 to 0.79134, saving model to weights.best.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-3">Epoch 00140: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-4">Epoch 00141: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-5">Epoch 00142: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-6">Epoch 00143: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-7">Epoch 00144: val_acc improved from 0.79134 to 0.79528, saving model to weights.best.hdf5</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-8">Epoch 00145: val_acc improved from 0.79528 to 0.79528, saving model to weights.best.hdf5</div><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-9">Epoch 00146: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-10">Epoch 00147: val_acc did not improve</div><div class="crayon-line" id="crayon-5a6593f1d8f3a111997004-11">Epoch 00148: val_acc did not improve</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f3a111997004-12">Epoch 00149: val_acc did not improve</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You should see the weight file in your local directory.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f3f897035631" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
weights.best.hdf5</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f3f897035631-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f3f897035631-1">weights.best.hdf5</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This is a handy checkpoint strategy to always use during your experiments. It will ensure that your best model is saved for the run for you to use later if you wish. It avoids you needing to include code to manually keep track and serialize the best model when training.</p>
<h2>Loading a Check-Pointed Neural Network Model</h2>
<p>Now that you have seen how to checkpoint your deep learning models during training, you need to review how to load and use a checkpointed model.</p>
<p>The checkpoint only includes the model weights. It assumes you know the network structure. This too can be serialize to file in JSON or YAML format.</p>
<p>In the example below, the model structure is known and the best weights are loaded from the previous experiment, stored in the working directory in the weights.best.hdf5 file.</p>
<p>The model is then used to make predictions on the entire dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f42302880656" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# How to load and use weights from a checkpoint
from keras.models import Sequential
from keras.layers import Dense
from keras.callbacks import ModelCheckpoint
import matplotlib.pyplot as plt
import numpy
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
# load weights
model.load_weights("weights.best.hdf5")
# Compile model (required to make predictions)
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print("Created model and loaded weights from file")
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# estimate accuracy on whole dataset using loaded weights
scores = model.evaluate(X, Y, verbose=0)
print("%s: %.2f%%" % (model.metrics_names[1], scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-2">2</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-4">4</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-6">6</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-8">8</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-10">10</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-12">12</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-14">14</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-16">16</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-18">18</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-20">20</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-22">22</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-24">24</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f42302880656-26">26</div><div class="crayon-num" data-line="crayon-5a6593f1d8f42302880656-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-1"><span class="crayon-p"># How to load and use weights from a checkpoint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">callbacks </span><span class="crayon-e">import </span><span class="crayon-e">ModelCheckpoint</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-5"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-6"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-7"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-8"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-10"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-12"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-13"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-14"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-15"><span class="crayon-p"># load weights</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">load_weights</span><span class="crayon-sy">(</span><span class="crayon-s">"weights.best.hdf5"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-17"><span class="crayon-p"># Compile model (required to make predictions)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-19"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Created model and loaded weights from file"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-20"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-21"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-22"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-24"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-25"><span class="crayon-p"># estimate accuracy on whole dataset using loaded weights</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f42302880656-26"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a6593f1d8f42302880656-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%s: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">metrics_names</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Running the example produces the following output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1d8f45230986260" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Created model and loaded weights from file
acc: 77.73%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1d8f45230986260-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a6593f1d8f45230986260-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1d8f45230986260-1">Created model and loaded weights from file</div><div class="crayon-line crayon-striped-line" id="crayon-5a6593f1d8f45230986260-2">acc: 77.73%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post you have discovered the importance of checkpointing deep learning models for long training runs.</p>
<p>You learned two checkpointing strategies that you can use on your next deep learning project:</p>
<ol>
<li>Checkpoint Model Improvements.</li>
<li>Checkpoint Best Model Only.</li>
</ol>
<p>You also learned how to load a checkpointed model and make predictions.</p>
<p>Do you have any questions about checkpointing deep learning models or about this post? Ask your questions in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="apss-social-share apss-theme-4 clearfix">
<div class="apss-twitter apss-single-icon">
<a href="javascript:void(0);" onclick="apss_open_in_popup_window(event, 'https://twitter.com/intent/tweet?text=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fcheck-point-deep-learning-models-keras%2F&amp;');" rel="nofollow" target="" title="Share on Twitter">
<div class="apss-icon-block clearfix">
<i class="fa fa-twitter"></i>
<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
</div>
</a>
</div>
<div class="apss-facebook apss-single-icon">
<a href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/check-point-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/check-point-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Facebook">
<div class="apss-icon-block clearfix">
<i class="fa fa-facebook"></i>
<span class="apss-social-text">Share on Facebook</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-linkedin apss-single-icon">
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/&amp;summary=Deep+learning+models+can+take+hours%2C+days+or+even+weeks+to+train.%0D%0A%0D%0AIf+the+run+is+stopped+unexpecte..." onclick="apss_open_in_popup_window(event, 'http://www.linkedin.com/shareArticle?mini=true&amp;title=How%20to%20Check-Point%20Deep%20Learning%20Models%20in%20Keras&amp;url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/&amp;summary=Deep+learning+models+can+take+hours%2C+days+or+even+weeks+to+train.%0D%0A%0D%0AIf+the+run+is+stopped+unexpecte...');" rel="nofollow" target="" title="Share on LinkedIn">
<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
<span class="apss-social-text">Share on LinkedIn</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
<div class="apss-google-plus apss-single-icon">
<a href="https://plus.google.com/share?url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/" onclick="apss_open_in_popup_window(event, 'https://plus.google.com/share?url=https://machinelearningmastery.com/check-point-deep-learning-models-keras/');" rel="nofollow" target="" title="Share on Google Plus">
<div class="apss-icon-block clearfix">
<i class="fa fa-google-plus"></i>
<span class="apss-social-text">Share on Google Plus</span>
<span class="apss-share">Share</span>
</div>
</a>
</div>
</div> </section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Dr. Jason Brownlee is a husband, proud father, academic researcher, author, professional developer and a machine learning practitioner. He is dedicated to helping developers get started and get good at applied machine learning.
<a href="/about">Learn more</a>.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/applied-machine-learning-with-weka/" rel="prev"><i class="fa fa-angle-left"></i> Rapidly Accelerate Your Progress in Applied Machine Learning With Weka</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/download-install-weka-machine-learning-workbench/" rel="next">How to Download and Install the Weka Machine Learning Workbench <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">62 Responses to <em>How to Check-Point Deep Learning Models in Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-366278">
<div class="comment-container" id="li-comment-366278">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6c9c132a8e164b6b2f5eb12dc4c859b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6c9c132a8e164b6b2f5eb12dc4c859b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gerrit Govaerts</span>
<span class="date">October 5, 2016 at 1:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-366278" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>79.56% with a 3 hidden layer architecture , 24 neurons each<br/>
Great blog , learned a lot</p>
<div class="reply">
<a aria-label="Reply to Gerrit Govaerts" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=366278#respond" onclick='return addComment.moveForm( "comment-366278", "366278", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366295">
<div class="comment-container" id="li-comment-366295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2016 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-366295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Gerrit, I’m glad you found it useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=366295#respond" onclick='return addComment.moveForm( "comment-366295", "366295", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-367777">
<div class="comment-container" id="li-comment-367777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/982fe9edec4382849efdc3cca9679a7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/982fe9edec4382849efdc3cca9679a7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lau MingFei</span>
<span class="date">October 21, 2016 at 1:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-367777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, how can I checkpoint a model with my custom metric? The example codes you gave above is monitor = ‘val_acc’ , but when I replace it with monitor = my_metric , it displays the following warning message:</p>
<p>/usr/local/lib/python3.5/dist-packages/keras/callbacks.py:286: RuntimeWarning: Can save best model only with  available, skipping.<br/>
  ‘skipping.’ % (self.monitor), RuntimeWarning)</p>
<p>So how should I do with this?</p>
<div class="reply">
<a aria-label="Reply to Lau MingFei" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=367777#respond" onclick='return addComment.moveForm( "comment-367777", "367777", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-367856">
<div class="comment-container" id="li-comment-367856">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2016 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-367856" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Lau, </p>
<p>I have not tried to check point with a custom metric, sorry. I cannot give you good advice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=367856#respond" onclick='return addComment.moveForm( "comment-367856", "367856", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-369881">
<div class="comment-container" id="li-comment-369881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1cca40452c95dca2c7446715db4ca7f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1cca40452c95dca2c7446715db4ca7f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xu Zhang</span>
<span class="date">November 8, 2016 at 11:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-369881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
A great post!</p>
<p>I saved the model and weights using callbacks, ModelCheckpoint. If I want to train it continuously from the last epoch, how to set the model.fit() command to start from the previous epoch?  Sometimes, we need to change the learning rates after several epochs and to continue training from the last epoch. Your advice is highly appreciated.</p>
<div class="reply">
<a aria-label="Reply to Xu Zhang" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=369881#respond" onclick='return addComment.moveForm( "comment-369881", "369881", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370068">
<div class="comment-container" id="li-comment-370068">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2016 at 9:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-370068" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Xu Zhang,</p>
<p>You can load the model weights back into your network and then start a new training process.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=370068#respond" onclick='return addComment.moveForm( "comment-370068", "370068", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-378695">
<div class="comment-container" id="li-comment-378695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bbbb845899b9e01138c30740cce6fbdc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bbbb845899b9e01138c30740cce6fbdc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lopez GG</span>
<span class="date">December 30, 2016 at 1:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-378695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason. I ran a epoch and got the loss down to 353.6888. The session got disconnected so I used the weights as follows. However, I dont see a change in loss. I am loading the weights correctly ? Here is my code </p>
<p>&gt;&gt;&gt; filename = “weights-improvement-01–353.6888-embedding.hdf5”<br/>
&gt;&gt;&gt; model.load_weights(filename)<br/>
&gt;&gt;&gt; model.compile(loss=’binary_crossentropy’, optimizer=’adam’)<br/>
&gt;&gt;&gt; model.fit(dataX_Arr, dataY_Arr, batch_size=batch_size, nb_epoch=15, callbacks=callbacks_list)<br/>
Epoch 1/15<br/>
147744/147771 [============================&gt;.] – ETA: 1s – loss: -353.6892Epoch 00000: loss improved from inf to -353.68885, saving model to weights-</p>
<div class="reply">
<a aria-label="Reply to Lopez GG" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=378695#respond" onclick='return addComment.moveForm( "comment-378695", "378695", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-378900">
<div class="comment-container" id="li-comment-378900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 31, 2016 at 7:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-378900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It looks like you are loading the weights correctly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=378900#respond" onclick='return addComment.moveForm( "comment-378900", "378900", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-372880">
<div class="comment-container" id="li-comment-372880">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e029b6071ee3c7694e9aea295a758ee0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e029b6071ee3c7694e9aea295a758ee0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anthony</span>
<span class="date">November 29, 2016 at 9:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-372880" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post again Jason, thank you!</p>
<div class="reply">
<a aria-label="Reply to Anthony" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=372880#respond" onclick='return addComment.moveForm( "comment-372880", "372880", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-372996">
<div class="comment-container" id="li-comment-372996">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2016 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-372996" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found it useful Anthony.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=372996#respond" onclick='return addComment.moveForm( "comment-372996", "372996", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-385187">
<div class="comment-container" id="li-comment-385187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nasarudin</span>
<span class="date">January 31, 2017 at 1:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-385187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for your tutorial. I want to implement this checkpoint function in iris-flower model script but failed to do it. It keeps showing this error and I do not know how to solve it.</p>
<p>I put the ‘model checkpoint’ line after the ‘baseline model’ function and add ‘callbacks’</p>
<p>RuntimeError: Cannot clone object , as the constructor does not seem to set parameter callbacks</p>
<p>Thank you for your help</p>
<div class="reply">
<a aria-label="Reply to Nasarudin" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=385187#respond" onclick='return addComment.moveForm( "comment-385187", "385187", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385413">
<div class="comment-container" id="li-comment-385413">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-385413" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Nasarudin, sorry I am not sure of the cause of this error.</p>
<p>I believe you cannot use callbacks like the checkpointing when using the KerasClassifier as is the case in the iris tutorial:<br/>
<a href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" rel="nofollow">http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=385413#respond" onclick='return addComment.moveForm( "comment-385413", "385413", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-386153">
<div class="comment-container" id="li-comment-386153">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nasarudin</span>
<span class="date">February 6, 2017 at 1:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386153" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. Thank you for your reply. I have some dataset that looks same with the iris dataset but it is a lot bigger. I thought maybe I can use the callbacks when I train the dataset.</p>
<p>Since training a large dataset might taking a lot of time, do you have any suggestion to implement other function that can do checkpoint when using KerasClassifier?nk for the </p>
<p>By the way, you can refer to this link for the script that I wrote to implement the checkpoint function with KerasClassifier.</p>
<p><a href="http://stackoverflow.com/questions/41937719/checkpoint-deep-learning-models-in-keras" rel="nofollow">http://stackoverflow.com/questions/41937719/checkpoint-deep-learning-models-in-keras</a></p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Nasarudin" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386153#respond" onclick='return addComment.moveForm( "comment-386153", "386153", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-386189">
<div class="comment-container" id="li-comment-386189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2017 at 9:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Nasarudin,</p>
<p>I would recommend using a standalone Keras model rather than the sklearn wrapper if you wish to use checkpointing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386189#respond" onclick='return addComment.moveForm( "comment-386189", "386189", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-385812">
<div class="comment-container" id="li-comment-385812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/424fb7baf0713f7272bd14e074e75b2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/424fb7baf0713f7272bd14e074e75b2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abner</span>
<span class="date">February 3, 2017 at 3:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-385812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorials love your page. I got a question: I am trying to optimize a model based on val_acc using ModelCheckpoint. However, I get great results rather quickly (example: val_acc = .98). This is my max validation, therefore, the model that will be saved (save_best_only). However several epochs gave me the same max validation and the latter epochs have higher training accuracy. Example Epoch 3: acc = .70, val_acc = .98, Epoch 50: acc = 1.00, val_acc = .98. Clearly, I would want to save the second one which generalizes on the data plus shows great training. How do I do this without having to save every epoch? Basically, I want to pass a second sorting parameter to monitor (monitor=val_acc,acc).</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Abner" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=385812#respond" onclick='return addComment.moveForm( "comment-385812", "385812", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385931">
<div class="comment-container" id="li-comment-385931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 4, 2017 at 9:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-385931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, off the cuff, I think you can pass multiple metrics for check-pointing. </p>
<p>Try multiple checkpoint objects?</p>
<p>Here’s the docs if that helps:<br/>
<a href="https://keras.io/callbacks/#modelcheckpoint" rel="nofollow">https://keras.io/callbacks/#modelcheckpoint</a></p>
<p>Ideally, you do want a balance between performance on the training dataset and on the validation dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=385931#respond" onclick='return addComment.moveForm( "comment-385931", "385931", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-386341">
<div class="comment-container" id="li-comment-386341">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/424fb7baf0713f7272bd14e074e75b2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/424fb7baf0713f7272bd14e074e75b2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abner</span>
<span class="date">February 7, 2017 at 5:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386341" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it’s not letting me pass an array list or multiple parameters it’s only expecting 1 parameter base on literature, for now, I have to settle for using val_acc for bottlenecks/top layer and val_loss for the final model, though I would prefer more control. maybe I’ll ask for it in a feature request.</p>
<div class="reply">
<a aria-label="Reply to Abner" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386341#respond" onclick='return addComment.moveForm( "comment-386341", "386341", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-386374">
<div class="comment-container" id="li-comment-386374">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 7, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386374" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great idea, add an issue on the Keras project.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386374#respond" onclick='return addComment.moveForm( "comment-386374", "386374", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-393797">
<div class="comment-container" id="li-comment-393797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/916089315ae080657de293be05947355?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/916089315ae080657de293be05947355?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Damily</span>
<span class="date">March 22, 2017 at 10:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-393797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Abner, do you solve this problem now？<br/>
hope to receive your reply.</p>
<div class="reply">
<a aria-label="Reply to Damily" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=393797#respond" onclick='return addComment.moveForm( "comment-393797", "393797", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-386786">
<div class="comment-container" id="li-comment-386786">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdf96c5f7fdf1a477ef5db235f6b5db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdf96c5f7fdf1a477ef5db235f6b5db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatma</span>
<span class="date">February 9, 2017 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386786" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for your tutorial. I need to ask one question, if my input contains two images with different labels (the label represents the popularity of the image). I need to know how to feed this pair of images such that the first image pass through CNN1 and the second one pass through CNN2 Then I can merge them using the merge layer to classify which one is more popular than the other one. How can I use the library in order to handle the two different inputs?</p>
<div class="reply">
<a aria-label="Reply to Fatma" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386786#respond" onclick='return addComment.moveForm( "comment-386786", "386786", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-386899">
<div class="comment-container" id="li-comment-386899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 10, 2017 at 9:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Fatma,</p>
<p>Perhaps you can reframe your problem to output the popularity for one image and use an “if” statement to rank the relative popularities of each image separately?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386899#respond" onclick='return addComment.moveForm( "comment-386899", "386899", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-386944">
<div class="comment-container" id="li-comment-386944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdf96c5f7fdf1a477ef5db235f6b5db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdf96c5f7fdf1a477ef5db235f6b5db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatma</span>
<span class="date">February 10, 2017 at 1:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-386944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I need to compare between the popularity value of the two input images such that the output will be the first image is high popular than the second image or vice versa then when I feed one test image (unlabeled) it should be compared with some baseline of the training data to compute its popularity</p>
<div class="reply">
<a aria-label="Reply to Fatma" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=386944#respond" onclick='return addComment.moveForm( "comment-386944", "386944", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-389374">
<div class="comment-container" id="li-comment-389374">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/921783683597a63e90bbec29d33ec81b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nasarudin</span>
<span class="date">February 21, 2017 at 3:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-389374" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial as always.</p>
<p>I want to ask regarding ‘validation_split’ in the script. What is the difference between this script that has ‘validation_script’ variable and the one from here which did not have ‘validation_split’ variable <a href="http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">http://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a> ?</p>
<div class="reply">
<a aria-label="Reply to Nasarudin" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=389374#respond" onclick='return addComment.moveForm( "comment-389374", "389374", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-389465">
<div class="comment-container" id="li-comment-389465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 22, 2017 at 9:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-389465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Nasarudin.</p>
<p>If you have a validation_split, it will give you some feedback during training about the performance on the model on “unseen” data. When using a check-point, this can be useful as you can stop training when performance on validation data stops improving (a sign of possible overfitting).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=389465#respond" onclick='return addComment.moveForm( "comment-389465", "389465", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-393118">
<div class="comment-container" id="li-comment-393118">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/faee5cad3bfaa32d6235fa87d6f0f8fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/faee5cad3bfaa32d6235fa87d6f0f8fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jerpint</span>
<span class="date">March 18, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-393118" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks!</p>
<div class="reply">
<a aria-label="Reply to jerpint" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=393118#respond" onclick='return addComment.moveForm( "comment-393118", "393118", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393129">
<div class="comment-container" id="li-comment-393129">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 18, 2017 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-393129" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re very welcome!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=393129#respond" onclick='return addComment.moveForm( "comment-393129", "393129", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396002">
<div class="comment-container" id="li-comment-396002">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/caa2db1b76a6a94e16d201ad5d5a4ddb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/caa2db1b76a6a94e16d201ad5d5a4ddb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aleksandra Nabożny</span>
<span class="date">April 10, 2017 at 11:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-396002" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! Thank you very much for the tutorial!</p>
<p>Can you provide a sample code to visualize results as follows: plot some images from validation dataset with their 5 top label predictions?</p>
<div class="reply">
<a aria-label="Reply to Aleksandra Nabożny" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=396002#respond" onclick='return addComment.moveForm( "comment-396002", "396002", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396041">
<div class="comment-container" id="li-comment-396041">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2017 at 9:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-396041" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes you could do this using the probabilistic output from the network.</p>
<p>Sorry, I do not have examples at this stage.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=396041#respond" onclick='return addComment.moveForm( "comment-396041", "396041", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396918">
<div class="comment-container" id="li-comment-396918">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c9a46b52eb150564bd67cf31679fd978?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c9a46b52eb150564bd67cf31679fd978?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pratik</span>
<span class="date">April 19, 2017 at 6:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-396918" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial Jason  🙂</p>
<div class="reply">
<a aria-label="Reply to Pratik" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=396918#respond" onclick='return addComment.moveForm( "comment-396918", "396918", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396986">
<div class="comment-container" id="li-comment-396986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-396986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you found it useful Pratik.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=396986#respond" onclick='return addComment.moveForm( "comment-396986", "396986", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397515">
<div class="comment-container" id="li-comment-397515">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f0872fa70e5a6974051075a405a7398?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f0872fa70e5a6974051075a405a7398?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://github.com/krisalpha" rel="external nofollow">Krishan Chopra</a></span>
<span class="date">April 25, 2017 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-397515" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir, i want to thank you for this cool tutorial,<br/>
Currently i am  checkpointing my model every 50 epochs. I also want to checkpoint any epoch whose val_acc is better but is not the 50th epoch. For ex. i have checkpointed 250th epoch, but val_acc for 282th epoch is besser and i have to save it but as i have specified the period to be 50, i cant save the 282th epoch.<br/>
Should i implement both attributes save_best_only=true and period=50 in ModelCheckPoint ?</p>
<div class="reply">
<a aria-label="Reply to Krishan Chopra" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=397515#respond" onclick='return addComment.moveForm( "comment-397515", "397515", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397532">
<div class="comment-container" id="li-comment-397532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-397532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I follow.</p>
<p>You can use the checkpoint to save any improvement to the model regardless of epoch. Perhaps that would be an approach to try?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=397532#respond" onclick='return addComment.moveForm( "comment-397532", "397532", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400023">
<div class="comment-container" id="li-comment-400023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4bc48035c14847beadecd1c8376de639?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4bc48035c14847beadecd1c8376de639?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Zhihao Chen</span>
<span class="date">May 19, 2017 at 11:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-400023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I love your tutorial very much but just find a little bit confused about how to combine the check point with the cross validation. As is shown in your other tutorial, we don’t explicitly call model.fit when doing cross validation. Could you give me an example how to add check-point into this?</p>
<div class="reply">
<a aria-label="Reply to Zhihao Chen" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=400023#respond" onclick='return addComment.moveForm( "comment-400023", "400023", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400079">
<div class="comment-container" id="li-comment-400079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-400079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may have to run the k-fold cross-validation process manually (e.g. loop the folds yourself).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=400079#respond" onclick='return addComment.moveForm( "comment-400079", "400079", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400683">
<div class="comment-container" id="li-comment-400683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6bdfd8b1fab6e88177b5064115418734?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6bdfd8b1fab6e88177b5064115418734?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chiyuan</span>
<span class="date">May 28, 2017 at 3:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-400683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Love your articles. Learnt lost of things here.</p>
<p>Please keep your tutorials going!</p>
<div class="reply">
<a aria-label="Reply to chiyuan" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=400683#respond" onclick='return addComment.moveForm( "comment-400683", "400683", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401160">
<div class="comment-container" id="li-comment-401160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-401160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=401160#respond" onclick='return addComment.moveForm( "comment-401160", "401160", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403347">
<div class="comment-container" id="li-comment-403347">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/137ef055d4e19ba184c3cd4c70fb527b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/137ef055d4e19ba184c3cd4c70fb527b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abolfazl</span>
<span class="date">June 22, 2017 at 3:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-403347" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, your blog is amazing. Thanks for helping us out in learning this awesome field.</p>
<div class="reply">
<a aria-label="Reply to Abolfazl" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=403347#respond" onclick='return addComment.moveForm( "comment-403347", "403347", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403373">
<div class="comment-container" id="li-comment-403373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2017 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-403373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you find it useful Abolfazl.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=403373#respond" onclick='return addComment.moveForm( "comment-403373", "403373", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404233">
<div class="comment-container" id="li-comment-404233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f78f3822f34e02e2cf74e8c677540b6d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f78f3822f34e02e2cf74e8c677540b6d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xiufeng Yang</span>
<span class="date">June 29, 2017 at 3:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-404233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, great post! I want to save the training model not the validation model, how to set the parameters in checkpoint()?</p>
<div class="reply">
<a aria-label="Reply to Xiufeng Yang" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=404233#respond" onclick='return addComment.moveForm( "comment-404233", "404233", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404301">
<div class="comment-container" id="li-comment-404301">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2017 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-404301" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The trained model is saved, there is no validation model. Just an evaluation of the model using validation data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=404301#respond" onclick='return addComment.moveForm( "comment-404301", "404301", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414283">
<div class="comment-container" id="li-comment-414283">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd5795d25e9e04d6c48c4c73bd79d055?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd5795d25e9e04d6c48c4c73bd79d055?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike</span>
<span class="date">September 19, 2017 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-414283" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it possible to checkpoint in between epochs?<br/>
I have an enormous dataset that takes 20hrs per epoch and it’s failed before it finished an epoch. It would be great if I could checkpoint every fifth of an epoch or so.</p>
<div class="reply">
<a aria-label="Reply to Mike" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=414283#respond" onclick='return addComment.moveForm( "comment-414283", "414283", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414322">
<div class="comment-container" id="li-comment-414322">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2017 at 5:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-414322" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a data generator and then using a checkpoint after a fixed number of batches. This might work.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=414322#respond" onclick='return addComment.moveForm( "comment-414322", "414322", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418607">
<div class="comment-container" id="li-comment-418607">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c8cb27807a931dd084cfe55fca45ce5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c8cb27807a931dd084cfe55fca45ce5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mounir</span>
<span class="date">October 31, 2017 at 10:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-418607" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great blog. Do you also happen to know how to save/store the epoch number of the last observed improvement during training? That would be very useful to study overfitting</p>
<div class="reply">
<a aria-label="Reply to Mounir" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=418607#respond" onclick='return addComment.moveForm( "comment-418607", "418607", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418630">
<div class="comment-container" id="li-comment-418630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 1, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-418630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you could add the “epoch” variable to the checkpoint filename.</p>
<p>For example:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5a6593f1dae59649100185" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
filename = 'model-ep{epoch:03d}-loss{loss:.3f}-val_loss{val_loss:.3f}.h5'</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a6593f1dae59649100185-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a6593f1dae59649100185-1"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'model-ep{epoch:03d}-loss{loss:.3f}-val_loss{val_loss:.3f}.h5'</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=418630#respond" onclick='return addComment.moveForm( "comment-418630", "418630", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418856">
<div class="comment-container" id="li-comment-418856">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f1b00c9cdbeb941879f2b02cdb8d50f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f1b00c9cdbeb941879f2b02cdb8d50f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jes</span>
<span class="date">November 3, 2017 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-418856" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>is it possible to use Keras checkpoints together with Gridsearch? in case Gridsearch crashes?</p>
<div class="reply">
<a aria-label="Reply to Jes" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=418856#respond" onclick='return addComment.moveForm( "comment-418856", "418856", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418878">
<div class="comment-container" id="li-comment-418878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 2:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-418878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not a good idea Jes. I’d recommend doing a custom grid search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=418878#respond" onclick='return addComment.moveForm( "comment-418878", "418878", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422059">
<div class="comment-container" id="li-comment-422059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ea388a823e1083cc90f1be1035f9cbd9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ea388a823e1083cc90f1be1035f9cbd9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abad</span>
<span class="date">December 3, 2017 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-422059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Receiving following error:<br/>
TypeError                                 Traceback (most recent call last)<br/>
 in ()<br/>
     72<br/>
     73 filepath=”weights.best.hdf5″<br/>
—&gt; 74 checkpoint = ModelCheckpoint(filepath, monitor=’val_acc’, verbose=0, save_best_only=True,node=’max’)<br/>
     75 callbacks_checkpt = [checkpoint]<br/>
     76 </p>
<p>TypeError: __init__() got an unexpected keyword argument ‘node’</p>
<div class="reply">
<a aria-label="Reply to Abad" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=422059#respond" onclick='return addComment.moveForm( "comment-422059", "422059", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422098">
<div class="comment-container" id="li-comment-422098">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 4, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-422098" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like a typo.</p>
<p>Double check that you have copied the code exactly from the tutorial?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=422098#respond" onclick='return addComment.moveForm( "comment-422098", "422098", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-424639">
<div class="comment-container" id="li-comment-424639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/55061d7664887d613a41dc688842fafc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/55061d7664887d613a41dc688842fafc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/" rel="external nofollow">Aditya</a></span>
<span class="date">December 24, 2017 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-424639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
Thanks for the informative post.</p>
<p>I have one question – in case of unexpected stoppage of the run, we have the best model weights for the epochs DONE SO FAR. How can we use this checkpoint as a STARTING point to continue with the remaining epochs?</p>
<div class="reply">
<a aria-label="Reply to Aditya" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=424639#respond" onclick='return addComment.moveForm( "comment-424639", "424639", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424699">
<div class="comment-container" id="li-comment-424699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 25, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-424699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can load the weights, see the example in the tutorial of exactly this.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=424699#respond" onclick='return addComment.moveForm( "comment-424699", "424699", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-424817">
<div class="comment-container" id="li-comment-424817">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbef5cc188a9cdc17b701b5cfcb8ba9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbef5cc188a9cdc17b701b5cfcb8ba9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liaqat Ali</span>
<span class="date">December 27, 2017 at 3:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-424817" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for such a nice explanation. I want to ask if we are performing some experiments &amp; want the neural network model to achieve high accuracy on for test set. Can we use this method to find the best tuned network or the highest possible accuracy.?????</p>
<div class="reply">
<a aria-label="Reply to Liaqat Ali" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=424817#respond" onclick='return addComment.moveForm( "comment-424817", "424817", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424827">
<div class="comment-container" id="li-comment-424827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 27, 2017 at 5:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-424827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This method can help find and save a well performing model during training.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=424827#respond" onclick='return addComment.moveForm( "comment-424827", "424827", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425878">
<div class="comment-container" id="li-comment-425878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5ebb2ddabade0ddf992dcc6e9c049f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5ebb2ddabade0ddf992dcc6e9c049f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">davenso</span>
<span class="date">January 8, 2018 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-425878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>very cool.</p>
<div class="reply">
<a aria-label="Reply to davenso" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=425878#respond" onclick='return addComment.moveForm( "comment-425878", "425878", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425907">
<div class="comment-container" id="li-comment-425907">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-425907" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=425907#respond" onclick='return addComment.moveForm( "comment-425907", "425907", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425879">
<div class="comment-container" id="li-comment-425879">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5ebb2ddabade0ddf992dcc6e9c049f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5ebb2ddabade0ddf992dcc6e9c049f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">davenso</span>
<span class="date">January 8, 2018 at 4:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-425879" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Based on this example, how long does it take typically to save or retrieve a checkpoint model?</p>
<div class="reply">
<a aria-label="Reply to davenso" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=425879#respond" onclick='return addComment.moveForm( "comment-425879", "425879", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425908">
<div class="comment-container" id="li-comment-425908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-425908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very fast, just a few seconds for large models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=425908#respond" onclick='return addComment.moveForm( "comment-425908", "425908", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-425965">
<div class="comment-container" id="li-comment-425965">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80d4f7c3574cf491f3ae62ffd40dc260?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80d4f7c3574cf491f3ae62ffd40dc260?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">davenso</span>
<span class="date">January 9, 2018 at 3:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-425965" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, Jason. Could you kindly give an estimate, more than 10 secs?</p>
<div class="reply">
<a aria-label="Reply to davenso" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=425965#respond" onclick='return addComment.moveForm( "comment-425965", "425965", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426048">
<div class="comment-container" id="li-comment-426048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-426048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Large models can take about a minute.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=426048#respond" onclick='return addComment.moveForm( "comment-426048", "426048", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-426264">
<div class="comment-container" id="li-comment-426264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c37bc17ca9178c3e5f91ba0f3dc7021?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c37bc17ca9178c3e5f91ba0f3dc7021?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kszyniu</span>
<span class="date">January 12, 2018 at 5:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-426264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice post.<br/>
However, I have one question. Can I get number of epochs that model was trained for in other way than reading its filename?<br/>
Here’s my use case: upon loading my model I want to restore the training exactly from the point I saved it (by passing a value to initial_epoch argument in .fit()) for the sake of better-looking graphs in TensorBoard.<br/>
For example, I trained my model for 2 epochs (got 2 messages: “Epoch 1/5”, “Epoch 2/5”) and saved it. Now, I want to load that model and continue training from 3rd epoch (I expect getting message “Epoch 3/5” and so on).<br/>
Is there a better way than saving epochs to filename and then getting it from there (which seems kinda messy)?</p>
<div class="reply">
<a aria-label="Reply to kszyniu" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=426264#respond" onclick='return addComment.moveForm( "comment-426264", "426264", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426297">
<div class="comment-container" id="li-comment-426297">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 11:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-426297" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could read this from the filename. It’s just a string.</p>
<p>You could also have a callback that writes the last epoch completed to a file, and overwrite this file each time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=426297#respond" onclick='return addComment.moveForm( "comment-426297", "426297", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426677">
<div class="comment-container" id="li-comment-426677">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a940fab845c76d69f7c7f37be30a424?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a940fab845c76d69f7c7f37be30a424?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Max Jansen</span>
<span class="date">January 16, 2018 at 9:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-426677" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post and a fantastic blog! I can’t thank you enough!</p>
<div class="reply">
<a aria-label="Reply to Max Jansen" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=426677#respond" onclick='return addComment.moveForm( "comment-426677", "426677", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426717">
<div class="comment-container" id="li-comment-426717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 17, 2018 at 9:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/#comment-426717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="https://machinelearningmastery.com/check-point-deep-learning-models-keras/?replytocom=426717#respond" onclick='return addComment.moveForm( "comment-426717", "426717", "respond", "2575" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/check-point-deep-learning-models-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea aria-required="true" cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2575"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="f3c40ccbc5"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="35"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Dr. Jason Brownlee.
<br/>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br/>
Looking for step-by-step tutorials?<br/>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br/>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img alt="Your First Machine Learning Project in Python Step-By-Step" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" title="Your First Machine Learning Project in Python Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step">Your First Machine Learning Project in Python Step-By-Step</a>
<span class="meta">June 10, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 21, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img alt="Line Plots of Air Pollution Time Series" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" title="Multivariate Time Series Forecasting with LSTMs in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras">Multivariate Time Series Forecasting with LSTMs in Keras</a>
<span class="meta">August 14, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img alt="Tour of Deep Learning Algorithms" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/04/Tour-of-Deep-Learning-Algorithms-150x150.jpg" title="Develop Your First Neural Network in Python With Keras Step-By-Step" width="45"/></a> <a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
<span class="meta">May 24, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/03/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" width="45"/></a> <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
<span class="meta">March 13, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
<span class="meta">July 26, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" title="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
<span class="meta">April 7, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" width="45"/></a> <a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
<span class="meta">June 2, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img alt="Regression Tutorial with Keras Deep Learning Library in Python" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" title="Regression Tutorial with the Keras Deep Learning Library in Python" width="45"/></a> <a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python">Regression Tutorial with the Keras Deep Learning Library in Python</a>
<span class="meta">June 9, 2016</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" width="45"/></a> <a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
<span class="meta">August 9, 2016</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> </aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/contact/">Contact</a> |
<a href="/about/">About</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9.2" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"555b70787c"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/seo-optimized-share-buttons/js/frontend.js?ver=4.2.2.0.iis7_supports_permalinks" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.2" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.2" type="text/javascript"></script>
</body>
</html>